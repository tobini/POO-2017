'From Cuis 5.0 of 7 November 2016 [latest update: #2974] on 7 November 2016 at 2:53:38 pm'!


----SNAPSHOT----#(7 November 2016 2:53:55.973029 pm) Cuis5.0-2974-spur.image priorSource: 0!

----QUIT----#(7 November 2016 2:54:03.110029 pm) Cuis5.0-2974-spur.image priorSource: 92!

----STARTUP----#(17 November 2016 12:32:23.600889 pm) as /root/PayloadSoftware/Cuis-Smalltalk-Dev/Cuis5.0-2974-spur.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #2974] on 16 November 2016 at 3:55:25 pm'!
!Integer class methodsFor: 'instance creation' stamp: 'jmv 11/16/2016 15:37:15' prior: 16860879!
              readFrom: aStream base: base
	"Answer an instance of one of my concrete subclasses. Initial minus sign
	accepted, and bases > 10 use letters A-Z. Embedded radix specifiers not
	allowed--use Number readFrom: for that. Answer zero (not an error) if
	there are no digits."

	| digit value neg cc atLeastOneDigitRead |
	neg _ aStream peekFor: $-.
	neg ifFalse: [aStream peekFor: $+].
	value _ 0.
	atLeastOneDigitRead _ false.
	[ aStream atEnd ]
		whileFalse: [
			cc _ aStream next.
			digit _ cc digitValue.
			(digit < 0 or: [digit >= base])
				ifTrue: [
					aStream skip: -1.
					atLeastOneDigitRead ifFalse: [self error: 'At least one digit expected here'].
					^neg
						ifTrue: [value negated]
						ifFalse: [value]].
			value _ value * base + digit.
			atLeastOneDigitRead _ true ].
	neg ifTrue: [^ value negated].
	^ value! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2975-Integer-readFrom-cleanup-JuanVuletich-2016Nov16-15h20m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2975] on 17 November 2016 at 9:08:34 am'!
!PositionableStream methodsFor: 'accessing' stamp: 'jmv 11/17/2016 09:06:59' prior: 16891425!
           peek
	"Answer what would be returned if the message next were sent to the 
	receiver. If the receiver is at the end, answer nil."

	| nextObject |
	position < readLimit ifTrue: [
		^collection at: position+1 ].
	self atEnd ifTrue: [^nil].
	nextObject _ self next.
	position _ position - 1.
	^nextObject! !
!StandardFileStream methodsFor: 'read, write, position' stamp: 'jmv 11/17/2016 09:07:20' prior: 16913380!
    peek
	"Answer what would be returned if the message next were sent to the receiver. If the receiver is at the end, answer nil.  "
	| next |
	position < readLimit ifTrue: [
		^collection at: position+1 ].
	self atEnd ifTrue: [^ nil].
	next _ self basicNext.
	self position: self position - 1.
	^ next! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2976-peek-Optimization-JuanVuletich-2016Nov17-09h06m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2975] on 17 November 2016 at 9:18:37 am'!
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:42'!
                               nextDouble64BigEndian: bigEndian
	"Store the given number as a 32 bit Float on this (binary) stream.

	Float pi hex '400921FB54442D18'
	Float pi negated hex 'C00921FB54442D18'

	(ByteArray streamContents: [ :strm |
		strm nextDouble64Put: Float pi bigEndian: false ])
			readStream nextDouble64BigEndian: false

	(ByteArray streamContents: [ :strm |
		strm nextDouble64Put: Float pi bigEndian: true ])
			readStream nextDouble64BigEndian: true
	"
	| bytes |
	bytes _ self next: 8.
	^ bytes doubleAt: 1 bigEndian: bigEndian! !
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:40'!
            nextDouble64Put: aFloat bigEndian: bigEndian
	"Store the given number as a 32 bit Float on this (binary) stream.

	Float pi hex '400921FB54442D18'
	Float pi negated hex 'C00921FB54442D18'

	(ByteArray streamContents: [ :strm |
		strm nextDouble64Put: Float pi bigEndian: false ]) hex

	(ByteArray streamContents: [ :strm |
		strm nextDouble64Put: Float pi bigEndian: true ]) hex
	"
	| bytes |
	bytes _ ByteArray new: 8.
	bytes doubleAt: 1 put: aFloat bigEndian: bigEndian.
	self nextPutAll: bytes! !
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:38'!
      nextFloat32BigEndian: bigEndian
	"Store the given number as a 32 bit Float on this (binary) stream.

	Float pi hex '400921FB54442D18'
	Float pi negated hex 'C00921FB54442D18'
	Float pi asIEEE32BitWord hex '16r40490FDB'
	Float pi negated asIEEE32BitWord hex '16rC0490FDB'

	(ByteArray streamContents: [ :strm |
		strm nextFloat32Put: Float pi bigEndian: false ])
			readStream nextFloat32BigEndian: false

	(ByteArray streamContents: [ :strm |
		strm nextFloat32Put: Float pi bigEndian: true ])
			readStream nextFloat32BigEndian: true
	"
	| bytes |
	bytes _ self next: 4.
	^ bytes floatAt: 1 bigEndian: bigEndian! !
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:34'!
                  nextFloat32Put: aFloat bigEndian: bigEndian
	"Store the given number as a 32 bit Float on this (binary) stream.

	Float pi hex '400921FB54442D18'
	Float pi negated hex 'C00921FB54442D18'
	Float pi asIEEE32BitWord hex '16r40490FDB'
	Float pi negated asIEEE32BitWord hex '16rC0490FDB'

	(ByteArray streamContents: [ :strm |
		strm nextFloat32Put: Float pi bigEndian: false ]) hex 'DB0F4940'

	(ByteArray streamContents: [ :strm |
		strm nextFloat32Put: Float pi bigEndian: true ]) hex '40490FDB'
	"
	| bytes |
	bytes _ ByteArray new: 4.
	bytes floatAt: 1 put: aFloat bigEndian: bigEndian.
	self nextPutAll: bytes! !
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:26'!
                    nextSignedInt16BigEndian: bigEndian
	"Answer the next  signed, 16-bit integer from this (binary) stream.

	(ByteArray streamContents: [ :strm |
		strm nextSignedInt16Put: -12345 bigEndian: false ]) 
			readStream nextSignedInt16BigEndian: false

	(ByteArray streamContents: [ :strm |
		strm nextSignedInt16Put: -12345 bigEndian: true ]) 
			readStream nextSignedInt16BigEndian: true
	"
	| bytes |
	bytes _ self next: 2.
	^ bytes shortAt: 1 bigEndian: bigEndian! !
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:26'!
          nextSignedInt16Put: aNumber bigEndian: bigEndian
	"Store the given number as a signed, 16-bit integer on this (binary) stream.

	(16r10000-12345) hex '16rCFC7'

	(ByteArray streamContents: [ :strm |
		strm nextSignedInt16Put: -12345 bigEndian: false ]) hex

	(ByteArray streamContents: [ :strm |
		strm nextSignedInt16Put: -12345 bigEndian: true ]) hex
	"
	| bytes |
	bytes _ ByteArray new: 2.
	bytes shortAt: 1 put: aNumber bigEndian: bigEndian.
	self nextPutAll: bytes! !
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:26'!
nextSignedInt32BigEndian: bigEndian
	"Answer the next signed, 32-bit integer from this (binary) stream.

	(ByteArray streamContents: [ :strm |
		strm nextSignedInt32Put: -123456 bigEndian: false ]) 
			readStream nextSignedInt32BigEndian: false

	(ByteArray streamContents: [ :strm |
		strm nextSignedInt32Put: -123456 bigEndian: true ]) 
			readStream nextSignedInt32BigEndian: true
	"
	| bytes |
	bytes _ self next: 4.
	^ bytes longAt: 1 bigEndian: bigEndian! !
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:27'!
          nextSignedInt32Put: aNumber bigEndian: bigEndian
	"Store the given number as a signed, 32-bit integer on this (binary) stream.

	(16r100000000-123456) hex '16rFFFE1DC0'

	(ByteArray streamContents: [ :strm |
		strm nextSignedInt32Put: -123456 bigEndian: false ]) hex

	(ByteArray streamContents: [ :strm |
		strm nextSignedInt32Put: -123456 bigEndian: true ]) hex
	"
	| bytes |
	bytes _ ByteArray new: 4.
	bytes longAt: 1 put: aNumber bigEndian: bigEndian.
	self nextPutAll: bytes! !
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:18'!
                      nextUnsignedInt16BigEndian: bigEndian
	"Answer the next unsigned, 16-bit integer from this (binary) stream.

	(ByteArray streamContents: [ :strm |
		strm nextUnsignedInt16Put: 12345 bigEndian: false ]) 
			readStream nextUnsignedInt16BigEndian: false

	(ByteArray streamContents: [ :strm |
		strm nextUnsignedInt16Put: 12345 bigEndian: true ]) 
			readStream nextUnsignedInt16BigEndian: true
	"
	| bytes |
	bytes _ self next: 2.
	^ bytes unsignedShortAt: 1 bigEndian: bigEndian! !
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:27'!
                         nextUnsignedInt16Put: aNumber bigEndian: bigEndian
	"Store the given number as a unsigned, 16-bit integer on this (binary) stream.

	12345 hex  '16r3039'

	(ByteArray streamContents: [ :strm |
		strm nextUnsignedInt16Put: 12345 bigEndian: false ]) hex

	(ByteArray streamContents: [ :strm |
		strm nextUnsignedInt16Put: 12345 bigEndian: true ]) hex
	"
	| bytes |
	bytes _ ByteArray new: 2.
	bytes unsignedShortAt: 1 put: aNumber bigEndian: bigEndian.
	self nextPutAll: bytes! !
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:19'!
                            nextUnsignedInt32BigEndian: bigEndian
	"Answer the next unsigned, 32-bit integer from this (binary) stream.

	(ByteArray streamContents: [ :strm |
		strm nextUnsignedInt32Put: 123456 bigEndian: false ]) 
			readStream nextUnsignedInt32BigEndian: false

	(ByteArray streamContents: [ :strm |
		strm nextUnsignedInt32Put: 123456 bigEndian: true ]) 
			readStream nextUnsignedInt32BigEndian: true
	"
	| bytes |
	bytes _ self next: 4.
	^ bytes unsignedLongAt: 1 bigEndian: bigEndian! !
!Stream methodsFor: 'normalized access' stamp: 'jmv 2/25/2016 11:27'!
                        nextUnsignedInt32Put: aNumber bigEndian: bigEndian
	"Store the given number as a unsigned, 32-bit integer on this (binary) stream.

	123456 hex '16r1E240'

	(ByteArray streamContents: [ :strm |
		strm nextUnsignedInt32Put: 123456 bigEndian: false ]) hex

	(ByteArray streamContents: [ :strm |
		strm nextUnsignedInt32Put: 123456 bigEndian: true ]) hex
	"
	| bytes |
	bytes _ ByteArray new: 4.
	bytes unsignedLongAt: 1 put: aNumber bigEndian: bigEndian.
	self nextPutAll: bytes! !
!Stream methodsFor: 'nonhomogeneous accessing' stamp: 'jmv 6/14/2013 20:02'!
                   nextNumber
	"Answer a number from the stream."

	|element|
	[(element := self next) isNil or: [element isDigit or: [element = $- or: [element = $)]]]] whileFalse.
	element ifNil: [^nil].
	self skip: -1.
	element = $) ifTrue: [^nil].
	^Number readFrom: self! !
!Stream methodsFor: 'nonhomogeneous accessing' stamp: 'jmv 2/29/2016 11:04'!
               nextNumber: n 
	"Answer the next n bytes as a positive Integer or LargePositiveInteger.
	Currently only for bigEndian. Consider following the convention in category 'normalized access'"
	| s |
	s _ 0.
	1 to: n do: 
		[:i | s _ (s bitShift: 8) bitOr: self next asInteger].
	^ s normalize! !
!Stream methodsFor: 'nonhomogeneous accessing' stamp: 'jmv 2/29/2016 11:04'!
                 nextNumber: n put: v 
	"Append to the receiver the argument, v, which is a positive 
	SmallInteger or a LargePositiveInteger, as the next n bytes.
	Possibly pad with leading zeros.
	Currently only for bigEndian. Consider following the convention in category 'normalized access'"

	1 to: n do: [:i | self nextPut: (v digitAt: n+1-i)].
	^ v
! !
!Stream methodsFor: 'nonhomogeneous accessing' stamp: 'ls 9/14/1998 22:46'!
                             nextString
	"Read a string from the receiver. The first byte is the length of the string, unless it is greater than 192, in which case the first four bytes encode the length.  I expect to be in ascii mode when called (caller puts back to binary)."

	| aString length |

	"read the length in binary mode"
	self binary.
	length _ self next.		"first byte."
	length >= 192 ifTrue: [length _ length - 192.
		1 to: 3 do: [:ii | length _ length * 256 + self next]].
	aString _ String new: length.

	"read the characters in ASCII mode"
	self ascii.
	self nextInto: aString.
	^aString! !
!Stream methodsFor: 'nonhomogeneous accessing' stamp: 'yo 4/16/2001 17:56'!
                 nextStringPut: s 
	"Append the string, s, to the receiver.  Only used by DataStream.  Max size of 64*256*256*256."

	| length |
	(length _ s size) < 192
		ifTrue: [self nextPut: length]
		ifFalse: 
			[self nextPut: (length digitAt: 4)+192.
			self nextPut: (length digitAt: 3).
			self nextPut: (length digitAt: 2).
			self nextPut: (length digitAt: 1)].
	self nextPutAll: s asByteArray.
	^s! !

DummyStream removeSelector: #nextDouble64BigEndian:!

DummyStream removeSelector: #nextDouble64BigEndian:!

DummyStream removeSelector: #nextDouble64Put:bigEndian:!

DummyStream removeSelector: #nextDouble64Put:bigEndian:!

DummyStream removeSelector: #nextNumber:put:!

DummyStream removeSelector: #nextNumber:put:!

DummyStream removeSelector: #nextSignedInt16BigEndian:!

DummyStream removeSelector: #nextSignedInt16BigEndian:!

DummyStream removeSelector: #nextSignedInt16Put:bigEndian:!

DummyStream removeSelector: #nextSignedInt16Put:bigEndian:!

DummyStream removeSelector: #nextSignedInt32BigEndian:!

DummyStream removeSelector: #nextSignedInt32BigEndian:!

DummyStream removeSelector: #nextSignedInt32Put:bigEndian:!

DummyStream removeSelector: #nextSignedInt32Put:bigEndian:!

DummyStream removeSelector: #nextStringPut:!

DummyStream removeSelector: #nextStringPut:!

DummyStream removeSelector: #nextUnsignedInt16BigEndian:!

DummyStream removeSelector: #nextUnsignedInt16BigEndian:!

DummyStream removeSelector: #nextUnsignedInt16Put:bigEndian:!

DummyStream removeSelector: #nextUnsignedInt16Put:bigEndian:!

DummyStream removeSelector: #nextUnsignedInt32BigEndian:!

DummyStream removeSelector: #nextUnsignedInt32BigEndian:!

DummyStream removeSelector: #nextUnsignedInt32Put:bigEndian:!

DummyStream removeSelector: #nextUnsignedInt32Put:bigEndian:!

DataStream removeSelector: #readStringOld!

DataStream removeSelector: #readStringOld!

PositionableStream removeSelector: #nextDouble64BigEndian:!

PositionableStream removeSelector: #nextDouble64BigEndian:!

PositionableStream removeSelector: #nextDouble64Put:bigEndian:!

PositionableStream removeSelector: #nextDouble64Put:bigEndian:!

PositionableStream removeSelector: #nextFloat32BigEndian:!

PositionableStream removeSelector: #nextFloat32BigEndian:!

PositionableStream removeSelector: #nextFloat32Put:bigEndian:!

PositionableStream removeSelector: #nextFloat32Put:bigEndian:!

PositionableStream removeSelector: #nextNumber!

PositionableStream removeSelector: #nextNumber!

PositionableStream removeSelector: #nextNumber:!

PositionableStream removeSelector: #nextNumber:!

PositionableStream removeSelector: #nextNumber:put:!

PositionableStream removeSelector: #nextNumber:put:!

PositionableStream removeSelector: #nextSignedInt16BigEndian:!

PositionableStream removeSelector: #nextSignedInt16BigEndian:!

PositionableStream removeSelector: #nextSignedInt16Put:bigEndian:!

PositionableStream removeSelector: #nextSignedInt16Put:bigEndian:!

PositionableStream removeSelector: #nextSignedInt32BigEndian:!

PositionableStream removeSelector: #nextSignedInt32BigEndian:!

PositionableStream removeSelector: #nextSignedInt32Put:bigEndian:!

PositionableStream removeSelector: #nextSignedInt32Put:bigEndian:!

PositionableStream removeSelector: #nextString!

PositionableStream removeSelector: #nextString!

PositionableStream removeSelector: #nextStringOld!

PositionableStream removeSelector: #nextStringOld!

PositionableStream removeSelector: #nextStringPut:!

PositionableStream removeSelector: #nextStringPut:!

PositionableStream removeSelector: #nextUnsignedInt16BigEndian:!

PositionableStream removeSelector: #nextUnsignedInt16BigEndian:!

PositionableStream removeSelector: #nextUnsignedInt16Put:bigEndian:!

PositionableStream removeSelector: #nextUnsignedInt16Put:bigEndian:!

PositionableStream removeSelector: #nextUnsignedInt32BigEndian:!

PositionableStream removeSelector: #nextUnsignedInt32BigEndian:!

PositionableStream removeSelector: #nextUnsignedInt32Put:bigEndian:!

PositionableStream removeSelector: #nextUnsignedInt32Put:bigEndian:!

Stream removeSelector: #nextStringOld!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2977-Stream-refactor-JuanVuletich-2016Nov17-09h08m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2977] on 17 November 2016 at 10:29:07 am'!
!PositionableStream methodsFor: 'testing' stamp: 'jmv 11/17/2016 10:28:06' prior: 16891536!
         atEnd
	"Answer whether the receiver can access any more objects."

	^position >= readLimit! !
!ReadStream methodsFor: 'accessing' stamp: 'jmv 11/17/2016 09:59:57' prior: 16897965!
            next
	"Answer the next object in the Stream represented by the receiver."

	^position >= readLimit
		ifFalse: [collection at: (position _ position + 1)]! !
!WriteStream methodsFor: 'accessing' stamp: 'jmv 11/17/2016 10:28:35' prior: 16946385!
             nextPut: anObject 
	"Insert the argument at the next position in the Stream represented by the receiver."

	position >= writeLimit
		ifTrue: [^ self pastEndPut: anObject]
		ifFalse: [
			position _ position + 1.
			^collection at: position put: anObject]! !
!ReadWriteStream methodsFor: 'accessing' stamp: 'jmv 11/17/2016 10:28:45' prior: 16898094!
   next
	"Return the next object in the Stream represented by the receiver."

	"treat me as a FIFO"
	^ position >= readLimit
		ifFalse: [collection at: (position _ position + 1)]! !
!StandardFileStream methodsFor: 'read, write, position' stamp: 'jmv 11/17/2016 10:00:56' prior: 16913098!
   basicNext
	"Answer the next byte from this file, or nil if at the end of the file."
	
	| count |
	collection ifNotNil: [
		position < readLimit 
			ifFalse: [ 
				readLimit := self primRead: fileID into: collection startingAt: 1 count: collection size.
				position := 0.
				readLimit = 0 ifTrue: [ ^nil ] ].
		^collection at: (position := position + 1) ].	
	count _ self primRead: fileID into: buffer1 startingAt: 1 count: 1.
	^count = 1
		ifTrue: [ buffer1 at: 1 ]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2978-RemoveObsoletePrimCalls-JuanVuletich-2016Nov17-10h26m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2977] on 17 November 2016 at 10:31:18 am'!

Stream subclass: #StdIOReadStream
	instanceVariableNames: 'fileID name buffer1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'System-Support'!

!classDefinition: #StdIOReadStream category: #'System-Support'!
Stream subclass: #StdIOReadStream
	instanceVariableNames: 'fileID name buffer1'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'System-Support'!
!StdIOReadStream commentStamp: '<historical>' prior: 0!
     Standard Input Stream.

A basic problem/restriction with this code is that currently the VM runs multiple VM threads within a single OS thread.

This means that waiting on StdIn blocks the VM, suspending all Smalltalk code.!

Stream subclass: #StdIOWriteStream
	instanceVariableNames: 'fileID name buffer1 collection readLimit position'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'System-Support'!

!classDefinition: #StdIOWriteStream category: #'System-Support'!
Stream subclass: #StdIOWriteStream
	instanceVariableNames: 'fileID name buffer1 collection readLimit position'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'System-Support'!
!StdIOWriteStream commentStamp: '<historical>' prior: 0!
               Standard Output/Error Streams.!
!StdIOReadStream methodsFor: 'open / close' stamp: 'jmv 11/17/2016 10:12:24'!
                  openOnHandle: aFileID name: streamName
	"Initialize the instance with the given file handle.
	 N.B. Do _not_ register the stream.  We do not want it to be
	 closed implicitly (e.g. on GC).  There may be multiple instances
	 accessing the same stream.  The stream is not a file."

	fileID _ aFileID.
	name _ streamName.
	buffer1 _ String new: 1! !
!StdIOReadStream methodsFor: 'streaming' stamp: 'jmv 11/17/2016 10:01:57'!
                          next
	"Answer the next byte from this stream, or wait until one becomes available.
	Warning: all Smalltalk processes are essentially suspended until that happens!!"

	| count |
	count _ self primRead: fileID into: buffer1 startingAt: 1 count: 1.
	^count = 1
		ifTrue: [ buffer1 at: 1 ]! !
!StdIOReadStream methodsFor: 'printing' stamp: 'jmv 11/17/2016 09:47:10'!
                     printOn: aStream
	"Put a printed version of the receiver onto aStream."

	aStream nextPutAll: self class name; nextPutAll: ': '; print: name! !
!StdIOReadStream methodsFor: 'primitives' stamp: 'jmv 11/17/2016 09:45:28'!
    primRead: id into: byteArray startingAt: startIndex count: count
	"Read up to count bytes of data from this file into the given string or byte array starting at the given index. Answer the number of bytes actually read."

	<primitive: 'primitiveFileRead' module: 'FilePlugin'>
	self error: 'File read failed'! !
!StdIOReadStream class methodsFor: 'instance creation' stamp: 'jmv 11/17/2016 09:46:36'!
               stdin
	| newSelf |
	newSelf _ self basicNew.
	newSelf 
		openOnHandle: self stdinHandle 
		name: 'stdin'.
	^newSelf! !
!StdIOReadStream class methodsFor: 'accessing' stamp: 'jmv 11/17/2016 09:26:47'!
                        stdinHandle

	^ StdIOWriteStream stdioHandles at: 1! !
!StdIOWriteStream methodsFor: 'open / close' stamp: 'jmv 11/17/2016 10:14:32'!
                          openOnHandle: aFileID name: streamName
	"Initialize the instance with the given file handle.
	 N.B. Do _not_ register the stream.  We do not want it to be
	 closed implicitly (e.g. on GC).  There may be multiple instances
	 accessing the same stream.  The stream is not a file."

	fileID _ aFileID.
	name _ streamName.
	buffer1 _ String new: 1! !
!StdIOWriteStream methodsFor: 'streaming' stamp: 'jmv 11/17/2016 10:19:51'!
                         flush
	"Flush pending changes"
	^self primFlush: fileID! !
!StdIOWriteStream methodsFor: 'streaming' stamp: 'jmv 11/17/2016 10:18:42'!
                         nextPut: char
	"Write the given character to this file."

	buffer1 at: 1 put: char.
	self primWrite: fileID from: buffer1 startingAt: 1 count: 1.
	^ char
! !
!StdIOWriteStream methodsFor: 'printing' stamp: 'jmv 11/17/2016 09:35:56'!
                       printOn: aStream
	"Put a printed version of the receiver onto aStream.  1/31/96 sw"

	aStream nextPutAll: self class name; nextPutAll: ': '; print: name! !
!StdIOWriteStream methodsFor: 'primitives' stamp: 'jmv 11/17/2016 10:20:17'!
                       primFlush: id
	"Flush pending changes to the disk"

	<primitive: 'primitiveFileFlush' module: 'FilePlugin'>! !
!StdIOWriteStream methodsFor: 'primitives' stamp: 'jmv 11/17/2016 10:19:14'!
    primWrite: id from: stringOrByteArray startingAt: startIndex count: count
	"Write count bytes onto this file from the given string or byte array starting at the given index. Answer the number of bytes written."

	<primitive: 'primitiveFileWrite' module: 'FilePlugin'>
	(FileWriteError fileName: name)
		signal: (self closed
			ifTrue: [ 'File [', name, '] is closed' ]
			ifFalse: [ 'File [', name, '] write failed' ])! !
!StdIOWriteStream class methodsFor: 'instance creation' stamp: 'jmv 11/17/2016 10:15:08'!
stderr
	| newSelf |
	newSelf _ self basicNew.
	newSelf 
		openOnHandle: self stderrHandle 
		name: 'stderr'.
	^newSelf! !
!StdIOWriteStream class methodsFor: 'instance creation' stamp: 'jmv 11/17/2016 10:15:11'!
            stdout
	| newSelf |
	newSelf _ self basicNew.
	newSelf 
		openOnHandle: self stdoutHandle 
		name: 'stdout'.
	^newSelf! !
!StdIOWriteStream class methodsFor: 'accessing' stamp: 'jmv 11/17/2016 09:26:20'!
                    stderrHandle

	^ self stdioHandles at: 3! !
!StdIOWriteStream class methodsFor: 'accessing' stamp: 'jmv 11/17/2016 09:26:09'!
  stdioHandles
" answer handles: #(stdin stdout stderr) "
	<primitive: 'primitiveFileStdioHandles' module: 'FilePlugin' error: ec>
	self primitiveFailed! !
!StdIOWriteStream class methodsFor: 'accessing' stamp: 'jmv 11/17/2016 09:26:12'!
                    stdoutHandle

	^ self stdioHandles at: 2! !

Smalltalk removeClassNamed: #StdIOFileStream!

Smalltalk removeClassNamed: #StdIOFileStream!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2979-NewStdIO-JuanVuletich-2016Nov17-10h29m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2979] on 17 November 2016 at 10:51:20 am'!
!StdIOWriteStream methodsFor: 'character writing' stamp: 'jmv 11/17/2016 10:48:18'!
                              newLine
	"Append a newLine character to the receiver.
	The Cuis convention is to use lf on output."

	self nextPut: Character newLineCharacter! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2980-stdout-newLine-JuanVuletich-2016Nov17-10h48m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2980] on 17 November 2016 at 11:51:03 am'!

Stream subclass: #StdIOReadStream
	instanceVariableNames: 'fileID name buffer1 peeked '
	classVariableNames: 'StdIn '
	poolDictionaries: ''
	category: 'System-Support'!

!classDefinition: #StdIOReadStream category: #'System-Support'!
Stream subclass: #StdIOReadStream
	instanceVariableNames: 'fileID name buffer1 peeked'
	classVariableNames: 'StdIn'
	poolDictionaries: ''
	category: 'System-Support'!

Stream subclass: #StdIOWriteStream
	instanceVariableNames: 'fileID name buffer1 collection readLimit position '
	classVariableNames: 'StdOut StdErr '
	poolDictionaries: ''
	category: 'System-Support'!

!classDefinition: #StdIOWriteStream category: #'System-Support'!
Stream subclass: #StdIOWriteStream
	instanceVariableNames: 'fileID name buffer1 collection readLimit position'
	classVariableNames: 'StdErr StdOut'
	poolDictionaries: ''
	category: 'System-Support'!
!StdIOReadStream methodsFor: 'streaming' stamp: 'jmv 11/17/2016 11:28:43'!
                    peek
	"Answer the next byte from this stream, or wait until one becomes available.
	Warning: all Smalltalk processes are essentially suspended until that happens!!
	
	Do not advance the stream!!"

	"Multiple calls to #peek don't make new reads"
	peeked ifFalse: [
		self privateRead.
		peeked _ true ].

	"peeked is always true on exit"
	^buffer1 at: 1! !
!StdIOReadStream methodsFor: 'streaming' stamp: 'jmv 11/17/2016 11:33:22'!
                 peekFor: aCharacter 
	"Answer false and do not move over the next element if it is not equal to the argument, aCharacter 
	Answer true and increment the position for accessing elements, if the next element is equal to anObject."

	| nextChar |
	nextChar _ self peek.
	aCharacter = nextChar ifTrue: [
		self next.
		^ true].
	^ false! !
!StdIOReadStream methodsFor: 'streaming' stamp: 'jmv 11/17/2016 11:24:52'!
     privateRead
	"Read one Character.
	Private."
	| count |
	count _ self primRead: fileID into: buffer1 startingAt: 1 count: 1.
	count = 1 ifFalse: [ buffer1 at: 1 put: nil ]! !
!StdIOReadStream class methodsFor: 'cached state access' stamp: 'jmv 11/17/2016 11:45:00'!
                      releaseClassCachedState

	StdIn _ nil! !
!StdIOWriteStream methodsFor: 'character writing' stamp: 'jmv 11/17/2016 11:08:02'!
   space
	"Append a space character to the receiver."

	self nextPut: Character space! !
!StdIOWriteStream class methodsFor: 'cached state access' stamp: 'jmv 11/17/2016 11:44:50'!
              releaseClassCachedState

	StdOut _ nil.
	StdErr _ nil! !
!StdIOReadStream methodsFor: 'open / close' stamp: 'jmv 11/17/2016 11:13:30' prior: 50332252!
         openOnHandle: aFileID name: streamName
	"Initialize the instance with the given file handle.
	 N.B. Do _not_ register the stream.  We do not want it to be
	 closed implicitly (e.g. on GC).  There may be multiple instances
	 accessing the same stream.  The stream is not a file."

	fileID _ aFileID.
	name _ streamName.
	buffer1 _ String new: 1.
	peeked _ false! !
!StdIOReadStream methodsFor: 'streaming' stamp: 'jmv 11/17/2016 11:28:44' prior: 50332266!
                         next
	"Answer the next byte from this stream, or wait until one becomes available.
	Warning: all Smalltalk processes are essentially suspended until that happens!!"

	"If last call was #peek, not #next, then just answer cached value."
	peeked
		ifFalse: [ self privateRead ]
		ifTrue: [ peeked _ false ].

	"peeked is always false on exit"
	^buffer1 at: 1! !
!StdIOReadStream class methodsFor: 'instance creation' stamp: 'jmv 11/17/2016 11:45:39' prior: 50332298!
                stdin
	StdIn ifNil: [
		StdIn _ self basicNew.
		StdIn 
			openOnHandle: self stdinHandle 
			name: 'stdin' ].
	^StdIn! !
!StdIOWriteStream class methodsFor: 'instance creation' stamp: 'jmv 11/17/2016 11:46:13' prior: 50332367!
                            stderr
	StdErr ifNil: [
		StdErr _ self basicNew.
		StdErr 
			openOnHandle: self stderrHandle 
			name: 'stderr' ].
	^StdErr! !
!StdIOWriteStream class methodsFor: 'instance creation' stamp: 'jmv 11/17/2016 11:46:37' prior: 50332374!
                     stdout
	StdOut ifNil: [
		StdOut _ self basicNew.
		StdOut 
			openOnHandle: self stdoutHandle 
			name: 'stdout' ].
	^StdOut! !

Stream subclass: #StdIOReadStream
	instanceVariableNames: 'fileID name buffer1 peeked'
	classVariableNames: 'StdIn'
	poolDictionaries: ''
	category: 'System-Support'!

!classDefinition: #StdIOReadStream category: #'System-Support'!
Stream subclass: #StdIOReadStream
	instanceVariableNames: 'fileID name buffer1 peeked'
	classVariableNames: 'StdIn'
	poolDictionaries: ''
	category: 'System-Support'!

Stream subclass: #StdIOWriteStream
	instanceVariableNames: 'fileID name buffer1'
	classVariableNames: 'StdErr StdOut'
	poolDictionaries: ''
	category: 'System-Support'!

!classDefinition: #StdIOWriteStream category: #'System-Support'!
Stream subclass: #StdIOWriteStream
	instanceVariableNames: 'fileID name buffer1'
	classVariableNames: 'StdErr StdOut'
	poolDictionaries: ''
	category: 'System-Support'!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2981-StdIn-peek-peekFor-JuanVuletich-2016Nov17-11h08m-jmv.1.cs.st----!

----SNAPSHOT----#(17 November 2016 12:32:56.842092 pm) Cuis5.0-2981-spur.image priorSource: 186!

----QUIT----#(17 November 2016 12:33:29.990717 pm) Cuis5.0-2981-spur.image priorSource: 29844!

----STARTUP----#(14 December 2016 2:31:49.510252 pm) as /root/PayloadSoftware/Cuis-Smalltalk-Dev/Cuis5.0-2981-spur.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #2981] on 17 November 2016 at 5:11:35 pm'!
!SequenceableCollection methodsFor: 'copying' stamp: 'jmv 11/17/2016 17:08:04' prior: 16906186!
               copyReplaceFrom: start to: stop with: replacementCollection 
	"Answer a copy of the receiver satisfying the following conditions: 
	+ stop is less than start, then this is an insertion; stop should be exactly start-1, 
	+ start = 1 means insert before the first character,
	+ start = size+1 means append after last character. 
	+ Otherwise, this is a replacement; start and stop have to be within the receiver's bounds."

	| newSequenceableCollection newSize endReplacement |
	newSize _ self size - (stop - start + 1) + replacementCollection size.
	endReplacement _ start - 1 + replacementCollection size.
	newSequenceableCollection _ self species new: newSize.
	start > 1 ifTrue:[
		newSequenceableCollection
			replaceFrom: 1
			to: start - 1
			with: self
			startingAt: 1].
	start <= endReplacement ifTrue:[
		newSequenceableCollection
			replaceFrom: start
			to: endReplacement
			with: replacementCollection
			startingAt: 1].
	endReplacement < newSize ifTrue:[
		newSequenceableCollection
			replaceFrom: endReplacement + 1
			to: newSize
			with: self
			startingAt: stop + 1].
	^newSequenceableCollection! !
!SHTextStylerST80 methodsFor: 'private' stamp: 'jmv 11/17/2016 16:54:39' prior: 16903350!
        setAttributesFromRanges: ranges

	formattedText removeAttributesThat: [ :attribute | attribute isForShout ].

	"Optimize for mutation speed unless method is really large but with very few distict elements:
	Source code that includes just big literals is better served by conventional Text+RunArray"
	"Do it only if we are not breaking textModel!! (for instance, StyledTextEditor asks for formatting just sections, not whole #actualContents)."
	formattedText == textModel actualContents ifTrue: [
		(formattedText size > 2000 and: [ ranges size < 50 ]) ifFalse: [
			formattedText _ formattedText optimizedForMutationSpeed.
			textModel basicActualContents: formattedText ]].

	ranges do: [ :range |

		"Smalltalk text styling"
		(self attributesFor: range rangeType) ifNotNil: [ :attributes |
			attributes do: [ :each |
				formattedText addAttribute: each from: range start to: range end ]].

		"Show as subscripts if appropriate."
		(classOrMetaClass isNil or: [
			classOrMetaClass theNonMetaClass lastUnderscoreMeansSubscript]) ifTrue: [
				(#( instVar classVar globalVar workspaceVar poolConstant
					patternArg methodArg patternTempVar tempVar		
					blockPatternArg blockArg blockPatternTempVar blockTempVar 
					incompleteIdentifier undefinedIdentifier) pointsTo: range rangeType )
						ifTrue: [
							formattedText lastIndexOf: $_ startingAt: range end endingAt: range start do: [ :i |
								formattedText addAttribute: ShoutTextEmphasis subscript from: i to: range end ] ]]]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2982-CodeColorizerFix-JuanVuletich-2016Nov17-17h08m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2981] on 17 November 2016 at 5:18:27 pm'!
!DummyStream methodsFor: 'as yet unclassified' stamp: 'KenD 11/5/2016 16:17:09'!
           space! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2983-DummyStream-space-KenDickey-2016Nov17-17h18m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2981] on 18 November 2016 at 10:49:39 am'!
!TheWorldMenu methodsFor: 'construction' stamp: 'jmv 5/3/2015 10:19' prior: 16935004!
                       newMorph
	"The user requested 'new morph' from the world menu.  Put up a menu that allows many ways of obtaining new morphs.  If the preference #classicNewMorphMenu is true, the full form of yore is used; otherwise, a much shortened form is used."
	| menu subMenu catDict shortCat class |
	menu _ self menu: 'Add a new morph'.
	menu

		add: 'From Clipboard'
		target: myHand
		action: #pasteMorph;
		
		add: 'From Alphabetical List'
		subMenu: self alphabeticalMorphMenu.
	menu addLine.
		
	"Add 'Classic' New Morph menu"
	catDict _ Dictionary new.
	SystemOrganization categories do: [ :cat |
		((cat beginsWith: 'Morphic-') and: [ (#('Morphic-Menus' 'Morphic-Support' ) includes: cat) not ]) ifTrue: [
			shortCat _ (cat
				copyFrom: 'Morphic-' size + 1
				to: cat size).
			(SystemOrganization listAtCategoryNamed: cat) do: [ :cName |
				class _ Smalltalk at: cName.
				((class inheritsFrom: Morph) and: [ class includeInNewMorphMenu ]) ifTrue: [
					(catDict includesKey: shortCat)
						ifTrue: [ (catDict at: shortCat) addLast: class ]
						ifFalse: [
							catDict
								at: shortCat
								put: (OrderedCollection with: class) ]]]]].
	catDict keys sort do: [ :categ |
		subMenu _ MenuMorph new.
		((catDict at: categ) asArray sort: [ :c1 :c2 |
			c1 name < c2 name ]) do: [ :cl |
			subMenu
				add: cl name
				target: self
				selector: #newMorphOfClass:event:
				argument: cl ].
		menu
			add: categ
			subMenu: subMenu ].

	self doPopUp: menu.! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2984-NewMorphMenuFix-JuanVuletich-2016Nov18-10h34m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2984] on 30 November 2016 at 2:56:21 pm'!
!SequenceableCollection methodsFor: 'enumerating' stamp: 'jmv 11/30/2016 14:52:08'!
     with: otherCollection with: thirdCollection collect: threeArgBlock
	"Collect and return the result of evaluating twoArgBlock with corresponding elements from this collection and otherCollection."
	| n result |
	n _ self size.
	otherCollection size = n ifFalse: [ self error: 'otherCollection must be the same size' ].
	thirdCollection size = n ifFalse: [ self error: 'thirdCollection must be the same size' ].
	result _ self species new: n.
	1 to: n do: [ :index | 
		result at: index put:
			(threeArgBlock
				value: (self at: index)
				value: (otherCollection at: index)
				value: (thirdCollection at: index) )].
	^ result! !
!SequenceableCollection methodsFor: 'enumerating' stamp: 'jmv 11/25/2016 12:15:27'!
                     with: otherCollection with: thirdCollection do: threeArgBlock 
	"Evaluate twoArgBlock with corresponding elements from this collection and otherCollection."
	| n |
	n _ self size.
	otherCollection size = n ifFalse: [self error: 'otherCollection must be the same size'].
	thirdCollection size = n ifFalse: [self error: 'thirdCollection must be the same size'].
	1 to: n do: [ :index |
		threeArgBlock
			value: (self at: index)
			value: (otherCollection at: index)
			value: (thirdCollection at: index)]! !
!OrderedCollection methodsFor: 'enumerating' stamp: 'jmv 11/30/2016 14:51:19'!
                      with: otherCollection with: thirdCollection collect: threeArgBlock
	"Collect and return the result of evaluating twoArgBlock with 
	corresponding elements from this collection and otherCollection."
	| result |
	otherCollection size = self size ifFalse: [self error: 'otherCollection must be the same size'].
	result _ self species new: self size.
	1 to: self size do: [ :index |
		result addLast:
			(threeArgBlock
				value: (self at: index)
				value: (otherCollection at: index)
				value: (thirdCollection at: index) )].
	^ result! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2985-withwithdo-withwithdcollect-JuanVuletich-2016Nov30-14h47m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2984] on 30 November 2016 at 3:22:11 pm'!
!SequenceableCollection methodsFor: 'math functions' stamp: 'jmv 11/30/2016 15:04:11'!
                         += anObject
	^anObject isNumber
		ifTrue: [ self replace: [ :v | v + anObject ]]
		ifFalse: [
			self withIndexDo: [ :v :i |
				self at: i put: ((self at: i) + (anObject at: i)) ]]! !
!SequenceableCollection methodsFor: 'math functions' stamp: 'jmv 11/25/2016 11:41:25'!
                -= anObject
	^anObject isNumber
		ifTrue: [ self replace: [ :v | v - anObject ]]
		ifFalse: [
			self withIndexDo: [ :v :i |
				self at: i put: ((self at: i) - (anObject at: i)) ]]! !
!SequenceableCollection methodsFor: 'math functions' stamp: 'jmv 11/30/2016 15:21:00'!
                derivative
	| displaced answer |
	displaced _ self class new: self size.
	displaced replaceFrom: 2 to: self size with: self startingAt: 1.
	displaced at: 1 put: self first - self first.	"Some reasonable zero"
	answer _ self copy.
	answer -= displaced.
	^answer! !
!SequenceableCollection methodsFor: 'math functions' stamp: 'jmv 11/29/2016 14:23:32'!
 integral
	| answer |
	answer _ self copy.
	2 to: answer size do: [ :i |
		answer at: i put: (answer at: i) + (answer at: i-1) ].
	^answer! !

FloatArray removeSelector: #derivative!

FloatArray removeSelector: #derivative!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2986-Collection-derivative-integral-JuanVuletich-2016Nov30-14h56m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2974] on 26 November 2016 at 8:42:22 am'!
!HaloMorph methodsFor: 'stepping' stamp: 'len 7/25/2016 21:39'!
        step
	(target isNil or: [target isInWorld not]) ifTrue: [self delete]! !
!HaloMorph methodsFor: 'stepping' stamp: 'len 7/25/2016 21:41'!
                       stepTime
	^ 100! !
!HaloMorph methodsFor: 'stepping' stamp: 'len 7/25/2016 21:38'!
             wantsSteps
	^ true! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2987-DeleteHaloWhenMorphIsDeleted-LucianoEstebanNotarfrancesco-2016Nov26-08h41m-len.2.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2974] on 26 November 2016 at 8:46:53 am'!
!MenuMorph methodsFor: 'keyboard control' stamp: 'len 6/11/2016 20:40' prior: 16867064!
           keyboardFocusChange: aBoolean
	"Notify change due to green border for keyboard focus"

	aBoolean ifFalse: [self deleteIfPopUp: nil].
	self redrawNeeded! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2988-AvoidManuesHangingAround-LucianoEstebanNotarfrancesco-2016Nov26-08h42m-len.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2974] on 26 November 2016 at 8:52:37 am'!
!SequenceableCollection methodsFor: 'copying' stamp: 'len 4/18/2016 22:08'!
                      shuffledBy: aGenerator
	"To answer a mutable collection when receiver is, for example, an Interval."
	^ (self collect: [ :each | each ]) shuffleBy: aGenerator! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2989-ShuffledBy-LucianoEstebanNotarfrancesco-2016Nov26-08h46m-len.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2974] on 26 November 2016 at 9:02:48 am'!
!SystemDictionary methodsFor: 'browsing' stamp: 'len 6/9/2016 23:23'!
   browseAllPrimitives
	self browseAllSelect: [:each| each primitive ~= 0 and: [(each primitive between: 256 and: 291) not]]
! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2990-SmalltalkBrowseAllPrimitives-LucianoEstebanNotarfrancesco-2016Nov26-08h52m-len.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2974] on 26 November 2016 at 9:03:51 am'!
!SystemDictionary methodsFor: 'retrieving' stamp: 'len 11/26/2016 09:03:25' prior: 16921461!
                              allCallsOn: aLiteral   "Smalltalk browseAllCallsOn: #open:label:."
	"Answer a Collection of all the methods that call on aLiteral."
	| aCollection special aList byte |

	#(23 48 'fred' (new open:label:)) size.
"Example above should find #open:label:, though it is deeply embedded here."

	aCollection _ OrderedCollection new.
	special _ self hasSpecialSelector: aLiteral ifTrueSetByte: [:b | byte _ b ].
	self allBehaviorsDo: [:class |
		aList _ class whichSelectorsReferTo: aLiteral special: special byte: byte.
		aList do: [ :sel |
			"For special selectors, look for the literal in the source code.
			Otherwise, for example, searching for senders of #== will include senders of #ifNil.
			Except for #at:put:, because it has two arguments and won't find it in the source code like that."
			(byte isNil or: [aLiteral = #at:put: or: [
				((class sourceCodeAt: sel)
					findString: aLiteral) > 0]]) ifTrue: [

				aCollection add: (
					MethodReference new
						setStandardClass: class 
						methodSymbol: sel
				)
			]
		]
	].
	^ aCollection! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2991-SendersOfatput-LucianoEstebanNotarfrancesco-2016Nov26-09h02m-len.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2974] on 26 November 2016 at 9:06:05 am'!
!String methodsFor: 'testing' stamp: 'len 11/26/2016 09:05:35'!
         isAlphaNumeric
	"Answer true if the receiver contains only letters or digits."
	^ self allSatisfy: [:each| each isAlphaNumeric]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2992-StringisAlphaNumeric-LucianoEstebanNotarfrancesco-2016Nov26-09h03m-len.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2974] on 26 November 2016 at 9:08:39 am'!
!Form methodsFor: 'fileIn/Out' stamp: 'len 8/1/2016 08:13' prior: 16847779!
                  printOn: aStream
	aStream isText
		ifTrue:
			[aStream withAttribute: (TextAnchor new anchoredFormOrMorph: self) do: [aStream nextPut: $*].
			^ self].
	aStream
		nextPutAll: self class name;
		nextPut: $(; print: width;
		nextPut: $x; print: height;
		nextPut: $x; print: depth;
		nextPut: $)! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2993-FormPrintOnTextForWorkspaces-LucianoEstebanNotarfrancesco-2016Nov26-09h06m-len.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2993] on 5 December 2016 at 8:17:22 am'!
!Morph methodsFor: 'printing' stamp: 'jmv 12/5/2016 08:16:19' prior: 16876467!
  printOn: aStream 
	"Add the identity of the receiver to a stream"
	aStream isText
		ifTrue: [
			aStream
				withAttribute: (TextAnchor new anchoredFormOrMorph: (owner ifNil: [self] ifNotNil: [self imageForm:32]))
				do: [ aStream nextPut: $* ].
			^ self].
	super printOn: aStream. "a(n) className"
	aStream 
		nextPut: $(;
		print: self identityHash;
		nextPut: $).
	self valueOfProperty: #morphName ifPresentDo: [ :x | aStream nextPutAll: x asString]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2994-MorphPrintOnTextEnh-JuanVuletich-2016Dec05-08h16m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2994] on 5 December 2016 at 9:46:02 am'!
!Integer methodsFor: 'comparing' stamp: 'len 12/5/2016 09:46:00' prior: 16859447!
                       hash
	"Hash is reimplemented because = is implemented.
	| s |
	s _ (1 to: 10000) asSet.
	[s includes: 123456] bench
	"

	^self hashMultiply! !

"Postscript:
Leave the line above, and replace the rest of this comment by a useful one.
Executable statements should follow this comment, and should
be separated by periods, with no exclamation points (!!).
Be sure to put any further comments in double-quotes, like this one."

Set rehashAllSets!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2995-Integer-hash-LucianoEstebanNotarfrancesco-2016Dec05-09h39m-len.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2986] on 2 December 2016 at 4:40:51 pm'!
!Form methodsFor: 'scaling, rotation' stamp: 'jmv 12/2/2016 15:47:08' prior: 16848280!
                         flippedBy: direction
	"Return a copy of the receiver flipped either #vertical, #horizontal or #both. (#both is a 180 degrees rotation)
	Form lena display.
	(Form lena flippedBy: #vertical) display.
	(Form lena flippedBy: #horizontal) display.
	(Form lena flippedBy: #both) display.
	"
	| newForm quad |
	newForm _ self class extent: self extent depth: depth.
	quad _ self boundingBox innerCorners.
	quad _ (
		direction caseOf: {
			[ #vertical ] 		-> [#(2 1 4 3)].
			[ #horizontal ] 	-> [#(4 3 2 1)].
			[ #both ] 			-> [#(3 4 1 2)]})
		collect: [:i | quad at: i].
	(WarpBlt toForm: newForm)
		sourceForm: self;
		colorMap: (self colormapIfNeededFor: newForm);
		combinationRule: 3;
		copyQuad: quad toRect: newForm boundingBox.
"	newForm offset: (self offset flippedBy: direction centerAt: aPoint)."
	^ newForm
"
[Sensor isAnyButtonPressed] whileFalse:
	[((Form fromDisplay: (Sensor mousePoint extent: 130@66))
			flippedBy: #vertical centerAt: 0@0) display]
"
"Consistency test...
 | f f2 p |
[ Sensor isAnyButtonPressed ] whileFalse: [
	f _ Form fromDisplay: ((p _ Sensor mousePoint) extent: 31@41).
	Display fillBlack: (p extent: 31@41).
	f2 _ f flippedBy: #vertical centerAt: 0@0.
	(f2 flippedBy: #vertical centerAt: 0@0) displayAt: p ]
"! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2996-Form-FlippedBy-both-JuanVuletich-2016Dec02-15h42m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2996] on 9 December 2016 at 9:12:18 am'!
!StringMorph methodsFor: 'initialization' stamp: 'jmv 12/9/2016 09:09:45' prior: 16918230!
                       initialize
	super initialize.
	font _ nil.
	emphasis _ 0.
	self contents: 'String Morph'
! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2997-StringMorph-fix-JuanVuletich-2016Dec09-09h07m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2974] on 29 November 2016 at 9:10:32 pm'!
!OrderedCollection methodsFor: 'converting' stamp: 'len 11/29/2016 08:54:14'!
           asNewArray
	^ array copyFrom: firstIndex to: lastIndex! !
!OrderedCollection class methodsFor: 'instance creation' stamp: 'len 11/28/2016 19:18:39'!
           newFrom: aCollection
	"Create a new collection containing all the elements from aCollection"

	^(self new: aCollection size)
		resetTo: 1;
		addAll: aCollection;
		yourself! !
!OrderedCollection methodsFor: 'enumerating' stamp: 'len 11/28/2016 10:50:21' prior: 16883972!
                 collect: aBlock 
	"Evaluate aBlock with each of my elements as the argument. Collect the 
	resulting values into a collection that is like me. Answer the new 
	collection. Override superclass in order to use addLast:, not at:put:."

	| newCollection |
	newCollection _ self species new: self size.
	newCollection resetTo: 1.
	firstIndex to: lastIndex do: [ :index |
		newCollection addLast: (aBlock value: (array at: index))].
	^ newCollection! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2998-OrderedCollectionTweaks-LucianoEstebanNotarfrancesco-2016Nov26-09h08m-len.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2995] on 6 December 2016 at 8:16:54 pm'!

RectangleLikeMorph subclass: #ResizeMorph
	instanceVariableNames: 'gridLineWidth gridColor selectionColor outlineMorph grid from to action'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Views'!

!classDefinition: #ResizeMorph category: #'Morphic-Views'!
RectangleLikeMorph subclass: #ResizeMorph
	instanceVariableNames: 'gridLineWidth gridColor selectionColor outlineMorph grid from to action'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Views'!
!SystemWindow methodsFor: 'resize/collapse' stamp: 'bp 10/18/2015 12:18'!
             resize
	| resizeMorph |
	resizeMorph _ ResizeMorph new morphExtent: 200@150.
	resizeMorph action: [self resize: (resizeMorph selectionRectangle: Display extent)].
	resizeMorph morphPosition: self world activeHand morphPosition.
	resizeMorph openInWorld
	! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/11/2015 22:22'!
                 action: aBlock
	action _ aBlock! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/18/2015 18:00'!
                drawGridOn: aCanvas
	0 to: grid x do: [:i |
		| x |
		x _ i * (extent x - gridLineWidth) / grid x.
		aCanvas line: x @ 0 to: x @ (extent y - 2) width: gridLineWidth color: gridColor].
	0 to: grid y do: [:i |
		| y |
		y _ i * (extent y - gridLineWidth) / grid y.
		aCanvas line: 0 @ y to: (extent x - 2) @ y width: gridLineWidth color: gridColor]! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/11/2015 23:02'!
                     drawOn: aCanvas
	super drawOn: aCanvas.
	from ifNotNil: [aCanvas fillRectangle: (self selectionRectangle: extent) color: selectionColor].
	self drawGridOn: aCanvas! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/11/2015 19:00'!
            grid: aPoint
	grid _ aPoint! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/11/2015 19:00'!
                    handlesMouseDown: aMouseButtonEvent
	^true! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/17/2015 15:51'!
     initialize
	super initialize.
	extent _ 400@300.
	color _ Color white.
	grid _ 8@6.
	gridLineWidth _ 2.
	gridColor _ Color black.
	selectionColor _ Color red! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/11/2015 23:18'!
                  mouseButton1Down: aMouseButtonEvent localPosition: localEventPosition
	from _ self toGridPoint: localEventPosition.
	outlineMorph _ BorderedRectMorph new
		borderColor: Color black;
		color: Color transparent;
		openInWorld;
		hide.
	self selectTo: localEventPosition! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/11/2015 23:17'!
    mouseButton1Up: aMouseButtonEvent localPosition: localEventPosition
	self selectTo: localEventPosition.
	outlineMorph delete.
	action ifNotNil: [
		action value.
		self delete]! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/11/2015 21:32'!
                               mouseMove: aMouseButtonEvent localPosition: localEventPosition
	self selectTo: localEventPosition! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/11/2015 21:25'!
              printOn: aStream
	super printOn: aStream.
	aStream space; print: from; space; print: to! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/11/2015 23:14'!
                        selectTo: localEventPosition
	| newTo |
	newTo _ self toGridPoint: localEventPosition.
	newTo ~= to ifTrue: [
		to _ newTo.
		self redrawNeeded.
		self updateOutlineMorph]! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/17/2015 15:35'!
    selectionRectangle: aRectangle
	^(from corner: to + 1) scaledBy: aRectangle // grid! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/17/2015 15:34'!
                            toGridPoint: aPoint
	^(aPoint min: extent - 1) // (extent // grid)! !
!ResizeMorph methodsFor: 'as yet unclassified' stamp: 'bp 10/11/2015 23:15'!
             updateOutlineMorph
	| rectangle |
	rectangle _ self selectionRectangle: Display extent.
	outlineMorph
		morphPosition: rectangle origin extent: rectangle extent;
		show! !
!SystemWindow methodsFor: 'menu' stamp: 'bp 10/11/2015 21:42' prior: 16926424!
     buildWindowMenu

	| aMenu |

	aMenu _ MenuMorph new defaultTarget: self.

	aMenu 
		add: 'change title...' action: #relabel;
		add: 'window color...' action: #setWindowColor;
		addLine;
		add: 'send to back' action: #sendToBack;
		add: 'make next-to-topmost' action: #makeSecondTopmost;
		addLine;
		add: (self isSticky ifTrue: [ 'make draggable' ] ifFalse: [ 'make undraggable' ]) action: #toggleStickiness;
		addLine;
		add: 'close' action: #delete;
		add: 'collapse' action: #collapse;
		add: 'expand / contract' action: #expandBoxHit;
		addLine;
		add: 'resize...' action: #resize;
		add: 'resize full' action: #resizeFull;
		add: 'resize top' action: #resizeTop;
		add: 'resize left' action: #resizeLeft;
		add: 'resize bottom' action: #resizeBottom;
		add: 'resize right' action: #resizeRight;
		add: 'resize top left' action: #resizeTopLeft;
		add: 'resize top right' action: #resizeTopRight;
		add: 'resize bottom left' action: #resizeBottomLeft;
		add: 'resize bottom right' action: #resizeBottomRight.

	^ aMenu! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/2999-ResizeMorph-BernhardPieber-2016Dec06-20h13m-bp.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2981] on 9 December 2016 at 10:27:21 am'!
!PasteUpMorph methodsFor: 'printing' stamp: 'jmv 12/9/2016 10:25:13' prior: 16887389!
  printOn: aStream
	"Reimplemented to add a tag showing that the receiver is currently functioning as a 'world', if it is"

	self isWorldMorph
		ifTrue: [aStream nextPutAll: ' [world]']
		ifFalse: [super printOn: aStream]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3000-PasteUpMorph-print-fix-JuanVuletich-2016Dec09-10h25m-jmv.1.cs.st----!

----SNAPSHOT----#(14 December 2016 2:32:05.602236 pm) Cuis5.0-3000-spur.image priorSource: 29942!

----QUIT----#(14 December 2016 2:32:40.672866 pm) Cuis5.0-3000-spur.image priorSource: 54545!

----STARTUP----#(19 December 2016 1:35:02.293384 pm) as /root/PayloadSoftware/Cuis-Smalltalk-Dev/Cuis5.0-3000-spur.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3000] on 15 December 2016 at 12:11:15 pm'!
!Point methodsFor: 'printing' stamp: 'jmv 12/15/2016 10:20:58'!
                 printStringFractionDigits: placesDesired
	^(x printStringFractionDigits: placesDesired), '@', (y printStringFractionDigits: placesDesired)! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3001-Point-printStringFractionDigits-JuanVuletich-2016Dec15-10h20m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3000] on 16 December 2016 at 3:13:12 pm'!
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 12/16/2016 15:05:52' prior: 16924259!
                             browseMyChanges
	"Browse only the changes (in the changes file) by the current author.
	Smalltalk browseMyChanges
	"
	self browseAllSelect: [ :method |
       method fileIndex > 1 "only look at changes file"
               and: [ method timeStamp beginsWith: Utilities authorInitials, ' ' ]]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3002-BrowseMyChanges-fix-JuanVuletich-2016Dec16-15h03m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3002] on 19 December 2016 at 12:44:03 pm'!
!CompiledMethod methodsFor: 'accessing' stamp: 'jmv 12/17/2016 22:38:52' prior: 16819446!
                initialPC
	"Answer the program counter for the receiver's first bytecode."
	^ (self numLiterals + 1) * Smalltalk wordSize + 1! !
!SystemDictionary methodsFor: 'memory space' stamp: 'jmv 12/17/2016 22:37:27' prior: 16920388!
lowSpaceThreshold 
	"Answer the low space threshold. When the amount of free memory (after garbage collection)
	 falls below this limit, the system is in serious danger of completely exhausting memory and
	 crashing. This limit should be made high enough to allow the user open a debugger to diagnose
	 a problem or to save the image.  In a stack-based VM such as Cog contexts for activations in
	 the stack zone will have to be created as the debugger opens, requiring additional headroom."

	| slotsForDebugger slotsForContextsOnStackPages |
	slotsForDebugger := 65536. "Arbitrary guess"
	slotsForContextsOnStackPages :=
		(self vmParameterAt: 42)
			ifNil: [0]
			ifNotNil:
				[:numStackPages| | headerSize numActivationsPerPage maxContextSize |
				numActivationsPerPage := 40. "Design goal of the Cog VM"
				headerSize := 2. "64-bytes for Spur"
				maxContextSize := MethodContext instSize + CompiledMethod fullFrameSize + headerSize.
				numStackPages * numActivationsPerPage * maxContextSize].
	^slotsForDebugger + slotsForContextsOnStackPages * self wordSize! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3003-FixFor64BitSpur-JuanVuletich-2016Dec19-12h41m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3002] on 19 December 2016 at 12:54:39 pm'!
!Parser methodsFor: 'primitives' stamp: 'nice 9/6/2013 00:48' prior: 16885817!
                      externalFunctionDeclaration
	"Parse the function declaration for a call to an external library."
	| descriptorClass callType modifier retType externalName args argType module fn |
	descriptorClass := Smalltalk at: #ExternalFunction ifAbsent: [ ^ false ].
	callType := descriptorClass callingConventionFor: here.
	callType == nil ifTrue:[^false].
	[modifier := descriptorClass callingConventionModifierFor: token.
	 modifier notNil] whileTrue:
		[self advance.
		 callType := callType bitOr: modifier].
	"Parse return type"
	self advance.
	retType := self externalType: descriptorClass.
	retType == nil ifTrue:[^self expected:'return type'].
	"Parse function name or index"
	externalName := here.
	(self match: #string) 
		ifTrue:[externalName := externalName asSymbol]
		ifFalse:[(self match:#number) ifFalse:[^self expected:'function name or index']].
	(self match: #leftParenthesis) ifFalse:[^self expected:'argument list'].
	args := WriteStream on: Array new.
	[self match: #rightParenthesis] whileFalse:[
		argType := self externalType: descriptorClass.
		argType == nil ifTrue:[^self expected:'argument'].
		argType isVoid & argType isPointerType not ifFalse:[args nextPut: argType]].
	(self matchToken: 'module:') ifTrue:[
		module := here.
		(self match: #string) ifFalse:[^self expected: 'String'].
		module := module asSymbol].
	Smalltalk at: #ExternalLibraryFunction ifPresent:[:xfn|
		fn := xfn name: externalName 
				module: module 
				callType: callType
				returnType: retType
				argumentTypes: args contents.
		self allocateLiteral: fn].
	(self matchToken: 'error:')
		ifTrue:
			[| errorCodeVariable |
			 errorCodeVariable := here.
			(hereType == #string
			 or: [hereType == #word]) ifFalse:[^self expected: 'error code (a variable or string)'].
			 self advance.
			 self addPragma: (Pragma keyword: #primitive:error: arguments: (Array with: 120 with: errorCodeVariable)).
			 fn ifNotNil: [fn setErrorCodeName: errorCodeVariable]]
		ifFalse:
			[self addPragma: (Pragma keyword: #primitive: arguments: #(120))].
	^true! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3004-externalFunctionDeclaration-JuanVuletich-2016Dec19-12h44m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3002] on 19 December 2016 at 1:08:36 pm'!

SmallInteger class
	instanceVariableNames: 'minVal maxVal '!

!classDefinition: 'SmallInteger class' category: #'Kernel-Numbers'!
SmallInteger class
	instanceVariableNames: 'minVal maxVal'!
!SmallInteger class methodsFor: 'class initialization' stamp: 'jmv 12/19/2016 13:03:09'!
                    initMinValAndMaxVal
	| next val |
	val := -32768. "Assume at least 16 bits"
	[next := val + val.
	 next class == self] whileTrue:
		[val := next].
	minVal := val.
	maxVal := -1 - val! !
!SystemDictionary methodsFor: 'image' stamp: 'jmv 12/19/2016 13:04:12' prior: 16925538!
              wordSize
	"Answer the size in bytes of an object pointer or word in the object memory.
	The value does not change for a given image, but may be modified by a SystemTracer
	when converting the image to another format. The value is cached in WordSize to
	avoid the performance overhead of repeatedly consulting the VM."

	"Smalltalk wordSize"

	^ WordSize ifNil: [
		SmallInteger initMinValAndMaxVal.
		WordSize := [self vmParameterAt: 40] on: Error do: [4]]! !

SmallInteger class
	instanceVariableNames: 'minVal maxVal'!

!classDefinition: 'SmallInteger class' category: #'Kernel-Numbers'!
SmallInteger class
	instanceVariableNames: 'minVal maxVal'!

"Postscript:
Leave the line above, and replace the rest of this comment by a useful one.
Executable statements should follow this comment, and should
be separated by periods, with no exclamation points (!!).
Be sure to put any further comments in double-quotes, like this one."
SmallInteger initMinValAndMaxVal!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3005-SmallInteger-minVal-maxVal-part1-JuanVuletich-2016Dec19-12h54m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3005] on 19 December 2016 at 1:12:20 pm'!
!SmallInteger class methodsFor: 'constants' stamp: 'jmv 12/19/2016 13:06:38' prior: 16909182!
    maxVal
	"Answer the maximum value for a SmallInteger."

	"Ensure word size is properly set. If so, maxVal is also set."
	Smalltalk wordSize.
	^maxVal! !
!SmallInteger class methodsFor: 'constants' stamp: 'jmv 12/19/2016 13:07:24' prior: 16909186!
         minVal
	"Answer the minimum value for a SmallInteger."

	"Ensure word size is properly set. If so, minVal is also set."
	Smalltalk wordSize.
	^minVal! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3006-SmallInteger-minVal-maxVal-part2-JuanVuletich-2016Dec19-13h11m-jmv.1.cs.st----!

----SNAPSHOT----#(19 December 2016 1:35:11.847544 pm) Cuis5.0-3006-spur.image priorSource: 54644!

----QUIT----#(19 December 2016 1:35:24.272429 pm) Cuis5.0-3006-spur.image priorSource: 62581!

----STARTUP----#(19 December 2016 1:45:03.353057 pm) as /root/PayloadSoftware/Cuis-Smalltalk-Dev/Cuis5.0-3006-spur.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3006] on 19 December 2016 at 1:42:27 pm'!
!SmallFloat64 commentStamp: '<historical>' prior: 16908181!
                  My instances represent 64-bit Floats whose exponent fits in 8 bits as immediate objects. This representation is only available on 64-bit systems, not 32-bit systems.!

"Postscript:
Leave the line above, and replace the rest of this comment by a useful one.
Executable statements should follow this comment, and should
be separated by periods, with no exclamation points (!!).
Be sure to put any further comments in double-quotes, like this one."
SmallFloat64 tryPrimitive: 161 withArgs: #(999).
!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3007-SmallFloat64-fixHash-forSpur64Conversion-JuanVuletich-2016Dec19-13h41m-jmv.1.cs.st----!

----SNAPSHOT----#(19 December 2016 1:45:10.081033 pm) Cuis5.0-3007-spur.image priorSource: 62680!

----QUIT----#(19 December 2016 1:45:27.503203 pm) Cuis5.0-3007-spur.image priorSource: 63733!

----STARTUP----#(19 December 2016 3:02:46.256654 pm) as /root/PayloadSoftware/ffi/Cuis5.0-3007-spur-64.image!


Display extent!

Display extent!

Display extent!

----QUIT----#(19 December 2016 3:04:52.716701 pm) Cuis5.0-3007-spur-64.image priorSource: 63832!

----STARTUP----#(27 December 2016 12:18:48.689655 pm) as /root/PayloadSoftware/Cuis-Smalltalk-Dev/Cuis5.0-3007-spur-64.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3007] on 22 December 2016 at 4:05:04 pm'!
!LargePositiveInteger methodsFor: 'testing' stamp: 'nice 8/31/2008 00:07'!
                          isLarge
	^true! !
!SmallInteger methodsFor: 'testing' stamp: 'nice 8/31/2008 00:07'!
           isLarge
	^false! !
!ByteArray methodsFor: 'platform independent access' stamp: 'ul 9/27/2015 23:01'!
                           long64At: index bigEndian: bigEndian
	"Return a 64-bit signed integer quantity starting from the given byte index."

	| value |
	value := self unsignedLong64At: index bigEndian: bigEndian.
	value digitLength < 8 ifTrue: [ ^value ].
	(value digitAt: 8) < 16r80 ifTrue: [ ^value ].
	^value - 16r10000000000000000! !
!ByteArray methodsFor: 'platform independent access' stamp: 'ul 9/27/2015 22:57'!
                    long64At: index put: value bigEndian: bigEndian
	"Store a 64-bit signed integer quantity starting from the given byte index."
	
	^self
		unsignedLong64At: index
		put: (value negative
			ifFalse: [ value ]
			ifTrue: [ value + 16r10000000000000000 ])
		bigEndian: bigEndian! !
!ByteArray methodsFor: 'platform independent access' stamp: 'eem 2/22/2016 09:36'!
                        unsignedLong64At: index bigEndian: bigEndian
	"Return a 64-bit unsigned integer quantity starting from the given byte index. Use #normalize where necessary to ensure compatibility with non-30-bit SmallIntegers."

	| byte |
	SmallInteger maxVal >  1073741823 ifTrue:
		[bigEndian
			ifTrue: "64-bit SmallIntegers have a 3 bit tag and a sign bit, so the most positive value has 16rF as its top byte."
				[(byte := self at: index) <= 16rF ifTrue:
					[^((((((((byte bitShift: 8) + (self at: index + 1) bitShift: 8) + (self at: index + 2) bitShift: 8) + (self at: index + 3)) bitShift: 8)
						+ (self at: index + 4) bitShift: 8) + (self at: index + 5) bitShift: 8) + (self at: index + 6) bitShift: 8) + (self at: index + 7)]]
			ifFalse:
				[(byte := self at: index + 7) <= 16rF ifTrue:
					[^((((((((byte bitShift: 8) + (self at: index + 6) bitShift: 8) + (self at: index + 5) bitShift: 8) + (self at: index + 4)) bitShift: 8)
						+ (self at: index + 3) bitShift: 8) + (self at: index + 2) bitShift: 8) + (self at: index + 1) bitShift: 8) + (self at: index)]]].
	bigEndian ifFalse: [
		(byte := self at: index + 7) = 0 ifFalse: [
			^(LargePositiveInteger new: 8)
				replaceFrom: 1 to: 8 with: self startingAt: index;
				normalize ].
		(byte := self at: index + 6) = 0 ifFalse: [
			^(LargePositiveInteger new: 7)
				replaceFrom: 1 to: 7 with: self startingAt: index;
				normalize ].
		(byte := self at: index + 5) = 0 ifFalse: [
			^(LargePositiveInteger new: 6)
				replaceFrom: 1 to: 6 with: self startingAt: index;
				normalize ].
		(byte := self at: index + 4) = 0 ifFalse: [
			^(LargePositiveInteger new: 5)
				replaceFrom: 1 to: 5 with: self startingAt: index;
				normalize ].
		(byte := self at: index + 3) <= 16r3F ifFalse: [
			^(LargePositiveInteger new: 4)
				replaceFrom: 1 to: 4 with: self startingAt: index;
				normalize ].
		^(((byte bitShift: 8) + (self at: index + 2) bitShift: 8) + (self at: index + 1) bitShift: 8) + (self at: index) ].
	(byte := self at: index) = 0 ifFalse: [
		^(LargePositiveInteger new: 8)
			digitAt: 1 put: (self at: index + 7);
			digitAt: 2 put: (self at: index + 6);
			digitAt: 3 put: (self at: index + 5);
			digitAt: 4 put: (self at: index + 4);
			digitAt: 5 put: (self at: index + 3);
			digitAt: 6 put: (self at: index + 2);
			digitAt: 7 put: (self at: index + 1);
			digitAt: 8 put: byte;
			normalize ].
	(byte := self at: index + 1) = 0 ifFalse: [	
		^(LargePositiveInteger new: 7)
			digitAt: 1 put: (self at: index + 7);
			digitAt: 2 put: (self at: index + 6);
			digitAt: 3 put: (self at: index + 5);
			digitAt: 4 put: (self at: index + 4);
			digitAt: 5 put: (self at: index + 3);
			digitAt: 6 put: (self at: index + 2);
			digitAt: 7 put: byte;
			normalize ].
	(byte := self at: index + 2) = 0 ifFalse: [	
		^(LargePositiveInteger new: 6)
			digitAt: 1 put: (self at: index + 7);
			digitAt: 2 put: (self at: index + 6);
			digitAt: 3 put: (self at: index + 5);
			digitAt: 4 put: (self at: index + 4);
			digitAt: 5 put: (self at: index + 3);
			digitAt: 6 put: byte;
			normalize ].
	(byte := self at: index + 3) = 0 ifFalse: [	
		^(LargePositiveInteger new: 5)
			digitAt: 1 put: (self at: index + 7);
			digitAt: 2 put: (self at: index + 6);
			digitAt: 3 put: (self at: index + 5);
			digitAt: 4 put: (self at: index + 4);
			digitAt: 5 put: byte;
			normalize ].		
	(byte := self at: index + 4) <= 16r3F ifFalse: [
		^(LargePositiveInteger new: 4)
			digitAt: 1 put: (self at: index + 7);
			digitAt: 2 put: (self at: index + 6);
			digitAt: 3 put: (self at: index + 5);
			digitAt: 4 put: byte;
			normalize ].
	^(((byte bitShift: 8) + (self at: index + 5) bitShift: 8) + (self at: index + 6) bitShift: 8) + (self at: index + 7)! !
!ByteArray methodsFor: 'platform independent access' stamp: 'ul 9/9/2015 20:18'!
        unsignedLong64At: index put: value bigEndian: bigEndian
	"Store a 64-bit unsigned integer quantity starting from the given byte index"
	
	| i j |
	value isLarge ifTrue: [
		i := value digitLength.
		bigEndian ifFalse: [
			self
				replaceFrom: index
					to: index + i - 1
					with: value 
					startingAt: 1;
				replaceFrom: index + i
					to: index + 7
					with: #[0 0 0 0 0 0 0 0]
					startingAt: 1.
			^value ].
		j := index + 8.
		i <= 7 ifTrue: [
			self
				replaceFrom: index
				to: j - i - 1
				with: #[0 0 0 0 0 0 0 0]
				startingAt: 1 ].
		[ 1 <= i ] whileTrue: [
			self at: j - i put: (value digitAt: i).
			i := i - 1 ].
		^value ].
	bigEndian ifFalse: [
		j := index - 1.
		i := value.
		[ 1 <= i ] whileTrue: [
			self at: (j := j + 1) put: (i bitAnd: 16rFF).
			i := i bitShift: -8 ].
		self replaceFrom: j + 1
			to: index + 7
			with: #[0 0 0 0 0 0 0 0]
			startingAt: 1.
		^value ].
	j := index + 8.
	i := value.
	[ 1 <= i ] whileTrue: [
		self at: (j := j - 1) put: (i bitAnd: 16rFF).
		i := i bitShift: -8 ].
	self replaceFrom: index
		to: j - 1
		with: #[0 0 0 0 0 0 0 0]
		startingAt: 1.
	^value! !
!ByteArray methodsFor: 'platform independent access' stamp: 'ul 9/9/2015 20:28' prior: 16793638!
                    longAt: index bigEndian: bigEndian
	"Return a 32-bit integer quantity starting from the given byte index. Use #normalize where necessary to ensure compatibility with non-30-bit SmallIntegers."
	
	| byte result |
	bigEndian ifFalse: [
		(byte := self at: index + 3) <= 16r7F ifTrue: [ "Is the result non-negative?"
			byte <= 16r3F ifTrue: [
				^(((byte bitShift: 8) + (self at: index + 2) bitShift: 8) + (self at: index + 1) bitShift: 8) + (self at: index) ].
			^(LargePositiveInteger new: 4)
				replaceFrom: 1
					to: 4
					with: self
					startingAt: index;
				normalize ].
		"Negative"
		byte >= 16rC0 ifTrue: [
			^-1 - (((((byte bitShift: 8) + (self at: index + 2) bitShift: 8) + (self at: index + 1) bitXor: 16rFFFFFF) bitShift: 8) + ((self at: index) bitXor: 16rFF)) ].
		(result := LargeNegativeInteger new: 4)
			digitAt: 4 put: ((self at: index + 3) bitXor: 16rFF);
			digitAt: 3 put: ((self at: index + 2) bitXor: 16rFF);
			digitAt: 2 put: ((self at: index + 1) bitXor: 16rFF).
		(byte := ((self at: index) bitXor: 16rFF) + 1) <= 16rFF ifTrue: [
			^result
				digitAt: 1 put: byte;
				normalize ].
		^result
			digitAt: 1 put: 16rFF;
			- 1 "It's tempting to do the subtraction in a loop to avoid the LargeInteger creation, but it's actually slower than this." ].
	(byte := self at: index) <= 16r7F ifTrue: [ "Is the result non-negative?"
		byte <= 16r3F ifTrue: [
			^(((byte bitShift: 8) + (self at: index + 1) bitShift: 8) + (self at: index + 2) bitShift: 8) + (self at: index + 3) ].
		^(LargePositiveInteger new: 4)
			digitAt: 1 put: (self at: index + 3);
			digitAt: 2 put: (self at: index + 2);
			digitAt: 3 put: (self at: index + 1);
			digitAt: 4 put: byte;
			normalize ].
	"Negative"
	16rC0 <= byte ifTrue: [
		^-1 - (((((byte bitShift: 8) + (self at: index + 1) bitShift: 8) + (self at: index + 2) bitXor: 16rFFFFFF) bitShift: 8) + ((self at: index + 3) bitXor: 16rFF)) ].
	(result := LargeNegativeInteger new: 4)
		digitAt: 4 put: (byte bitXor: 16rFF);
		digitAt: 3 put: ((self at: index + 1) bitXor: 16rFF);
		digitAt: 2 put: ((self at: index + 2) bitXor: 16rFF).
	(byte := ((self at: index + 3) bitXor: 16rFF) + 1) <= 16rFF ifTrue: [
		^result
			digitAt: 1 put: byte;
			normalize ].
	^result 
		digitAt: 1 put: 16rFF;
		- 1 "It's tempting to do the subtraction in a loop to avoid the LargeInteger creation, but it's actually slower than this."! !
!ByteArray methodsFor: 'platform independent access' stamp: 'ul 9/6/2015 17:13' prior: 16793658!
             longAt: index put: value bigEndian: bigEndian
	"Store a 32-bit signed integer quantity starting from the given byte index"
	
	| v v2 |
	value isLarge ifTrue: [
		bigEndian ifFalse: [
			value positive ifTrue: [
				self 
					replaceFrom: index
					to: index + 3
					with: value
					startingAt: 1.
				^value ].
			v := 0.
			[ v <= 3 and: [ (v2 := ((value digitAt: v + 1) bitXor: 16rFF) + 1) = 16r100 ] ] whileTrue: [
				self at: index + v put: 0.
				v := v + 1 ].
			self at: index + v put: v2.
			v := v + 1.
			[ v <= 3 ] whileTrue: [
				self at: index + v put: ((value digitAt: (v := v + 1)) bitXor: 16rFF) ].
			^value ].
		value positive ifTrue: [
			self
				at: index put: (value digitAt: 4);
				at: index + 1 put: (value digitAt: 3);
				at: index + 2 put: (value digitAt: 2);
				at: index + 3 put: (value digitAt: 1).
			^value ].
		v := 3.
		[ 0 <= v and: [ (v2 := ((value digitAt: 4 - v) bitXor: 16rFF) + 1) = 16r100 ] ] whileTrue: [
			self at: index + v put: 0.
			v := v - 1 ].
		self at: index + v put: v2.
		[ 0 <= (v := v - 1) ] whileTrue: [
			self at: index + v put: ((value digitAt: 4 - v) bitXor: 16rFF) ].
		^value ].
	v := value bitShift: -24.
	0 <= (v := (v bitAnd: 16r7F) - (v bitAnd: 16r80)) ifFalse: [
		v := v + 16r100 ].
	bigEndian ifFalse: [
		self 
			at: index put: (value bitAnd: 16rFF);
			at: index + 1 put: ((value bitShift: -8) bitAnd: 16rFF);
			at: index + 2 put: ((value bitShift: -16) bitAnd: 16rFF);
			at: index + 3 put: v.
		^value ].
	self
		at: index put: v;
		at: index + 1 put: ((value bitShift: -16) bitAnd: 16rFF);
		at: index + 2 put: ((value bitShift: -8) bitAnd: 16rFF);
		at: index + 3 put: (value bitAnd: 16rFF).
	^value! !
!ByteArray methodsFor: 'platform independent access' stamp: 'ul 9/6/2015 23:16' prior: 16793680!
      shortAt: index bigEndian: bigEndian
	"Return a 16-bit signed integer quantity starting from the given byte index"

	| result |
	result := bigEndian
		ifFalse: [ ((self at: index + 1) bitShift: 8) + (self at: index) ]
		ifTrue: [ ((self at: index) bitShift: 8) + (self at: index + 1) ].
	result < 16r8000 ifTrue: [ ^result ].
	^result - 16r10000! !
!ByteArray methodsFor: 'platform independent access' stamp: 'ul 9/6/2015 23:16' prior: 16793690!
   shortAt: index put: value bigEndian: bigEndian
	"Store a 16-bit signed integer quantity starting from the given byte index"
	
	| unsignedValue |
	(unsignedValue := value) < 0 ifTrue: [
		unsignedValue := unsignedValue + 16r10000 ].
	bigEndian ifFalse: [
		self 
			at: index + 1 put: (unsignedValue bitShift: -8);
			at: index put: (unsignedValue bitAnd: 16rFF).
		^value ].
	self
		at: index put: (unsignedValue bitShift: -8);
		at: index + 1 put: (unsignedValue bitAnd: 16rFF).
	^value! !
!ByteArray methodsFor: 'platform independent access' stamp: 'eem 2/22/2016 09:20' prior: 16793700!
                  unsignedLongAt: index bigEndian: bigEndian
	"Return a 32-bit unsigned integer quantity starting from the given byte index. Use #normalize where necessary to ensure compatibility with non-30-bit SmallIntegers."
	| byte |
	bigEndian ifTrue:
		[((byte := self at: index) <= 16r3F
		 or: [SmallInteger maxVal >  1073741823]) ifTrue:
			[^(((byte bitShift: 8) + (self at: index + 1) bitShift: 8) + (self at: index + 2) bitShift: 8) + (self at: index + 3)].
		^(LargePositiveInteger new: 4)
			digitAt: 1 put: (self at: index + 3);
			digitAt: 2 put: (self at: index + 2);
			digitAt: 3 put: (self at: index + 1);
			digitAt: 4 put: byte;
			normalize].
	((byte := self at: index + 3) <= 16r3F
	 or: [SmallInteger maxVal >  1073741823]) ifTrue:
		[^(((byte bitShift: 8) + (self at: index + 2) bitShift: 8) + (self at: index + 1) bitShift: 8) + (self at: index)].
	^(LargePositiveInteger new: 4)
		replaceFrom: 1 to: 4 with: self startingAt: index;
		normalize! !
!ByteArray methodsFor: 'platform independent access' stamp: 'ul 9/3/2015 01:33' prior: 16793720!
  unsignedLongAt: index put: value bigEndian: bigEndian
	"Store a 32-bit unsigned integer quantity starting from the given byte index"
	
	value isLarge
		ifTrue: [
			bigEndian ifFalse: [
				self
					replaceFrom: index
					to: index + 3
					with: value
					startingAt: 1.
				^value ].
			self
				at: index put: (value digitAt: 4);
				at: index + 1 put: (value digitAt: 3);
				at: index + 2 put: (value digitAt: 2);
				at: index +3 put: (value digitAt: 1) ]
		ifFalse: [
			bigEndian ifFalse: [
				self 
					at: index put: (value bitAnd: 16rFF);
					at: index + 1 put: ((value bitShift: -8) bitAnd: 16rFF);
					at: index + 2 put: ((value bitShift: -16) bitAnd: 16rFF);
					at: index + 3 put: (value bitShift: -24).
				^value ].
			self 
				at: index put: (value bitShift: -24);
				at: index + 1 put: ((value bitShift: -16) bitAnd: 16rFF);
				at: index + 2 put: ((value bitShift: -8) bitAnd: 16rFF);
				at: index + 3 put: (value bitAnd: 16rFF) ].
	^value! !
!ByteArray methodsFor: 'platform independent access' stamp: 'ul 9/3/2015 01:33' prior: 16793740!
                 unsignedShortAt: index bigEndian: bigEndian
	"Return a 16-bit unsigned integer quantity starting from the given byte index"

	bigEndian ifFalse: [ ^((self at: index + 1) bitShift: 8) + (self at: index) ].
	^((self at: index) bitShift: 8) + (self at: index + 1)
	! !
!ByteArray methodsFor: 'platform independent access' stamp: 'ul 9/3/2015 15:29' prior: 16793751!
                     unsignedShortAt: index put: value bigEndian: bigEndian
	"Store a 16-bit unsigned integer quantity starting from the given byte index"
	
	bigEndian ifFalse: [
		self 
			at: index + 1 put: (value bitShift: -8);
			at: index put: (value bitAnd: 16rFF).
		^value ].
	self
		at: index put: (value bitShift: -8);
		at: index+1 put: (value bitAnd: 16rFF).
	^value! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3008-ByteArray-UpdateToSqueak-JuanVuletich-2016Dec22-15h54m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3008] on 26 December 2016 at 2:54:38 pm'!
!Float64Array methodsFor: 'accessing' stamp: 'jmv 12/26/2016 14:53:06' prior: 16846088!
            floatAt: index put: aFloat
	"Store the argument (e.g., 64 bit Float) at the given index
	Use the same internal representation as BoxedFloat64. I.e. a BoxedFloat64 and a Float64Array of size 1 hold the same bits.
	Allow subclasses to redefine #at:put:"

	"This breaks with SmallFloat64"
	"self replaceWordsFrom: index * 2 - 1 to: index * 2  with: aFloat asFloat startingAt: 1."

	"Float >>basicAt: acts as if Floats were stored in big endian format. Our instances are in platform endianess."
	Smalltalk isLittleEndian
		ifTrue: [
			self basicAt: index * 2 - 1 put: (aFloat basicAt: 2).
			self basicAt: index * 2 put: (aFloat basicAt: 1) ]
		ifFalse: [
			self basicAt: index * 2 - 1 put: (aFloat basicAt: 1).
			self basicAt: index * 2 put: (aFloat basicAt: 2) ].
	^aFloat! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3009-Float64Array-fixForSmallFloats-JuanVuletich-2016Dec26-14h53m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3009] on 27 December 2016 at 12:14:57 pm'!
!SystemDictionary methodsFor: 'snapshot and quit' stamp: 'jmv 12/27/2016 12:14:33' prior: 16922764!
                         saveAsNewVersion
	"Save the image/changes using the next available version number."
	"
	Smalltalk saveAsNewVersion
	"
	| fileName newName changesName systemVersion |
	self okayToSave ifFalse: [ ^ self ].
	systemVersion _ SystemVersion current.
	fileName _ String streamContents: [ :strm |
		strm
			nextPutAll: 'Cuis';
			print: systemVersion versionMajor;
			nextPut: $.;
			print: systemVersion versionMinor;
			nextPut: $-;
			print: systemVersion highestUpdate.
		Smalltalk isSpur ifTrue: [
			strm nextPutAll: '-spur'.
			Smalltalk wordSize = 8 ifTrue: [
				strm nextPutAll: '-64' ]]].
	newName _ fileName, '.image'.
	(DirectoryEntry smalltalkImageDirectory // newName) exists ifTrue: [
		newName _ DirectoryEntry smalltalkImageDirectory
			nextNameFor: fileName
			extension: 'image' ].
	changesName _ self fullNameForChangesNamed: newName.
	"Check to see if there is a .changes file that would cause a problem if we saved a new .image file with the new version number"
	changesName asFileEntry exists ifTrue: [
		^ self inform:
'There is already .changes file of the desired name,
', newName, '
curiously already present, even though there is
no corresponding .image file.   Please remedy
manually and then repeat your request.' ].
	"Try to clear all user state, including all class vars, preferences, etc"
	self saveAs: newName andQuit: false clearAllClassState: true! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3010-saveAsNewVersion-spur64-JuanVuletich-2016Dec27-12h14m-jmv.1.cs.st----!

----SNAPSHOT----#(27 December 2016 12:18:59.203561 pm) Cuis5.0-3010-spur-64.image priorSource: 64090!

----QUIT----#(27 December 2016 12:19:11.089187 pm) Cuis5.0-3010-spur-64.image priorSource: 81847!

----STARTUP----#(27 December 2016 3:30:14.950041 pm) as /root/PayloadSoftware/Cuis-Smalltalk-Dev/Cuis5.0-3010-spur-64.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3009] on 27 December 2016 at 9:51:30 am'!
!Float64Array methodsFor: 'accessing' stamp: 'jmv 12/27/2016 09:51:21' prior: 50334122!
         floatAt: index put: aNumber
	"Store the argument (e.g., 64 bit Float) at the given index
	Use the same internal representation as BoxedFloat64. I.e. a BoxedFloat64 and a Float64Array of size 1 hold the same bits.
	Allow subclasses to redefine #at:put:"

	"This breaks with SmallFloat64"
	"self replaceWordsFrom: index * 2 - 1 to: index * 2  with: aFloat asFloat startingAt: 1."

	"Float >>basicAt: acts as if Floats were stored in big endian format. Our instances are in platform endianess."
	| aFloat |
	aFloat _ aNumber asFloat.
	Smalltalk isLittleEndian
		ifTrue: [
			self basicAt: index * 2 - 1 put: (aFloat basicAt: 2).
			self basicAt: index * 2 put: (aFloat basicAt: 1) ]
		ifFalse: [
			self basicAt: index * 2 - 1 put: (aFloat basicAt: 1).
			self basicAt: index * 2 put: (aFloat basicAt: 2) ].
	^aFloat! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3011-Float64Array-fixForSmallIntegers-JuanVuletich-2016Dec27-09h51m-jmv.1.cs.st----!

----SNAPSHOT----#(27 December 2016 3:30:22.206752 pm) Cuis5.0-3011-spur-64.image priorSource: 81950!

----QUIT----#(27 December 2016 3:30:38.307126 pm) Cuis5.0-3011-spur-64.image priorSource: 83341!

----STARTUP----#(18 January 2017 10:35:47.281303 pm) as /root/PayloadSoftware/Cuis-Smalltalk-Dev/Cuis5.0-3011-spur-64.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3011] on 29 December 2016 at 11:02:24 am'!

PluggableScrollPane subclass: #HierarchicalListMorph
	instanceVariableNames: 'selectedMorph getListSelector keystrokeActionSelector autoDeselect autoExpand sortingSelector getSelectionSelector setSelectionSelector menuGetter mainView highlightedMorph doubleClickSelector '
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Views'!

!classDefinition: #HierarchicalListMorph category: #'Morphic-Views'!
PluggableScrollPane subclass: #HierarchicalListMorph
	instanceVariableNames: 'selectedMorph getListSelector keystrokeActionSelector autoDeselect autoExpand sortingSelector getSelectionSelector setSelectionSelector menuGetter mainView highlightedMorph doubleClickSelector'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Views'!
!Inspector methodsFor: 'user commands' stamp: 'jmv 12/29/2016 10:58:58'!
       inspectSelection
	self selection inspect! !
!ObjectExplorer methodsFor: 'user commands' stamp: 'jmv 12/29/2016 11:01:35'!
      inspectSelection
	self object inspect! !
!HierarchicalListMorph methodsFor: 'events' stamp: 'jmv 12/29/2016 10:55:06'!
         doubleClick: aMouseButtonEvent localPosition: localEventPosition

	doubleClickSelector ifNil: [ ^super doubleClick: aMouseButtonEvent localPosition: localEventPosition ].
	^ self model perform: doubleClickSelector! !
!HierarchicalListMorph methodsFor: 'initialization' stamp: 'jmv 12/29/2016 10:55:42'!
                 doubleClickSelector: aSymbol
	doubleClickSelector _ aSymbol! !
!PluggableListMorph methodsFor: 'initialization' stamp: 'jmv 12/29/2016 10:41:28'!
              doubleClickSelector: aSymbol
	doubleClickSelector _ aSymbol! !
!HierarchicalListMorph methodsFor: 'events' stamp: 'jmv 12/29/2016 10:53:49' prior: 16853080!
   mouseButton1Down: aMouseButtonEvent localPosition: localEventPosition

	| itemMorph |
	aMouseButtonEvent hand newKeyboardFocus: self.
	itemMorph _ self itemFromPoint: localEventPosition.
	itemMorph ifNil: [ ^super mouseButton1Down: aMouseButtonEvent localPosition: localEventPosition ].
	self highlightedMorph: itemMorph.
	(itemMorph inToggleArea: (itemMorph internalize: (scroller internalize: localEventPosition)))
		ifTrue: [ ^self toggleExpandedState: itemMorph event: aMouseButtonEvent ]. 
	aMouseButtonEvent hand 
		waitForClicksOrDragOrSimulatedMouseButton2: self 
		event: aMouseButtonEvent 
		clkSel: #click:localPosition:
		clkNHalf: nil
		dblClkSel: (doubleClickSelector ifNotNil: [ #doubleClick:localPosition: ])
		dblClkNHalfSel: nil
		tripleClkSel: nil! !
!DebuggerWindow methodsFor: 'GUI building' stamp: 'jmv 12/29/2016 10:59:15' prior: 16831023!
 buildMorphicWindow
	"Open a full morphic debugger with the given label"

	| upperMorph receiverInspector receiverInspectorText contextVariableInspector contextVariableInspectorText bottomMorph |

	upperMorph _ PluggableListMorph
		model: model 
		listGetter: #contextStackList
		indexGetter: #contextStackIndex
		indexSetter: #toggleContextStackIndex:
		mainView: self
		menuGetter: #contextStackMenu
		keystrokeAction: #contextStackKey:from:.

	receiverInspector _ PluggableListMorph
			model: model receiverInspector
			listGetter: #fieldList
			indexGetter: #selectionIndex 
			indexSetter: #toggleIndex:
			mainView: self
			menuGetter: #receiverFieldListMenu
			keystrokeAction: #inspectorKey:from:.
	receiverInspector doubleClickSelector: #inspectSelection.
	receiverInspectorText _ TextModelMorph
			textProvider: model receiverInspector
			textGetter: #acceptedContents 
			textSetter: #accept:
			selectionGetter: #contentsSelection.
	contextVariableInspector _ PluggableListMorph
			model: model contextVariablesInspector 
			listGetter: #fieldList
			indexGetter: #selectionIndex 
			indexSetter: #toggleIndex:
			mainView: self
			menuGetter: #contextFieldListMenu
			keystrokeAction: #inspectorKey:from:.
	contextVariableInspector doubleClickSelector: #inspectSelection.
	contextVariableInspectorText _ TextModelMorph
			textProvider: model contextVariablesInspector
			textGetter: #acceptedContents 
			textSetter: #accept:
			selectionGetter: #contentsSelection.

	bottomMorph _ LayoutMorph newRow.
	bottomMorph
		addMorph: receiverInspector proportionalWidth: 0.2;
		addAdjusterAndMorph: receiverInspectorText proportionalWidth: 0.3;
		addAdjusterAndMorph: contextVariableInspector proportionalWidth: 0.2;
		addAdjusterAndMorph: contextVariableInspectorText proportionalWidth: 0.3.

	self layoutMorph
		addMorph: upperMorph proportionalHeight: 0.25;
		addAdjusterAndMorph: self buildLowerPanes proportionalHeight: 0.55;
		addAdjusterAndMorph: bottomMorph proportionalHeight: 0.2! !
!InspectorWindow methodsFor: 'GUI building' stamp: 'jmv 12/29/2016 11:00:06' prior: 16857200!
                    buildMorphicWindow
	" Inspector openOn: SystemOrganization "
	| contentsText list upperRow evaluatorText label |
	"Build widgets. We'll assemble them below."
	list _ PluggableListMorph
			model: model 
			listGetter: #fieldList
			indexGetter: #selectionIndex
			indexSetter: #toggleIndex:
			mainView: self
			menuGetter: #fieldListMenu
			keystrokeAction: #inspectorKey:from:.
	list doubleClickSelector: #inspectSelection.
	contentsText _ TextModelMorph
			textProvider: model
			textGetter: #acceptedContents 
			textSetter: #accept:
			selectionGetter: #contentsSelection.
	evaluatorText _ (TextModelMorph textProvider: model)
			askBeforeDiscardingEdits: false.
	"Upper row has two widgets, side by side: the list of variables at the left side, and the variable contents pane at the right side."
	upperRow _ LayoutMorph newRow.
	upperRow
		addMorph: list proportionalWidth: 0.3;
		addAdjusterAndMorph: contentsText proportionalWidth: 0.7.
	"Inspector Window has two rows: At the top, the one we just bult. Below it, the evaluation pane."
	self layoutMorph
		addMorph: upperRow proportionalHeight: 0.7;
		addAdjusterAndMorph: evaluatorText proportionalHeight: 0.3.
	"Set label"
	label _ [model object printStringLimitedTo: 64]
		on: UnhandledError
		do: [:ex | ex return: model object class printString, ' (printing failed)'].
	(label includesSubString: model object  class name)
		ifFalse: [label _ model object  class name, ': ', label].
	self setLabel: label! !
!ObjectExplorerWindow methodsFor: 'GUI building' stamp: 'jmv 12/29/2016 11:00:46' prior: 16883288!
buildMorphicWindow

	| textMorph |
	listMorph _ HierarchicalListMorph
			model: model
			listGetter: #getList
			indexGetter: #getCurrentSelection
			indexSetter: #noteNewSelection:
			mainView: self
			menuGetter: #genericMenu
			keystrokeAction: #explorerKey:from:.
	listMorph autoDeselect: false.
	listMorph doubleClickSelector: #inspectSelection.
	textMorph _ (TextModelMorph textProvider: model)
			askBeforeDiscardingEdits: false.
	self layoutMorph
		addMorph: listMorph proportionalHeight: 0.8;
		addAdjusterAndMorph: textMorph proportionalHeight: 0.2.
	self setLabel: (model rootObject printStringLimitedTo: 64)! !
!ObjectExplorerWindow methodsFor: 'menu commands' stamp: 'jmv 12/29/2016 10:50:28' prior: 16883479!
             openWeightExplorer
	"Create and schedule a Weight Explorer on the receiver's model's currently selected object."

	^WeightTracer openExplorerOn: model object! !

PluggableScrollPane subclass: #HierarchicalListMorph
	instanceVariableNames: 'selectedMorph getListSelector keystrokeActionSelector autoDeselect autoExpand sortingSelector getSelectionSelector setSelectionSelector menuGetter mainView highlightedMorph doubleClickSelector'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Views'!

!classDefinition: #HierarchicalListMorph category: #'Morphic-Views'!
PluggableScrollPane subclass: #HierarchicalListMorph
	instanceVariableNames: 'selectedMorph getListSelector keystrokeActionSelector autoDeselect autoExpand sortingSelector getSelectionSelector setSelectionSelector menuGetter mainView highlightedMorph doubleClickSelector'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Views'!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3012-DoubleClickOpensInspector-JuanVuletich-2016Dec29-10h36m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3012] on 29 December 2016 at 11:30:18 am'!
!SHParserST80 methodsFor: 'parse' stamp: 'jmv 12/29/2016 11:29:52' prior: 16902537!
                           parseExternalCall
	self scanNext.
	self failWhen: currentToken isNil.
	self scanPast: #externalCallType.
	currentToken = '*' 
		ifTrue: [self scanPast: #externalCallTypePointerIndicator].
	currentTokenFirst isDigit 
		ifTrue: [self scanPast: #integer]
		ifFalse: 	[
			self failUnless: currentTokenFirst == $'.
			self parseString].
	self failUnless: currentTokenFirst == $(.
	self scanPast: #leftParenthesis.
	[currentTokenFirst ~~ $)] 
		whileTrue: [
			self failWhen: currentToken isNil.
			self scanPast: #externalCallType.
			currentToken = '*' 
				ifTrue: [self scanPast: #externalCallTypePointerIndicator]].
	self scanPast: #rightParenthesis.
	currentToken = 'module:' 
		ifTrue: [
			self scanPast: #module.
			self failUnless: currentTokenFirst == $'.
			self parseString].
	self failUnless: currentToken = '>'.
	self scanPast: #primitiveOrExternalCallEnd! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3013-Shout-ExternalCallFix-JuanVuletich-2016Dec29-11h29m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3013] on 29 December 2016 at 3:36:31 pm'!
!CompiledMethod methodsFor: 'file in/out' stamp: 'jmv 12/29/2016 15:25:13' prior: 16820644!
               storeDataOn: aDataStream
	"Store myself on a DataStream.  I am a mixture of objects and raw data bytes.  Only use this for blocks.  Normal methodDictionaries should not be put out using ReferenceStreams.  Their fileOut should be attached to the beginning of the file."

	| byteLength lits |
	"No inst vars of the normal type"
	byteLength _ self basicSize.
	aDataStream
		beginInstance: self class
		size: byteLength.
	lits _ self numLiterals + 1.	"counting header"
	1 to: lits do:
		[:ii | aDataStream nextPut: (self objectAt: ii)].
	lits*Smalltalk wordSize+1 to: byteLength do:
		[:ii | aDataStream byteStream nextPut: (self basicAt: ii)].
			"write bytes straight through to the file"! !
!DataStream methodsFor: 'write and read' stamp: 'jmv 12/29/2016 15:27:40' prior: 16827456!
                   readMethod
	"PRIVATE -- Read the contents of an arbitrary instance.
	 ASSUMES: readDataFrom:size: sends me beginReference: after it
	   instantiates the new object but before reading nested objects.
	 NOTE: We must restore the current reference position after
	   recursive calls to next.
	Let the instance, not the class read the data.  "
	| instSize refPosn newClass className xxHeader nLits byteCodeSizePlusTrailer newMethod lits |

	instSize _ (byteStream nextUnsignedInt32BigEndian: true) - 1.
	refPosn _ self getCurrentReference.
	className _ self next.
	newClass _ Smalltalk at: className asSymbol.

	xxHeader _ self next.
		"nArgs _ (xxHeader >> 24) bitAnd: 16rF."
		"nTemps _ (xxHeader >> 18) bitAnd: 16r3F."
		"largeBit _ (xxHeader >> 17) bitAnd: 1."
	nLits _ (xxHeader >> 9) bitAnd: 16rFF.
		"primBits _ ((xxHeader >> 19) bitAnd: 16r600) + (xxHeader bitAnd: 16r1FF)."
	byteCodeSizePlusTrailer _ instSize - (newClass instSize "0") - (nLits + 1 * Smalltalk wordSize).

	newMethod _ newClass 
		newMethod: byteCodeSizePlusTrailer
		header: xxHeader.

	self setCurrentReference: refPosn.  "before readDataFrom:size:"
	self beginReference: newMethod.
	lits _ newMethod numLiterals + 1.	"counting header"
	2 to: lits do:
		[:ii | newMethod objectAt: ii put: self next].
	lits*Smalltalk wordSize+1 to: newMethod basicSize do:
		[:ii | newMethod basicAt: ii put: byteStream next].
			"Get raw bytes directly from the file"
	self setCurrentReference: refPosn.  "before returning to next"
	^ newMethod! !
!DataStream methodsFor: 'other' stamp: 'jmv 12/29/2016 15:36:22' prior: 16827907!
            vacantRef
	"Answer the magic 32-bit constant we use ***ON DISK*** as a stream 'reference
	 position' to identify a reference that's not yet filled in. This must be a
	 value that won't be used as an ordinary reference. Cf. outputReference: and
	 readReference. -- 
	 NOTE: We could use a different type ID for vacant-refs rather than writing
		object-references with a magic value. (The type ID and value are
		overwritten by ordinary object-references when weak refs are fullfilled.)"

	"In 32 bit Cuis it was:"
	"^ SmallInteger maxVal"

	"Use that very same value even if in 64 bit Cuis.
	This means that DataStreams are limited to 1GibiBytes in size."
	^16r3FFFFFFF! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3014-DataStream-FixFor64Bits-JuanVuletich-2016Dec29-15h19m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3000] on 10 December 2016 at 10:41:46 am'!
!Scanner methodsFor: 'multi-character scans' stamp: 'jmv 12/10/2016 01:38:21'!
                              xBacktick
	"Smalltalk code evaluated at compile time as a literal."

	self step.
	buffer reset.
	[hereChar == $`
		and: [aheadChar == $`
				ifTrue: [self step. false]
				ifFalse: [true]]]
		whileFalse: [
			buffer nextPut: self step.
			(hereChar = Scanner doItCharacterValue asCharacter and: [source atEnd])
				ifTrue: [^self offEnd: 'Unmatched back quote']].
	self step.
	token _ Compiler evaluate: buffer contents.
	tokenType _ #literal! !
!Character methodsFor: 'testing' stamp: 'jmv 12/10/2016 01:26:44' prior: 16800539!
               isValidInIdentifiers
	"Can c be part of an identifier? (unary or keyword selector, or variable name)"

	^self isAlphaNumeric or: [ #( $_ ) statePointsTo: self ]! !
!CompiledMethod methodsFor: 'comparing' stamp: 'jmv 12/10/2016 01:27:06' prior: 16819629!
  = method
	| numLits lit1 lit2 |

	"Any object is equal to itself"
	self == method ifTrue: [ ^ true ].

	"Answer whether the receiver implements the same code as the 
	argument, method."
	(method is: #CompiledMethod) ifFalse: [ ^false ].
	self size = method size ifFalse: [ ^false ].
	self header = method header ifFalse: [ ^false ].
	self initialPC to: self endPC do: [ :i |
		(self at: i) = (method at: i) ifFalse: [ ^false ]].
	(numLits _ self numLiterals) ~= method numLiterals ifTrue: [ ^false ].

	"Dont bother checking FFI and named primitives''
	jmv: Does this make any sense?
	 (#(117 120) includes: self primitive) ifTrue: [^ true]."

	 "properties"
	(self properties analogousCodeTo: method properties) ifFalse: [
		^false ].

	"#penultimateLiteral is selector (or properties, just compared, above)
	Last literal is #methodClass.
	Don't compare them. Two methods might be equal even if they have different selector (or none at all)
	or are installed in different classes (or none at all)"
	1 to: numLits-2 do: [ :i |
		lit1 _ self literalAt: i.
		lit2 _ method literalAt: i.
		lit1 = lit2 ifFalse: [
			(i = 1 and: [ #(117 120) includes: self primitive ])
				ifTrue: [
					lit1 isArray
						ifTrue: [
							(lit2 isArray and: [ lit1 allButLast = lit2 allButLast ]) ifFalse: [
								^false ]]
						ifFalse: [ "ExternalLibraryFunction"
							(lit1 analogousCodeTo: lit2) ifFalse: [
								^false ]]]
				ifFalse: [
					 lit1 isFloat
						ifTrue: [
							"Floats match if values are close, due to roundoff error."
							(lit1 closeTo: lit2) ifFalse: [ ^false ].
							self flag: 'just checking'. self halt ]
						ifFalse: [
							"any other discrepancy is a failure"
							^ false ]]]].
	^true! !
!Scanner class methodsFor: 'cached class state' stamp: 'jmv 12/10/2016 01:26:17' prior: 16904329!
     initTypeTable
	| newTable |
	newTable := Array new: 256 withAll: #xIllegal. "default"
	newTable atAll: #(9 10 12 13 32 ) put: #xDelimiter. "tab lf ff cr space"

	1 to: 255
		do: [:index |
			(Character numericValue: index) isValidInIdentifiers
				ifTrue: [
					"Digits and $_ are overwritten later"
					newTable at: index put: #xLetter ]].

	newTable atAll: ($0 numericValue to: $9 numericValue) put: #xDigit.
	newTable atAll:  '!!%&+-*/\,<=>?@~' asByteArray put: #xBinary.

	newTable at: Scanner doItCharacterValue put: #doIt.
	newTable at: $" numericValue put: #xDoubleQuote.
	newTable at: $# numericValue put: #xLitQuote.
	newTable at: $$ numericValue put: #xDollar.
	newTable at: $' numericValue put: #xSingleQuote.
	newTable at: $` numericValue put: #xBacktick.
	newTable at: $: numericValue put: #xColon.
	newTable at: $( numericValue put: #leftParenthesis.
	newTable at: $) numericValue put: #rightParenthesis.
	newTable at: $. numericValue put: #period.
	newTable at: $; numericValue put: #semicolon.
	newTable at: $[ numericValue put: #leftBracket.
	newTable at: $] numericValue put: #rightBracket.
	newTable at: ${ numericValue put: #leftBrace.
	newTable at: $} numericValue put: #rightBrace.
	newTable at: $^ numericValue put: #upArrow.
	newTable at: $_ numericValue put: #xUnderscore.
	newTable at: $| numericValue put: #verticalBar.
	TypeTable := newTable "bon voyage!!"

	"
	Scanner initTypeTable
	"! !
!SHParserST80 methodsFor: 'scan' stamp: 'jmv 12/10/2016 01:42:02' prior: 16901958!
                             scanWhitespace
	| c |
	
	[c := self currentChar.
	c notNil and: [c isSeparator or: [c == $`]]] 
		whileTrue: [sourcePosition := sourcePosition + 1].
	c == $" ifTrue: [self scanComment]! !
!SHParserST80 methodsFor: 'character testing' stamp: 'jmv 12/10/2016 10:24:38' prior: 16902078!
    isBinarySelectorCharacter: aCharacter

	aCharacter isValidInIdentifiers ifTrue: [^false].
	aCharacter isSeparator ifTrue: [^false].

	('"#$'':().;[]{}_`'  includes: aCharacter) 
		ifTrue:[^false].
	aCharacter numericValue = Scanner doItCharacterValue ifTrue: [^false "the doIt char"].
	aCharacter numericValue = 0 ifTrue: [^false].
	"Any other char is ok as a binary selector char."
	^true! !

Scanner removeSelector: #scanStringStruct!

Scanner removeSelector: #scanStringStruct!

Scanner removeSelector: #scanStringStruct:!

Scanner removeSelector: #scanStringStruct:!

"Postscript:
Leave the line above, and replace the rest of this comment by a useful one.
Executable statements should follow this comment, and should
be separated by periods, with no exclamation points (!!).
Be sure to put any further comments in double-quotes, like this one."
Scanner initTypeTable!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3015-Backticks-JuanVuletich-2016Dec10-10h41m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3015] on 29 December 2016 at 4:06:32 pm'!
!LiteralNode methodsFor: 'printing' stamp: 'jmv 12/29/2016 16:06:13' prior: 16865098!
                             printOn: aStream indent: level

	key isVariableBinding
		ifTrue: [
			key key isNil
				ifTrue: [
					aStream nextPutAll: '###'; nextPutAll: key value soleInstance name ]
				ifFalse: [
					aStream nextPutAll: '##'; nextPutAll: key key ]]
		ifFalse: [
			key isLiteral
				ifTrue: [ key storeOn: aStream ]
				ifFalse: [
					"Need to generate code for stuff that is in a CompiledMethod literal
					but is not understood as a literal by the Compiler.
					Well, then it is because it was generated using backticks!!"
					aStream nextPut: $`.
					key storeOn: aStream.
					aStream nextPut: $`.
					]
			]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3016-Backticks-SupportInDecompiler-JuanVuletich-2016Dec29-15h57m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3016] on 30 December 2016 at 10:57:00 am'!
!Scanner methodsFor: 'multi-character scans' stamp: 'jmv 12/30/2016 10:29:16' prior: 50334670!
  xBacktick
	"Smalltalk code evaluated at compile time as a literal."

	self step.
	buffer reset.
	[hereChar == $`
		and: [aheadChar == $`
				ifTrue: [self step. false]
				ifFalse: [true]]]
		whileFalse: [
			buffer nextPut: self step.
			(hereChar = Scanner doItCharacterValue asCharacter and: [source atEnd])
				ifTrue: [^self offEnd: 'Unmatched back quote']].
	self step.
	token _ [ Compiler evaluate: buffer contents ] 
		on: SyntaxErrorNotification, UndeclaredVariableReference, Error
		do: [ :ex |
			ex class caseOf: {
				[ SyntaxErrorNotification ] -> [
						self notify: 'Can not compile: ', ex errorMessage at: mark].
				[ UndeclaredVariableReference ] -> [ 
						self notify: 'Can not compile: Variable ''', ex varName, ''' is not declared' at: mark ]
			} otherwise: [
						self notify: 'Can not evaluate code: ', ex description at: mark ]].
	tokenType _ #literal! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3017-Backticks-betterErrorMessages-JuanVuletich-2016Dec30-10h56m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3016] on 30 December 2016 at 11:00:38 am'!
!Editor class methodsFor: 'class initialization' stamp: 'jmv 12/30/2016 11:00:14' prior: 16836909!
               initialize
	"
	Editor initialize
	"
	self withAllSubclassesDo: [ :c |
		c basicInitialize ]! !
!TextEditor methodsFor: 'editing keys' stamp: 'jmv 12/30/2016 10:34:01' prior: 16931735!
        enclose: aKeyboardEvent
	"Insert or remove bracket characters around the current selection."
	"This is a user command, and generates undo"

	| left right startIndex stopIndex oldSelection which |
	startIndex _ self startIndex.
	stopIndex _ self stopIndex.
	oldSelection _ self selection.
	which _ '([<{"''`' indexOf: aKeyboardEvent keyCharacter ifAbsent: [ ^true ].
	left _ '([<{"''`' at: which.
	right _ ')]>}"''`' at: which.
	((startIndex > 1 and: [stopIndex <= model textSize])
			and: [ (model actualContents at: startIndex-1) = left and: [(model actualContents at: stopIndex) = right]])
		ifTrue: [
			"already enclosed; strip off brackets"
			self selectFrom: startIndex-1 to: stopIndex.
			self replaceSelectionWith: oldSelection]
		ifFalse: [
			"not enclosed; enclose by matching brackets"
			self replaceSelectionWith:
				(Text string: (String with: left) attributes: emphasisHere),
				oldSelection,
				(Text string: (String with: right) attributes: emphasisHere).
			self selectFrom: startIndex+1 to: stopIndex].
	^true! !
!TextEditor class methodsFor: 'keyboard shortcut tables' stamp: 'jmv 12/30/2016 10:33:45' prior: 16933087!
        basicCmdShortcutsSpec
	"
	Editor initialize
	"

	"arranged in QWERTY keyboard order"
	^#(
		#(		$( 	#enclose:					'Enclose within ( and ), or remove enclosing ( and )')
		#(		$[ 	#enclose:					'Enclose within [ and ], or remove enclosing [ and ]')
		#(		${ 	#enclose:					'Enclose within { and }, or remove enclosing { and }')
		#(		$' 	#enclose:					'Enclose within single quotes, or remove enclosing single quotes')
		#(		$" 	#enclose:					'Enclose within double quotes, or remove enclosing double quotes')
		#(		$` 	#enclose:					'Enclose within backticks, or remove enclosing backticks')
		#(		$< #enclose:					'Enclose within < and >, or remove enclosing < and >')

		#(		$a 	#selectAll:					'Select all')
		#(		$f 	#find:						'Find')
		#(		$g 	#findAgain:				'Find again')
		#(		$h 	#help:						'Open this help')
		#(		$j 	#setSearchString:		'Set selection as search string for find again')

		#(		$z 	#undo:						'Undo (multiple levels)')
		#(		$x 	#cut:							'Cut selection and store it in the Clipboard')
		#(		$c 	#copySelection:			'Copy selection to the Clipboard')
		#(		$v 	#paste:						'Paste Clipboard contents')

		#(		$R	#indent:						'Indent (move selection one tab-stap right)')
		#(		$Y	#makeUppercase:		'Force selection to uppercase')
		#(		$U	#changeLineEndsToLf:	'Convert line endings to LF characters (Cuis convention) in selection')

		#(		$H	#cursorTopHome:		'Move cursor to start of text')
		#(		$L	#outdent:					'Outdent (move selection one tab-stop left)')

		#(		$Z	#redo:						'Redo (multiple levels)')
		#(		$X	#makeLowercase:		'Force selection to lowercase')
		#(		$C	#compareToClipboard:	'Compare argument to clipboard')

		#(		$ 	#selectWord:				'Select the current word as with double clicking')
	)! !
!SmalltalkEditor methodsFor: 'new selection' stamp: 'jmv 12/30/2016 10:36:10' prior: 16910578!
                     selectWord
	"Select delimited text or word--the result of double-clicking."

	| leftDelimiters rightDelimiters |
	"Warning. Once me (jmv) added Character crCharacter to the delimiters, to make double-click at and of line select whole line.
	This had the bad effect that if a class name is the last word of a line, double-click would correctly select it, but after that,
	doing ctrl-b to browse it would select the whole line..."
	leftDelimiters _ '([{<|''"`'.
	rightDelimiters _ ')]}>|''"`'.
	^self selectWordLeftDelimiters: leftDelimiters rightDelimiters: rightDelimiters! !

Editor initialize!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3018-Backticks-editorSupport-JuanVuletich-2016Dec30-10h57m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3016] on 30 December 2016 at 11:01:51 am'!
!SHParserST80 methodsFor: 'parse' stamp: 'jmv 12/30/2016 10:51:03'!
                     parseBacktick
	self enterBlock.
	self scanPast: #backtick.
	currentTokenFirst == $| ifTrue: [self parseBlockTemporaries].
	self parseStatementList.
	self failUnless: currentTokenFirst == $`.
	self scanPast: #backtick.
	self leaveBlock! !
!SHParserST80 methodsFor: 'scan' stamp: 'tween 2/17/2007 14:51' prior: 50334801!
 scanWhitespace
	| c |
	
	[c := self currentChar.
	c notNil and: [c isSeparator]] 
		whileTrue: [sourcePosition := sourcePosition + 1].
	c == $" ifTrue: [self scanComment]! !
!SHParserST80 methodsFor: 'parse' stamp: 'jmv 12/30/2016 10:51:08' prior: 16902861!
                              parseTerm
	self failWhen: currentToken isNil.
	currentTokenFirst == $( 
		ifTrue: [
			bracketDepth := bracketDepth + 1.
			self scanPast: #leftParenthesis level: bracketDepth.
			self parseExpression.
			self failUnless: currentTokenFirst == $).
			self scanPast: #rightParenthesis level: bracketDepth.
			bracketDepth := bracketDepth - 1.
			^self ].
	currentTokenFirst == $[ ifTrue: [^self parseBlock].
	currentTokenFirst == $` ifTrue: [^self parseBacktick].
	currentTokenFirst == ${ 
		ifTrue: [
			self scanPast: #leftBrace.
			self parseBraceArray.
			^self ].
	self isName ifTrue: [^self scanPast: (self resolve: currentToken)].
	self parseLiteral: false! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3019-Backticks-BetterShoutSupport-JuanVuletich-2016Dec30-11h00m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3019] on 30 December 2016 at 11:46:58 am'!
!SHTextStylerST80 methodsFor: 'private' stamp: 'jmv 12/30/2016 11:44:19' prior: 50332635!
                     setAttributesFromRanges: ranges

	formattedText removeAttributesThat: [ :attribute | attribute isForShout ].

	"Optimize for mutation speed unless method is really large but with very few distict elements:
	Source code that includes just big literals is better served by conventional Text+RunArray"
	"Do it only if we are not breaking textModel!! (for instance, StyledTextEditor asks for formatting just sections, not whole #actualContents)."
	formattedText == textModel actualContents ifTrue: [
		(formattedText size > 2000 and: [ ranges size < 50 ]) ifFalse: [
			formattedText _ formattedText optimizedForMutationSpeed.
			textModel basicActualContents: formattedText ]].

	ranges do: [ :range |

		"Smalltalk text styling"
		(self attributesFor: range rangeType) ifNotNil: [ :attributes |
			attributes do: [ :each |
				formattedText addAttribute: each from: range start to: range end ]].

		"Show as subscripts if appropriate."
		classOrMetaClass ifNotNil: [
			classOrMetaClass theNonMetaClass lastUnderscoreMeansSubscript ifTrue: [
				(#( instVar classVar globalVar workspaceVar poolConstant
					patternArg methodArg patternTempVar tempVar		
					blockPatternArg blockArg blockPatternTempVar blockTempVar 
					incompleteIdentifier undefinedIdentifier) pointsTo: range rangeType )
						ifTrue: [
							formattedText lastIndexOf: $_ startingAt: range end endingAt: range start do: [ :i |
								formattedText addAttribute: ShoutTextEmphasis subscript from: i to: range end ] ]]]]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3020-AvoidUnwantedSubscriptInClassDefinitions-JuanVuletich-2016Dec30-11h45m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3020] on 2 January 2017 at 2:27:29 pm'!
!Preferences class methodsFor: 'personalization' stamp: 'jmv 1/2/2017 14:18:06'!
                       usePreDebugWindow
	^ self
		valueOfFlag: #usePreDebugWindow
		ifAbsent: [ false ].! !
!SystemWindow methodsFor: 'open/close' stamp: 'jmv 1/2/2017 14:11:03'!
   initialFrameIn: aWorld
	^RealEstateAgent initialFrameFor: self world: aWorld! !
!DebuggerWindow methodsFor: 'GUI building' stamp: 'jmv 1/2/2017 14:13:23'!
     initialFrameIn: aWorld
	| e |
	e _ self runningWorld morphExtent.
	^(0@0 corner: e) insetBy: e // 10! !
!SystemWindow methodsFor: 'open/close' stamp: 'jmv 1/2/2017 14:11:12' prior: 16926575!
 openInWorld: aWorld
	"This msg and its callees result in the window being activeOnlyOnTop"
	| frameRect |
	frameRect _ self initialFrameIn: aWorld.
	self morphExtent: frameRect extent.
	aWorld addMorph: self position: frameRect topLeft.
	"Do it deferred. Was needed for text cursor to start blinking if (Preferences disable: #focusFollowsMouse) "
	WorldState addDeferredUIMessage: [ self activate ]! !
!PreDebugWindow class methodsFor: 'instance creation' stamp: 'jmv 1/2/2017 14:19:05' prior: 16892694!
        open: model label: aString message: messageString
	|  window |
	Preferences usePreDebugWindow
		ifTrue: [
			window _ self new.
			window
				model: model;
				buildMorphicWindowMessage: messageString print.
			aString ifNotNil: [ window setLabel: aString ].
			 window openInWorld ]
		ifFalse: [
			model openFullMorphicLabel: aString ]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3021-DebuggerUsabilityEnh-JuanVuletich-2017Jan02-14h27m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3021] on 3 January 2017 at 9:34:24 pm'!
!WriteStream methodsFor: 'accessing' stamp: 'jmv 1/3/2017 21:22:43'!
                         nextPutAllString: aString withAttributes: attributesArray

	| newEnd |
	(self isCompatibleWithContents: aString)
		ifFalse: [ ^ super nextPutAllString: aString withAttributes: attributesArray ].

	newEnd _ position + aString size.
	newEnd > writeLimit ifTrue: [
		self growTo: newEnd + 10].

	collection
		replaceFrom: position+1
		to: newEnd 
		withString: aString
		attributes: attributesArray
		startingAt: 1.
	position _ newEnd! !
!WriteStream methodsFor: 'private' stamp: 'jmv 1/3/2017 21:21:34'!
          isCompatibleWithContents: aCollection

	collection class == aCollection class
		ifTrue: [ ^ true ].

	(aCollection isString and: [ collection is: #Text])
		ifTrue: [ ^ true ].

	^ false! !
!PositionableStream methodsFor: 'testing' stamp: 'jmv 1/3/2017 10:57:48' prior: 16891569!
         isText
	"Return true if the receiver is a Text stream"
	^collection is: #Text! !
!WriteStream methodsFor: 'accessing' stamp: 'jmv 1/3/2017 21:22:51' prior: 16946406!
                          nextPutAll: aCollection

	| newEnd |
	(self isCompatibleWithContents: aCollection)
		ifFalse: [ ^ super nextPutAll: aCollection ].

	newEnd _ position + aCollection size.
	newEnd > writeLimit ifTrue: [
		self growTo: newEnd + 10].

	collection replaceFrom: position+1 to: newEnd  with: aCollection startingAt: 1.
	position _ newEnd.! !
!WriteStream methodsFor: 'private' stamp: 'jmv 1/3/2017 10:57:15' prior: 16946621!
                             withAttribute: aTextAttribute do: streamBlock
	| pos1 val |

	(collection is: #Text) ifFalse: [
		^streamBlock value ].

	pos1 _ self position.
	val _ streamBlock value.
	collection addAttribute: aTextAttribute from: pos1+1 to: self position.
	^ val! !
!WriteStream methodsFor: 'private' stamp: 'jmv 1/3/2017 10:57:19' prior: 16946627!
                withAttributes: attributes do: streamBlock 
	| pos1 val |

	(collection is: #Text) ifFalse: [
		^streamBlock value ].

	pos1 _ self position.
	val _ streamBlock value.
	attributes do: [:attribute |
		collection
			addAttribute: attribute
			from: pos1 + 1
			to: self position].
	^ val! !

Text class removeSelector: #streamContents:!

Text class removeSelector: #streamContents:!

Smalltalk removeClassNamed: #TextStream!

Smalltalk removeClassNamed: #TextStream!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3022-TextStream-removal-JuanVuletich-2017Jan03-21h10m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3022] on 4 January 2017 at 10:42:00 am'!
!SmallInteger methodsFor: 'system primitives' stamp: 'jmv 1/4/2017 10:35:09' prior: 16909090!
     digitAt: n 
	"Answer the value of an indexable field in the receiver.  LargePositiveInteger uses bytes of base two number, and each is a 'digit' base 256.  Fail if the argument (the index) is not an Integer or is out of bounds."
	n > Smalltalk wordSize ifTrue: [^ 0].
	self < 0
		ifTrue: 
			[self = SmallInteger minVal ifTrue: [
				"Can't negate minVal -- treat specially"
				^ Smalltalk wordSize = 4
					ifTrue: [ #(0 0 0 64) at: n ]
					ifFalse: [ #(0 0 0 0 0 0 0 16) at: n ]].
			^ ((0-self) bitShift: (1-n)*8) bitAnd: 16rFF]
		ifFalse: [^ (self bitShift: (1-n)*8) bitAnd: 16rFF]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3023-SmallInteger-digitAt-fixFor64Bits-JuanVuletich-2017Jan04-10h41m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3022] on 4 January 2017 at 10:46:32 am'!

Integer class removeSelector: #byte1:byte2:byte3:byte4:!

Integer class removeSelector: #byte1:byte2:byte3:byte4:!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3024-Integer-from4Bytes-removal-JuanVuletich-2017Jan04-10h44m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3024] on 6 January 2017 at 10:05:27 am'!
!WeakArray class methodsFor: 'system startup' stamp: 'jmv 1/6/2017 09:56:14'!
startUp
	"Do it even if just continuing after image snapshot"
	self restartFinalizationProcess! !
!SystemDictionary methodsFor: 'startup' stamp: 'jmv 1/6/2017 09:59:32'!
                      doStartUp: isARealStartup
	"
	isARealStartup
		true: system is coming up (VM and image just started)
		false: we have just saved an image snapshot, but didn't quit.
	"

	"Here, startup begins!!"
	Cursor normal activateCursor.
	self setGCParameters.
	isARealStartup ifTrue: [
		self clearExternalObjects ].
	self readCommandLineArguments.
	self processStartUpList: isARealStartup.
	isARealStartup ifTrue: [
		self setPlatformPreferences.
		self setStartupStamp ]! !
!Behavior methodsFor: 'system startup' stamp: 'jmv 1/6/2017 09:52:14' prior: 16785037!
                        startUp
	"This message is sent to registered classes when the system is coming up, or after an image save."! !
!Behavior methodsFor: 'system startup' stamp: 'jmv 1/6/2017 09:53:18' prior: 16785042!
                          startUp: isARealStartup
	"This message is sent to registered classes, with isARealStartup = true when the system is coming up,
	and with isARealStartup = false after a snapshot (image save, no quit).
	Classes caring about the difference should reimplement this method."

	^ self startUp! !
!WeakArray class methodsFor: 'class initialization' stamp: 'jmv 1/6/2017 09:49:16' prior: 16943683!
                          initialize
	"
	WeakArray initialize.
	SystemDictionary initialize.
	"

	self restartFinalizationProcess! !
!SystemDictionary methodsFor: 'snapshot and quit' stamp: 'jmv 1/6/2017 09:53:30' prior: 16922685!
                   processStartUpList: isARealStartup
	"Send #startUp to each class that needs to run initialization after a snapshot."

	EndianCache _ self calcEndianness.
	self send: #startUp: toClassesNamedIn: StartUpList with: isARealStartup! !
!SystemDictionary methodsFor: 'snapshot and quit' stamp: 'jmv 1/6/2017 09:55:41' prior: 16922813!
                        send: startUpOrShutDown toClassesNamedIn: startUpOrShutDownList with: argument
	"Send the message #startUp: or #shutDown: to each class named in the list.
	The argument indicates if the system is about to quit (for #shutDown:) or if
	the image is ia real startup (or just continue after image save) (for #startUp:).
	If any name cannot be found, then remove it from the list."

	| removals class |
	removals _ OrderedCollection new.
	startUpOrShutDownList do:
		[:name |
		class _ self at: name ifAbsent: nil.
		class
			ifNil: [removals add: name]
			ifNotNil: [
				class isInMemory ifTrue: [
					class perform: startUpOrShutDown with: argument]]].

	"Remove any obsolete entries, but after the iteration"
	"Well, not. Better just ignore them. Maybe it is stuff, like SoundPlayer, that was moved to optional packages, and can be loaded again anytime."
	"startUpOrShutDownList removeAll: removals"! !
!SystemDictionary methodsFor: 'snapshot and quit' stamp: 'jmv 1/6/2017 09:59:34' prior: 16922908!
                       snapshot: save andQuit: quit embedded: embeddedFlag clearAllClassState: clearAllStateFlag
"WARNING: Current process will be killed.
UI Process will be restarted
"
	"Mark the changes file and close all files as part of #processShutdownList.
	If save is true, save the current state of this Smalltalk in the image file.
	If quit is true, then exit to the outer OS shell.
	The latter part of this method runs when resuming a previously saved image. This resume logic checks for a document file to process when starting up."
	"
	To test the full cleanup and startup procedures, evaluate:
		Smalltalk snapshot: false andQuit: false embedded: false clearAllClassState: true

	To test the cleanup done when saving the image, evaluate:
		Smalltalk snapshot: false andQuit: false embedded: false clearAllClassState: false
	"
| activeProc |
activeProc _ Processor activeProcess.
[ 
	| isARealStartup world reopenTranscript |
	self logSapshot: save andQuit: quit.

	reopenTranscript _ false.
	clearAllStateFlag ifTrue: [
		TranscriptWindow allInstancesDo: [ :each | each isInWorld ifTrue: [ each delete. reopenTranscript _ true ]].
		Transcript logToFile: false ].
	ActiveModel flushEventSystem.
	self processShutDownList: quit.


	"Lo que sigue aca podria ir al shutdown de alguien... (se levantan en startup!!)"
	Smalltalk stopLowSpaceWatcher.
	WeakArray stopFinalizationProcess.
	ProcessorScheduler stopBackgroundProcess.
	
	"Cosas que levanto explicitamente abajo"
	world _ ProjectX ui.
	"Replace with this to create a new world at startup after 'saveAsNewVersion'"
	"world _ clearAllStateFlag ifFalse: [ ProjectX ui ]."
	ProjectX stopUIProcess.
	activeProc isTerminated ifFalse: [
		activeProc terminate ].

	"Clean Globals"
	Smalltalk at: #Sensor put: nil.
	Smalltalk at: #Display put: nil.
	Smalltalk closeSourceFiles. Smalltalk at: #SourceFiles put: nil.
	Smalltalk allClassesDo: [ :cls | cls releaseClassCachedState ].
	clearAllStateFlag ifTrue: [	
		Smalltalk allClassesDo: [ :cls | cls releaseClassState ]].
	"Ojo con los pool dicts. Creo que no hay ninguno..."
	
	"To keep cleaning stuff that shouldn't be saved..."
	clearAllStateFlag ifTrue: [ Smalltalk printStuffToCleanOnImageSave ].


	"Do image save & quit as apropriate"
	Cursor write activateCursor.
	save
		ifTrue: [
			isARealStartup _ embeddedFlag
				ifTrue: [ self snapshotEmbeddedPrimitive ]
				ifFalse: [ self snapshotPrimitive ]]
		ifFalse: [ isARealStartup _ false ].
	quit & (isARealStartup == false) ifTrue: [ self quitPrimitive ].


	"If starting from absolute scratch, this would be a good time to recreate Global names"
	Smalltalk at: #Sensor put: nil.
	Smalltalk at: #Display put: (DisplayScreen extent: 1024@768 depth: 32).
	Smalltalk at: #SourceFiles put: (Array new: 2).
	Smalltalk openSourceFiles.

	"Here, startup begins!! (isARealStartup might be nil)"
	Smalltalk allClassesDo: [ :cls | cls initClassCachedState ].
	self doStartUp: isARealStartup == true.
	
	
	ProjectX spawnNewMorphicProcessFor: (world ifNil: [ PasteUpMorph newWorld ]).

	reopenTranscript ifTrue: [
		WorldState addDeferredUIMessage: [
			TranscriptWindow openTranscript ]].
	"
	WorldState addDeferredUIMessage: [
		world fullRepaintNeeded ].
	"

	"If system is coming up (VM and image just started)"
	isARealStartup == true ifTrue: [	
		WorldState addDeferredUIMessage: [
			self processCommandLineArguments.
			AppLauncher launchApp ]].

	"Now it's time to raise an error"
	isARealStartup ifNil: [ self error: 'Failed to write image file (disk full?)' ].

] forkAt: Processor timingPriority-1 named: 'Startup process'.! !

SystemDictionary removeSelector: #startup:!

SystemDictionary removeSelector: #startup:!

WeakArray class removeSelector: #startUp:!

WeakArray class removeSelector: #startUp:!

WeakArray initialize!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3025-RestartFinalizationAfterImageSave-JuanVuletich-2017Jan06-09h49m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3025] on 13 January 2017 at 9:55:29 am'!
!LargePositiveInteger methodsFor: 'bit manipulation' stamp: 'jmv 1/13/2017 09:39:07'!
                 bitXor: arg
	"Primitive 36 deals with only 64-bit values (up to 8 byte LargeIntegers).
	The inherited <primitive: 'primDigitBitXor' module:'LargeIntegers'> deals with 
	arbitrary sized large integers, but is much slower.
	This method gives a performance improvement for integers using 32 to 64 bits on 32 bit VMs,
	but only for 62 to 64 bits on 64 bits VMs.
	See http://forum.world.st/Integer-arithmetic-and-bit-operations-in-Squeak-and-Pharo-32bit-amp-64bit-tc4928994.html#none
	"

    <primitive:36>
    ^super bitXor: arg! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3026-LargeInteger-bitXor-performanceImprov-JuanVuletich-2017Jan13-09h54m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3025] on 13 January 2017 at 9:55:58 am'!
!SHParserST80 methodsFor: 'parse' stamp: 'ul 10/12/2010 02:43'!
                 parseStringOrSymbol

	currentTokenFirst == $' ifTrue: [ ^self parseString ].
	currentTokenFirst == $# ifTrue: [ ^self parseSymbol ].
	self error! !
!SHParserST80 methodsFor: 'parse' stamp: 'jmv 1/13/2017 09:53:38' prior: 16902728!
                         parsePrimitive
	self scanNext.
	currentTokenFirst isDigit 
		ifTrue: [self scanPast: #integer]
		ifFalse: [
			self failUnless: currentTokenFirst == $'.
			self parseString.
			currentToken = 'module:' 
				ifTrue: [
					self scanPast: #module.
					self failUnless: currentTokenFirst == $'.
					self parseString]].
	currentToken = 'error:' ifTrue: [
		self scanPast: #primitive. "there's no rangeType for error"
		self isName
			ifTrue: [ self scanPast: #patternTempVar ]
			ifFalse: [ self parseStringOrSymbol ] ].
	self failUnless: currentToken = '>'.
	self scanPast: #primitiveOrExternalCallEnd! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3027-ShoutFix-JuanVuletich-2017Jan13-09h55m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3025] on 13 January 2017 at 9:59:33 am'!
!Float methodsFor: 'private' stamp: 'jmv 1/13/2017 09:57:46' prior: 16845694!
                    replaceWordsFrom: start to: stop with: replacement startingAt: repStart
	"Primitive. This destructively replaces elements from start to stop in the receiver starting at index, repStart, in the collection, replacement. Answer the receiver. Range checks are performed in the primitive only. Optional. See Object documentation whatIsAPrimitive."

	<primitive: 105 error: ec>
	self primitiveFailed! !
!LargePositiveInteger methodsFor: 'system primitives' stamp: 'jmv 1/13/2017 09:58:53' prior: 16862796!
            replaceFrom: start to: stop with: replacement startingAt: repStart 
	"Primitive. This destructively replaces elements from start to stop in the receiver starting at index, repStart, in the collection, replacement. Answer the receiver. Range checks are performed in the primitive only. Optional. See Object documentation whatIsAPrimitive."

	<primitive: 105 error: ec>
	super replaceFrom: start to: stop with: replacement startingAt: repStart! !
!String methodsFor: 'private' stamp: 'jmv 1/13/2017 09:58:04' prior: 16917188!
                    replaceFrom: start to: stop with: replacement startingAt: repStart 
	"Primitive. This destructively replaces elements from start to stop in the receiver starting at index, repStart, in the collection, replacement. Answer the receiver. Range checks are performed in the primitive only. Optional. See Object documentation whatIsAPrimitive."

	<primitive: 105 error: ec>
	super replaceFrom: start to: stop with: replacement startingAt: repStart! !
!Array methodsFor: 'private' stamp: 'jmv 1/13/2017 09:57:31' prior: 16779882!
                     replaceFrom: start to: stop with: replacement startingAt: repStart 
	"Primitive. This destructively replaces elements from start to stop in the receiver starting at index, repStart, in the collection, replacement. Answer the receiver. Range checks are performed in the primitive only. Optional. See Object documentation whatIsAPrimitive."

	<primitive: 105 error: ec>
	super replaceFrom: start to: stop with: replacement startingAt: repStart! !
!ByteArray methodsFor: 'private' stamp: 'jmv 1/13/2017 09:57:38' prior: 16793800!
                 replaceFrom: start to: stop with: replacement startingAt: repStart 
	"Primitive. This destructively replaces elements from start to stop in the receiver starting at index, repStart, in the collection, replacement. Answer the receiver. Range checks are performed in the primitive only. Optional. See Object documentation whatIsAPrimitive."

	<primitive: 105 error: ec>
	super replaceFrom: start to: stop with: replacement startingAt: repStart! !
!Float64Array methodsFor: 'private' stamp: 'jmv 1/13/2017 09:57:50' prior: 16846133!
              replaceWordsFrom: start to: stop with: replacement startingAt: repStart
	"Primitive. This destructively replaces elements from start to stop in the receiver starting at index, repStart, in the collection, replacement. Answer the receiver. Range checks are performed in the primitive only. Optional. See Object documentation whatIsAPrimitive."

	<primitive: 105 error: ec>
	self primitiveFailed! !
!FloatArray methodsFor: 'private' stamp: 'jmv 1/13/2017 09:58:24' prior: 16846632!
replaceFrom: start to: stop with: replacement startingAt: repStart 
	"Primitive. This destructively replaces elements from start to stop in the receiver starting at index, repStart, in the collection, replacement. Answer the receiver. Range checks are performed in the primitive only. Optional. See Object documentation whatIsAPrimitive."

	<primitive: 105 error: ec>
	super replaceFrom: start to: stop with: replacement startingAt: repStart! !
!RunNotArray methodsFor: 'private' stamp: 'jmv 1/13/2017 09:58:00' prior: 16901681!
               replaceFrom: start to: stop with: replacement startingAt: repStart 
	"Copied from Array"
	"Primitive. This destructively replaces elements from start to stop in the receiver starting at index, repStart, in the collection, replacement. Answer the receiver. Range checks are performed in the primitive only. Optional. See Object documentation whatIsAPrimitive."

	<primitive: 105 error: ec>
	super replaceFrom: start to: stop with: replacement startingAt: repStart! !
!WordArray methodsFor: 'private' stamp: 'jmv 1/13/2017 09:58:38' prior: 16945290!
                            replaceFrom: start to: stop with: replacement startingAt: repStart 

	<primitive: 105 error: ec>
	super replaceFrom: start to: stop with: replacement startingAt: repStart ! !
!Bitmap methodsFor: 'accessing' stamp: 'jmv 1/13/2017 09:57:27' prior: 16787571!
replaceFrom: start to: stop with: replacement startingAt: repStart 
	"Primitive. This destructively replaces elements from start to stop in the receiver starting at index, repStart, in the collection, replacement. Answer the receiver. Range checks are performed in the primitive only. Optional. See Object documentation whatIsAPrimitive."

	<primitive: 105 error: ec>
	super replaceFrom: start to: stop with: replacement startingAt: repStart! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3028-GrabErrorCodeForPrim105-JuanVuletich-2017Jan13-09h55m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3028] on 14 January 2017 at 8:18:04 am'!
!Point commentStamp: 'jmv 12/30/2016 17:39:06' prior: 16890200!
                  I represent an x-y pair of numbers usually designating a location on the screen.

When dealing with display coordinates, the y axis is usually considered to increase downwards. However, the standard math convention is to consider it increasing upwards. 
Points don't need to know about this. In the first case, theta increases clockwise. In the second case, it increases counter-clockwise, also the standard math convention.

Any method that doesn't follow this (because it assumes one specific convention) include this fact in the selector and in a comment.

My instances are immutable. See #privateSetX:setY:!
!Point methodsFor: 'private' stamp: 'jmv 12/11/2016 10:28:44'!
                             privateSetX: xValue setY: yValue
	"Points are immutable. Right now this is by convention, but we'll make this enfoced by VM.
	Do not all this method, except from instance creation."
	x _ xValue.
	y _ yValue! !
!Point methodsFor: 'copying' stamp: 'pb 10/29/2016 18:18:07'!
                shallowCopy
	"Immutable"
	^ self.! !
!Object class methodsFor: 'instance creation' stamp: 'jmv 12/30/2016 17:33:31' prior: 16882941!
                           unStream: aByteArray
	^ ReferenceStream unStream: aByteArray! !
!DataStream class methodsFor: 'as yet unclassified' stamp: 'jmv 12/30/2016 17:33:27' prior: 16828091!
                          unStream: aByteArray

	^(self on: ((RWBinaryOrTextStream with: aByteArray) reset; binary)) next! !
!Point class methodsFor: 'instance creation' stamp: 'pb 10/29/2016 17:14:00' prior: 16890866!
                               r: rho degrees: degrees
	"Answer an instance of me with polar coordinates rho and theta."
	^ self
		rho: rho
		theta: degrees asFloat degreesToRadians.! !
!Point class methodsFor: 'instance creation' stamp: 'pb 10/29/2016 17:12:53' prior: 16890873!
       rho: rho theta: radians
	"Answer an instance of me with polar coordinates rho and theta."
	^ self
		x: rho asFloat * radians cos
		y: rho asFloat * radians sin.! !
!Point class methodsFor: 'instance creation' stamp: 'jmv 12/11/2016 10:28:50' prior: 16890880!
                             x: anX y: anY
	"Answer an instance of me with supplied coordinates."

	^self new privateSetX: anX setY: anY! !

Point removeSelector: #setR:degrees:!

Point removeSelector: #setR:degrees:!

Point removeSelector: #setRho:theta:!

Point removeSelector: #setRho:theta:!

Point removeSelector: #setX:setY:!

Point removeSelector: #setX:setY:!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3029-Point-immutable-PhilBellalouna-2017Jan14-08h15m-pb.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3029] on 14 January 2017 at 8:53:02 am'!
!SystemDictionary methodsFor: 'code authors' stamp: 'jmv 1/14/2017 08:52:09' prior: 16920588!
     knownInitialsAndNames
	"This list could include people who hasn't contributed code to the Cuis image, but to some optional package."
"
| all ok |
all _ Smalltalk allContributors asSet.
ok _ (Smalltalk knownInitialsAndNames collect: [ :pair | pair first ]) asSet.
(all copyWithoutAll: ok) print

		initials         				name"
^ #(
	#('ab' 						'Alexandre Bergel')
	#('abc' 					'Colin Putney')
	#('acg' 					'Andrew C. Greenberg')
	#('ads' 					'Adam Spitz')
	#('AFi' 					'Alain Fischer')
	#('ajh' 					'Anthony Hannan')
	#('al' 						'Adrian Lienhard')
	#('aoy' 					'Andres Otaduy')
	#('apb' 					'Andrew P. Black')
	#('ar' 						'Andreas Raab')
	#('asm' 					'Alejandro Magistrello')
	#('avi' 					'Avi Bryant')
	#('BenComan' 			'Ben Coman')
	#('bf' 						'Bert Freudenberg')
	#('BG' 					'Boris Gaertner')
	#('BJP' 					'Bijan Parsia')
	#('bkv' 					'Brent Vukmer')
	#('bolot' 					'Bolot Kerimbaev')
	#('bp' 						'Bernhard Pieber')
	#('BP' 						'Brent Pinkney') 
	#('brp' 					'Brent Pinkney')
	#('cbc' 					'Chris Cunningham')
	#('cbr'						'Casey Ransberger')
	#('ccn' 					'Chris Norton')
	#('cmm' 					'Chris Muller')
	#('crl' 						'Craig Latta')
	#('cwp' 					'Colin Putney')
	#('das' 					'David A Smith')
	#('dc' 						'Damien Cassou')
	#('dew' 					'Doug Way')
	#('dgd' 					'Diego Gomez Deck')
	#('dkh'					'Dale Henrichs')
	#('dhn'	 				'Dan Norton')
	#('dhhi' 					'Dan Ingalls')
	#('di' 						'Dan Ingalls')
	#('djp' 					'David J. Pennell')
	#('DKL'					'Daniel K Lyons ')
	#('DM' 					'Duncan Mak')
	#('DSM' 					'Duane Maxwell')
	#('DSG'					'David Graham')
	#('dtl' 						'Dave Lewis')
	#('dvf' 					'Daniel Vainsencher')
	#('eat' 					'Eric Arseneau Tremblay')
	#('eem'					'Eliot Emilio Miranda')
	#('eliot'					'Eliot Emilio Miranda')
	#('efc' 					'Eddie Cottongim')
	#('em' 					'Ernest Micklei?')
	#('emm' 					'Ernest Micklei')
	#('fbs' 					'Frank Shearar')
	#('FBS' 					'Frank Shearar')
	#('fc' 						'Frank Caggiano')
	#('fcs' 					'Frank Sergeant')
	#('FernandoOlivero' 		'Fernando Olivero')
	#('FernanodOlivero' 		'Fernando Olivero')
	#('GabrielOmarCotelli' 	'Gabriel Omar Cotelli')
	#('gera' 					'Gerardo Richarte')
	#('gh' 						'Goran Krampe (nee Hultgren)')
	#('gk' 						'Goran Krampe (nee Hultgren)')
	#('gm' 					'German Morales')
	#('go' 						'Georg Gollmann')
	#('gsa' 					'German Arduino')
	#('HAW' 					'Hernan Wilkinson')
	#('HB' 					'Hari Balaraman')
	#('hjh' 					'Hannes Hirzel')
	#('hmm' 					'Hans-Martin Mosner')
	#('hsj' 					'Henrik Sperre Johansen')
	#('Igor.Stasenko' 		'Igor Stasenko')
	#('ikp' 					'Ian Piumarta')
	#('Jb' 						'Jean Baptiste Arnaud')
	#('jcg' 					'Joshua Gargus')
	#('jdr' 					'Javier Diaz-Reinoso')
	#('je' 						'Joern Eyrich')
	#('jf' 						'Julian Fitzell')
	#('JF' 						'Julian Fitzell')
	#('jhm' 					'John Maloney')
	#('jk'						'Jonathan Kelly')
	#('jlb' 						'Jim Benson')
	#('jm' '					John Maloney')
	#('jmb' 					'Hans Baveco')
	#('JMG'					'Jeff Gonis')
	#('JMM' 					'John McIntosh')
	#('jmv' 					'Juan Vuletich')
	#('JMV' 					'Juan Vuletich')
	#('jp' 						'Joseph Pelrine')
	#('jrm' 					'John-Reed Maffeo')
	#('jrp' 					'John Pierce')
	#('jsp' 					'Jeff Pierce')
	#('KenD' 					'Ken Dickey')
	#('kfr' 					'Karl Ramberg')
	#('KLC'			 		'Ken Causey')
	#('kph'					'Keith Hodges')
	#('KTT' 					'Kurt Thams')
	#('laza' 					'Alexander Lazarevic')
	#('LC' 						'Leandro Caniglia')
	#('len' 					'Luciano Esteban Notarfrancesco')
	#('lpc'						'Laura Perez Cerrato')
	#('lr' 						'Lukas Renggli')
	#('Lukas Renggli' 		'Lukas Renggli')
	#('ls' 						'Lex Spoon')
	#('md' 					'Marcus Denker')
	#('MarcusDenker' 		'Marcus Denker')
	#('marcus.denker' 		'Marcus Denker')
	#('mdr' 					'Mike Rutenberg')
	#('mga' 					'Markus Galli')
	#('mha' 					'Michael Haupt')
	#('mir' 					'Michael Rueger')
	#('mjg' 					'Mark Guzdial')
	#('mk' 					'Matej Kosik')
	#('MPH' 					'Michael Hewner')
	#('mpw' 					'Marcel Weiher')
	#('MPW' 					'Marcel Weiher')
	#('mrm' 					'Martin McClure')
	#('mtf' 					'Matthew Fulmer')
	#('mu' 					'Masashi Umezawa')
	#('nb' 						'Naala Brewer')
	#('nice'				 	'Nicolas Cellier')
	#('nk' 						'Ned Konz')
	#('nop' 					'Jay Carlson')
	#('NS' 						'Nathanael Schaerli')
	#('panda' 					'Michael Rueger')
	#('pb'						'Phil Bellalouna')
	#('PHK' 					'Peter Keeler')
	#('Pmm' 					'Philippe Marschall')
	#('pnm' 					'Paul McDonough')
	#('r++' 					'Gerardo Richarte')
	#('raa' 					'Bob Arning')
	#('RAA' 					'Bob Arning')
	#('raok' 					'Richard A. O''Keefe')
	#('rca' 					'Russell Allen')
	#('reThink'			 	'Paul McDonough')
	#('rew' 					'Roger Whitney')
	#('rhi' 						'Robert Hirschfeld')
	#('RJT' 					'Ron Teitelbaum')
	#('rr' 						'Romain Robbes')
	#('rss' 					'Ron Spengler')
	#('rw' 						'Robert Withers')
	#('rww' 					'Robert Withers')
	#('Sames' 				'Samuel S. Shuster')
	#('sbw' 					'Stephan B. Wessels')
	#('sd' 						'Stephane Ducasse')
	#('SD' 					'Stephane Ducasse')
	#('sge' 					'Steve Elkins')
	#('sma' 					'Stefan Matthias Aust')
	#('sps' 					'Steven Swerling')
	#('SqR' 					'Andres Valloud')
	#('sqr' 					'Andres Valloud')
	#('sr' 						'Stephan Rudlof')
	#('SSS' 					'Samuel S. Shuster')
	#('stephane.ducasse' 	'Stephane Ducasse')
	#('stephaneducasse' 	'Stephane Ducasse')
	#('stp' 					'Stephen Travis Pope')
	#('sumim' 				'Masato Sumi')
	#('svp' 					'Stephen Vincent Pair')
	#('sw' 					'Scott Wallace')
	#('TAG' 					'Travis Griggs')
	#('tak' 					'Takashi Yamamiya')
	#('tao' 					'Tim Olson')
	#('TBn' 					'Torsten Bergmann')
	#('tfei' 					'The Fourth Estate, Inc.')
	#('tfel' 					'Tim Felgentreff')
	#('th' 						'Torge Husfeldt')
	#('tk' 						'Ted Kaehler')
	#('tlk' 						'Tom Koenig')
	#('tpr' 					'Tim Rowledge')
	#('TPR' 					'Tim Rowledge')
	#('tween' 				'Andy Tween')
	#('ul' 						'Levente Uzonyi')
	#('vb' 						'Vassili Bykov')
	#('ward' 					'Ward Cunningham')
	#('wiz' 					'Jerome Peace')
	#('wod' 					'Bill Dargel')
	#('yo' 						'Yoshiki Ohshima')
	#('zz' 						'Serge Stinckwich'))! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3030-AddHernanAndGeraToKnownAuthors-JuanVuletich-2017Jan14-08h52m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3025] on 10 January 2017 at 8:09:15 pm'!

Object subclass: #TestResultForDebuggingAndInspection
	instanceVariableNames: 'testResult'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tools-Testing'!

!classDefinition: #TestResultForDebuggingAndInspection category: #'Tools-Testing'!
Object subclass: #TestResultForDebuggingAndInspection
	instanceVariableNames: 'testResult'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tools-Testing'!
!CompiledMethod methodsFor: 'testing' stamp: 'HernanWilkinson 1/10/2017 18:22:10'!
                       isTestMethod

    ^ (self methodClass is: #TestCaseClass) 
		and: [ ((self selector beginsWith: 'test') or: [ (self selector beginsWith: 'should')]) 
		and: [ self numArgs isZero ] ]! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HernanWilkinson 1/10/2017 19:35:14'!
                      acceptAndTest
	
	^self acceptThenTestMethodAndSuite: [ :aMethod | self testSuiteOf: aMethod methodClass ]! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HernanWilkinson 1/10/2017 19:35:34'!
   acceptAndTestAll
	
	^self acceptThenTestMethodAndSuite: [ :aMethod | self testSuiteForCategoryOf: aMethod methodClass ]
	
	! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HernanWilkinson 1/10/2017 19:04:06'!
                 acceptThenTestMethodAndSuite: aSuiteBuilder
	
	| potencialTestMethod |
	
	self acceptContents ifFalse: [ ^false ].
	
	potencialTestMethod _ model textProvider currentCompiledMethod.
	self runAndDebuggIfNecessary: potencialTestMethod.
	^(self runTestSuite: (aSuiteBuilder value: potencialTestMethod)) hasPassed
	! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HernanWilkinson 1/10/2017 18:50:03'!
                     flashWith: aColor

	^morph flashWith: aColor! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HernanWilkinson 1/10/2017 18:50:21'!
flashWithGreen

	^self flashWith: Color green

	
	
	! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HernanWilkinson 1/10/2017 19:03:07'!
                        runAndDebuggIfNecessary: aPotentialTestMethod

	aPotentialTestMethod isTestMethod ifTrue: [
		aPotentialTestMethod methodClass debug: aPotentialTestMethod selector ]! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HernanWilkinson 1/10/2017 19:04:42'!
       runTestSuite: aTestSuite

	| suiteRunResult |
	 
	suiteRunResult _ aTestSuite run.
	suiteRunResult hasPassed 
		ifTrue: [self flashWithGreen ]
		ifFalse: [ suiteRunResult forDebuggingAndInspection inspect ].
		
	^suiteRunResult 

	
	
	! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HernanWilkinson 1/10/2017 19:35:52'!
 testSuiteForCategoryOf: aClass

	| testCaseClasses |
	
	testCaseClasses _ (SystemOrganization listAtCategoryNamed: aClass category)
		collect: [ :aClassName | Smalltalk classNamed: aClassName ]
		thenSelect: [ :aClassInCategory | aClassInCategory is: #TestCaseClass ].
		
	
	^testCaseClasses
		inject: (TestSuite named: 'Test of Category ', aClass category)
		into: [ :suite :testCaseClass | testCaseClass addToSuiteFromSelectors: suite ]! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HernanWilkinson 1/10/2017 19:34:58'!
                      testSuiteOf: aPotentialTestCaseClass

	^(aPotentialTestCaseClass is: #TestCaseClass)
		ifTrue: [ aPotentialTestCaseClass buildSuite ]
		ifFalse: [ TestSuite named: 'Tests of ', aPotentialTestCaseClass name ]! !
!DisplayScreen methodsFor: 'displaying' stamp: 'HernanWilkinson 1/10/2017 18:45:48'!
                        flash: aRectangle with: aColor

	self fill: aRectangle fillColor: aColor.
	self forceToScreen: aRectangle.
	(Delay forMilliseconds: 100) wait.
	self fill: aRectangle fillColor: aColor.
	self forceToScreen: aRectangle! !
!Morph methodsFor: 'macpal' stamp: 'HernanWilkinson 1/10/2017 18:49:44'!
                           flashWith: aColor

	self morphBoundsInWorld ifNotNil: [ :r | Display flash: r with: aColor ]! !
!InnerTextMorph methodsFor: 'editing' stamp: 'HernanWilkinson 1/10/2017 15:56:51'!
             confirmAcceptAnyway

	^ self confirm: 
'Caution!! Contents were saved
elsewhere since you started
editing them here.  Accept anyway?'! !
!TestCase class methodsFor: 'Testing' stamp: 'HernanWilkinson 1/10/2017 16:29:48'!
    is: aSymbol

	^aSymbol == #TestCaseClass or: [ super is: aSymbol ]! !
!TestResult methodsFor: 'Inspecting' stamp: 'HernanWilkinson 1/10/2017 16:33:03'!
        forDebuggingAndInspection

	^TestResultForDebuggingAndInspection on: self! !
!TestResultForDebuggingAndInspection methodsFor: 'initialization' stamp: 'HernanWilkinson 1/10/2017 16:34:56'!
    initializeOn: aTestResult

	testResult _ aTestResult! !
!TestResultForDebuggingAndInspection methodsFor: 'printing' stamp: 'HernanWilkinson 1/10/2017 17:49:59'!
                               print: aCollectionOfTestCases startingWith: header on: aStream
	
	aCollectionOfTestCases
		do: [ :aTestCase |
			aStream 
				nextPutAll: header;
				space;
				nextPutAll: aTestCase class name;
				nextPutAll: ' debug: #';
				nextPutAll: aTestCase selector ]
		separatedBy: [ aStream newLine ].
		
	! !
!TestResultForDebuggingAndInspection methodsFor: 'printing' stamp: 'HernanWilkinson 1/10/2017 17:49:05'!
      printOn: aStream

	aStream print: testResult.
	aStream newLine.
	
	self print: testResult errors startingWith: '"E"' on: aStream.
	self print: testResult failures startingWith: '"F"' on: aStream.
	! !
!TestResultForDebuggingAndInspection methodsFor: 'running' stamp: 'HernanWilkinson 1/10/2017 18:14:09'!
               reRun

	| suite |
	 
	suite _ TestSuite new.
	suite addTests: testResult tests.
	
	testResult _ suite run.! !
!TestResultForDebuggingAndInspection class methodsFor: 'instance creation' stamp: 'HernanWilkinson 1/10/2017 16:34:28'!
                          on: aTestResult

	^self new initializeOn: aTestResult! !
!TextEditor methodsFor: 'menu messages' stamp: 'HernanWilkinson 1/10/2017 16:00:24' prior: 16932076!
  acceptContents
	"Save the current text of the text being edited as the current acceptable version for purposes of canceling.  Allow my morph to take appropriate action"
	^morph acceptContents! !
!SmalltalkEditor class methodsFor: 'keyboard shortcut tables' stamp: 'HernanWilkinson 1/10/2017 19:58:01' prior: 16910705!
  initializeMenu
	"Initialize the mouseButton2 (right button) pop-up menu and corresponding messages."
	"
	Editor initialize
	"

	menu _ SelectionMenu fromArray: {
		{'Help...'.										#openHelp}.
		#-.
		{'Do it (d)'.									#doIt}.
		{'Print it (p)'.									#printIt}.
		{'Inspect it (i)'.								#inspectIt}.
		{'Explore it (I)'.								#exploreIt}.
		{'Debug it (D)'.								#debugIt}.
		{'Profile it'.									#profileIt}.
		#-.
		{'Explain'.										#explain}.
		{'Browse it (b)'.								#browseIt}.
		{'Senders of it (n)'.							#sendersOfIt}.
		{'Implementors of it (m)'.					#implementorsOfIt}.
		{'References to it (N)'.						#referencesToIt}.
		#-.
		{'Method Strings with it (E)'.				#methodStringsContainingit}.
		{'Method Source with it'.					#methodSourceContainingIt}.
		{'Class Comments with it'.					#classCommentsContainingIt}.
		#-.
		{'Accept (s)'.									#acceptContents}.
		{'Cancel (l)'.									#cancelEdits}.
		{'Accept & Run Test in Class (t)'.			#acceptAndTest}.
		{'Accept & Run Test in Category (y)'.		#acceptAndTestAll}.
		#-.
		{'More...'.										#getMenu2}.
	}.
	menu2 _ SelectionMenu fromArray: {
		{'Find...(f)'.									#find}.
		{'Find Again (g)'.								#findAgain}.
		{'Use Selection for Find (j)'.				#setSearchString}.
		#-.
		{'Undo - multiple (z)'.						#undo}.
		{'Redo - multiple (Z)'.						#redo}.
		{'Undo / Redo history'.						#offerUndoHistory}.
		#-.
		{'Copy (c)'.									#copySelection}.
		{'Cut (x)'.										#cut}.
		{'Paste (v)'.									#paste}.
		{'Paste without Format'.						#pasteString}.
		{'Paste...'.									#pasteRecent}.
		#-.
		{'Toggle WordWrap'.						#wrapOnOff}.
		{'Set Font... (k)'.								#offerFontMenu}.
		{'Clear Font'.									#clearFont}.
		{'Set Default Font...'.						#offerDefaultFontMenu}.
		#-.
		{'More...'.										#getMenu}.
	}! !
!InspectorWindow methodsFor: 'GUI building' stamp: 'HernanWilkinson 1/10/2017 17:47:44' prior: 16857247!
                     initialExtent

	^600@325! !
!InnerTextMorph methodsFor: 'editing' stamp: 'HernanWilkinson 1/10/2017 19:46:39' prior: 16855583!
 acceptContents
	"The message is sent when the user hits return or Cmd-S.
	Accept the current contents and end editing."
	"Inform the model of text to be accepted, and return true if OK."

	| accepted prevSelection prevScrollValue |
	
	prevSelection _ self editor selectionInterval copy.
	prevScrollValue _ owner verticalScrollBar value.
	
	(self canDiscardEdits and: [(self hasProperty: #alwaysAccept) not]) ifTrue: [self flash. ^true].
	(self hasEditingConflicts and: [ self confirmAcceptAnyway not ]) ifTrue: [self flash. ^false].
	
	accepted _ model acceptContentsFrom: owner.
	"During the step for the browser, updatePaneIfNeeded is called, and 
		invariably resets the contents of the code-holding PluggableTextMorph
		at that time, resetting the cursor position and scroller in the process.
		The following line forces that update without waiting for the step,
 		then restores the cursor and scrollbar"
	
	"some implementors of acceptContentsFrom: answer self :("
	^accepted == true 
		ifTrue: [
			model refetch.
			self editor selectFrom: prevSelection first to: prevSelection last.
			WorldState addDeferredUIMessage: [
				self world ifNotNil: [ :w | w activeHand newKeyboardFocus: self ].
				owner verticalScrollBar setValue: prevScrollValue].
			true]
		ifFalse: [ false ]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3031-TDDSupport-0-HernanWilkinson.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3025] on 10 January 2017 at 8:09:22 pm'!
!SmalltalkEditor methodsFor: 'editing keys' stamp: 'HernanWilkinson 1/10/2017 20:04:06'!
         acceptAndTest: aKeyboardEvent

	^self acceptAndTest! !
!SmalltalkEditor methodsFor: 'editing keys' stamp: 'HernanWilkinson 1/10/2017 20:04:34'!
                acceptAndTestAll: aKeyboardEvent

	^self acceptAndTestAll! !
!SmalltalkEditor methodsFor: 'editing keys' stamp: 'HernanWilkinson 1/10/2017 20:02:27'!
          debugIt: aKeyboardEvent

	self debugIt.
	^true! !
!SmalltalkEditor class methodsFor: 'keyboard shortcut tables' stamp: 'HernanWilkinson 1/10/2017 20:03:23' prior: 16910661!
                   cmdShortcutsSpec
	"
	Editor initialize
	"
	"arranged in QWERTY keyboard order"
	^#(
		#(		$t	#acceptAndTest:				'Saves method, runs it as test and then all tests in class. Opens debugger if error')
		#(		$y	#acceptAndTestAll:				'Saves method, runs it as test and then all tests in class category. Opens debugger if error')
		#(		$i	#inspectIt:							'Inspect it (selection is a valid expression, or selection is over an inspect-ilst)')
		#(		$p	#printIt:								'Print it (selection is a valid expression)')

		#(		$s	#save:								'Save (i.e. accept)')
		#(		$d	#doIt:								'Do it (selection is a valid expression)')
		#(		$l	#cancelEdits:						'Cancel')

		#(		$b	#browseIt:							'Browse it (selection is a class name or cursor is over a class-list or message-list)')
		#(		$n	#sendersOfIt:						'Senders of it (selection is a message selector or cursor is over a class-list or message-list)')
		#(		$m	#implementorsOfIt:				'Implementors of it (selection is a message selector or cursor is over a class-list or message-list)')

		#(		$E	#methodStringsContainingit:'Method strings containing it')
		#(		$T	#displayIfTrue:					'Insert #ifTrue:')
		#(		$I	#exploreIt:							'Inspect via Object Explorer')

		#(		$A	#argAdvance:						'Advance argument')
		#(		$D	#debugIt:							'Debut it')
		#(		$F	#displayIfFalse:					'Insert #ifFalse:')
		#(		$G	#fileItIn:							'File in selection')

		#(		$V	#pasteInitials:					'Paste author initials')
		#(		$N	#referencesToIt:					'References to it (selection is a class name, or cursor is over a class-list or message-list)')
	)! !
!SmalltalkEditor class methodsFor: 'keyboard shortcut tables' stamp: 'HernanWilkinson 1/10/2017 19:58:01' prior: 50336255!
                           initializeMenu
	"Initialize the mouseButton2 (right button) pop-up menu and corresponding messages."
	"
	Editor initialize
	"

	menu _ SelectionMenu fromArray: {
		{'Help...'.										#openHelp}.
		#-.
		{'Do it (d)'.									#doIt}.
		{'Print it (p)'.									#printIt}.
		{'Inspect it (i)'.								#inspectIt}.
		{'Explore it (I)'.								#exploreIt}.
		{'Debug it (D)'.								#debugIt}.
		{'Profile it'.									#profileIt}.
		#-.
		{'Explain'.										#explain}.
		{'Browse it (b)'.								#browseIt}.
		{'Senders of it (n)'.							#sendersOfIt}.
		{'Implementors of it (m)'.					#implementorsOfIt}.
		{'References to it (N)'.						#referencesToIt}.
		#-.
		{'Method Strings with it (E)'.				#methodStringsContainingit}.
		{'Method Source with it'.					#methodSourceContainingIt}.
		{'Class Comments with it'.					#classCommentsContainingIt}.
		#-.
		{'Accept (s)'.									#acceptContents}.
		{'Cancel (l)'.									#cancelEdits}.
		{'Accept & Run Test in Class (t)'.			#acceptAndTest}.
		{'Accept & Run Test in Category (y)'.		#acceptAndTestAll}.
		#-.
		{'More...'.										#getMenu2}.
	}.
	menu2 _ SelectionMenu fromArray: {
		{'Find...(f)'.									#find}.
		{'Find Again (g)'.								#findAgain}.
		{'Use Selection for Find (j)'.				#setSearchString}.
		#-.
		{'Undo - multiple (z)'.						#undo}.
		{'Redo - multiple (Z)'.						#redo}.
		{'Undo / Redo history'.						#offerUndoHistory}.
		#-.
		{'Copy (c)'.									#copySelection}.
		{'Cut (x)'.										#cut}.
		{'Paste (v)'.									#paste}.
		{'Paste without Format'.						#pasteString}.
		{'Paste...'.									#pasteRecent}.
		#-.
		{'Toggle WordWrap'.						#wrapOnOff}.
		{'Set Font... (k)'.								#offerFontMenu}.
		{'Clear Font'.									#clearFont}.
		{'Set Default Font...'.						#offerDefaultFontMenu}.
		#-.
		{'More...'.										#getMenu}.
	}! !
!InnerTextMorph methodsFor: 'editing' stamp: 'HernanWilkinson 1/10/2017 19:46:39' prior: 50336320!
                           acceptContents
	"The message is sent when the user hits return or Cmd-S.
	Accept the current contents and end editing."
	"Inform the model of text to be accepted, and return true if OK."

	| accepted prevSelection prevScrollValue |
	
	prevSelection _ self editor selectionInterval copy.
	prevScrollValue _ owner verticalScrollBar value.
	
	(self canDiscardEdits and: [(self hasProperty: #alwaysAccept) not]) ifTrue: [self flash. ^true].
	(self hasEditingConflicts and: [ self confirmAcceptAnyway not ]) ifTrue: [self flash. ^false].
	
	accepted _ model acceptContentsFrom: owner.
	"During the step for the browser, updatePaneIfNeeded is called, and 
		invariably resets the contents of the code-holding PluggableTextMorph
		at that time, resetting the cursor position and scroller in the process.
		The following line forces that update without waiting for the step,
 		then restores the cursor and scrollbar"
	
	"some implementors of acceptContentsFrom: answer self :("
	^accepted == true 
		ifTrue: [
			model refetch.
			self editor selectFrom: prevSelection first to: prevSelection last.
			WorldState addDeferredUIMessage: [
				self world ifNotNil: [ :w | w activeHand newKeyboardFocus: self ].
				owner verticalScrollBar setValue: prevScrollValue].
			true]
		ifFalse: [ false ]! !

Editor initialize!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3032-TDDSupport-1-HernanWilkinson.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3025] on 12 January 2017 at 5:14:29 pm'!
!Debugger methodsFor: 'as yet unclassified' stamp: 'HAW 1/12/2017 17:05:16'!
 askForSuperclassOf: aClass toImplement: aSelector ifCancel: cancelBlock

	| classes chosenClassIndex |

	classes _ aClass withAllSuperclasses.
	chosenClassIndex _ PopUpMenu
		withCaption: 'Define #', aSelector, ' in which class?'
		chooseFrom: (classes collect: [:c | c name]).
	chosenClassIndex = 0 ifTrue: [^ cancelBlock value].

	^ classes at: chosenClassIndex! !
!Debugger methodsFor: 'as yet unclassified' stamp: 'HAW 1/12/2017 17:09:46'!
    create

	self shouldBeAbleToCreateMethod 
		ifTrue: [ self createMethod ]
		ifFalse: [ self inform: 'Only available for doesNotUndertand:' ]! !
!Debugger methodsFor: 'as yet unclassified' stamp: 'HAW 1/12/2017 17:04:29'!
   createMethod

	| message chosenClass interruptedContext |
	
	interruptedContext _ self interruptedContext.
	message _ interruptedContext tempAt: 1.
	chosenClass _ self
		askForSuperclassOf: interruptedContext receiver class
		toImplement: message selector
		ifCancel: [^self].
	self implement: message inClass: chosenClass.
! !
!Debugger methodsFor: 'as yet unclassified' stamp: 'HAW 1/12/2017 17:01:22'!
           shouldBeAbleToCreateMethod

	^self interruptedContext selector == #doesNotUnderstand:! !
!DebuggerWindow methodsFor: 'GUI building' stamp: 'HAW 1/12/2017 17:04:50' prior: 16831115!
           customButtonSpecs
	"Answer an array of elements of the form wording, selector, help-message, that characterize the custom button row of a debugger."

	^#(
		('Restart'		restart				'reset this context to its start.')
		('Into'			send					'step Into message sends')
		('Over'			doStep				'step Over message sends')
		('Through'		stepIntoBlock		'step into a block')
		('Full Stack'	fullStack			'show full stack')
		('Where'		where				'select current pc range')
		('Create'		create 				'create method'))! !
!PreDebugWindow methodsFor: 'GUI building' stamp: 'HAW 1/12/2017 17:06:02' prior: 16892577!
             buttonRowForPreDebugWindow: aDebugger
	| row aButton triads buttons |
	buttons _ OrderedCollection new.
	triads _ OrderedCollection withAll: self preDebugButtonSpec.
	(aDebugger shouldBeAbleToCreateMethod) ifTrue: [
		triads add: { 'Create'. #createMethod. 'create the missing method' }
	].
	triads do: [ :triad |
		aButton _ PluggableButtonMorph new model: self.
		aButton label: triad first.
		aButton action: triad second.
		aButton setBalloonText: triad third.
		buttons add: aButton].
	
	row _ LayoutMorph newRow.
	row doAdoptWidgetsColor.
	row color: Color transparent.
	row separation: 1.
	row addMorphs: buttons.
	^row! !
!PreDebugWindow methodsFor: 'button actions' stamp: 'HAW 1/12/2017 17:06:43' prior: 16892636!
            createMethod
	"Should only be called when this Debugger was created in response to a
	MessageNotUnderstood exception. Create a stub for the method that was
	missing and proceed into it."
	
	model createMethod.
	self debug
! !

PreDebugWindow removeSelector: #askForSuperclassOf:toImplement:ifCancel:!

PreDebugWindow removeSelector: #askForSuperclassOf:toImplement:ifCancel:!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3033-CreateMethodSupport-HernanWilkinson-HAW.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3025] on 12 January 2017 at 6:54:23 pm'!
!Behavior methodsFor: 'accessing class hierarchy' stamp: 'HAW 1/12/2017 18:29:00'!
                      allSuperclassesUpTo: aSuperclass
	
	| superclasses |
	
	^ superclass = aSuperclass
		ifTrue: [ OrderedCollection with: aSuperclass]
		ifFalse: [superclasses _ superclass allSuperclassesUpTo: aSuperclass.
			superclasses addFirst: superclass.
			superclasses]! !
!Behavior methodsFor: 'accessing class hierarchy' stamp: 'HAW 1/12/2017 18:30:53'!
       withAllSuperclassesUpTo: aSuperclass

	| classes |
	
	classes _ self allSuperclassesUpTo: aSuperclass.
	classes addFirst: self.
	
	^ classes! !
!ContextPart methodsFor: 'debugger access' stamp: 'HAW 1/12/2017 17:48:35'!
    arguments

	| arguments |

	arguments _ Array new: self selector numArgs.
	1 to: arguments size do: [ :index | arguments at: index put: (self tempAt: index)].

	^arguments.
	
	! !
!ContextPart methodsFor: 'debugger access' stamp: 'HAW 1/12/2017 17:47:30'!
messageForYourself

	^Message selector: self selector arguments: self arguments.
	! !
!Debugger methodsFor: 'method creation' stamp: 'HAW 1/12/2017 18:31:14'!
 askForSuperclassOf: aClass upTo: aSuperclass toImplement: aSelector ifCancel: cancelBlock

	| classes chosenClassIndex |

	classes _ aClass withAllSuperclassesUpTo: aSuperclass. 
	chosenClassIndex _ PopUpMenu
		withCaption: 'Define #', aSelector, ' in which class?'
		chooseFrom: (classes collect: [:c | c name]).
	chosenClassIndex = 0 ifTrue: [^ cancelBlock value].

	^ classes at: chosenClassIndex! !
!Debugger methodsFor: 'method creation' stamp: 'HAW 1/12/2017 18:45:03'!
    createMethodOnSubclassResponsibility

	| message chosenClass subclassResponsibilityContext |
	
	subclassResponsibilityContext _ self interruptedContext sender sender.
	message _ subclassResponsibilityContext messageForYourself.
	
	chosenClass _ self
		askForSuperclassOf: subclassResponsibilityContext receiver class
		upTo: subclassResponsibilityContext method methodClass
		toImplement: message selector
		ifCancel: [^self].
		
	self implement: message inClass: chosenClass context: subclassResponsibilityContext 

! !
!Debugger methodsFor: 'method creation' stamp: 'HAW 1/12/2017 18:43:11'!
              createMethodWhenDoesNotUndertand

	| message chosenClass interruptedContext |
	
	interruptedContext _ self interruptedContext.
	message _ interruptedContext tempAt: 1.
	
	chosenClass _ self
		askForSuperclassOf: interruptedContext receiver class
		toImplement: message selector
		ifCancel: [^self].
	
	self implement: message inClass: chosenClass context: self selectedContext

! !
!Debugger methodsFor: 'method creation' stamp: 'HAW 1/12/2017 18:43:25'!
                         implement: aMessage inClass: aClass context: aContext 
	
	aClass
		compile: aMessage createStubMethod
		classified: (self askForCategoryIn: aClass default: 'as yet unclassified').
		
	aContext privRefreshWith: (aClass lookupSelector: aMessage selector).
	aMessage arguments withIndexDo: [ :arg :index | aContext tempAt: index put: arg ].
	self resetContext: aContext! !
!Debugger methodsFor: 'method creation' stamp: 'HAW 1/12/2017 17:22:28'!
     wasInterrupedOnDoesNotUnderstand

	^self interruptedContext selector == #doesNotUnderstand:! !
!Debugger methodsFor: 'method creation' stamp: 'HAW 1/12/2017 17:25:23'!
                        wasInterruptedOnSubclassResponsibility

	^self interruptedContext sender ifNil: [ false ] ifNotNil: [ :senderContext | senderContext selector == #subclassResponsibility ]! !
!Debugger methodsFor: 'method creation' stamp: 'HAW 1/12/2017 18:31:48' prior: 50336551!
                         askForSuperclassOf: aClass toImplement: aSelector ifCancel: cancelBlock

	^self askForSuperclassOf: aClass upTo: ProtoObject toImplement: aSelector ifCancel: cancelBlock
! !
!Debugger methodsFor: 'method creation' stamp: 'HAW 1/12/2017 18:46:00' prior: 50336572!
                         createMethod

	self wasInterrupedOnDoesNotUnderstand ifTrue: [ ^self createMethodWhenDoesNotUndertand ].
	self wasInterruptedOnSubclassResponsibility ifTrue: [ ^self createMethodOnSubclassResponsibility ].
	
	self inform: 'Only available for #doesNotUndertand: and #subclassResponsibility' ! !
!Debugger methodsFor: 'method creation' stamp: 'HAW 1/12/2017 17:22:47' prior: 50336585!
 shouldBeAbleToCreateMethod

	^self wasInterrupedOnDoesNotUnderstand or: [ self wasInterruptedOnSubclassResponsibility]! !
!DebuggerWindow methodsFor: 'GUI building' stamp: 'HAW 1/12/2017 18:46:32' prior: 50336591!
          customButtonSpecs
	"Answer an array of elements of the form wording, selector, help-message, that characterize the custom button row of a debugger."

	^#(
		('Restart'		restart				'reset this context to its start.')
		('Into'			send					'step Into message sends')
		('Over'			doStep				'step Over message sends')
		('Through'		stepIntoBlock		'step into a block')
		('Full Stack'	fullStack			'show full stack')
		('Where'		where				'select current pc range')
		('Create'		createMethod		'create method'))! !
!PreDebugWindow methodsFor: 'GUI building' stamp: 'HAW 1/12/2017 18:47:35' prior: 50336610!
          buttonRowForPreDebugWindow: aDebugger
	| row aButton triads buttons |
	buttons _ OrderedCollection new.
	triads _ OrderedCollection withAll: self preDebugButtonSpec.
	aDebugger shouldBeAbleToCreateMethod ifTrue: [ triads add: { 'Create'. #createMethod. 'create the missing method' }].
	
	triads do: [ :triad |
		aButton _ PluggableButtonMorph new model: self.
		aButton label: triad first.
		aButton action: triad second.
		aButton setBalloonText: triad third.
		buttons add: aButton].
	
	row _ LayoutMorph newRow.
	row doAdoptWidgetsColor.
	row color: Color transparent.
	row separation: 1.
	row addMorphs: buttons.
	^row! !

Debugger removeSelector: #create!

Debugger removeSelector: #create!

Debugger removeSelector: #implement:inClass:!

Debugger removeSelector: #implement:inClass:!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3034-CreateMethodSupport-HernanWilkinson-1-HAW.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3032] on 14 January 2017 at 9:09:47 am'!
!Theme methodsFor: 'menus' stamp: 'jmv 1/14/2017 09:09:05' prior: 16936064!
                             miscellaneousIcons

	"Everything else."

	^ {
		#('restore display (r)' 'set display depth...' 'move windows onscreen' 'Utilities saveDisplay.') -> #displayIcon.
		#('changes...' 'dual change sorter' 'change sets with this method' 'find a change sorter' 'recent changes in file' 'Undo / Redo history' 'code file contents' 'package file contents') -> #changesIcon.
		#('Install New Updates' 'update' 'turn on auto-update (a)' 'update list (u)' 'install code' 'fileIn entire file' 'install package') -> #updateIcon.
		#('find again (g)' 'full stack (k)') -> #systemIcon.
		#('print it (p)' 'check change set for slips') -> #printIcon.
		#('accept (s)' 'make changes go to me (m)') -> #acceptIcon.
		#('cancel (l)' 'turn off auto-update (a)') -> #cancelIcon.
		#('debug...' 'Debug it (D)' 'toggle break on entry') -> #debugIcon.
		#('close' 'close all debuggers' 'close top window') -> #closeIcon.
		#('collapse' 'hide taskbar' 'collapse all windows') -> #collapseIcon.
		#('expand / contract' 'show taskbar' 'restore all windows') -> #expandIcon.
		#('menu') -> #windowMenuIcon.
		#('browse all' 'browser' 'browse it (b)' 'MessageTally UI and browse' 'browse recent submissions' 'browse full (b)' 'find changed browsers...' 'browse (b)' 'browse my changes') -> #editFindReplaceIcon.
		#('workspace' 'workspace with contents') -> #terminalIcon.
		#('styled text editor' 'text editor'  'basic text editor'  'unicode editor' 'edit this list' 'edit postscript...' 'add postscript...') -> #textEditorIcon.
		#('file list' 'find a fileList' 'compress file') -> #systemFileManagerIcon.
		#('transcript' 'find a transcript' 'Transcript clear.' 'log to transcript') -> #printerIcon.
		#('process browser' 'vm statistics' 'MessageTally all Processes') -> #systemMonitorIcon.
		#('emergency evaluator' 'conflicts with other change sets' 'check for slips' 'conflicts with change set opposite' 'conflicts with category opposite') -> #emblemImportantIcon.
		#('change sorter') -> #halfRefreshIcon.
		#('SUnit Test Runner' 'Accept & Run Test in Class (t)' 'Accept & Run Test in Category (y)') -> #weatherFewCloudsIcon.
		#('Font Sizes...' 'system fonts...' 'set font... (k)') -> #preferencesDesktopFontIcon.
		#('full screen on') -> #viewFullscreenIcon.
		#('full screen off') -> #exitFullscreenIcon.
		#('set desktop color...') -> #wallpaperIcon.
		#('preferences...' 'All preferences...' 'what to show...' 'view as hex') -> #preferencesIcon.
		#('Editor keyboard shortcuts') -> #keyboardShortcutsIcon.
		#('world menu help') -> #globeIcon.		"currently unused, but a neat icon"
		#('useful expressions' 'class comments with it' 'check for uncommented methods' 'check for uncommented classes') -> #chatIcon.
		#('set code author...' 'check for other authors' 'check for any other authors') -> #usersIcon.
		#('space left') -> #removableMediaIcon.
		#('start drawing all again' 'window color...') -> #graphicsIcon.
		#('start stepping again') -> #mediaPlaybackStartIcon.
		#('file out current change set' 'fileOut' 'File out and remove (o)' 'File out and keep (k)') -> #fileOutIcon.
		#('recently logged changes...' 'versions (v)' 'recent classes... (r)' 'trim history' 'Profile it') -> #clockIcon.
		#('senders of it (n)' 'senders of... (n)' 'local senders of...' 'senders (n)') -> #mailForwardIcon.
		#('implementors of it (m)' 'implementors of... (m)' 'implementors of sent messages') -> #developmentIcon.
		#('references to it (N)') -> #addressBookIcon.
		#('class var refs...' 'class refs (N)' 'class variables' 'class vars' 'local implementors of...' 'subclass template') -> #classIcon.
		#('inst var refs...' 'inst var defs...' 'sample instance') -> #instanceIcon.
		#('Use Selection for Find (j)' 'rename class ...' 'rename...' 'change title...') -> #saveAsIcon.
		#('smalltalk options' 'method source with it' 'browse method (O)' 'check for uncategorized methods') -> #scriptIcon.
		#('method strings with it (E)' 'Toggle WordWrap') -> #genericTextIcon.
		#('browse hierarchy (h)' 'move to top' 'promote to top of list') -> #goTopIcon.
		#('move up' 'make next-to-topmost') -> #goUpIcon.
		#('move to bottom' 'send to back' 'send top window to back') -> #goBottomIcon.
		#('inheritance (i)' 'move down') -> #goDownIcon.
		#('browse protocol (p)' 'spawn sub-protocol') -> #spreadsheetIcon.
		#('spawn full protocol') -> #speadsheetTemplateIcon.
		#('alphabetize') -> #fontXGenericIcon.
		#('Installed Packages' 'browse' 'show category (C)' 'categorize all uncategorized' 'select change set...' 'view affected class categories') -> #packageIcon.
		#('remove from current change set' 'remove empty categories' 'subtract other side (-)' 'remove from this browser') -> #listRemoveIcon.
		#('add to current change set' 'add all meths to current chgs' 'add preamble (p)' 'More...') -> #listAddIcon.
		#('toggle diffing (D)' 'toggle selections') -> #switchIcon.
		#('reorganize' 'create inst var accessors' 'ChangeSorter reorderChangeSets.' 'reorder all change sets' 'by name' 'by size' 'by date') -> #sendReceiveIcon.
		#('unsent methods' 'unreferenced class vars' 'unreferenced inst vars' 'Undeclared inspect.' 'Undeclared removeUnreferencedKeys; inspect.' 'ChangeSorter removeEmptyUnnamedChangeSets.' 'check for unsent messages') -> #junkIcon.
		#('find changed windows...') -> #newWindowIcon.
		#('make undraggable') -> #pushPinIcon.
		#('Utilities saveScreenshot.') -> #stillCameraIcon.
		#('add new directory') -> #newFolderIcon.
		#('select all' 'deselect all') -> #selectAllIcon.
		#('sort by date') -> #dateIcon.
		#('justified') -> #formatJustifyFillIcon.
		#('centered') -> #formatJustifyCenterIcon.
		#('set alignment...' 'leftFlush') -> #formatJustifyLeftIcon.
		#('rightFlush') -> #formatJustifyRightIcon.
		#('signal Semaphore (S)') -> #haloHelpIcon.
		#('Change Paragraph Style...' 'Change Character Style...' 'Remove Character Style' 'Replace all uses of Paragraph Style...' 'Replace all uses of Character Style...' 'Set Default Font...') -> #fontXGenericIcon.
		#('Clear Font') -> #newIcon.
		#('code file browser' 'package file browser') -> #findIcon.
	}! !

"Postscript:
Leave the line above, and replace the rest of this comment by a useful one.
Executable statements should follow this comment, and should
be separated by periods, with no exclamation points (!!).
Be sure to put any further comments in double-quotes, like this one."
Theme current class beCurrent!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3035-AddIconsForTDDSupport-JuanVuletich-2017Jan14-09h07m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3035] on 16 January 2017 at 11:04:32 am'!

(Smalltalk classNamed: 'Taskbar') ifNotNil: [ :tbClass |
	PasteUpMorph allInstancesDo: [ :w | w hideTaskbar ].
	tbClass allInstancesDo: [ :each | each delete ]]!

StringMorph subclass: #UpdatingStringMorph
	instanceVariableNames: 'target getSelector stepTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets'!

!classDefinition: #UpdatingStringMorph category: #'Morphic-Widgets'!
StringMorph subclass: #UpdatingStringMorph
	instanceVariableNames: 'target getSelector stepTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Widgets'!
!UpdatingStringMorph commentStamp: 'jmv 1/5/2013 23:49' prior: 0!
        UpdatingStringMorph new
     target: [self runningWorld activeHand morphPosition asString];
     getSelector: #value;
     stepTime: 10;
     openInWorld!

LayoutMorph subclass: #TaskbarMorph
	instanceVariableNames: 'viewBox scale'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tools-Taskbar'!

!classDefinition: #TaskbarMorph category: #'Tools-Taskbar'!
LayoutMorph subclass: #TaskbarMorph
	instanceVariableNames: 'viewBox scale'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tools-Taskbar'!
!TaskbarMorph commentStamp: '<historical>' prior: 0!
      A simple task bar written for Cuis.

dashBoard contains views/controls
viewBox contains graphic buttons of "iconized" windows/morphs.
scale allows 1x 2x 4x tarkbar height. [scale= 1,2,4]!
!Preferences class methodsFor: 'personalization' stamp: 'jmv 1/15/2017 18:51:02'!
                  taskbarIncludesAllWindows
	"
	true: All windows are included in Taskbar
	false: Only collapsed windows are included in Taskbar
	"
	^ self
		valueOfFlag: #taskbarIncludesAllWindows
		ifAbsent: [ true ].! !
!Morph methodsFor: 'accessing' stamp: 'jmv 1/15/2017 18:06:45'!
                   taskbar
	^self world ifNotNil: [ :w | w taskbar ]! !
!Morph methodsFor: 'submorphs-add/remove' stamp: 'jmv 1/15/2017 14:52:58'!
showAndComeToFront

	self show; comeToFront! !
!PasteUpMorph methodsFor: 'change reporting' stamp: 'jmv 1/16/2017 09:56:14'!
   addedMorph: aMorph
	"Notify the receiver that the given morph was just added."
	super addedMorph: aMorph.
	self taskbar ifNotNil: [ :tb |
		tb wasOpened: aMorph ]! !
!PasteUpMorph methodsFor: 'change reporting' stamp: 'jmv 1/16/2017 09:56:07'!
            removedMorph: aMorph
	"Notify the receiver that aMorph was just removed from its children"
	super removedMorph: aMorph.
	self taskbar ifNotNil: [ :tb |
		tb wasDeleted: aMorph ]! !
!PasteUpMorph methodsFor: 'taskbar' stamp: 'jmv 1/15/2017 18:57:53'!
      taskbarDeleted
	taskbar _ nil! !
!UpdatingStringMorph methodsFor: 'accessing' stamp: 'jmv 1/4/2013 13:15'!
                     getSelector: aSymbol
	getSelector _ aSymbol! !
!UpdatingStringMorph methodsFor: 'accessing' stamp: 'jmv 1/4/2013 13:18'!
       stepTime

	^stepTime! !
!UpdatingStringMorph methodsFor: 'accessing' stamp: 'jmv 1/4/2013 13:15'!
                              stepTime: aNumber
	stepTime _ aNumber! !
!UpdatingStringMorph methodsFor: 'accessing' stamp: 'jmv 1/4/2013 13:15'!
             target: anObject
	target _ anObject! !
!UpdatingStringMorph methodsFor: 'initialization' stamp: 'jmv 9/13/2013 09:23'!
         initialize
	super initialize.
	target _ self.
	getSelector _ #contents.
	stepTime _ 50! !
!UpdatingStringMorph methodsFor: 'stepping' stamp: 'jmv 2/27/2016 20:07'!
                            stepAt: millisecondSinceLast

	self contents: (target perform: getSelector)! !
!UpdatingStringMorph methodsFor: 'stepping' stamp: 'jmv 1/4/2013 13:18'!
        wantsSteps
	"Return true if the receiver wants to its #step or #stepAt: methods be run"

	^true! !
!UpdatingStringMorph methodsFor: 'geometry' stamp: 'jmv 1/15/2017 14:25:27'!
                fitContents
	"Don't shrink each time contents change.
	Might shrink during layout"
	self morphExtent: (extent max: self measureContents)! !
!UpdatingStringMorph class methodsFor: 'new-morph participation' stamp: 'jmv 4/15/2014 09:26'!
                     initializedInstance
	"Answer a digital clock"

	| newInst |
	newInst := self 
		contents: '' 
		font: (AbstractFont familyName: 'DejaVu' pointSize: 22) 
		emphasis: AbstractFont  boldCode.
	newInst 
		stepTime: 500; "half a second"
		target: [String streamContents: [ :strm | DateAndTime now printHMSOn: strm]] ;
		getSelector: #value.
		
	^ newInst! !
!TaskbarMorph methodsFor: 'accessing' stamp: 'jmv 1/15/2017 14:49:41'!
                        buttonFor: aMorph
	
	viewBox ifNotNil: [
		viewBox submorphs do: [ :button | 
			button model == aMorph
				ifTrue: [ ^button ]]
	].
	^nil! !
!TaskbarMorph methodsFor: 'accessing' stamp: 'jmv 1/15/2017 14:49:30'!
           scale

	 ^ scale ifNil: [ self defaultScale ] ifNotNil: [ scale ]! !
!TaskbarMorph methodsFor: 'events' stamp: 'jmv 1/8/2017 16:48:00'!
                        notifyDisplayResize
	Display
		when: #screenSizeChanged
		send: #screenSizeChanged
		to: self.
	self screenSizeChanged! !
!TaskbarMorph methodsFor: 'events' stamp: 'jmv 1/8/2017 16:48:14'!
   screenSizeChanged
	"Respond to change in screen size by repositioning self to bottom of screen"
	
"	Transcript newLine; print: 'Taskbar screenSizeChanged'.
"
	| y e |
	WorldState addDeferredUIMessage: [
		self world ifNotNil: [ :w |
			y _ w morphExtent y - self defaultHeight.
			e _ self internalizeDistance: w morphExtent x @ self defaultHeight.
			self morphPosition: 0@y extent: e ]]! !
!TaskbarMorph methodsFor: 'initialization' stamp: 'jmv 1/15/2017 14:49:51'!
            defaultHeight

	^ Preferences windowTitleFont height * 2 * self scale! !
!TaskbarMorph methodsFor: 'initialization' stamp: 'jmv 1/15/2017 14:49:19'!
           defaultScale

	 ^ 1! !
!TaskbarMorph methodsFor: 'initialization' stamp: 'jmv 1/8/2017 16:57:33'!
                              initialize
	super initialize.
	viewBox _ LayoutMorph newRow color: self defaultColor.
	self
		addMorph: UpdatingStringMorph initializedInstance
		layoutSpec:  (LayoutSpec morphWidthProportionalHeight: 1.0).
	self
		addMorph: viewBox 
		layoutSpec: (LayoutSpec
			proportionalWidth: 1.0
			proportionalHeight: 1.0 
			minorDirectionPadding: #right).
	viewBox separation: 5
! !
!TaskbarMorph methodsFor: 'testing' stamp: 'jmv 1/8/2017 16:44:53'!
    is: aSymbol
	^ aSymbol == #TaskbarMorph or: [ super is: aSymbol ]! !
!TaskbarMorph methodsFor: 'testing' stamp: 'jmv 1/8/2017 16:47:41'!
                       isSticky
	"answer whether the receiver is Sticky"
	^true! !
!TaskbarMorph methodsFor: 'services' stamp: 'jmv 1/15/2017 18:42:23'!
                              addButtonFor: aMorph

	| button |
	button _ PluggableButtonMorph
			model: aMorph
			stateGetter: nil
			action: #showAndComeToFront.
	button
		color: self color;
		icon: (aMorph imageForm: 32);
		setBalloonText: aMorph label.
	viewBox
		addMorph: button
		fixedWidth: self defaultHeight! !
!TaskbarMorph methodsFor: 'services' stamp: 'jmv 1/15/2017 18:20:11'!
                       removeButtonFor: aMorph

	(self buttonFor: aMorph) ifNotNil: [ :b |
		b delete ]! !
!TaskbarMorph methodsFor: 'services' stamp: 'jmv 1/15/2017 18:49:21'!
      restoreAll
	viewBox ifNotNil: [
		viewBox submorphs do: [ :button | 
			button model showAndComeToFront ]	]! !
!TaskbarMorph methodsFor: 'services' stamp: 'jmv 1/15/2017 18:23:09'!
           wasCollapsed: aMorph
	"Add a button for aMorph if not already there (see #taskbarIncludesAllWindows)"

	(self buttonFor: aMorph) ifNil: [
		self addButtonFor: aMorph ]! !
!TaskbarMorph methodsFor: 'services' stamp: 'jmv 1/15/2017 18:25:27'!
               wasDeleted: aMorph
	"aMorph was deleted. Remove button for aMorph"

	self removeButtonFor: aMorph! !
!TaskbarMorph methodsFor: 'services' stamp: 'jmv 1/15/2017 18:19:22'!
                     wasMadeVisible: aMorph
	"aMorph is now visible. Remove button for aMorph if appropriate (see #taskbarIncludesAllWindows)"

	Preferences taskbarIncludesAllWindows ifFalse: [
		self removeButtonFor: aMorph ]! !
!TaskbarMorph methodsFor: 'services' stamp: 'jmv 1/15/2017 18:21:15'!
         wasOpened: aMorph
	"aMorph was added to the world. Add button for aMorph if appropriate (see #taskbarIncludesAllWindows)"
	
	Preferences taskbarIncludesAllWindows ifTrue: [
		self addButtonFor: aMorph ]! !
!TaskbarMorph methodsFor: 'submorphs-add/remove' stamp: 'jmv 1/15/2017 18:57:58'!
delete

	| w |
	self restoreAll.
	super delete.
	w _ self world ifNil: [ self runningWorld ].
	Display removeActionsWithReceiver: self.
	w ifNotNil: [ w taskbarDeleted ]! !
!TaskbarMorph methodsFor: 'submorphs-add/remove' stamp: 'jmv 1/16/2017 09:52:23'!
 noteNewOwner: aMorph
	"I have just been added as a submorph of aMorph"
	super noteNewOwner: aMorph.
	Preferences taskbarIncludesAllWindows ifTrue: [
		aMorph submorphsDo: [ :m |
			m == self ifFalse: [
				self addButtonFor: m ]]].
	self notifyDisplayResize! !
!TaskbarMorph methodsFor: 'menus' stamp: 'jmv 1/15/2017 19:14:11'!
                        handlesMouseDown: aMouseButtonEvent

	^ true! !
!TaskbarMorph methodsFor: 'menus' stamp: 'jmv 1/15/2017 19:10:57'!
             mouseButton2Activity

	| menu |
	menu _ MenuMorph new defaultTarget: self.
	menu
		addLine;
		add: 'Normal Height' action: #scaleNormal;
		add: 'Scale x 2' action: #scaleX2;
		add: 'Scale x 4' action: #scaleX4.
	menu popUpInWorld! !
!TaskbarMorph methodsFor: 'resize' stamp: 'jmv 1/15/2017 19:01:25'!
                   scale: anInteger

	(anInteger between: 1 and: 4) ifFalse: [ self error: 'scale should be 1 2 or 4' ].
	scale := anInteger.
	self screenSizeChanged. "rescale self"
	viewBox ifNotNil: [ "rescale buttons"
		viewBox submorphs do: [ :button | 
			button layoutSpec fixedWidth: self defaultHeight
		]
	]! !
!TaskbarMorph methodsFor: 'resize' stamp: 'jmv 1/15/2017 19:00:49'!
               scaleNormal

	self scale: 1! !
!TaskbarMorph methodsFor: 'resize' stamp: 'jmv 1/15/2017 19:00:52'!
                             scaleX2

	self scale: 2! !
!TaskbarMorph methodsFor: 'resize' stamp: 'jmv 1/15/2017 19:00:55'!
 scaleX4

	self scale: 4! !
!TaskbarMorph class methodsFor: 'system startup' stamp: 'jmv 1/8/2017 16:47:17'!
                    initClassCachedState

	"Should use some other way to find relevant instances"
	self flag: #jmvVer2.
	self allInstancesDo: [ :each |
		each notifyDisplayResize ]! !
!Morph methodsFor: 'drawing' stamp: 'jmv 1/15/2017 18:24:25' prior: 16874345!
              visible: aBoolean
	"set the 'visible' attribute of the receiver to aBoolean"

	self visible == aBoolean
		ifTrue: [ ^ self ].
	aBoolean ifFalse: [
		self redrawNeeded ].
	self setProperty: #visible toValue: aBoolean.
	owner ifNotNil: [ owner someSubmorphPositionOrExtentChanged ].
	aBoolean ifTrue: [
		self redrawNeeded.
		self taskbar ifNotNil: [ :tb |
			tb wasMadeVisible: self ]]! !
!Morph methodsFor: 'halos and balloon help' stamp: 'jmv 1/15/2017 14:58:58' prior: 16875692!
                               comeToFrontAndAddHalo
	self show.
	self comeToFront.
	self addHalo! !
!Morph methodsFor: 'menus' stamp: 'jmv 1/15/2017 18:24:40' prior: 16876276!
              collapse
	"If taskbar not visible, just hide."

	self hide.
	self taskbar
		ifNotNil: [ :tb | tb wasCollapsed: self ]! !
!Morph methodsFor: 'menus' stamp: 'jmv 1/15/2017 14:59:12' prior: 16876281!
                           expand
	
	self show.
	self comeToFront! !
!Morph methodsFor: 'testing' stamp: 'jmv 1/15/2017 15:04:18' prior: 16876985!
        isCollapsed

	^ self visible not! !
!PasteUpMorph methodsFor: 'world state' stamp: 'jmv 1/8/2017 16:44:57' prior: 16887743!
    allNonWindowRelatedSubmorphs
	"Answer all non-window submorphs that are not flap-related"

	^submorphs 
		reject: [ :m | (m is: #SystemWindow) or: [ m is: #TaskbarMorph ] ]! !
!PasteUpMorph methodsFor: 'taskbar' stamp: 'jmv 1/15/2017 14:43:48' prior: 16887920!
                           showTaskbar

	taskbar ifNil: [
		taskbar _ TaskbarMorph newRow.
		taskbar openInWorld: self ]! !
!StringMorph methodsFor: 'geometry' stamp: 'jmv 1/15/2017 14:22:53' prior: 16918181!
          measureContents
	| f |
	f _ self fontToUse.
	^((f widthOfString: contents) max: 3)  @ f height! !

TaskbarMorph removeSelector: #intoWorld:!

PasteUpMorph removeSelector: #isCollapsed:!

PasteUpMorph removeSelector: #isCollapsed:!

PasteUpMorph removeSelector: #minimize:!

PasteUpMorph removeSelector: #minimize:!

PasteUpMorph removeSelector: #restore:!

PasteUpMorph removeSelector: #restore:!

PasteUpMorph removeSelector: #taskbar:!

PasteUpMorph removeSelector: #taskbar:!

PasteUpMorph allInstancesDo: [ :w | w showTaskbar ]!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3036-NewTaskbar-JuanVuletich-2017Jan16-10h55m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3036] on 17 January 2017 at 11:13:18 am'!
!DebuggerWindow methodsFor: 'GUI building' stamp: 'jmv 1/17/2017 10:51:52'!
                          initialExtent
	^ RealEstateAgent standardWindowExtent * 3 // 2! !
!RealEstateAgent class methodsFor: 'as yet unclassified' stamp: 'jmv 1/17/2017 11:12:27' prior: 16898269!
                    maximumUsableAreaInWorld: aWorldOrNil

	| allowedArea |
	allowedArea _ Display boundingBox.
	aWorldOrNil ifNotNil: [
		allowedArea _ allowedArea intersect: aWorldOrNil viewBox.
		aWorldOrNil taskbar ifNotNil: [ :tb |
			allowedArea _ (allowedArea areasOutside: tb morphBoundsInWorld) first ]].
	^allowedArea
! !
!PasteUpMorph methodsFor: 'geometry' stamp: 'jmv 1/17/2017 11:00:35' prior: 16887247!
                  privateExtent: newExtent

	^ (super privateExtent: newExtent)
		ifTrue: [
			self buildMagnifiedBackgroundImage.
			worldState clearCanvas ]; yourself! !
!PasteUpMorph methodsFor: 'project state' stamp: 'jmv 1/17/2017 10:56:23' prior: 16887422!
           viewBox

	^ worldState
		ifNotNil: [
			 0@0 extent: extent ]
		ifNil: [
			self world viewBox ]! !
!PasteUpMorph methodsFor: 'world state' stamp: 'jmv 1/17/2017 11:05:24' prior: 16887834!
   restoreMorphicDisplay
	DisplayScreen startUp.
	self
		morphExtent: Display extent;
		handsDo: [ :h | h visible: true ];
		fullRepaintNeeded.
	WorldState addDeferredUIMessage: [ Cursor normal activateCursor ]! !
!PasteUpMorph class methodsFor: 'instance creation' stamp: 'jmv 1/17/2017 11:04:44' prior: 16887959!
        newWorld
	"
[
	ProjectX stopUIProcess.
	ProjectX spawnNewMorphicProcessFor: PasteUpMorph newWorld
] fork.
	"
	| w ws |
	w _ self new.
	ws _ WorldState new.
	w worldState: ws.
	w morphPosition: 0@0 extent: Display extent.
	ws setCanvas: Display getCanvas.
	w borderWidth: 0.
	ws handsDo: [ :h |
		h privateOwner: w ].
	^w! !
!WorldState methodsFor: 'canvas' stamp: 'jmv 1/17/2017 10:57:47' prior: 16945711!
          ensureNonDisplayCanvas
	(canvas isNil or: [
		canvas drawsOnDisplay or: [
		(canvas extent ~= world morphExtent) or: [
		canvas form depth ~= Display depth]]]) ifTrue: [
			"allocate a new offscreen canvas the size of the window"
			self setCanvas: (BitBltCanvas withExtent: world morphExtent depth: Display depth)]! !
!WorldState methodsFor: 'update cycle' stamp: 'jmv 1/17/2017 11:05:18' prior: 16946039!
         tryDeferredUpdatingAndSetCanvasFor: aWorld
        "If this platform supports deferred updates, then make my canvas be the Display (or a rectangular portion of it), set the Display to deferred update mode, and answer true. Otherwise, set a non-Disply canvas and answer false.."
	| properDisplay |
	
	"As this is the only sender of #deferUpdates: , this could be done in Morphic or image startup, and never efterwards..."
	(Display deferUpdates: true) ifNil: [
		"deferred updates not supported by the VM, do them in the image!!"
		self ensureNonDisplayCanvas.
		^ false].
	
	"if no canvas, or canvas was offscreen, from a platform that didnt support defers, then fix it"
	properDisplay _ canvas notNil and: [canvas drawsOnDisplay].
	properDisplay ifFalse: [
		aWorld morphPosition: 0@0 extent: Display extent.
		self setCanvas: Display getCanvas.
	].
	^ true! !
!WorldState methodsFor: 'drawing' stamp: 'jmv 7/28/2015 08:35' prior: 16946090!
                  displayWorld: aWorld submorphs: submorphs
	"Update this world's display."

	| deferredUpdateVMMode worldDamageRects handsToDraw allDamage |
	self checkIfUpdateNeeded ifFalse: [ ^ self ].  "display is already up-to-date"
	"I (jmv) removed the call to 'deferUpdates: false' below. No more need to call this every time."
	deferredUpdateVMMode _ self tryDeferredUpdatingAndSetCanvasFor: aWorld.

	"repair world's damage on canvas"
	worldDamageRects _ self drawInvalidAreasWorld: aWorld submorphs: submorphs.

	"Check which hands need to be drawn (they are not the hardware mouse pointer)"
	handsToDraw _ self selectHandsToDrawForDamage: worldDamageRects.
	allDamage _ Array streamContents: [ :strm |
		strm nextPutAll: worldDamageRects.
		handsToDraw do: [ :h | 
			h savePatchFrom: canvas appendDamageTo: strm ]].

	"Draw hands (usually carying morphs) onto world canvas"
	canvas newClipRect: nil.
	handsToDraw reverseDo: [ :h | canvas fullDrawHand: h ].

	"quickly copy altered rects of canvas to Display:"
	deferredUpdateVMMode ifFalse: [
		"Drawing was done to off-Display canvas. Copy content to Display"
		canvas showAt: aWorld viewBox origin invalidRects: allDamage ].

	"Display deferUpdates: false."
	"Display forceDisplayUpdate"
	Display forceDamageToScreen: allDamage.

	"Restore world canvas under hands and their carried morphs"
	handsToDraw do: [ :h | h restoreSavedPatchOn: canvas ].! !

WorldState removeSelector: #viewBox!

WorldState removeSelector: #viewBox!

WorldState removeSelector: #viewBox:!

WorldState removeSelector: #viewBox:!

DebuggerWindow removeSelector: #initialFrameIn:!

DebuggerWindow removeSelector: #initialFrameIn:!

PasteUpMorph removeSelector: #viewBox:!

PasteUpMorph removeSelector: #viewBox:!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3037-WindowsAvoidTaskbarArea-JuanVuletich-2017Jan17-10h47m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3037] on 18 January 2017 at 10:36:09 am'!
!TaskbarMorph methodsFor: 'services' stamp: 'jmv 1/18/2017 10:34:55' prior: 50337258!
                  addButtonFor: aMorph

	| button |
	aMorph == self ifFalse: [
		button _ PluggableButtonMorph
			model: aMorph
			stateGetter: nil
			action: #showAndComeToFront.
		button
			color: self color;
			icon: (aMorph imageForm: 32);
			setBalloonText: aMorph label.
		viewBox
			addMorph: button
			fixedWidth: self defaultHeight ]! !
!TaskbarMorph methodsFor: 'submorphs-add/remove' stamp: 'jmv 1/18/2017 10:35:05' prior: 50337321!
                      noteNewOwner: aMorph
	"I have just been added as a submorph of aMorph"
	super noteNewOwner: aMorph.
	Preferences taskbarIncludesAllWindows ifTrue: [
		aMorph submorphsDo: [ :m |
			self addButtonFor: m ]].
	self notifyDisplayResize! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3038-TaskbarTweaks-JuanVuletich-2017Jan18-10h34m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3038] on 18 January 2017 at 7:35:13 pm'!
!DirectoryEntry methodsFor: 'enumeration' stamp: 'jmv 1/18/2017 11:20:57'!
   fileMatching: pattern
"
	DirectoryEntry smalltalkImageDirectory fileMatching: '*.image'.
	DirectoryEntry smalltalkImageDirectory fileMatching: 'x*.image'.
"
	self filesDo: [ :file |
		(pattern match: file name)
			ifTrue: [ ^ file ]].
	^ nil! !
!DirectoryEntry methodsFor: 'enumeration' stamp: 'jmv 1/18/2017 11:13:59' prior: 16834484!
                directoriesDo: aBlock
	self childrenDo: [ :each |
		each isFile ifFalse: [
			aBlock value: each ]]! !
!DirectoryEntry methodsFor: 'enumeration' stamp: 'jmv 1/18/2017 11:19:42' prior: 16834701!
                              directoryMatching: pattern
"
	DirectoryEntry smalltalkImageDirectory directoryMatching: 'C*Pack*'.
	DirectoryEntry smalltalkImageDirectory directoryMatching: 'xC*Pack*'.
"
	self directoriesDo: [ :directory |
		(pattern match: directory name)
			ifTrue: [ ^ directory ]].
	^ nil! !
!DirectoryEntry methodsFor: 'enumeration' stamp: 'jmv 1/18/2017 11:14:17' prior: 16834493!
            filesDo: aBlock
	self childrenDo: [ :each |
		each isFile ifTrue: [
			aBlock value: each ]]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3039-DirectoryEntryTweaks-JuanVuletich-2017Jan18-19h34m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3039] on 18 January 2017 at 10:26:44 pm'!
!TaskbarMorph methodsFor: 'services' stamp: 'jmv 1/18/2017 22:25:29' prior: 50337619!
                           addButtonFor: aMorph

	| button |
	aMorph == self ifFalse: [
		button _ PluggableButtonMorph
			model: aMorph
			stateGetter: nil
			action: #showAndComeToFront.
		button
			color: self color;
			icon: (aMorph imageForm: 32);
			setBalloonText: aMorph label.
		button icon: button magnifiedIcon.
		viewBox
			addMorph: button
			fixedWidth: self defaultHeight ]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3040-DontWasteMemoryOnTaskbarButtons-JuanVuletich-2017Jan18-22h26m-jmv.1.cs.st----!

----SNAPSHOT----#(18 January 2017 10:36:10.429049 pm) Cuis5.0-3040-spur-64.image priorSource: 83443!

----QUIT----#(18 January 2017 10:36:23.953152 pm) Cuis5.0-3040-spur-64.image priorSource: 193992!

----STARTUP----#(20 February 2017 12:08:31.543295 pm) as /home/juan/Rectifier/Cuis-Smalltalk-Dev/Cuis5.0-3040-spur-64.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3040] on 22 January 2017 at 9:33:48 pm'!
!PasteUpMorph methodsFor: 'geometry' stamp: 'jmv 1/22/2017 21:17:32' prior: 50337474!
                            privateExtent: newExtent

	^ (super privateExtent: newExtent)
		ifTrue: [
			self buildMagnifiedBackgroundImage.
			worldState ifNotNil: [
				worldState clearCanvas ]];
		yourself! !
!SystemWindow methodsFor: 'drawing' stamp: 'jmv 1/22/2017 21:25:10' prior: 16926091!
                   drawOn: aCanvas

	| titleColor roundCorners |

	titleColor _ self widgetsColor.
	self isTopWindow
		ifTrue: [ titleColor _ titleColor lighter ].

	roundCorners _ Theme current roundWindowCorners.
	roundCorners
		ifTrue: [
			"Round corners. Optional title gradient."
			self drawRoundedFrameOn: aCanvas color: titleColor ]
		ifFalse: [
			"No round corners. No title gradient."
			self drawClassicFrameOn: aCanvas color: titleColor ].
	Theme current minimalWindows
		ifFalse: [
			labelString ifNotNil: [self drawLabelOn: aCanvas]]! !
!MenuMorph methodsFor: 'control' stamp: 'jmv 1/22/2017 21:31:40' prior: 16866779!
                       popUpInWorld: aWorld
	"Present this menu under control of the given hand."
	"Needed if not the real world but an inner PasteUpMorph"
	| positionInWorld |
	positionInWorld _ aWorld internalizeFromWorld: aWorld activeHand morphPosition.
	^self
		popUpAt: positionInWorld
		forHand: aWorld activeHand
		in: aWorld
! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3041-Fix-clearCanvas-DNU-JuanVuletich-2017Jan22-21h17m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #2974] on 3 December 2016 at 9:04:32 am'!
!Integer methodsFor: 'private' stamp: 'nice 1/19/2013 03:13'!
                           montgomeryDigitBase
	"Answer the base used by Montgomery algorithm."
	^1 << self montgomeryDigitLength! !
!Integer methodsFor: 'private' stamp: 'nice 1/19/2013 03:27'!
                        montgomeryDigitLength
	"Answer the number of bits composing a digit in Montgomery algorithm.
	Primitive use either 8 or 32 bits digits"
	<primitive: 'primMontgomeryDigitLength' module:'LargeIntegers'>
	^8 "Legacy plugin which did not have this primitive did use 8 bits digits"! !
!Integer methodsFor: 'private' stamp: 'nice 1/19/2013 03:14'!
          montgomeryDigitMax
	"Answer the maximum value of a digit used in Montgomery algorithm."
	
	^1 << self montgomeryDigitLength - 1! !
!Integer methodsFor: 'private' stamp: 'nice 1/19/2013 03:16'!
                               montgomeryNumberOfDigits
	"Answer the number of montgomery digits required to represent the receiver."
	^self digitLength * 8 + (self montgomeryDigitLength - 1) // self montgomeryDigitLength! !
!Integer methodsFor: 'mathematical functions' stamp: 'nice 1/16/2013 18:38' prior: 16859768!
 raisedTo: n modulo: m
	"Answer the modular exponential.
	Note: this implementation is optimized for case of large integers raised to large powers."
	| a s mInv |
	n = 0 ifTrue: [^1].
	(self >= m or: [self < 0]) ifTrue: [^self \\ m raisedTo: n modulo: m].
	n < 0 ifTrue: [^(self reciprocalModulo: m) raisedTo: n negated modulo: m].
	(n < 4096 or: [m even])
		ifTrue:
			["Overhead of Montgomery method might cost more than naive divisions, use naive"
			^self slidingLeftRightRaisedTo: n modulo: m].
	
	mInv := self montgomeryDigitBase - ((m bitAnd: self montgomeryDigitMax) reciprocalModulo: self montgomeryDigitBase).
 
	"Initialize the result to R=self montgomeryDigitModulo raisedTo: m montgomeryNumberOfDigits"
	a := (1 bitShift: m montgomeryNumberOfDigits * m montgomeryDigitLength) \\ m.
	
	"Montgomerize self (multiply by R)"
	(s := self montgomeryTimes: (a*a \\ m) modulo: m mInvModB: mInv)
		ifNil:
			["No Montgomery primitive available ? fallback to naive divisions"
			^self slidingLeftRightRaisedTo: n modulo: m].

	"Exponentiate self*R"
	a := s montgomeryRaisedTo: n times: a modulo: m mInvModB: mInv.

	"Demontgomerize the result (divide by R)"
	^a montgomeryTimes: 1 modulo: m mInvModB: mInv! !
!Integer methodsFor: 'testing' stamp: 'nice 11/14/2011 21:59' prior: 16860231!
                      isProbablyPrime
	"See isProbablyPrimeWithK:andQ: for the algoritm description."
	
	| k q |
	self <= 1 ifTrue: [ ^false ].
	self even ifTrue: [ ^self = 2 ].
	"Factor self into (2 raisedTo: k) * q + 1, where q odd"
	q := self bitShift: -1.
	k := q lowBit.
	q := q bitShift: 1 - k.
	"Repeat the probabilistic until false (the probability of false negative is null) or until probability is very low."
	25 timesRepeat: [ (self isProbablyPrimeWithK: k andQ: q) ifFalse: [ ^false ] ].
	"The probability of false positive after 25 iterations is less than (1/4 raisedTo: 25) < 1.0e-15"
	^true! !
!Integer methodsFor: 'private' stamp: 'nice 11/15/2011 23:13' prior: 16860590!
      isProbablyPrimeWithK: k andQ: q 
	"Algorithm P, probabilistic primality test, from
	Knuth, Donald E. 'The Art of Computer Programming', Vol 2,
	Third Edition, section 4.5.4, page 395, P1-P5 refer to Knuth description..
	Note that this is a Miller Rabin test which may answer false positives (known as pseudoprimes) for at most 1/4 of the possible bases x."

	| x j y minusOne |
	"P1"
	x := (self - 2) atRandom + 1.
	"P2"
	j := 0.
	y := x raisedTo: q modulo: self.
	minusOne := self - 1.
	
	["P3"
	y = 1 ifTrue: [^j = 0].
	y = minusOne ifTrue: [^true].
	"P4"
	(j := j + 1) < k]
		whileTrue:
			[y := y squared \\ self].
	"P5"
	^false! !
!Integer methodsFor: 'private' stamp: 'nice 1/16/2013 18:40' prior: 16860675!
                      montgomeryTimes: a modulo: m mInvModB: mInv
	"Answer the result of a Montgomery multiplication
	self * a * (b raisedTo: m montgomeryNumberOfDigits) inv \\ m
	NOTE: it is assumed that:
	self montgomeryNumberOfDigits <= m montgomeryNumberOfDigits
	a montgomeryNumberOfDigits <= m montgomeryNumberOfDigits
	mInv * m \\ b = (-1 \\ b) = (b-1) (this implies m odd)
	where b = self montgomeryDigitBase
	
	Answer nil in case of absent plugin or other failure."
	
	<primitive: 'primMontgomeryTimesModulo' module:'LargeIntegers'>
	^nil! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3042-MontgomeryExponentiationFix-LucianoEstebanNotarfrancesco-2016Nov29-21h10m-len.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3042] on 22 January 2017 at 9:49:56 pm'!
!Integer methodsFor: 'arithmetic' stamp: 'len 12/4/2016 13:11:44'!
        reciprocalModulo2: n
	"Answer an integer x such that self * x \\ n = 1, with 0 < x < n, or nil if it doesn't exist."
	| xgcd |
	self == 0 ifTrue: [^ nil].
	self == 1 ifTrue: [^ 1].
	xgcd _ self xgcd: n.
	^ (xgcd at: 1) == 1 ifTrue: [^ (xgcd at: 2) \\ n]! !
!Integer methodsFor: 'arithmetic' stamp: 'len 12/4/2016 13:07:08'!
                            xgcd: anInteger
	"Extended Euclidean algorithm.
	Answer an array {x. u. v} where self * u + (anInteger * v) = x, and x = (self gcd: anInteger)."
	| a b s t sp tp r rp |
	a _ self. b _ anInteger.
	s _ 0. sp _ 1.
	t _ 1. tp _ 0.
	r _ a abs. rp _ b abs.
	[r == 0]
		whileFalse:
			[ | q temp |
			q _ rp // r.
			temp _ r. r _ rp - (q * r). rp _ temp.
			temp _ s. s _ sp - (q * s). sp _ temp.
			temp _ t. t _ tp - (q * t). tp _ temp].
	sp _ sp * b sign. tp _ tp * a sign.
	^ {rp. tp. sp}! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3043-Alternative-gcd-reciprocalModulo-LucianoEstebanNotarfrancesco-2017Jan22-21h46m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3043] on 16 February 2017 at 2:31:35 pm'!
!FileSystemEntry methodsFor: 'accessing-file name' stamp: 'jmv 2/16/2017 11:21:10' prior: 16843823!
        baseName
	^self fileAccessor baseNameFor: name! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3044-basename-fix-JuanVuletich-2017Feb16-11h21m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3044] on 17 February 2017 at 3:11:08 pm'!
!PluggableButtonMorph methodsFor: 'private' stamp: 'jmv 2/17/2017 15:10:48' prior: 16888368!
           magnifiedIcon
	| factor magnifiedExtent w h |

	icon ifNil: [ ^nil ].
	magnifiedIcon ifNil: [
		magnifiedIcon _ icon.
		w _ icon width.
		h _ icon height.
		w*h = 0 ifFalse: [
			factor _ 1.0 * extent x / w min: 1.0 * extent y / h.
			(factor < 1 or: [ factor > 1.7 and: [self isRoundButton]]) ifTrue: [
				magnifiedExtent _ (icon extent * factor) rounded.
				magnifiedIcon _ icon magnifyTo: magnifiedExtent ]]].
	^magnifiedIcon! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3045-magnifiedIcon-fix-JuanVuletich-2017Feb17-15h10m-jmv.1.cs.st----!

----SNAPSHOT----#(20 February 2017 12:09:34.739158 pm) Cuis5.0-3045-spur-64.image priorSource: 194094!

----QUIT----#(20 February 2017 12:09:57.201979 pm) Cuis5.0-3045-spur-64.image priorSource: 202910!

----STARTUP----#(6 March 2017 10:16:04.474788 am) as /home/juan/Rectifier/Cuis-Smalltalk-Dev/Cuis5.0-3045-spur-64.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3042] on 10 February 2017 at 5:39:28 pm'!

Object subclass: #ProgessiveTestRunner
	instanceVariableNames: 'testSuite testsStream progressBar testResult testRunIncrement'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tools-Testing'!

!classDefinition: #ProgessiveTestRunner category: #'Tools-Testing'!
Object subclass: #ProgessiveTestRunner
	instanceVariableNames: 'testSuite testsStream progressBar testResult testRunIncrement'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Tools-Testing'!
!Browser methodsFor: 'tdd' stamp: 'HAW 2/10/2017 17:32:22'!
        debugMethodTest
	
	currentCompiledMethod isTestMethod ifTrue: [
		currentCompiledMethod methodClass debugAsFailure: currentCompiledMethod selector ]
! !
!Browser methodsFor: 'tdd' stamp: 'HAW 2/4/2017 20:33:00'!
            runClassTests
	
	self selectedClassName ifNotNil: [ :aClassName | | selectedClass |
		selectedClass _ Smalltalk classNamed: aClassName.
		(ProgessiveTestRunner for: (TestSuite forClass: selectedClass)) value ]! !
!Browser methodsFor: 'tdd' stamp: 'HAW 2/7/2017 10:47:50'!
                runMessageCategoryTests
	
	selectedMessageCategory ifNotNil: [ | selectedClass suite |
		selectedClass _ Smalltalk classNamed: selectedClassName.
		suite _ TestSuite forMessageCategoryNamed: selectedMessageCategory of: selectedClass categorizedWith: classOrganizer.
		(ProgessiveTestRunner for: suite) value ]
	
	! !
!Browser methodsFor: 'tdd' stamp: 'HAW 2/4/2017 21:51:50'!
        runMethodTest
	
	| suite |
	
	suite _ TestSuite forCompiledMethod: currentCompiledMethod.
	(ProgessiveTestRunner for: suite) value 
	! !
!Browser methodsFor: 'tdd' stamp: 'HAW 2/1/2017 19:23:54'!
                            runSystemCategoryTests
	
	selectedSystemCategory ifNotNil: [ | suite |
		suite _ TestSuite forSystemCategoryNamed: selectedSystemCategory using: systemOrganizer.
		(ProgessiveTestRunner for: suite) value ]
	
	! !
!Behavior methodsFor: 'tdd' stamp: 'HAW 2/7/2017 11:55:50'!
               testCaseClass

	self subclassResponsibility ! !
!Behavior methodsFor: 'tdd' stamp: 'HAW 2/7/2017 11:55:40'!
                    withTestCaseClassDo: aFoundTestCaseClassBlock ifNone: aNoneBlock 
		
	| potentialTestCaseClass |
	
	potentialTestCaseClass _ self testCaseClass.
	
	^potentialTestCaseClass ifNil: aNoneBlock ifNotNil: aFoundTestCaseClassBlock 
	! !
!Class methodsFor: 'tdd' stamp: 'HAW 2/7/2017 10:42:40'!
testCaseClass
		
	| potentialTestCaseClass |
	
	potentialTestCaseClass _ Smalltalk classNamed: self name, 'Test'.
	
	^potentialTestCaseClass 
	
 ! !
!Metaclass methodsFor: 'tdd' stamp: 'HAW 2/7/2017 11:56:51'!
              testCaseClass

	^self soleInstance testCaseClass ! !
!Categorizer methodsFor: 'tdd' stamp: 'HAW 2/7/2017 09:06:13'!
            classesAt: aCategoryName

	^(self listAtCategoryNamed: aCategoryName) collect: [:aClassName | Smalltalk classNamed: aClassName ]
		! !
!Categorizer methodsFor: 'tdd' stamp: 'HAW 2/7/2017 09:06:34'!
                          testCaseClassesAt: aCategoryName

	^(self classesAt: aCategoryName) select: [ :aClass | aClass is: #TestCaseClass ]! !
!SmalltalkEditor methodsFor: 'editing keys' stamp: 'HAW 2/10/2017 16:03:46'!
                            acceptAndDebugTest: aKeyboardEvent 
	
	^self acceptAndDebugTest ! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HAW 2/10/2017 17:34:45'!
                        acceptAndDebugTest
	
	^self acceptAndWithMethodDo: [ :aPotencialTestMethod | 
		aPotencialTestMethod isTestMethod ifTrue: [ aPotencialTestMethod methodClass debugAsFailure: aPotencialTestMethod selector ]]! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HAW 2/10/2017 17:34:38'!
           acceptAndWithMethodDo: aBlock
	
	| potencialTestMethod |
	
	self acceptContents ifFalse: [ ^false ].
	
	potencialTestMethod _ self codeProvider currentCompiledMethod.
	^potencialTestMethod 
		ifNil: [ false ]
		ifNotNil: [
			aBlock value: potencialTestMethod.
			true]! !
!ProgessiveTestRunner methodsFor: 'initialization' stamp: 'HAW 2/1/2017 19:20:06'!
                            initializeFor: aTestSuite

	testSuite _ aTestSuite.
	! !
!ProgessiveTestRunner methodsFor: 'evaluating' stamp: 'HAW 1/31/2017 11:50:37'!
                       value

	testsStream _ ReadStream on: testSuite tests.
	testsStream atEnd
		ifTrue: [ self informNoTestToRun ]
	 	ifFalse:[ self createProgressBarAndRun ]! !
!ProgessiveTestRunner methodsFor: 'progress bar - private' stamp: 'HAW 1/31/2017 10:25:22'!
       calculateTestRunIncrement
	
	testRunIncrement _ 1/testsStream size! !
!ProgessiveTestRunner methodsFor: 'progress bar - private' stamp: 'HAW 1/31/2017 10:25:31'!
                              createProgressBar
		
	progressBar _ ProgressMorph label: testSuite name.
	self calculateTestRunIncrement.
	self updateProgressBarSubLabel.
	! !
!ProgessiveTestRunner methodsFor: 'progress bar - private' stamp: 'HAW 1/31/2017 10:25:43'!
                    updateDoneIncrement 

 	progressBar incrDone: testRunIncrement 
	! !
!ProgessiveTestRunner methodsFor: 'progress bar - private' stamp: 'HAW 1/31/2017 11:10:25'!
                               updateProgressBarSubLabel

	testsStream atEnd ifFalse: [
		progressBar subLabel: testsStream next printString, ' (', testsStream position printString, '/', testsStream size printString, ')' ].! !
!ProgessiveTestRunner methodsFor: 'show result - private' stamp: 'HAW 1/31/2017 20:05:25'!
 informAllTestPassed 
	
	PopUpMenu inform: testResult printString.
	! !
!ProgessiveTestRunner methodsFor: 'show result - private' stamp: 'HAW 1/31/2017 10:05:21'!
                              informNoTestToRun
		
	 PopUpMenu inform: 'No test to run'! !
!ProgessiveTestRunner methodsFor: 'show result - private' stamp: 'HAW 2/1/2017 19:26:08'!
         openTestResultForDebuggingAndInspection

	testResult forDebuggingAndInspection inspect ! !
!ProgessiveTestRunner methodsFor: 'show result - private' stamp: 'HAW 1/31/2017 10:10:53'!
          showDeffects
	
	 | defects |
			
	defects _ 	testResult defects.
	defects size = 1
		ifTrue: [ defects anyOne debug ] 
		ifFalse: [ self openTestResultForDebuggingAndInspection]! !
!ProgessiveTestRunner methodsFor: 'evaluating - private' stamp: 'HAW 2/1/2017 19:14:08'!
                  createProgressBarAndRun

	self createProgressBar.
	[ self runSuiteShowingProgress ] fork! !
!ProgessiveTestRunner methodsFor: 'evaluating - private' stamp: 'HAW 2/1/2017 19:26:59'!
           registerTestSuiteAction
		
	testSuite when: #changed: send: #testRun: to: self! !
!ProgessiveTestRunner methodsFor: 'evaluating - private' stamp: 'HAW 1/31/2017 10:09:41'!
                    runSuite
		
	testResult _ testSuite run.	
	testResult hasPassed 
		ifTrue: [ self informAllTestPassed ] 
		ifFalse: [self showDeffects ]
	! !
!ProgessiveTestRunner methodsFor: 'evaluating - private' stamp: 'HAW 1/31/2017 11:47:58'!
                        runSuiteShowingProgress

	[ self registerTestSuiteAction. 
	progressBar openInWorld.
	self runSuite ] ensure: [
		self unregisterTestSuiteAction.
		WorldState addDeferredUIMessage: [progressBar dismissMorph] ].
	! !
!ProgessiveTestRunner methodsFor: 'evaluating - private' stamp: 'HAW 2/1/2017 19:19:28'!
               testRun: aTest

	self updateProgressBarSubLabel.
	self updateDoneIncrement 
	
		! !
!ProgessiveTestRunner methodsFor: 'evaluating - private' stamp: 'HAW 1/31/2017 10:04:32'!
                  unregisterTestSuiteAction
	
	testSuite releaseActionMap ! !
!ProgessiveTestRunner class methodsFor: 'instance creation' stamp: 'HAW 1/31/2017 09:37:34'!
       for: aTestSuite

	^self new initializeFor: aTestSuite! !
!TestCase class methodsFor: 'Instance Creation' stamp: 'HAW 2/10/2017 16:01:40'!
                      debugAsFailure: aSymbol

	^(self selector: aSymbol) debugAsFailure
			! !
!TestSuite class methodsFor: 'Creation' stamp: 'HAW 2/4/2017 20:31:47'!
              forClass: aClass

	^(aClass is: #TestCaseClass) 
		ifTrue: [ self forTestCaseClass: aClass ]
		ifFalse: [ self forNoTestCaseClass: aClass ]
! !
!TestSuite class methodsFor: 'Creation' stamp: 'HAW 2/4/2017 21:53:12'!
        forCompiledMethod: aCompiledMethod

	^aCompiledMethod isTestMethod 
		ifTrue: [ self forTestMethod: aCompiledMethod ]
		ifFalse: [ self forNoTestMethod: aCompiledMethod ]
	! !
!TestSuite class methodsFor: 'Creation' stamp: 'HAW 2/1/2017 18:43:22'!
        forMessageCategoryNamed: aMessageCategoryName of: aClass categorizedWith: aClassOrganizer

	| suite |
	
	suite _ self named: aClass name, ' tests categorized under ',aMessageCategoryName.
	(aClassOrganizer listAtCategoryNamed: aMessageCategoryName) do: [ :selector |
		(aClass compiledMethodAt: selector) isTestMethod ifTrue: [ suite addTest: (aClass selector: selector) ]].
	
	^suite
	! !
!TestSuite class methodsFor: 'Creation' stamp: 'HAW 2/7/2017 10:24:12'!
                  forSystemCategoryNamed: aCategoryName  using: aSystemOrganizer 

	| testCaseClasses |
	
	testCaseClasses _ aSystemOrganizer testCaseClassesAt: aCategoryName.
	
	^testCaseClasses isEmpty 
		ifTrue: [ self forClasses: (aSystemOrganizer classesAt: aCategoryName) named: aCategoryName, ' infered tests' ]
		ifFalse: [ self forTestCaseClasses: testCaseClasses named: aCategoryName, ' tests' ]
		
! !
!TestSuite class methodsFor: 'Creation - Private' stamp: 'HAW 2/7/2017 10:25:51'!
   allTestCaseClassesReferencing: aClass

	^(aClass allCallsOn 
		collect: [ :aMethodReference | aMethodReference actualClass ]
		thenSelect: [ :aPotentialTestCaseClass | aPotentialTestCaseClass is: #TestCaseClass ]) asSet.! !
!TestSuite class methodsFor: 'Creation - Private' stamp: 'HAW 2/7/2017 10:27:27'!
              allTestsSending: aSelector
	
	^(Smalltalk allCallsOn: aSelector) select: [:aMethodReference | 
		(aMethodReference actualClass is: #TestCaseClass) and: [aMethodReference compiledMethod isTestMethod ]].! !
!TestSuite class methodsFor: 'Creation - Private' stamp: 'HAW 2/7/2017 09:08:23'!
 forClasses: classes named: name

	| suite |
	
	suite _ classes
		inject: (self named: name)
		into: [ :partialSuite :aClass | partialSuite addTests: (self forClass: aClass) tests ].
		
	^suite
		
! !
!TestSuite class methodsFor: 'Creation - Private' stamp: 'HAW 2/7/2017 10:32:17'!
      forNoTestCaseClass: aClass 

	^aClass 
		withTestCaseClassDo: [ :aTestCaseClass | self forTestCaseClass: aTestCaseClass ]
		ifNone: [ self forReferencesToClass: aClass ]

! !
!TestSuite class methodsFor: 'Creation - Private' stamp: 'HAW 2/7/2017 11:28:55'!
                               forNoTestMethod: aCompiledMethod 
	
	| allTestSenders testCaseClassesReferencingClass reducedTestSenders suite |
	
	allTestSenders _ self allTestsSending: aCompiledMethod selector.
	testCaseClassesReferencingClass _ aCompiledMethod methodClass 
		withTestCaseClassDo:  [:aTestCaseClass | Array with: aTestCaseClass ]
		ifNone: [ self allTestCaseClassesReferencing: aCompiledMethod methodClass ].
		
	reducedTestSenders _ allTestSenders select: [ :aMethodReference | testCaseClassesReferencingClass includes: aMethodReference actualClass ].
	reducedTestSenders isEmpty 
		ifTrue: [ suite _ self forClass: aCompiledMethod methodClass ]
		ifFalse: [ 
			suite _ self named: 'Tests senders of ', aCompiledMethod selector.
			reducedTestSenders do: [ :aMethodReference | suite addTest: (aMethodReference actualClass selector: aMethodReference selector)]].
	
	^suite! !
!TestSuite class methodsFor: 'Creation - Private' stamp: 'HAW 2/7/2017 10:33:27'!
              forReferencesToClass: aClass 

	| testCaseClasses |
	
	testCaseClasses _ self allTestCaseClassesReferencing: aClass.
		
	^testCaseClasses 
		inject: (self named: aClass name, ' all test references')
		into: [ :suite :aTestCaseClass | aTestCaseClass addToSuiteFromSelectors: suite ]
	

! !
!TestSuite class methodsFor: 'Creation - Private' stamp: 'HAW 2/7/2017 10:34:27'!
             forTestCaseClass: aTestCaseClass 

	| suite |
	
	suite _ aTestCaseClass buildSuite.
	suite name: aTestCaseClass name, ' tests'.
	
	^suite! !
!TestSuite class methodsFor: 'Creation - Private' stamp: 'HAW 2/7/2017 09:04:48'!
 forTestCaseClasses: testCaseClasses named: aName

	| suite |
	
	suite _ testCaseClasses
		inject: (self named: aName) 
		into: [:partialSuite :aTestCaseClass | aTestCaseClass addToSuiteFromSelectors: partialSuite ].
		
	^suite! !
!TestSuite class methodsFor: 'Creation - Private' stamp: 'HAW 2/4/2017 21:53:22'!
        forTestMethod: aCompiledMethod
	
	| suite |
	
	suite _ self named: 'Test'.
	suite addTest: (aCompiledMethod methodClass selector: aCompiledMethod selector).
	
	^suite
		! !
!UndefinedObject methodsFor: 'class hierarchy' stamp: 'HAW 2/10/2017 17:37:23'!
   allSuperclassesUpTo: aSuperclass 

	self error: (self superclassNotValidErrorDescriptionFor: aSuperclass)! !
!UndefinedObject methodsFor: 'class hierarchy' stamp: 'HAW 2/10/2017 17:37:30'!
   superclassNotValidErrorDescriptionFor: aClass 

	^aClass name, ' not in superclasses chain'! !
!Behavior methodsFor: 'system-support' stamp: 'HAW 2/4/2017 20:51:10' prior: 16785122!
          allCallsOn
	"Answer a SortedCollection of all the methods that refer to me by name or 
	as part of an association in a global dict."
	"
	^ (Smalltalk
		allCallsOn: (Smalltalk associationAt: self theNonMetaClass name))
		, (Smalltalk allCallsOn: self theNonMetaClass name)
	"

	^ Smalltalk allCallsOn: self theNonMetaClass name! !
!SystemDictionary methodsFor: 'browsing' stamp: 'HAW 2/4/2017 20:49:09' prior: 16923905!
                             browseAllCallsOnClass: aClass
	"Create and schedule a message browser on each method that refers to 
	aClass. For example, Smalltalk browseAllCallsOnClass: Object."
	self
		browseMessageList: aClass allCallsOn asArray sort
		name: 'Users of class ' , aClass theNonMetaClass name
		autoSelect: aClass theNonMetaClass name.! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HAW 2/1/2017 18:51:22' prior: 50336089!
        acceptAndTest
	
	self acceptThenTestMethodAndSuite: [ :aMethod | self testSuiteOf: aMethod methodClass ].
	^true! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HAW 2/1/2017 18:50:41' prior: 50336095!
                         acceptAndTestAll
	
	self acceptThenTestMethodAndSuite: [ :aMethod | self testSuiteForCategoryOf: aMethod methodClass ].
	^true
	
	! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HAW 2/10/2017 17:34:52' prior: 50336102!
      acceptThenTestMethodAndSuite: aSuiteBuilder
	
	self acceptAndWithMethodDo: [ :aPotencialTestMethod |
		self runAndDebuggIfNecessary: aPotencialTestMethod.
		self runTestSuite: (aSuiteBuilder value: aPotencialTestMethod) ]! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HAW 2/10/2017 16:08:47' prior: 50336124!
           runAndDebuggIfNecessary: aPotencialTestMethod

	aPotencialTestMethod isTestMethod ifTrue: [
		aPotencialTestMethod methodClass debug: aPotencialTestMethod selector ]! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HAW 2/1/2017 19:19:02' prior: 50336132!
    runTestSuite: aTestSuite

	(ProgessiveTestRunner for: aTestSuite) value
	
	! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HAW 2/5/2017 10:49:25' prior: 50336142!
                              testSuiteForCategoryOf: aClass

	^TestSuite forSystemCategoryNamed: aClass category using: SystemOrganization 
! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HAW 2/5/2017 10:48:27' prior: 50336159!
                          testSuiteOf: aClass

	^TestSuite forClass: aClass
! !
!SmalltalkEditor class methodsFor: 'keyboard shortcut tables' stamp: 'HAW 2/10/2017 15:58:27' prior: 50336386!
                           cmdShortcutsSpec
	"
	Editor initialize
	"
	"arranged in QWERTY keyboard order"
	^#(
		#(		$r	#acceptAndDebugTest:		'Saves method and debugs it')
		#(		$t	#acceptAndTest:				'Saves method, runs it as test and then all tests in class. Opens debugger if error')
		#(		$y	#acceptAndTestAll:				'Saves method, runs it as test and then all tests in class category. Opens debugger if error')
		#(		$i	#inspectIt:							'Inspect it (selection is a valid expression, or selection is over an inspect-ilst)')
		#(		$p	#printIt:								'Print it (selection is a valid expression)')

		#(		$s	#save:								'Save (i.e. accept)')
		#(		$d	#doIt:								'Do it (selection is a valid expression)')
		#(		$l	#cancelEdits:						'Cancel')

		#(		$b	#browseIt:							'Browse it (selection is a class name or cursor is over a class-list or message-list)')
		#(		$n	#sendersOfIt:						'Senders of it (selection is a message selector or cursor is over a class-list or message-list)')
		#(		$m	#implementorsOfIt:				'Implementors of it (selection is a message selector or cursor is over a class-list or message-list)')

		#(		$E	#methodStringsContainingit:'Method strings containing it')
		#(		$T	#displayIfTrue:					'Insert #ifTrue:')
		#(		$I	#exploreIt:							'Inspect via Object Explorer')

		#(		$A	#argAdvance:						'Advance argument')
		#(		$D	#debugIt:							'Debut it')
		#(		$F	#displayIfFalse:					'Insert #ifFalse:')
		#(		$G	#fileItIn:							'File in selection')

		#(		$V	#pasteInitials:					'Paste author initials')
		#(		$N	#referencesToIt:					'References to it (selection is a class name, or cursor is over a class-list or message-list)')
	)! !
!SmalltalkEditor class methodsFor: 'keyboard shortcut tables' stamp: 'HAW 2/10/2017 15:57:40' prior: 50336440!
          initializeMenu
	"Initialize the mouseButton2 (right button) pop-up menu and corresponding messages."
	"
	Editor initialize
	"

	menu _ SelectionMenu fromArray: {
		{'Help...'.										#openHelp}.
		#-.
		{'Do it (d)'.									#doIt}.
		{'Print it (p)'.									#printIt}.
		{'Inspect it (i)'.								#inspectIt}.
		{'Explore it (I)'.								#exploreIt}.
		{'Debug it (D)'.								#debugIt}.
		{'Profile it'.									#profileIt}.
		#-.
		{'Explain'.										#explain}.
		{'Browse it (b)'.								#browseIt}.
		{'Senders of it (n)'.							#sendersOfIt}.
		{'Implementors of it (m)'.					#implementorsOfIt}.
		{'References to it (N)'.						#referencesToIt}.
		#-.
		{'Method Strings with it (E)'.				#methodStringsContainingit}.
		{'Method Source with it'.					#methodSourceContainingIt}.
		{'Class Comments with it'.					#classCommentsContainingIt}.
		#-.
		{'Accept (s)'.									#acceptContents}.
		{'Cancel (l)'.									#cancelEdits}.
		{'Accept & Run Test in Class (t)'.			#acceptAndTest}.
		{'Accept & Run Test in Category (y)'.		#acceptAndTestAll}.
		{'Accept & Debug Test (r)'.					#acceptAndDebugTest}.
		#-.
		{'More...'.										#getMenu2}.
	}.
	menu2 _ SelectionMenu fromArray: {
		{'Find...(f)'.									#find}.
		{'Find Again (g)'.								#findAgain}.
		{'Use Selection for Find (j)'.				#setSearchString}.
		#-.
		{'Undo - multiple (z)'.						#undo}.
		{'Redo - multiple (Z)'.						#redo}.
		{'Undo / Redo history'.						#offerUndoHistory}.
		#-.
		{'Copy (c)'.									#copySelection}.
		{'Cut (x)'.										#cut}.
		{'Paste (v)'.									#paste}.
		{'Paste without Format'.						#pasteString}.
		{'Paste...'.									#pasteRecent}.
		#-.
		{'Toggle WordWrap'.						#wrapOnOff}.
		{'Set Font... (k)'.								#offerFontMenu}.
		{'Clear Font'.									#clearFont}.
		{'Set Default Font...'.						#offerDefaultFontMenu}.
		#-.
		{'More...'.										#getMenu}.
	}! !
!CodeWindow methodsFor: 'keyboard shortcuts' stamp: 'HAW 1/31/2017 11:56:31' prior: 16813767!
        classListKey: aChar from: view 
	"Respond to a Command key.  I am a model with a list of classes and a 
	code pane, and I also have a listView that has a list of methods.  The 
	view knows how to get the list and selection."

	aChar == $r ifTrue: [^ model recent].
	aChar == $h ifTrue: [^ self browseHierarchy].
	aChar == $x ifTrue: [^ model removeClass].
	aChar == $t ifTrue: [^ model runClassTests ].
	
	^ self messageListKey: aChar from: view! !
!CodeWindow methodsFor: 'keyboard shortcuts' stamp: 'HAW 2/10/2017 17:33:25' prior: 16813782!
 messageListKey: aChar from: view
	"Respond to a Command key.  I am a model with a code pane, and I also
	have a listView that has a list of methods.  The view knows how to get
	the list and selection."

	| sel class |
	aChar == $D ifTrue: [^ model toggleDiffing].

	sel _ model selectedMessageName.
	aChar == $m ifTrue: [  "These next two put up a type in if no message selected"
		^ self useSelector: sel orGetSelectorAndSendQuery: #browseAllImplementorsOf: to: Smalltalk].
	aChar == $n ifTrue: [
		^ self useSelector: sel orGetSelectorAndSendQuery: #browseAllCallsOn: to: Smalltalk].

	"The following require a class selection"
	(class _ model selectedClassOrMetaClass) ifNil: [^ self ].
	aChar == $b ifTrue: [^ BrowserWindow fullOnClass: class selector: sel].
	aChar == $N ifTrue: [^ self browseClassRefs].
	aChar == $i ifTrue: [^ self methodHierarchy].
	aChar == $h ifTrue: [^ self browseHierarchy].
	aChar == $p ifTrue: [^ self browseFullProtocol].

	"The following require a method selection"
	sel ifNotNil: [
		aChar == $o ifTrue: [^ model fileOutMessage].
		aChar == $c ifTrue: [^ model copySelector].
		aChar == $v ifTrue: [^ self browseVersions].
		aChar == $O ifTrue: [^ self openSingleMessageBrowser].
		aChar == $x ifTrue: [^ model removeMessage].
		aChar == $t ifTrue: [^ model runMethodTest].
		aChar == $r ifTrue: [^ model debugMethodTest]]! !
!CodeWindow methodsFor: 'keyboard shortcuts' stamp: 'HAW 2/7/2017 10:49:07' prior: 16813824!
                   systemCatListKey: aChar from: view
	"Respond to a Command key.  I am a model with a code pane, and I also have a listView that has a list of methods.  The view knows how to get the list and selection."

	aChar == $f ifTrue: [^ self findClass].
	aChar == $x ifTrue: [^ model removeSystemCategory].
	aChar == $t ifTrue: [ ^model runSystemCategoryTests ].
	
	^ self classListKey: aChar from: view! !
!BrowserWindow methodsFor: 'menu building' stamp: 'HAW 1/31/2017 11:32:21' prior: 16793212!
                       classListMenu
	"Set up the menu to apply to the receiver's class list, honoring the #shifted boolean"

	| aMenu |
	aMenu _ MenuMorph new defaultTarget: self.
	aMenu addList: #(
		('browse full (b)'			browseMethodFull)
		('browse hierarchy (h)'		browseHierarchy)
		('browse protocol (p)'		browseFullProtocol)
		-
		('fileOut'					fileOutClass				''		model)
		-
		('show hierarchy'			hierarchy					''		model)
		('show definition'			editClass					''		model)
		('show comment'			editComment			''		model)
		-
		('inst var refs...'				browseInstVarRefs)
		('inst var defs...'			browseInstVarDefs)
		-
		('class var refs...'			browseClassVarRefs)
		('class vars'					browseClassVariables)
		('class refs (N)'				browseClassRefs)
		-
		('rename class ...'			renameClass				''		model)
		('copy class...'				copyClass				''		model)
		('remove class (x)'			removeClass				''		model)
		-
		('Run tests (t)'		runClassTests 	''	model)
		('more...'					offerShiftedClassListMenu)).
	^ aMenu! !
!BrowserWindow methodsFor: 'menu building' stamp: 'HAW 1/31/2017 19:57:02' prior: 16793244!
                 messageCategoryMenu

	| aMenu |
	aMenu _ MenuMorph new defaultTarget: model.			"All the options are for the model."
	aMenu addList: #(
		('fileOut'							fileOutMessageCategories)
		-
		('reorganize'						editMessageCategories)
		('alphabetize'						alphabetizeMessageCategories)
		('remove empty categories'		removeEmptyCategories)
		('categorize all uncategorized'		categorizeAllUncategorizedMethods)
		('new category...'					addCategory)
		-
		('rename...'							renameCategory)
		('remove'							removeMessageCategory)
		-
		('Run tests'	runMessageCategoryTests)).
	^aMenu! !
!BrowserWindow methodsFor: 'menu building' stamp: 'HAW 2/10/2017 17:29:43' prior: 16793264!
messageListMenu
	"Answer the message-list menu"
	"Changed by emm to include menu-item for breakpoints"

	| aMenu |
	aMenu _ MenuMorph new defaultTarget: self.
	aMenu addList:#(
			('what to show...'				offerWhatToShowMenu)
                	('toggle break on entry'		toggleBreakOnEntry					''		model)
            	-
			('browse full (b)' 				browseMethodFull)
			('browse hierarchy (h)'			browseHierarchy)
			('browse method (O)'			openSingleMessageBrowser)
			('browse protocol (p)'			browseFullProtocol)
			-
			('fileOut'						fileOutMessage							''		model)
			-
			('senders of... (n)'				browseSendersOfMessages)
			('implementors of... (m)'			browseMessages)
			('inheritance (i)'					methodHierarchy)
			('versions (v)'					browseVersions)
			-
			('inst var refs...'					browseInstVarRefs)
			('inst var defs...'				browseInstVarDefs)
			('class var refs...'				browseClassVarRefs)
			('class variables'				browseClassVariables)
			('class refs (N)'					browseClassRefs)
			-
			('remove method (x)'			removeMessage							''		model)
			('Run test (t)'		runMethodTest 	'' 	model)
			('Debug test (r)'		debugMethodTest 	'' 	model)
			-
			('more...'						openShiftedMessageListMenu)).
	^ aMenu
! !
!BrowserWindow methodsFor: 'menu building' stamp: 'HAW 1/31/2017 11:52:17' prior: 16793404!
                systemCategoryMenu

	| aMenu |
	aMenu _ MenuMorph new defaultTarget: self.
	self flag: #renameSystemCategory.	"temporarily disabled"
	aMenu addList: #(
		('find class... (f)'				findClass)
		('recent classes... (r)'		recent									''		model)
		-
		('browse all'				browseAllClasses)
		('browse'					openSystemCategoryBrowser)
		-
		('fileOut'					fileOutSystemCategory				''		model)
		-
		('reorganize'				editSystemCategories					''		model)
		('alphabetize'				alphabetizeSystemCategories		''		model)
		-
		('update'					updateSystemCategories				''		model)
		('add item...'				addSystemCategory					''		model)
"		('rename...'					renameSystemCategory				''		model)"
		('remove'					removeSystemCategory				''		model)
		-
		('move to top'				moveSystemCategoryTop				''		model)
		('move up'					moveSystemCategoryUp				''		model)
		('move down'				moveSystemCategoryDown			''		model)
		('move to bottom' 			moveSystemCategoryBottom			''		model)
		-
		('Run tests (t)'				runSystemCategoryTests  	''	model)).
	^aMenu! !
!Theme methodsFor: 'menus' stamp: 'HAW 2/10/2017 17:30:49' prior: 50336846!
                       miscellaneousIcons

	"Everything else."

	^ {
		#('restore display (r)' 'set display depth...' 'move windows onscreen' 'Utilities saveDisplay.') -> #displayIcon.
		#('changes...' 'dual change sorter' 'change sets with this method' 'find a change sorter' 'recent changes in file' 'Undo / Redo history' 'code file contents' 'package file contents') -> #changesIcon.
		#('Install New Updates' 'update' 'turn on auto-update (a)' 'update list (u)' 'install code' 'fileIn entire file' 'install package') -> #updateIcon.
		#('find again (g)' 'full stack (k)') -> #systemIcon.
		#('print it (p)' 'check change set for slips') -> #printIcon.
		#('accept (s)' 'make changes go to me (m)') -> #acceptIcon.
		#('cancel (l)' 'turn off auto-update (a)') -> #cancelIcon.
		#('debug...' 'Debug it (D)' 'toggle break on entry') -> #debugIcon.
		#('close' 'close all debuggers' 'close top window') -> #closeIcon.
		#('collapse' 'hide taskbar' 'collapse all windows') -> #collapseIcon.
		#('expand / contract' 'show taskbar' 'restore all windows') -> #expandIcon.
		#('menu') -> #windowMenuIcon.
		#('browse all' 'browser' 'browse it (b)' 'MessageTally UI and browse' 'browse recent submissions' 'browse full (b)' 'find changed browsers...' 'browse (b)' 'browse my changes') -> #editFindReplaceIcon.
		#('workspace' 'workspace with contents') -> #terminalIcon.
		#('styled text editor' 'text editor'  'basic text editor'  'unicode editor' 'edit this list' 'edit postscript...' 'add postscript...') -> #textEditorIcon.
		#('file list' 'find a fileList' 'compress file') -> #systemFileManagerIcon.
		#('transcript' 'find a transcript' 'Transcript clear.' 'log to transcript') -> #printerIcon.
		#('process browser' 'vm statistics' 'MessageTally all Processes') -> #systemMonitorIcon.
		#('emergency evaluator' 'conflicts with other change sets' 'check for slips' 'conflicts with change set opposite' 'conflicts with category opposite') -> #emblemImportantIcon.
		#('change sorter') -> #halfRefreshIcon.
		#('SUnit Test Runner' 'Accept & Run Test in Class (t)' 'Accept & Run Test in Category (y)' 'Run tests (t)' 'Run tests' 'Run test (t)' 'Accept & Debug Test (r)' 'Debug test (r)') -> #weatherFewCloudsIcon.
		#('Font Sizes...' 'system fonts...' 'set font... (k)') -> #preferencesDesktopFontIcon.
		#('full screen on') -> #viewFullscreenIcon.
		#('full screen off') -> #exitFullscreenIcon.
		#('set desktop color...') -> #wallpaperIcon.
		#('preferences...' 'All preferences...' 'what to show...' 'view as hex') -> #preferencesIcon.
		#('Editor keyboard shortcuts') -> #keyboardShortcutsIcon.
		#('world menu help') -> #globeIcon.		"currently unused, but a neat icon"
		#('useful expressions' 'class comments with it' 'check for uncommented methods' 'check for uncommented classes') -> #chatIcon.
		#('set code author...' 'check for other authors' 'check for any other authors') -> #usersIcon.
		#('space left') -> #removableMediaIcon.
		#('start drawing all again' 'window color...') -> #graphicsIcon.
		#('start stepping again') -> #mediaPlaybackStartIcon.
		#('file out current change set' 'fileOut' 'File out and remove (o)' 'File out and keep (k)') -> #fileOutIcon.
		#('recently logged changes...' 'versions (v)' 'recent classes... (r)' 'trim history' 'Profile it') -> #clockIcon.
		#('senders of it (n)' 'senders of... (n)' 'local senders of...' 'senders (n)') -> #mailForwardIcon.
		#('implementors of it (m)' 'implementors of... (m)' 'implementors of sent messages') -> #developmentIcon.
		#('references to it (N)') -> #addressBookIcon.
		#('class var refs...' 'class refs (N)' 'class variables' 'class vars' 'local implementors of...' 'subclass template') -> #classIcon.
		#('inst var refs...' 'inst var defs...' 'sample instance') -> #instanceIcon.
		#('Use Selection for Find (j)' 'rename class ...' 'rename...' 'change title...') -> #saveAsIcon.
		#('smalltalk options' 'method source with it' 'browse method (O)' 'check for uncategorized methods') -> #scriptIcon.
		#('method strings with it (E)' 'Toggle WordWrap') -> #genericTextIcon.
		#('browse hierarchy (h)' 'move to top' 'promote to top of list') -> #goTopIcon.
		#('move up' 'make next-to-topmost') -> #goUpIcon.
		#('move to bottom' 'send to back' 'send top window to back') -> #goBottomIcon.
		#('inheritance (i)' 'move down') -> #goDownIcon.
		#('browse protocol (p)' 'spawn sub-protocol') -> #spreadsheetIcon.
		#('spawn full protocol') -> #speadsheetTemplateIcon.
		#('alphabetize') -> #fontXGenericIcon.
		#('Installed Packages' 'browse' 'show category (C)' 'categorize all uncategorized' 'select change set...' 'view affected class categories') -> #packageIcon.
		#('remove from current change set' 'remove empty categories' 'subtract other side (-)' 'remove from this browser') -> #listRemoveIcon.
		#('add to current change set' 'add all meths to current chgs' 'add preamble (p)' 'More...') -> #listAddIcon.
		#('toggle diffing (D)' 'toggle selections') -> #switchIcon.
		#('reorganize' 'create inst var accessors' 'ChangeSorter reorderChangeSets.' 'reorder all change sets' 'by name' 'by size' 'by date') -> #sendReceiveIcon.
		#('unsent methods' 'unreferenced class vars' 'unreferenced inst vars' 'Undeclared inspect.' 'Undeclared removeUnreferencedKeys; inspect.' 'ChangeSorter removeEmptyUnnamedChangeSets.' 'check for unsent messages') -> #junkIcon.
		#('find changed windows...') -> #newWindowIcon.
		#('make undraggable') -> #pushPinIcon.
		#('Utilities saveScreenshot.') -> #stillCameraIcon.
		#('add new directory') -> #newFolderIcon.
		#('select all' 'deselect all') -> #selectAllIcon.
		#('sort by date') -> #dateIcon.
		#('justified') -> #formatJustifyFillIcon.
		#('centered') -> #formatJustifyCenterIcon.
		#('set alignment...' 'leftFlush') -> #formatJustifyLeftIcon.
		#('rightFlush') -> #formatJustifyRightIcon.
		#('signal Semaphore (S)') -> #haloHelpIcon.
		#('Change Paragraph Style...' 'Change Character Style...' 'Remove Character Style' 'Replace all uses of Paragraph Style...' 'Replace all uses of Character Style...' 'Set Default Font...') -> #fontXGenericIcon.
		#('Clear Font') -> #newIcon.
		#('code file browser' 'package file browser') -> #findIcon.
	}! !
!TestCase methodsFor: 'Accessing' stamp: 'HAW 2/10/2017 17:37:41'!
                           should: aBlock raise: anExceptionalType withExceptionDo: assertionsBlock

	^self assert: (self executeShould: aBlock inScopeOf: anExceptionalType withExceptionDo: assertionsBlock)
			! !
!TestCase methodsFor: 'Private' stamp: 'HAW 2/10/2017 17:38:10'!
    executeShould: aBlock inScopeOf: anExceptionType withExceptionDo: assertionsBlock

	^[aBlock value.
 	false] 
		on: anExceptionType
		do: [:exception | 
			assertionsBlock value: exception.
			exception sunitExitWith: true]! !
!TestCase class methodsFor: 'Testing' stamp: 'HAW 2/10/2017 16:32:10' prior: 50336192!
      is: aSymbol

	^self ~= TestCase 
		and: [ aSymbol == #TestCaseClass or: [ super is: aSymbol ]]! !
!TestCase class methodsFor: 'Testing' stamp: 'HAW 2/1/2017 19:35:57' prior: 16927731!
        shouldInheritSelectors
	"I should inherit from an Abstract superclass but not from a concrete one by default, unless I have no testSelectors in which case I must be expecting to inherit them from my superclass.  If a test case with selectors wants to inherit selectors from a concrete superclass, override this to true in that subclass."

	^self ~= TestCase 
		and: [ self superclass isAbstract or: [self testSelectors isEmpty]]

"$QA Ignore:Sends system method(superclass)$"
			! !
!TestResultForDebuggingAndInspection methodsFor: 'printing' stamp: 'HAW 2/7/2017 10:51:56' prior: 50336209!
                 print: aCollectionOfTestCases startingWith: header on: aStream
	
	aCollectionOfTestCases do: [ :aTestCase |
		aStream 
			nextPutAll: header;
			space;
			nextPutAll: aTestCase class name;
			nextPutAll: ' debug: #';
			nextPutAll: aTestCase selector;
			newLine ]
		
		
	! !

TestSuite class removeSelector: #allTestCasesReferencing:!

TestSuite class removeSelector: #allTestReferencesTo:!

TestSuite class removeSelector: #allTestsReferencing:!

TestSuite class removeSelector: #from:using:!

TestSuite class removeSelector: #fromClass:!

TestSuite class removeSelector: #fromSystemCategoryNamed:using:!

ProgessiveTestRunner removeSelector: #initializeFor:informingResultUsing:!

ProgessiveTestRunner removeSelector: #initializeFor:showingTestPassedWith:!

ProgessiveTestRunner removeSelector: #showProgressBarAndRunSuite!

SmalltalkEditor removeSelector: #acceptAndWithTestMethodDo:!

SmalltalkEditor removeSelector: #flashWith:!

SmalltalkEditor removeSelector: #flashWith:!

SmalltalkEditor removeSelector: #flashWithGreen!

SmalltalkEditor removeSelector: #flashWithGreen!

Categorizer removeSelector: #testCasesAt:!

Class removeSelector: #withTestCaseClassDo:ifNone:!

Behavior removeSelector: #withTestClassDo:ifNone:!

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3046-TestRunningHelpers-HernanWilkinson-2017Jan31-09h21m-HAW.5.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3046] on 1 March 2017 at 12:34:07 pm'!
!CodeFile methodsFor: 'change record types' stamp: 'jmv 3/1/2017 12:31:23' prior: 16808869!
          doIt: chgRec
	"See senders of #doIt "
	| string |
	string := chgRec string.
	
	"Method classification spec"
	(string beginsWith: '(''') ifTrue: [
		^ doIts add: chgRec ].
		
	"Just for compatibility with Squeak, as Cuis always adds the #classDefinition change type marker in the files."
	('*ubclass:*instanceVariableNames:*classVariableNames:*poolDictionaries:*category:*'
		match: string) ifTrue:[^self classDefinition: string with: chgRec].

	"Just for compatibility with Squeak, as Cuis always adds the #classDefinition change type marker in the files."
	('* class*instanceVariableNames:*'
		match: string) ifTrue:[^self metaClassDefinition: string with: chgRec].

	"Just for compatibility with Squeak, as Cuis always adds the #methodRemoval: (or similar) change type marker in the files."
	('* removeSelector: *'
		match: string) ifTrue:[^self removedMethod: string with: chgRec].

	"Just for compatibility with Squeak, as Cuis always adds the #classComment change type marker in the files."
	('* comment:*'
		match: string) ifTrue:[^self msgClassComment: string with: chgRec].

	"Don't add these to a CodeFile. They will be added on save if needed."
	('* initialize'
		match: string) ifTrue:[^self]. "Initialization is done based on class>>initialize"

	('''From *'
		match: string) ifTrue:[^self possibleSystemSource: chgRec].
	doIts add: chgRec.! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3047-FileCodeBrowserFix-JuanVuletich-2017Mar01-12h33m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3047] on 2 March 2017 at 10:50:58 am'!

BorderedRectMorph subclass: #MenuMorph
	instanceVariableNames: 'defaultTarget selectedItem stayUp popUpOwner activeSubMenu titleMorph oldKeyboardFocus '
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Menus'!

!classDefinition: #MenuMorph category: #'Morphic-Menus'!
BorderedRectMorph subclass: #MenuMorph
	instanceVariableNames: 'defaultTarget selectedItem stayUp popUpOwner activeSubMenu titleMorph oldKeyboardFocus'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Menus'!
!MenuMorph commentStamp: '<historical>' prior: 16866262!
                  Instance variables:
	defaultTarget 		<Object>					The default target for creating menu items
	selectedItem			<MenuItemMorph> 		The currently selected item in the receiver
	stayUp 				<Boolean>				True if the receiver should stay up after clicks!
!MenuMorph methodsFor: 'control' stamp: 'jmv 3/2/2017 10:47:30' prior: 16866663!
                         deleteIfPopUp: evt
	"Remove this menu from the screen if stayUp is not true."

	stayUp ifFalse: [ self delete ].
	evt ifNotNil: [ evt hand ifNotNil: [ :h | h releaseMouseFocus: self ]]! !
!MenuMorph methodsFor: 'control' stamp: 'jmv 3/2/2017 10:48:01' prior: 16866680!
                   popUpAdjacentTo: rightOrLeftPointInWorld from: sourceItem
	"Present this menu at the given point under control of the given hand.
	Used mostly for submenus."

	| delta tryToPlace selectedOffset |
	selectedOffset _ (selectedItem ifNil: [ self items first ]) morphPosition.
	sourceItem world addMorphFront: self.

	tryToPlace _ [ :where :mustFit |
		self morphPosition: where - selectedOffset.
		delta _ self morphFullBoundsInWorld
			amountToTranslateWithin: sourceItem world morphBoundsInWorld.
		(delta x = 0 | mustFit) ifTrue: [
			delta = (0@0) ifFalse: [ self morphPosition: self morphPosition + delta ].
			^ self]].
	tryToPlace 
		value: rightOrLeftPointInWorld first value: false;
		value: rightOrLeftPointInWorld last - (extent x @ 0) value: false;
		value: rightOrLeftPointInWorld first value: true! !
!MenuMorph methodsFor: 'control' stamp: 'jmv 3/2/2017 10:48:31' prior: 16866709!
    popUpAt: aPoint forHand: hand allowKeyboard: aBoolean 
	"Present this menu at the given point under control of the given hand."

	| evt |
	self items isEmpty ifTrue: [^self].
	Theme current decorateMenu: self.
	(self submorphs select: [ :m | m is: #UpdatingMenuItemMorph ]) 
		do: [ :m | m updateContents].
	self runningWorld addMorphFront: self position: aPoint - (2 @ 8).
	self fitInWorld.
	"Acquire focus for valid pop up behavior"
	hand newMouseFocus: self.
	aBoolean ifTrue: [ hand newKeyboardFocus: self ].
	evt _ hand lastMouseEvent.
	(evt isKeyboard or: [ evt isMouse and: [ evt anyButtonPressed not ]]) 
		ifTrue: [
			"Select first item if button not down"
			self moveSelectionDown: 1 event: evt ]! !
!MenuMorph methodsFor: 'control' stamp: 'jmv 3/2/2017 10:48:26' prior: 16866745!
       popUpAt: aPoint forHand: hand in: aWorld allowKeyboard: aBoolean 
	"Present this menu at the given point under control of the given hand."

	self items isEmpty ifTrue: [ ^self ].
	Theme current decorateMenu: self.
	(self submorphs select: [ :m | m is: #UpdatingMenuItemMorph]) 
		do: [ :m | m updateContents].
	aWorld addMorphFront: self position: aPoint - (2 @ 8).
	self fitInWorld.
	"Acquire focus for valid pop up behavior"
	hand newMouseFocus: self.
	aBoolean ifTrue: [ hand newKeyboardFocus: self ]! !
!MenuMorph methodsFor: 'events' stamp: 'jmv 3/2/2017 10:47:45' prior: 16866819!
                     keyStroke: aKeyboardEvent 
	| matchString char asc selectable |
	char := aKeyboardEvent keyCharacter.
	asc := char numericValue.
	aKeyboardEvent isReturnKey
		ifTrue: [
			selectedItem ifNotNil: [
					selectedItem hasSubMenu 
						ifTrue: [
							aKeyboardEvent hand newMouseFocus: selectedItem subMenu.
							^aKeyboardEvent hand newKeyboardFocus: selectedItem subMenu]
						ifFalse: [
							"self delete."
							^selectedItem invokeWithEvent: aKeyboardEvent]].
			(selectable := self items) size = 1 
				ifTrue: [^selectable first invokeWithEvent: aKeyboardEvent].
			^self].
	asc = 27 
		ifTrue: [
			"escape key"
			self
				valueOfProperty: #matchString
				ifPresentDo: [ :str | 
					str isEmpty 
						ifFalse: [
							"If filtered, first ESC removes filter"
							self setProperty: #matchString toValue: String new.
							self selectItem: nil.
							^self displayFiltered: aKeyboardEvent]].
			"If a stand-alone menu, just delete it"
			^self delete].
	(asc = 28 or: [asc = 29]) 
		ifTrue: [
			"left or right arrow key"
			(selectedItem notNil and: [selectedItem hasSubMenu]) 
				ifTrue: [
					aKeyboardEvent hand newMouseFocus: selectedItem subMenu.
					selectedItem subMenu moveSelectionDown: 1 event: aKeyboardEvent.
					^aKeyboardEvent hand newKeyboardFocus: selectedItem subMenu]].
	asc = 30 ifTrue: [^self moveSelectionDown: -1 event: aKeyboardEvent].	"up arrow key"
	asc = 31 ifTrue: [^self moveSelectionDown: 1 event: aKeyboardEvent].	"down arrow key"
	asc = 11 ifTrue: [^self moveSelectionDown: -5 event: aKeyboardEvent].	"page up key"
	asc = 12 ifTrue: [^self moveSelectionDown: 5 event: aKeyboardEvent].	"page down key"
	matchString := self valueOfProperty: #matchString ifAbsent: [String new].
	matchString := char = Character backspace 
				ifTrue: [
					matchString isEmpty ifTrue: [matchString] ifFalse: [matchString allButLast]]
				ifFalse: [matchString copyWith: aKeyboardEvent keyCharacter].
	self setProperty: #matchString toValue: matchString.
	self displayFiltered: aKeyboardEvent! !
!MenuMorph methodsFor: 'events-processing' stamp: 'jmv 3/2/2017 10:47:57' prior: 16866952!
                    handleFocusEvent: aMorphicEvent
	"Handle focus events. Valid menu transitions are determined based on the menu currently holding the focus after the mouse went down on one of its children."
	| eventPositionInOurCoordinates |
	eventPositionInOurCoordinates _ self internalizeFromWorld: aMorphicEvent eventPosition.

	self dispatchEvent: aMorphicEvent localPosition: eventPositionInOurCoordinates.

	"Need to handle keyboard input if we have the focus."
	aMorphicEvent isKeyboard ifTrue: [ ^ aMorphicEvent sentTo: self localPosition: eventPositionInOurCoordinates].

	"We need to handle button clicks outside and transitions to local popUps so throw away everything else"
	(aMorphicEvent isMouseOver or: [aMorphicEvent isMouse not]) ifTrue: [ ^self ].
	"What remains are mouse buttons and moves"
	aMorphicEvent isMove ifFalse: [ ^ aMorphicEvent sentTo: self localPosition: eventPositionInOurCoordinates ]. "handle clicks outside by regular means"
	"Now it's getting tricky. On #mouseMove we might transfer control to *either* the currently active submenu or the pop up owner, if any. Since the active sub menu is always displayed upfront check it first."
	selectedItem ifNotNil:[(selectedItem activateSubmenu: aMorphicEvent) ifTrue: [^self]]! !
!MenuMorph methodsFor: 'initialization' stamp: 'jmv 3/2/2017 10:47:34' prior: 16867015!
             initialize
	super initialize.
	extent _ 40@10.
	defaultTarget _ nil.
	selectedItem _ nil.
	stayUp _ false! !
!MenuItemMorph methodsFor: 'events' stamp: 'jmv 3/2/2017 10:45:33' prior: 16866023!
                               mouseEnter: evt
	"The mouse entered the receiver"
	owner ifNil: [ ^self ].
	owner selectItem: self! !
!MenuItemMorph methodsFor: 'selecting' stamp: 'jmv 3/2/2017 10:36:12' prior: 16866139!
   deselect

	self isSelected: false.
	subMenu ifNotNil: [
		self removeAlarm: #deselectTimeOut ]! !
!MenuItemMorph methodsFor: 'selecting' stamp: 'jmv 3/2/2017 10:36:17' prior: 16866151!
       select
	self isSelected: true.
	subMenu ifNotNil: [
		subMenu delete.
		subMenu
			popUpAdjacentTo: (Array with: self morphBoundsInWorld topRight + (10@0)
									with: self morphBoundsInWorld topLeft)
			from: self.
		subMenu selectItem: nil ]! !

MenuItemMorph removeSelector: #activateOwnerMenu:!

MenuItemMorph removeSelector: #activateOwnerMenu:!

MenuMorph removeSelector: #activeSubmenu:!

MenuMorph removeSelector: #activeSubmenu:!

MenuMorph removeSelector: #delete!

MenuMorph removeSelector: #delete!

MenuMorph removeSelector: #popUpOwner!

MenuMorph removeSelector: #popUpOwner!

BorderedRectMorph subclass: #MenuMorph
	instanceVariableNames: 'defaultTarget selectedItem stayUp titleMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Menus'!

!classDefinition: #MenuMorph category: #'Morphic-Menus'!
BorderedRectMorph subclass: #MenuMorph
	instanceVariableNames: 'defaultTarget selectedItem stayUp titleMorph'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Menus'!

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3048-MenuSimplification-JuanVuletich-2017Mar02-10h45m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3048] on 2 March 2017 at 4:11:32 pm'!
!Transcripter class methodsFor: 'instance creation' stamp: 'dhn 2/6/2017 13:38:40' prior: 16938922!
                        newInFrame: frame
"
(Transcripter newInFrame: (0@0 extent: 100@200))
	nextPutAll: 'Hello there'; endEntry;
	newLine; print: 355.0/113; endEntry;
	readEvalPrint.
"
	| transcript |
	transcript _ self on: (String new: 100).
	transcript initInFrame: frame.
	^ transcript clear! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3049-TranscripterCommentFix-DanNorton-2017Mar02-16h10m-dhn.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3049] on 3 March 2017 at 9:17:59 am'!
!WorldState methodsFor: 'stepping' stamp: 'jmv 3/2/2017 19:35:58'!
cleanseStepList
	"Remove morphs from the step list that are not in this World.  Often were in a flap that has moved on to another world."

	| deletions morphToStep |
	deletions _ nil.
	stepList do: [:entry |
		morphToStep _ entry receiver.
		morphToStep world == world ifFalse:[
			deletions ifNil: [deletions _ OrderedCollection new].
			deletions addLast: entry]].

	deletions ifNotNil:[
		deletions do: [:entry|
			self stopSteppingMorph: entry receiver]].

	self alarms copy do:[:entry|
		morphToStep _ entry receiver.
		((morphToStep is: #Morph) and: [ morphToStep world == world ]) 
			ifFalse: [ self removeAlarm: entry selector for: entry receiver ]].! !
!WorldState methodsFor: 'stepping' stamp: 'jmv 3/2/2017 19:42:28'!
      runStepMethods
	"Perform periodic activity inbetween event cycles"
	| queue msg |

	queue _ self class deferredUIMessages.
	[ (msg _ queue nextOrNil) isNil ] whileFalse: [
		msg value
	].
	self runLocalStepMethods.

	"we are using a normal #step for these now"
	"aWorld allLowerWorldsDo: [ :each | each runLocalStepMethods ]."
! !
!WorldState methodsFor: 'update cycle' stamp: 'jmv 3/2/2017 19:34:41'!
              displayWorldSafely
	"Update this world's display and keep track of errors during draw methods."

	[world displayWorld] ifError: [:err :rcvr |
		"Handle a drawing error"
		| errCtx errMorph |
		errCtx _ thisContext.
		[
			errCtx _ errCtx sender.
			"Search the sender chain to find the morph causing the problem"
			[errCtx notNil and: [ (errCtx receiver is: #Morph) not ]] 
				whileTrue:[errCtx _ errCtx sender].
			"If we're at the root of the context chain then we have a fatal drawing problem"
			errCtx ifNil:[^self handleFatalDrawingError: err].
			errMorph _ errCtx receiver.
			"If the morph causing the problem has already the #drawError flag set,
			then search for the next morph above in the caller chain."
			errMorph isKnownFailing
		] whileTrue.
		errMorph drawingFails.
		self clearCanvas.
		"Install the old error handler, so we can re-raise the error"
		rcvr error: err.
	]! !
!WorldState methodsFor: 'update cycle' stamp: 'jmv 3/2/2017 19:34:09'!
                         doOneCycle
	"Do one cycle of the interaction loop. This method is called repeatedly when the world is running.
	
	Make for low cpu usage if the ui is inactive, but quick response when ui is in use.
	However, after some inactivity, there will be a larger delay before the ui gets responsive again."

	| wait waitUntil |
	waitDelay ifNil: [ waitDelay _ Delay forMilliseconds: 50 ].
	lastCycleHadAnyEvent
		ifTrue: [
			pause _ 20.				"This value will only be used when there are no more events to serve."
			wait _ 0 ]					"Don't wait"
		ifFalse: [
			pause < 200				"No events processed? Start saving CPU!! But never make the user wait more than 200ms for being responsive again."
				ifTrue: [ pause _ pause * 21//20 ].
			waitUntil _ lastCycleTime + pause.
			"Earlier if steps"
			stepList isEmpty not ifTrue: [
				waitUntil _ waitUntil min: stepList first scheduledTime ].
			"Earlier if alarms"
			alarms ifNotNil: [
				alarms isEmpty not ifTrue: [
					waitUntil _ waitUntil min: alarms first scheduledTime ]].

			wait _ waitUntil - Time localMillisecondClock ].
	Preferences serverMode
		ifTrue: [ wait _ wait max: 50 ].	"Always wait at least a bit on servers, even if this makes the UI slow."
	wait > 0 ifTrue: [
		waitDelay beingWaitedOn
			ifFalse: [ waitDelay setDelay: wait; wait ]
			ifTrue: [
				"If we are called from a different process than that of the main UI, we might be called in the main
				interCyclePause. In such case, use a new Delay to avoid 'This Delay has already been scheduled' errors"
				(Delay forMilliseconds: wait) wait ]].

	"Record start time of this cycle, and do cycle"
	lastCycleTime _ Time localMillisecondClock.
	lastCycleHadAnyEvent _ self doOneCycleNow! !
!WorldState methodsFor: 'update cycle' stamp: 'jmv 3/2/2017 19:34:47'!
                doOneCycleNow
	"Immediately do one cycle of the interaction loop.
	This should not be called directly, but only via doOneCycleFor:"

	| hadAnyEvent |
	"See #eventTickler"
	Cursor currentCursor = Cursor wait ifTrue: [
		Cursor normal activateCursor ].

	"Repair visual damage."
	DisplayScreen checkForNewScreenSize.
	self displayWorldSafely.

	"Run steps, alarms and deferred UI messages"
	world runStepMethods.

	"Process user input events. Run all event triggered code."
	hadAnyEvent _ false.
	self handsDo: [ :h |
		activeHand _ h.
		hadAnyEvent _ hadAnyEvent | h processEventQueue.
		activeHand _ nil ].

	"The default is the primary hand"
	activeHand _ self hands first.


	^hadAnyEvent! !
!WorldState methodsFor: 'update cycle' stamp: 'jmv 3/2/2017 19:43:12'!
   tryDeferredUpdatingAndSetCanvas
        "If this platform supports deferred updates, then make my canvas be the Display (or a rectangular portion of it), set the Display to deferred update mode, and answer true. Otherwise, set a non-Disply canvas and answer false.."
	| properDisplay |
	
	"As this is the only sender of #deferUpdates: , this could be done in Morphic or image startup, and never efterwards..."
	(Display deferUpdates: true) ifNil: [
		"deferred updates not supported by the VM, do them in the image!!"
		self ensureNonDisplayCanvas.
		^ false].
	
	"if no canvas, or canvas was offscreen, from a platform that didnt support defers, then fix it"
	properDisplay _ canvas notNil and: [canvas drawsOnDisplay].
	properDisplay ifFalse: [
		world morphPosition: 0@0 extent: Display extent.
		self setCanvas: Display getCanvas.
	].
	^ true! !
!WorldState methodsFor: 'drawing' stamp: 'jmv 3/2/2017 19:43:18'!
            displayWorldAndSubmorphs: submorphs
	"Update this world's display."

	| deferredUpdateVMMode worldDamageRects handsToDraw allDamage |
	self checkIfUpdateNeeded ifFalse: [ ^ self ].  "display is already up-to-date"
	"I (jmv) removed the call to 'deferUpdates: false' below. No more need to call this every time."
	deferredUpdateVMMode _ self tryDeferredUpdatingAndSetCanvas.

	"repair world's damage on canvas"
	worldDamageRects _ self drawInvalidAreasSubmorphs: submorphs.

	"Check which hands need to be drawn (they are not the hardware mouse pointer)"
	handsToDraw _ self selectHandsToDrawForDamage: worldDamageRects.
	allDamage _ Array streamContents: [ :strm |
		strm nextPutAll: worldDamageRects.
		handsToDraw do: [ :h | 
			h savePatchFrom: canvas appendDamageTo: strm ]].

	"Draw hands (usually carying morphs) onto world canvas"
	canvas newClipRect: nil.
	handsToDraw reverseDo: [ :h | canvas fullDrawHand: h ].

	"quickly copy altered rects of canvas to Display:"
	deferredUpdateVMMode ifFalse: [
		"Drawing was done to off-Display canvas. Copy content to Display"
		canvas showAt: world viewBox origin invalidRects: allDamage ].

	"Display deferUpdates: false."
	"Display forceDisplayUpdate"
	Display forceDamageToScreen: allDamage.

	"Restore world canvas under hands and their carried morphs"
	handsToDraw do: [ :h | h restoreSavedPatchOn: canvas ].! !
!WorldState methodsFor: 'drawing' stamp: 'jmv 3/2/2017 19:40:12'!
        drawInvalidAreasSubmorphs: submorphs
	"Redraw the damaged areas of the given canvas and clear the damage list. Return a collection of the areas that were redrawn."

	| initialRectsToRepair currentRectsToRepair newRectsToRepair morphsToDraw rectsForEachMorph thisMorphRects reuse i n morph morphBounds morphClipRect |

	"The simple implementation is slowers as it draws morph areas that will later be covered by other morphs.
	But it works, and it is easier to understand.
	See en.wikipedia.org/wiki/Painter's_algorithm"
	true not ifTrue: [ ^self simpleDrawInvalidAreasSubmorphs: submorphs ].

	"The response for #invalidRectsFullBounds: can include nils, that should be ignored."
	initialRectsToRepair _ damageRecorder invalidRectsFullBounds: world viewBox.
	damageRecorder reset.
	currentRectsToRepair _ OrderedCollection new.
	newRectsToRepair _ OrderedCollection withAll: initialRectsToRepair.
	morphsToDraw _ OrderedCollection new.
	rectsForEachMorph _ OrderedCollection new.
	thisMorphRects _ OrderedCollection new.
	n _ submorphs size.
	i _ 1.

	"The idea here is to iterate morphs front to back, i.e. first the ones on top.
	For each morph, record the rectangles it affects. And if a morph is opaque, remove the area behind it from the list of rectangles to be repaired.
	This means, for example, that morphs completely covered might even not be redrawn.
	this is a huge performance gain when there are many morphs on screen, especially if there are more than ten open windows, and Theme uses opaque colors.
	See 'A reverse painter's algorithm' at en.wikipedia.org/wiki/Painter's_algorithm"
	[ i <= n and: [ newRectsToRepair notEmpty ]] whileTrue: [
		morph _ submorphs at: i.
		morph visible ifTrue: [
			morphBounds _ morph morphFullBoundsInWorld.
			reuse _ currentRectsToRepair.
			currentRectsToRepair _ newRectsToRepair.
			newRectsToRepair _ reuse removeAll.
			currentRectsToRepair do: [ :r |
				(morphBounds intersects: r)
					ifTrue: [
						morphClipRect _ morphBounds intersect: r.
						thisMorphRects add: morphClipRect. "We could perhaps try and join adjacent rectangles in this collection..."
						morph addPossiblyUncoveredAreasIn: r to: newRectsToRepair ]
					ifFalse: [
						newRectsToRepair add: r ]].
			thisMorphRects ifNotEmpty: [
				morphsToDraw add: morph.
				rectsForEachMorph add: thisMorphRects.
				thisMorphRects _ OrderedCollection new.
			]].
		i _ i + 1 ].

	"*make this true to flash damaged areas for testing*"
	Preferences debugShowDamage ifTrue: [ world fillRects: initialRectsToRepair color: Color gray ].

	"Draw world background on those areas that were not completely covered by opaque morphs"
	i > n  ifTrue: [
		newRectsToRepair do: [ :r |
			world drawOn: (canvas newClipRect: r) ]].

	"Now, draw the recorded areas of selected morphs, back to front."
	morphsToDraw with: rectsForEachMorph reverseDo: [ :m :xrects |
		"Here we could think about merging all xrects into just one call...
		This would mean drawing each morph just once.
		But that would mean drawing pixels we were not told to. There could be other morphs in that area that are not even being drawn!!
		See WorldState class >> #experiment1"
"		rr _ nil."
		xrects do: [ :r |
"			rr _ rr ifNil: [ r ] ifNotNil: [ r quickMerge: rr ]."
			(canvas newClipRect: r) fullDraw: m.
		].
"		(canvas newClipRect: rr) fullDraw: m"
		"*make this true to flash damaged areas for testing*"
		Preferences debugShowDamage2 ifTrue: [
			world flashRects: xrects color: Color random ].
	].

	"Answer a list of rectangles to be updated on the Display.
	This usually is not performance critical, drawing morphs is slower than just exposing the Display."
	"What should we force on Display? Whatever was asked? Each small rect that was updated? A single bigger rect?
	Right now, answer whatever was asked... Maybe this could be changed if that enhances performance...
	(think of vnc over slow networks)"
	^ initialRectsToRepair! !
!WorldState methodsFor: 'drawing' stamp: 'jmv 3/2/2017 19:39:56'!
    simpleDrawInvalidAreasSubmorphs: submorphs

	"mover todo esto al canvas, no?
	Y ver que hacer con los argumentos, etc.... Toda esta bananarama!!"

	"Redraw the damaged areas of the given canvas and clear the damage list.
	Return a collection of the areas that were redrawn.
	This simple implementation just does as requested: No optimizations are done."

	| rectsToRepair morphBounds |
	"The response for #invalidRectsFullBounds: can include nils, that should be ignored."
	rectsToRepair _ damageRecorder invalidRectsFullBounds: world viewBox.
	damageRecorder reset.

	"Draw World"
	rectsToRepair do: [ :r |
		world drawOn: (canvas newClipRect: r) ].

	"Draw morphs"
	submorphs reverseDo: [ :morph |
		morph visible ifTrue: [
			morphBounds _ morph morphFullBoundsInWorld.
			rectsToRepair do: [ :r |
				(morphBounds intersects: r) ifTrue: [
					(canvas newClipRect: r) fullDraw: morph ]]]].

	^ rectsToRepair! !
!WorldState methodsFor: 'accessing' stamp: 'jmv 3/2/2017 21:47:15'!
         runLocalStepMethods
	"Run morph 'step' methods (LOCAL TO THIS WORLD) whose time has come. Purge any morphs that are no longer in this world."

	| now morphToStep scheduledTime |
	now _ lastCycleTime.
	self triggerAlarmsBefore: now.
	stepList isEmpty 
		ifTrue: [ ^self].
	[ stepList isEmpty not and: [ stepList first scheduledTime <= now ]] 
		whileTrue: [
			lastStepMessage _ stepList removeFirst.
			morphToStep _ lastStepMessage receiver.
			(morphToStep shouldGetStepsFrom: world) 
				ifTrue: [
					scheduledTime _ lastStepMessage scheduledTime.
					lastStepMessage valueAtTime: now - scheduledTime + lastStepMessage stepTime.
					lastStepMessage ifNotNil: [
							lastStepMessage scheduledTime: (scheduledTime + lastStepMessage stepTime max: now + 1).
							stepList add: lastStepMessage ]].
			lastStepMessage _ nil ]! !
!PasteUpMorph methodsFor: 'interaction loop' stamp: 'jmv 3/2/2017 19:34:01' prior: 16887286!
 doOneCycleNow
	"see the comment in doOneCycleNowFor:
	Only used for a few tests."
	worldState doOneCycleNow! !
!PasteUpMorph methodsFor: 'stepping' stamp: 'jmv 3/2/2017 19:36:23' prior: 16887443!
                            cleanseStepList
	"Remove morphs from the step list that are not in this World.  Often were in a flap that has moved on to another world."

	worldState cleanseStepList! !
!PasteUpMorph methodsFor: 'stepping' stamp: 'jmv 3/2/2017 19:42:32' prior: 16887451!
 runStepMethods

	worldState runStepMethods! !
!PasteUpMorph methodsFor: 'world state' stamp: 'jmv 3/2/2017 19:34:54' prior: 16887760!
                          displayWorldSafely

	worldState displayWorldSafely
! !
!PasteUpMorph methodsFor: 'world state' stamp: 'jmv 3/2/2017 19:33:20' prior: 16887765!
                 doOneCycle
	"see the comment in WorldState >> doOneCycle"

	worldState doOneCycle! !
!PasteUpMorph methodsFor: 'world state' stamp: 'jmv 3/2/2017 19:37:11' prior: 16887829!
                   privateOuterDisplayWorld

	worldState displayWorldAndSubmorphs: submorphs
! !
!WorldState class methodsFor: 'sample code' stamp: 'jmv 3/2/2017 19:39:21' prior: 16946320!
                      experiment1
	"To play with and learn about morphic Display update logic.
	Remove the morphs when done!!"
	"
	WorldState experiment1
	"
	| dr morph1 morph2 s w |
	morph1 _ RectangleLikeMorph new openInWorld.
	morph2 _ RectangleLikeMorph new openInWorld.
	morph2 color: Color green.
	morph2 morphPosition: 200@800 extent: 50@40.
	morph1 morphPosition: 120@720 extent: 220@100.

	w _ self runningWorld.
	s _ w instVarNamed: 'worldState'.
	dr _ s instVarNamed: 'damageRecorder'.

	dr doFullRepaint.
	dr reset;
	"	recordInvalidRect: (100@700 corner: 400@900);"
		recordInvalidRect: (100@700 corner: 150@900);
		recordInvalidRect: (300@700 corner: 400@900).
	Display fillColor: Color gray.
	"Do not draw the area used by the small rectangle, unless it is also drawn!!"
	s drawInvalidAreasSubmorphs: {morph1. morph2 }! !

WorldState removeSelector: #cleanseStepListForWorld:!

WorldState removeSelector: #cleanseStepListForWorld:!

WorldState removeSelector: #displayWorld:submorphs:!

WorldState removeSelector: #displayWorld:submorphs:!

WorldState removeSelector: #displayWorldSafely:!

WorldState removeSelector: #displayWorldSafely:!

WorldState removeSelector: #doOneCycleFor:!

WorldState removeSelector: #doOneCycleFor:!

WorldState removeSelector: #doOneCycleNowFor:!

WorldState removeSelector: #doOneCycleNowFor:!

WorldState removeSelector: #drawInvalidAreasWorld:submorphs:!

WorldState removeSelector: #drawInvalidAreasWorld:submorphs:!

WorldState removeSelector: #runLocalStepMethodsIn:!

WorldState removeSelector: #runLocalStepMethodsIn:!

WorldState removeSelector: #runStepMethodsIn:!

WorldState removeSelector: #runStepMethodsIn:!

WorldState removeSelector: #simpleDrawInvalidAreasWorld:submorphs:!

WorldState removeSelector: #simpleDrawInvalidAreasWorld:submorphs:!

WorldState removeSelector: #tryDeferredUpdatingAndSetCanvasFor:!

WorldState removeSelector: #tryDeferredUpdatingAndSetCanvasFor:!

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3050-WorldState-refactor-JuanVuletich-2017Mar03-09h17m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3049] on 3 March 2017 at 9:22:19 am'!
!PasteUpMorph methodsFor: 'interaction loop' stamp: 'jmv 3/2/2017 19:58:01' prior: 50339854!
                              doOneCycleNow
	"see the comment in WorldState >> doOneCycleNow
	Only used for a few tests."
	worldState doOneCycleNow! !
!WorldState methodsFor: 'update cycle' stamp: 'jmv 3/3/2017 09:21:41' prior: 50339571!
                doOneCycleNow
	"Immediately do one cycle of the interaction loop."

	| hadAnyEvent |
	"See #eventTickler"
	Cursor currentCursor = Cursor wait ifTrue: [
		Cursor normal activateCursor ].

	"Repair visual damage."
	DisplayScreen checkForNewScreenSize.
	self displayWorldSafely.

	"Run steps, alarms and deferred UI messages"
	self runStepMethods.

	"Process user input events. Run all event triggered code."
	hadAnyEvent _ false.
	self handsDo: [ :h |
		activeHand _ h.
		hadAnyEvent _ hadAnyEvent | h processEventQueue.
		activeHand _ nil ].

	"The default is the primary hand"
	activeHand _ self hands first.


	^hadAnyEvent! !

PasteUpMorph removeSelector: #runStepMethods!

PasteUpMorph removeSelector: #runStepMethods!

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3051-WorldState-refactor-JuanVuletich-2017Mar03-09h17m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3049] on 3 March 2017 at 9:27:56 am'!
!PasteUpMorph methodsFor: 'world state' stamp: 'jmv 3/2/2017 20:08:11'!
                             doOneMinimalCycleNow
	"see the comment in WorldState >> doOneMinimalCycleNow"

	worldState doOneMinimalCycleNow! !
!WorldState methodsFor: 'update cycle' stamp: 'jmv 3/2/2017 20:06:48'!
      doOneMinimalCycleNow
	"Immediately do one cycle of the interaction loop.
	Only repair display and process events. For modal menus and such."

	"Repair visual damage."
	self displayWorldSafely.

	"Process user input events. Run all event triggered code."
	^activeHand processEventQueue! !
!MenuMorph methodsFor: 'modal control' stamp: 'jmv 3/2/2017 20:08:34' prior: 16867177!
         invokeModal: allowKeyboardControl
	"Invoke this menu and don't return until the user has chosen a value.  If the allowKeyboarControl boolean is true, permit keyboard control of the menu
	See senders of this method for finding out how to use modal menu morphs."
	| w oldFocus actHand |
	w _ self runningWorld.
	actHand _ w activeHand.
	oldFocus _ actHand keyboardFocus.
	w doOneMinimalCycleNow.
	self	
		popUpAt: actHand morphPosition
		forHand: actHand 
		allowKeyboard: allowKeyboardControl.
	self isModalInvokationDone: false.
	[ self isInWorld & self isModalInvokationDone not ] whileTrue: [ w doOneMinimalCycleNow ].
	self delete.
	oldFocus ifNotNil: [ actHand newKeyboardFocus: oldFocus ].
	^ self modalSelection! !
!MVCMenuMorph methodsFor: 'invoking' stamp: 'jmv 3/2/2017 20:08:29' prior: 16865463!
                          invokeAt: aPoint allowKeyboard: aBoolean
	"Add this menu to the given world centered at the given point. Wait for the user to make a selection and answer it. The selection value returned is an integer in keeping with PopUpMenu, if the menu is converted from an MVC-style menu."
	"Details: This is invoked synchronously from the caller. In order to keep processing inputs and updating the screen while waiting for the user to respond, this method has its own version of the World's event loop." 
	|actHand w oldFocus |
	self flag: #bob.		"is <aPoint> global or local?"
	self flag: #arNote.	"<aPoint> is local to aWorld"
	w _ self runningWorld.
	actHand _ w activeHand.
	oldFocus _ actHand keyboardFocus.
	w doOneMinimalCycleNow.
	self
		popUpAt: aPoint
		forHand: actHand
		allowKeyboard: aBoolean.
	done _ false.
	[ self isInWorld & done not ] whileTrue: [ w doOneMinimalCycleNow ].
	self delete.
	oldFocus ifNotNil: [ actHand newKeyboardFocus: oldFocus ].
	^ mvcSelection ! !
!FillInTheBlankMorph methodsFor: 'invoking' stamp: 'jmv 3/2/2017 20:08:24' prior: 16844196!
                   getUserResponse
	"Wait for the user to accept or cancel, and answer the result string. Answers the empty string if the user cancels."
	"Details: This is invoked synchronously from the caller. In order to keep processing inputs and updating the screen while waiting for the user to respond, this method has its own version of the World's event loop."

	| w |
	w _ self world.
	w ifNil: [^ response].
	done _ false.
	textPane focusText.
	[done] whileFalse: [w doOneMinimalCycleNow].
	self delete.
	w doOneMinimalCycleNow.
	^ response
! !
!FillInTheBlankMorph class methodsFor: 'instance creation' stamp: 'jmv 3/3/2017 09:26:42' prior: 16844289!
                             request: queryString initialAnswer: defaultAnswer centerAt: aPoint onCancelReturn: returnOnCancel acceptOnCR: acceptBoolean
	"Create an instance of me whose question is queryString with the given initial answer. Invoke it centered at the given point, and answer the string the user accepts.   If the user cancels, answer returnOnCancel."
	"
	FillInTheBlankMorph
		request: 'Type something, then type [Return].'
		initialAnswer: 'yo ho ho!!'
	"

	| aFillInTheBlankMorph |
	aFillInTheBlankMorph _ self new
		setQuery: queryString
		initialAnswer: defaultAnswer
		acceptOnCR: acceptBoolean.
	aFillInTheBlankMorph responseUponCancel: returnOnCancel.
	self runningWorld addMorph: aFillInTheBlankMorph centeredNear: aPoint.
	^ aFillInTheBlankMorph getUserResponse! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3052-MenusDoReducedWorldCycle-JuanVuletich-2017Mar03-09h22m-jmv.2.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3049] on 3 March 2017 at 9:49:08 am'!
!WorldState methodsFor: 'accessing' stamp: 'jmv 3/3/2017 09:47:13'!
                     runLocalStepMethods: nowTime
	"Run morph 'step' methods (LOCAL TO THIS WORLD) whose time has come. Purge any morphs that are no longer in this world."

	| morphToStep scheduledTime |
	[ stepList notEmpty and: [ stepList first scheduledTime <= nowTime ]] 
		whileTrue: [
			lastStepMessage _ stepList removeFirst.
			morphToStep _ lastStepMessage receiver.
			(morphToStep shouldGetStepsFrom: world) 
				ifTrue: [
					scheduledTime _ lastStepMessage scheduledTime.
					lastStepMessage valueAtTime: nowTime - scheduledTime + lastStepMessage stepTime.
					lastStepMessage ifNotNil: [
							lastStepMessage scheduledTime: (scheduledTime + lastStepMessage stepTime max: nowTime + 1).
							stepList add: lastStepMessage ]].
			lastStepMessage _ nil ]! !
!WorldState methodsFor: 'alarms' stamp: 'jmv 3/3/2017 09:33:59' prior: 16945643!
                            addAlarm: aSelector withArguments: argArray for: aTarget at: scheduledTime
	"Add a new alarm with the given set of parameters"

	alarms add: 
		(MorphicAlarm 
			receiver: aTarget
			selector: aSelector
			arguments: argArray
			at: scheduledTime)! !
!WorldState methodsFor: 'alarms' stamp: 'jmv 3/3/2017 09:34:03' prior: 16945653!
                    adjustAlarmTimes: nowTime
	"Adjust the alarm times after some clock weirdness (such as image-startup etc)"
	| deltaTime |
	deltaTime _ nowTime - lastAlarmTime.
	alarms do: [ :alarm |
		alarm scheduledTime: alarm scheduledTime + deltaTime ]! !
!WorldState methodsFor: 'alarms' stamp: 'jmv 3/3/2017 09:34:21' prior: 16945673!
                            removeAlarm: aSelector for: aTarget 
	"Remove the alarm with the given selector"

	| alarm |
	alarm := alarms 
				detect: [ :any | any receiver == aTarget and: [any selector == aSelector]]
				ifNone: nil.
	alarm ifNotNil: [ alarms remove: alarm ]! !
!WorldState methodsFor: 'alarms' stamp: 'jmv 3/3/2017 09:35:03' prior: 16945684!
                   triggerAlarmsBefore: nowTime
	"Trigger all pending alarms that are to be executed before nowTime."

	nowTime - lastAlarmTime > 10000
		ifTrue: [ self adjustAlarmTimes: nowTime ].
	[ alarms notEmpty and: [ alarms first scheduledTime < nowTime ]]
		whileTrue: [ alarms removeFirst valueAtTime: nowTime ].
	lastAlarmTime _ nowTime! !
!WorldState methodsFor: 'initialization' stamp: 'jmv 3/3/2017 09:33:53' prior: 16945782!
                            initialize

	activeHand _ HandMorph new.
	hands _ { activeHand }.
	damageRecorder _ DamageRecorder new.
	stepList _ Heap sortBlock: self stepListSortBlock.
	alarms _ Heap sortBlock: self alarmSortBlock.
	lastAlarmTime _ 0.
	drawingFailingMorphs _ WeakIdentitySet new.
	pause _ 20.
	lastCycleTime _ Time localMillisecondClock.
	lastCycleHadAnyEvent _ false! !
!WorldState methodsFor: 'stepping' stamp: 'jmv 3/3/2017 09:39:18' prior: 50339448!
      cleanseStepList
	"Remove morphs from the step list that are not in this World."

	| deletions morphToStep |
	deletions _ nil.
	stepList do: [:entry |
		morphToStep _ entry receiver.
		morphToStep world == world ifFalse:[
			deletions ifNil: [deletions _ OrderedCollection new].
			deletions addLast: entry]].

	deletions ifNotNil:[
		deletions do: [:entry|
			self stopSteppingMorph: entry receiver]].

	alarms copy do: [ :entry |
		morphToStep _ entry receiver.
		((morphToStep is: #Morph) and: [ morphToStep world == world ]) 
			ifFalse: [ self removeAlarm: entry selector for: entry receiver ]]! !
!WorldState methodsFor: 'stepping' stamp: 'jmv 3/3/2017 09:46:37' prior: 50339471!
                   runStepMethods
	"Perform periodic activity inbetween event cycles"
	| queue msg |

	queue _ self class deferredUIMessages.
	[ (msg _ queue nextOrNil) isNil ] whileFalse: [
		msg value
	].
	self triggerAlarmsBefore: lastCycleTime.
	self runLocalStepMethods: lastCycleTime.

	"we are using a normal #step for these now"
	"aWorld allLowerWorldsDo: [ :each | each runLocalStepMethods ]."
! !

WorldState removeSelector: #alarms!

WorldState removeSelector: #alarms!

WorldState removeSelector: #runLocalStepMethods!

WorldState removeSelector: #runLocalStepMethods!

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3053-WorldState-refactor-JuanVuletich-2017Mar03-09h27m-jmv.2.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3053] on 3 March 2017 at 11:17:47 am'!

MorphicAlarm subclass: #StepMessage
	instanceVariableNames: 'stepTime lastEvaluationTime '
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Events'!

!classDefinition: #StepMessage category: #'Morphic-Events'!
MorphicAlarm subclass: #StepMessage
	instanceVariableNames: 'stepTime lastEvaluationTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Events'!
!StepMessage methodsFor: 'evaluating' stamp: 'jmv 3/3/2017 11:14:28'!
                     valueAtTime: millisecondClock

	|  nArgs millisecondsSinceLast |
	numArgs ifNil: [numArgs _ selector numArgs].
	nArgs _ arguments ifNil: [0] ifNotNil: [arguments size].
"OJO!!"
lastEvaluationTime ifNil: [ lastEvaluationTime _ millisecondClock ].
	millisecondsSinceLast _ millisecondClock - lastEvaluationTime.
	lastEvaluationTime _ millisecondClock.
	nArgs = numArgs ifTrue: [
		"Ignore extra argument"
		^self value ].
	^arguments
		ifNil: [ receiver perform: selector with: millisecondsSinceLast]
		ifNotNil: [ receiver perform: selector withArguments: (arguments copyWith: millisecondsSinceLast) ]! !
!WorldState methodsFor: 'accessing' stamp: 'jmv 3/3/2017 11:16:08' prior: 50340135!
                runLocalStepMethods: nowTime
	"Run morph 'step' methods (LOCAL TO THIS WORLD) whose time has come. Purge any morphs that are no longer in this world."

	| morphToStep scheduledTime |
	[ stepList notEmpty and: [ stepList first scheduledTime <= nowTime ]] 
		whileTrue: [
			lastStepMessage _ stepList removeFirst.
			morphToStep _ lastStepMessage receiver.
			(morphToStep shouldGetStepsFrom: world) 
				ifTrue: [
					scheduledTime _ lastStepMessage scheduledTime.
					lastStepMessage valueAtTime: nowTime.
					lastStepMessage ifNotNil: [
						lastStepMessage scheduledTime: (scheduledTime + lastStepMessage stepTime max: nowTime + 1).
						stepList add: lastStepMessage ]].
			lastStepMessage _ nil ]! !

MorphicAlarm subclass: #StepMessage
	instanceVariableNames: 'stepTime lastEvaluationTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Events'!

!classDefinition: #StepMessage category: #'Morphic-Events'!
MorphicAlarm subclass: #StepMessage
	instanceVariableNames: 'stepTime lastEvaluationTime'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Events'!

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3054-StepMessageCleanup-JuanVuletich-2017Mar03-11h11m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3053] on 3 March 2017 at 11:41:31 am'!
!StepMessage methodsFor: 'evaluating' stamp: 'jmv 3/3/2017 11:28:02'!
   rescheduleAfter: millisecondTimer
	"Schedule next run"
	scheduledTime _ scheduledTime + self stepTime max: millisecondTimer + 1! !
!WorldState methodsFor: 'stepping' stamp: 'jmv 3/3/2017 11:39:34' prior: 16945882!
          stopStepping: aMorph selector: aSelector
	"Remove the given morph from the step list."
	stepList removeAll: (stepList select:[:stepMsg| stepMsg receiver == aMorph and: [ stepMsg selector == aSelector ]])! !
!WorldState methodsFor: 'stepping' stamp: 'jmv 3/3/2017 11:39:22' prior: 16945896!
                              stopSteppingMorph: aMorph
	"Remove the given morph from the step list."
	stepList removeAll: (stepList select: [ :stepMsg | stepMsg receiver == aMorph])! !
!WorldState methodsFor: 'accessing' stamp: 'jmv 3/3/2017 11:39:10' prior: 50340307!
                runLocalStepMethods: nowTime
	"Run morph 'step' methods (LOCAL TO THIS WORLD) whose time has come. Purge any morphs that are no longer in this world."

	| stepMessage |
	[ stepList notEmpty and: [ stepList first scheduledTime <= nowTime ]] 
		whileTrue: [

			stepMessage _ stepList first.
			(stepMessage receiver shouldGetStepsFrom: world)
				ifTrue: [
					stepMessage valueAtTime: nowTime.
					"If it was not removed from the list during its own evaluation"
					stepMessage == stepList first ifTrue: [
						stepList removeFirst.
						stepMessage rescheduleAfter: nowTime.
						stepList add: stepMessage ]]

				ifFalse: [ stepList removeFirst ].
		]! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3055-SteppingCleanup-JuanVuletich-2017Mar03-11h17m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3053] on 3 March 2017 at 11:55:19 am'!
!StepMessage methodsFor: 'evaluating' stamp: 'jmv 3/3/2017 11:55:15' prior: 50340285!
             valueAtTime: millisecondClock

	|  nArgs millisecondsSinceLast |
	numArgs ifNil: [numArgs _ selector numArgs].
	nArgs _ arguments ifNil: [0] ifNotNil: [arguments size].
	lastEvaluationTime ifNil: [ lastEvaluationTime _ millisecondClock ].
	millisecondsSinceLast _ millisecondClock - lastEvaluationTime.
	lastEvaluationTime _ millisecondClock.
	nArgs = numArgs ifTrue: [
		"Ignore extra argument"
		^self value ].
	^arguments
		ifNil: [ receiver perform: selector with: millisecondsSinceLast]
		ifNotNil: [ receiver perform: selector withArguments: (arguments copyWith: millisecondsSinceLast) ]! !
!PasteUpMorph methodsFor: 'caching' stamp: 'jmv 3/3/2017 11:42:44' prior: 16887042!
                       releaseCachedState
	super releaseCachedState.
	backgroundImage _ nil.
	self isWorldMorph ifTrue: [
		worldState cleanseStepList.
		worldState clearCanvas ]! !
!WorldState methodsFor: 'alarms' stamp: 'jmv 3/3/2017 11:54:00' prior: 50340184!
                removeAlarm: aSelector for: aTarget 
	"Remove the alarm with the given selector"

	| alarm |
	alarm _ alarms 
				detect: [ :any | any receiver == aTarget and: [any selector == aSelector]]
				ifNone: nil.
	alarm ifNotNil: [ alarms remove: alarm ]! !
!WorldState methodsFor: 'stepping' stamp: 'jmv 3/3/2017 11:51:16' prior: 50340223!
                  cleanseStepList
	"Remove morphs from the step list that are not in this World."

	| deletions |
	deletions _ OrderedCollection new.
	stepList do: [ :entry |
		entry receiver world == world ifFalse: [
			deletions add: entry]].
	deletions do: [ :entry|
		stepList remove: entry ].

	deletions _ OrderedCollection new.
	alarms do: [ :entry |
		((entry receiver is: #Morph) and: [ entry receiver world == world ]) ifFalse: [
			deletions add: entry]].
	deletions do: [ :entry|
		alarms remove: entry ]! !

PasteUpMorph removeSelector: #cleanseStepList!

PasteUpMorph removeSelector: #cleanseStepList!

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3056-SteppingCleanup-JuanVuletich-2017Mar03-11h41m-jmv.2.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3056] on 3 March 2017 at 3:11:05 pm'!
!WorldState methodsFor: 'update cycle' stamp: 'jmv 3/3/2017 15:04:20' prior: 50339515!
              doOneCycle
	"Do one cycle of the interaction loop. This method is called repeatedly when the world is running.
	
	Make for low cpu usage if the ui is inactive, but quick response when ui is in use.
	However, after some inactivity, there will be a larger delay before the ui gets responsive again."

	| wait waitUntil |
	waitDelay ifNil: [ waitDelay _ Delay forMilliseconds: 50 ].
	lastCycleHadAnyEvent
		ifTrue: [
			pause _ 20.				"This value will only be used when there are no more events to serve."
			wait _ 0 ]					"Don't wait"
		ifFalse: [
			pause < 200				"No events processed? Start saving CPU!! But never make the user wait more than 200ms for being responsive again."
				ifTrue: [ pause _ pause * 21//20 ].
			waitUntil _ lastCycleTime + pause.
			"Earlier if steps"
			stepList isEmpty not ifTrue: [
				waitUntil _ waitUntil min: stepList first scheduledTime ].
			"Earlier if alarms"
			alarms ifNotNil: [
				alarms isEmpty not ifTrue: [
					waitUntil _ waitUntil min: alarms first scheduledTime ]].

			wait _ waitUntil - Time localMillisecondClock ].
	Preferences serverMode
		ifTrue: [ wait _ wait max: 50 ].	"Always wait at least a bit on servers, even if this makes the UI slow."
	wait > 5
		ifFalse: [ Processor yield ]
		ifTrue: [
			waitDelay beingWaitedOn
				ifFalse: [ waitDelay setDelay: wait; wait ]
				ifTrue: [
					"If we are called from a different process than that of the main UI, we might be called in the main
					interCyclePause. In such case, use a new Delay to avoid 'This Delay has already been scheduled' errors"
					(Delay forMilliseconds: wait) wait ]].

	"Record start time of this cycle, and do cycle"
	lastCycleTime _ Time localMillisecondClock.
	lastCycleHadAnyEvent _ self doOneCycleNow! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3057-SteppingHangWorkaround-JuanVuletich-2017Mar03-15h10m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3049] on 3 March 2017 at 7:15:45 pm'!
!TestCase methodsFor: 'Running' stamp: 'HAW 3/3/2017 19:13:13'!
    debugAsFailureIfCanNot: handler
	
	| semaphore |
	
	self ifCanNotDebugDo: [ ^handler value].
	
	semaphore := Semaphore new.
	self resources do: [:res | 
		res isAvailable ifFalse: [^res signalInitializationError]].
	[semaphore wait. 
	self tearDown.
	self resources do: [:each | each reset]] fork.
	(self class selector: testSelector) runCaseAsFailure: semaphore.! !
!TestCase methodsFor: 'Private' stamp: 'HAW 3/3/2017 14:13:09'!
                 canNotDebugMethodErrorDescription

	^self class canNotDebugMethodErrorDescription! !
!TestCase methodsFor: 'Private' stamp: 'HAW 3/3/2017 18:50:08'!
           ifCanNotDebugDo: handler

	^self testMethod isQuick ifTrue: handler! !
!TestCase methodsFor: 'Private' stamp: 'HAW 3/3/2017 14:13:37'!
                         signalCanNotDebugMethod 

	self error: self canNotDebugMethodErrorDescription! !
!TestCase methodsFor: 'Private' stamp: 'HAW 3/3/2017 14:10:20'!
               testMethod 

	^self class lookupSelector: self selector! !
!TestCase class methodsFor: 'Instance Creation' stamp: 'HAW 3/3/2017 18:51:38'!
                     debugAsFailure: aSymbol ifCanNot: handler

	^(self selector: aSymbol) debugAsFailureIfCanNot: handler
	! !
!TestCase class methodsFor: 'Error Descriptions' stamp: 'HAW 3/3/2017 16:33:00'!
    canNotDebugMethodErrorDescription

	^'Quick methods can not be debugged'! !
!Browser methodsFor: 'tdd' stamp: 'HAW 3/3/2017 19:12:25' prior: 50338019!
         debugMethodTest
	
	currentCompiledMethod isTestMethod ifTrue: [
		currentCompiledMethod methodClass debugAsFailure: currentCompiledMethod selector ifCanNot: [ PopUpMenu inform: TestCase canNotDebugMethodErrorDescription ]]
! !
!SmalltalkEditor methodsFor: 'tdd' stamp: 'HAW 3/3/2017 19:12:39' prior: 50338106!
          acceptAndDebugTest
	
	^self acceptAndWithMethodDo: [ :aPotencialTestMethod | 
		aPotencialTestMethod isTestMethod ifTrue: [ 
			aPotencialTestMethod methodClass debugAsFailure: aPotencialTestMethod selector ifCanNot: [ PopUpMenu inform: TestCase canNotDebugMethodErrorDescription ]]]! !
!TestCase methodsFor: 'Running' stamp: 'HAW 3/3/2017 18:49:24' prior: 16927491!
                 debugAsFailure
	
	^self debugAsFailureIfCanNot: [ self signalCanNotDebugMethod ]! !
!TestCase methodsFor: 'Private' stamp: 'HAW 3/3/2017 19:13:40' prior: 16927518!
                            openDebuggerOnFailingTestMethod

	| guineaPig context compiledMethod debugger |

	compiledMethod _ self testMethod.
	guineaPig _ [ self performTest ] newProcess.
	context _ guineaPig suspendedContext.
	debugger _ Debugger new
		process: guineaPig
		context: context.
	debugger openFullNoSuspendLabel: 'Debug failed test ', self printString.

	[debugger interruptedContext method == compiledMethod]
		whileFalse: [debugger send].
! !
!TestCase methodsFor: 'Private' stamp: 'HAW 3/3/2017 19:14:27' prior: 16927535!
                               openDebuggerOnFailingTestMethod: semaphore

	| guineaPig context compiledMethod debugger |

	compiledMethod _ self testMethod.
	guineaPig _ [ self performTest ] newProcess.
	context _ guineaPig suspendedContext.
	debugger _ TestCaseDebugger new
		process: guineaPig
		context: context.
	debugger doneSemaphore: semaphore.
	debugger openFullNoSuspendLabel: 'Debug failed test ', self printString.

	[debugger interruptedContext method == compiledMethod]
		whileFalse: [debugger send].
! !

TestCase class removeSelector: #debugAsFailure:!

TestCase class removeSelector: #debugAsFailure:!

TestCase removeSelector: #assertCanDebugMethod!

TestCase removeSelector: #canNotDebugQuickMethodErrorDescription!

TestCase removeSelector: #signalCanNotDebugQuickMethod!

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3058-CuisCore-HernanWilkinson-2017Mar02-18h30m-HAW.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3058] on 6 March 2017 at 10:14:29 am'!
!Delay class methodsFor: 'timer process' stamp: 'jmv 3/6/2017 10:13:34' prior: 16833016!
            handleTimerEvent
	"Handle a timer event; which can be either:
		- a schedule request (ScheduledDelay notNil)
		- an unschedule request (FinishedDelay notNil)
		- a timer signal (not explicitly specified)
	We check for timer expiry every time we get a signal."
	| nowTick nextTick afterwardsTick |
	"Wait until there is work to do."
	TimingSemaphore wait.

	"Process any schedule requests"
	ScheduledDelay ifNotNil: [
		"Schedule the given delay"
		self scheduleDelay: ScheduledDelay.
		ScheduledDelay := nil.
		ScheduledDelayNilledSemaphore initSignals. 
		ScheduledDelayNilledSemaphore signal ].

	"Process any unschedule requests"
	FinishedDelay ifNotNil: [
		self unscheduleDelay: FinishedDelay.
		FinishedDelay := nil.
		FinishedDelayNilledSemaphore initSignals.
		FinishedDelayNilledSemaphore signal ].

	"Check for clock wrap-around."
	nowTick := Time millisecondClockValue.
	nowTick < ActiveDelayStartTime ifTrue: [
		"clock wrapped"
		self saveResumptionTimes.
		self restoreResumptionTimes ].
	ActiveDelayStartTime := nowTick.

	"Signal any expired delays"
	[ ActiveDelay notNil and:[ nowTick >= ActiveDelay resumptionTime ]] whileTrue: [
		ActiveDelay signalWaitingProcess.
		SuspendedDelays isEmpty 
			ifTrue: [ ActiveDelay := nil ] 
			ifFalse:[ ActiveDelay := SuspendedDelays removeFirst ]].

	"And signal when the next request is due. We sleep at most 1sec here
	as a soft busy-loop so that we don't accidentally miss signals."
	nextTick := nowTick + 1000.
	ActiveDelay ifNotNil: [
		nextTick := nextTick min: ActiveDelay resumptionTime ].
	nextTick := nextTick min: SmallInteger maxVal.

	"Since we have processed all outstanding requests, reset the timing semaphore so
	that only new work will wake us up again. Do this RIGHT BEFORE setting the next
	wakeup call from the VM because it is only signaled once so we mustn't miss it."
	TimingSemaphore initSignals.
	Delay primSignal: TimingSemaphore atMilliseconds: nextTick.

	"This test is necessary for the obscure case that the msecs clock rolls over
	after nowTick has been computed (unlikely but not impossible). In this case we'd
	wait for MillisecondClockMask msecs (roughly six days) or until another delay gets
	scheduled (which may not be any time soon). In any case, since handling the
	condition is easy, let's just deal with it."
	afterwardsTick _ Time millisecondClockValue.
	afterwardsTick < nowTick  						"Means clock rollover."
		ifTrue: [ TimingSemaphore signal ]. "retry"

	"It seems that #primSignal:atMilliseconds: might not signal the semaphore if the requested moment is in the past.
	This behavior was observed in Linux Spur64 VMs.
	If this happens, next delay never finishes. Usual symptom is frozen Morphic.
	If there is any risk of this happening, just do another iteration right now."
	nextTick < afterwardsTick  						"We're already late for next signal."
		ifTrue: [ TimingSemaphore signal ]. "retry"! !
!WorldState methodsFor: 'update cycle' stamp: 'jmv 3/5/2017 00:38:27' prior: 50340477!
                     doOneCycle
	"Do one cycle of the interaction loop. This method is called repeatedly when the world is running.
	
	Make for low cpu usage if the ui is inactive, but quick response when ui is in use.
	However, after some inactivity, there will be a larger delay before the ui gets responsive again."

	| wait waitUntil |
	waitDelay ifNil: [ waitDelay _ Delay forMilliseconds: 50 ].
	lastCycleHadAnyEvent
		ifTrue: [
			pause _ 20.				"This value will only be used when there are no more events to serve."
			wait _ 0 ]					"Don't wait"
		ifFalse: [
			pause < 200				"No events processed? Start saving CPU!! But never make the user wait more than 200ms for being responsive again."
				ifTrue: [ pause _ pause * 21//20 ].
			waitUntil _ lastCycleTime + pause.
			"Earlier if steps"
			stepList isEmpty not ifTrue: [
				waitUntil _ waitUntil min: stepList first scheduledTime ].
			"Earlier if alarms"
			alarms ifNotNil: [
				alarms isEmpty not ifTrue: [
					waitUntil _ waitUntil min: alarms first scheduledTime ]].

			wait _ waitUntil - Time localMillisecondClock ].
	Preferences serverMode
		ifTrue: [ wait _ wait max: 50 ].	"Always wait at least a bit on servers, even if this makes the UI slow."
	wait > 0
		ifFalse: [ Processor yield ]
		ifTrue: [
			waitDelay beingWaitedOn
				ifFalse: [ waitDelay setDelay: wait; wait ]
				ifTrue: [
					"If we are called from a different process than that of the main UI, we might be called in the main
					interCyclePause. In such case, use a new Delay to avoid 'This Delay has already been scheduled' errors"
					(Delay forMilliseconds: wait) wait ]].

	"Record start time of this cycle, and do cycle"
	lastCycleTime _ Time localMillisecondClock.
	lastCycleHadAnyEvent _ self doOneCycleNow! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3059-RealFixForSteppingFreeze-JuanVuletich-2017Mar06-10h02m-jmv.1.cs.st----!

----SNAPSHOT----#(6 March 2017 10:16:14.796027 am) Cuis5.0-3059-spur-64.image priorSource: 203014!

----QUIT----#(6 March 2017 10:16:31.136894 am) Cuis5.0-3059-spur-64.image priorSource: 293443!

----STARTUP----#(8 March 2017 9:09:50.654222 am) as /home/juan/Rectifier/Cuis-Smalltalk-Dev/Cuis5.0-3059-spur-64.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3059] on 7 March 2017 at 9:52:45 am'!
!Time class methodsFor: 'primitives' stamp: 'jmv 3/7/2017 09:52:37' prior: 16937622!
               primMillisecondClock
	"Primitive. Answer the number of milliseconds since the millisecond clock
	was last reset or rolled over. No sync to any system clock.
	Implemented by all major platforms.
	Essential. See Object documentation whatIsAPrimitive. 
	
	Time primMillisecondClock
	Time primMillisecondClock / 1000 / 60.0

	Range is  from zero to 16r1FFFFFFF.
	The VM defines MillisecondClockMask as 16r1FFFFFFF

	Overflows usually every six days.
	Still used in #localMillisecondClock if the VM doesn't implement
		Time primLocalMicrosecondClock
	"
"Not really a clock, but a timer or ticker"

	<primitive: 135>
	self primitiveFailed! !
!Delay class methodsFor: 'timer process' stamp: 'jmv 3/7/2017 09:51:10' prior: 50340665!
           handleTimerEvent
	"Handle a timer event; which can be either:
		- a schedule request (ScheduledDelay notNil)
		- an unschedule request (FinishedDelay notNil)
		- a timer signal (not explicitly specified)
	We check for timer expiry every time we get a signal."
	| nowTick nextTick afterwardsTick |
	"Wait until there is work to do."
	TimingSemaphore wait.

	"Process any schedule requests"
	ScheduledDelay ifNotNil: [
		"Schedule the given delay"
		self scheduleDelay: ScheduledDelay.
		ScheduledDelay := nil.
		ScheduledDelayNilledSemaphore initSignals. 
		ScheduledDelayNilledSemaphore signal ].

	"Process any unschedule requests"
	FinishedDelay ifNotNil: [
		self unscheduleDelay: FinishedDelay.
		FinishedDelay := nil.
		FinishedDelayNilledSemaphore initSignals.
		FinishedDelayNilledSemaphore signal ].

	"Check for clock wrap-around."
	nowTick := Time millisecondClockValue.
	nowTick < ActiveDelayStartTime ifTrue: [
		"clock wrapped"
		self saveResumptionTimes.
		self restoreResumptionTimes ].
	ActiveDelayStartTime := nowTick.

	"Signal any expired delays"
	[ ActiveDelay notNil and:[ nowTick >= ActiveDelay resumptionTime ]] whileTrue: [
		ActiveDelay signalWaitingProcess.
		SuspendedDelays isEmpty 
			ifTrue: [ ActiveDelay := nil ] 
			ifFalse:[ ActiveDelay := SuspendedDelays removeFirst ]].

	"And signal when the next request is due. We sleep at most 1sec here
	as a soft busy-loop so that we don't accidentally miss signals."
	nextTick := nowTick + 1000.
	ActiveDelay ifNotNil: [
		nextTick := nextTick min: ActiveDelay resumptionTime ].
	nextTick := nextTick min: 16r1FFFFFFF.	"MillisecondClockMask"

	"Since we have processed all outstanding requests, reset the timing semaphore so
	that only new work will wake us up again. Do this RIGHT BEFORE setting the next
	wakeup call from the VM because it is only signaled once so we mustn't miss it."
	TimingSemaphore initSignals.
	Delay primSignal: TimingSemaphore atMilliseconds: nextTick.

	"This test is necessary for the obscure case that the msecs clock rolls over
	after nowTick has been computed (unlikely but not impossible). In this case we'd
	wait for MillisecondClockMask msecs (roughly six days) or until another delay gets
	scheduled (which may not be any time soon). In any case, since handling the
	condition is easy, let's just deal with it."
	afterwardsTick _ Time millisecondClockValue.
	afterwardsTick < nowTick  						"Means clock rollover."
		ifTrue: [ TimingSemaphore signal ]. "retry"

	"It seems that #primSignal:atMilliseconds: might not signal the semaphore if the requested moment is in the past.
	This behavior was observed in Linux Spur64 VMs.
	If this happens, next delay never finishes. Usual symptom is frozen Morphic.
	If there is any risk of this happening, just do another iteration right now."
	nextTick < afterwardsTick  						"We're already late for next signal."
		ifTrue: [ TimingSemaphore signal ]. "retry"! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3060-Proper-MillisecondClockMask-JuanVuletich-2017Mar07-09h05m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3061] on 7 March 2017 at 12:20:30 pm'!
!Time class methodsFor: 'primitives' stamp: 'jmv 3/7/2017 12:16:43' prior: 16937642!
                      primUtcMicrosecondClock
	"Answer the number of microseconds since the UTC Smalltalk epoch, 
	i.e. 00:00 on the morning of January 1, 1901, the start of the 20th century, in UTC time.
	 The value is derived from the Posix epoch with a constant offset corresponding to elapsed microseconds
	 between the two epochs according to RFC 868.
	Answer is (at least usually) a  LargePositiveInteger
	Cog VMs implement this. Interpreters might not."
	"
	Time primUtcMicrosecondClock
	Time primUtcMicrosecondClock/ 1000 / 1000 / 60 / 60 / 24 / 365.25

	(Time primUtcMicrosecondClock / 1000 / 1000 + Time primUtcWithOffset second) / 60 / 60 / 24 / 365.25
	(DateAndTime now - (DateAndTime year: 1901 month: 1 day: 1)) totalSeconds / 60 / 60 / 24 / 365.25
	"
	<primitive: 240>
	^nil! !
!Delay class methodsFor: 'primitives' stamp: 'jmv 3/7/2017 12:19:39'!
                       primSignal: aSemaphore atUTCMicroseconds: anInteger
	"Signal the semaphore when the UTC microsecond clock reaches the value of the second argument.
	 Fail if the first argument is neither a Semaphore nor nil.
	Fail if the second argument is not an integer (either SmallInteger or LargePositiveInteger).
	See #primUtcMicrosecondClock
	 Essential. See Object documentation whatIsAPrimitive."
	<primitive: 242>
	^self primitiveFailed! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3061-UTCDelayedSignalPrimitive-JuanVuletich-2017Mar07-12h16m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3061] on 7 March 2017 at 2:55:27 pm'!

BorderedRectMorph subclass: #MenuMorph
	instanceVariableNames: 'defaultTarget selectedItem stayUp titleMorph activeSubMenu popUpOwner '
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Menus'!

!classDefinition: #MenuMorph category: #'Morphic-Menus'!
BorderedRectMorph subclass: #MenuMorph
	instanceVariableNames: 'defaultTarget selectedItem stayUp titleMorph activeSubMenu popUpOwner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Menus'!
!MenuMorph methodsFor: 'control' stamp: 'ar 9/17/2000 20:38'!
   activeSubmenu: aSubmenu
	activeSubMenu ifNotNil:[activeSubMenu delete].
	activeSubMenu _ aSubmenu.! !
!MenuMorph methodsFor: 'initialization' stamp: 'ar 10/10/2000 01:57'!
                    delete
	activeSubMenu ifNotNil:[activeSubMenu delete].
	^super delete! !
!MenuItemMorph methodsFor: 'events' stamp: 'jmv 9/20/2012 00:14'!
                     activateOwnerMenu: evt
	"Activate our owner menu; e.g., pass control to it"
	owner ifNil: [ ^false ]. "not applicable"
	(owner morphContainsPoint: (owner internalizeFromWorld: evt eventPosition))
		ifFalse: [ ^false ].
	owner activate: evt.
	^true! !
!MenuMorph methodsFor: 'control' stamp: 'jmv 3/7/2017 14:37:43' prior: 50339178!
                    deleteIfPopUp: evt
	"Remove this menu from the screen if stayUp is not true. If it is a submenu, also remove its owning menu."

	stayUp ifFalse: [ self delete ].
	popUpOwner ifNotNil: [
		popUpOwner isSelected: false.
		popUpOwner deleteIfPopUp: evt ].
	evt ifNotNil: [ evt hand ifNotNil: [ :h | h releaseMouseFocus: self ]]! !
!MenuMorph methodsFor: 'control' stamp: 'jmv 5/9/2016 20:40' prior: 50339187!
          popUpAdjacentTo: rightOrLeftPointInWorld from: sourceItem
	"Present this menu at the given point under control of the given hand.
	Used mostly for submenus."

	| delta tryToPlace selectedOffset |
	popUpOwner _ sourceItem.
	selectedOffset _ (selectedItem ifNil: [ self items first ]) morphPosition.
	sourceItem world addMorphFront: self.

	tryToPlace _ [ :where :mustFit |
		self morphPosition: where - selectedOffset.
		delta _ self morphFullBoundsInWorld
			amountToTranslateWithin: sourceItem world morphBoundsInWorld.
		(delta x = 0 | mustFit) ifTrue: [
			delta = (0@0) ifFalse: [ self morphPosition: self morphPosition + delta ].
			^ self]].
	tryToPlace 
		value: rightOrLeftPointInWorld first value: false;
		value: rightOrLeftPointInWorld last - (extent x @ 0) value: false;
		value: rightOrLeftPointInWorld first value: true! !
!MenuMorph methodsFor: 'events-processing' stamp: 'jmv 8/20/2012 17:50' prior: 50339326!
  handleFocusEvent: aMorphicEvent
	"Handle focus events. Valid menu transitions are determined based on the menu currently holding the focus after the mouse went down on one of its children."
	| eventPositionInOurCoordinates |
	eventPositionInOurCoordinates _ self internalizeFromWorld: aMorphicEvent eventPosition.

	self dispatchEvent: aMorphicEvent localPosition: eventPositionInOurCoordinates.

	"Need to handle keyboard input if we have the focus."
	aMorphicEvent isKeyboard ifTrue: [ ^ aMorphicEvent sentTo: self localPosition: eventPositionInOurCoordinates].

	"We need to handle button clicks outside and transitions to local popUps so throw away everything else"
	(aMorphicEvent isMouseOver or: [aMorphicEvent isMouse not]) ifTrue: [ ^self ].
	"What remains are mouse buttons and moves"
	aMorphicEvent isMove ifFalse: [ ^ aMorphicEvent sentTo: self localPosition: eventPositionInOurCoordinates ]. "handle clicks outside by regular means"
	"Now it's getting tricky. On #mouseMove we might transfer control to *either* the currently active submenu or the pop up owner, if any. Since the active sub menu is always displayed upfront check it first."
	selectedItem ifNotNil:[(selectedItem activateSubmenu: aMorphicEvent) ifTrue: [^self]].
	"Note: The following does not traverse upwards but it's the best I can do for now"
	popUpOwner ifNotNil:[(popUpOwner activateOwnerMenu: aMorphicEvent) ifTrue: [^self]].! !
!MenuMorph methodsFor: 'initialization' stamp: 'jmv 9/8/2012 20:15' prior: 50339368!
     initialize
	super initialize.
	extent _ 40@10.
	defaultTarget _ nil.
	selectedItem _ nil.
	stayUp _ false.
	popUpOwner _ nil! !
!MenuItemMorph methodsFor: 'selecting' stamp: 'jmv 1/29/2014 23:46' prior: 50339381!
           deselect

	self isSelected: false.
	subMenu ifNotNil: [
		owner ifNotNil:[ owner activeSubmenu: nil ].
		self removeAlarm: #deselectTimeOut ]! !
!MenuItemMorph methodsFor: 'selecting' stamp: 'jmv 1/29/2014 23:44' prior: 50339387!
                          select
	self isSelected: true.
	owner activeSubmenu: subMenu.
	subMenu ifNotNil: [
		subMenu delete.
		subMenu
			popUpAdjacentTo: (Array with: self morphBoundsInWorld topRight + (10@0)
									with: self morphBoundsInWorld topLeft)
			from: self.
		subMenu selectItem: nil ]! !

BorderedRectMorph subclass: #MenuMorph
	instanceVariableNames: 'defaultTarget selectedItem stayUp titleMorph activeSubMenu popUpOwner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Menus'!

!classDefinition: #MenuMorph category: #'Morphic-Menus'!
BorderedRectMorph subclass: #MenuMorph
	instanceVariableNames: 'defaultTarget selectedItem stayUp titleMorph activeSubMenu popUpOwner'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Morphic-Menus'!

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3062-FixRecentMenuBreackage-JuanVuletich-2017Mar07-14h20m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3049] on 7 March 2017 at 3:18:07 pm'!
!TestCase methodsFor: 'Private' stamp: 'HAW 3/6/2017 14:55:23'!
                               methodForTest

	"Can not call it testMethod because it will be detected as test - Hernan" 

	^self class lookupSelector: self selector! !
!TestCase methodsFor: 'Private' stamp: 'HAW 3/6/2017 14:55:38' prior: 50340560!
      ifCanNotDebugDo: handler

	^self methodForTest isQuick ifTrue: handler! !
!TestCase methodsFor: 'Private' stamp: 'HAW 3/6/2017 14:55:45' prior: 50340614!
      openDebuggerOnFailingTestMethod

	| guineaPig context compiledMethod debugger |

	compiledMethod _ self methodForTest.
	guineaPig _ [ self performTest ] newProcess.
	context _ guineaPig suspendedContext.
	debugger _ Debugger new
		process: guineaPig
		context: context.
	debugger openFullNoSuspendLabel: 'Debug failed test ', self printString.

	[debugger interruptedContext method == compiledMethod]
		whileFalse: [debugger send].
! !
!TestCase methodsFor: 'Private' stamp: 'HAW 3/6/2017 14:55:50' prior: 50340631!
                            openDebuggerOnFailingTestMethod: semaphore

	| guineaPig context compiledMethod debugger |

	compiledMethod _ self methodForTest.
	guineaPig _ [ self performTest ] newProcess.
	context _ guineaPig suspendedContext.
	debugger _ TestCaseDebugger new
		process: guineaPig
		context: context.
	debugger doneSemaphore: semaphore.
	debugger openFullNoSuspendLabel: 'Debug failed test ', self printString.

	[debugger interruptedContext method == compiledMethod]
		whileFalse: [debugger send].
! !

TestCase removeSelector: #testMethod!

TestCase removeSelector: #testMethod!

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3063-FixForExtraTest-HernanWilkinson-2017Mar03-19h15m-HAW.1.cs.st----!

----SNAPSHOT----#(8 March 2017 9:10:16.580592 am) Cuis5.0-3063-spur-64.image priorSource: 293543!

----QUIT----#(8 March 2017 9:10:32.980626 am) Cuis5.0-3063-spur-64.image priorSource: 306790!

----STARTUP----#(13 March 2017 4:27:27.626002 pm) as /home/juan/Rectifier/Cuis-Smalltalk-Dev/Cuis5.0-3063-spur-64.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3063] on 13 March 2017 at 4:16:45 pm'!
!WriteStream methodsFor: 'accessing' stamp: 'jmv 3/12/2017 18:55:36' prior: 50335208!
           nextPutAllString: aString withAttributes: attributesArray

	| newEnd |
	(self isCompatibleWithContents: aString)
		ifFalse: [ ^ self nextPutAll: aString ].

	newEnd _ position + aString size.
	newEnd > writeLimit ifTrue: [
		self growTo: newEnd + 10].

	collection
		replaceFrom: position+1
		to: newEnd 
		withString: aString
		attributes: attributesArray
		startingAt: 1.
	position _ newEnd! !
!WriteStream methodsFor: 'private' stamp: 'jmv 3/12/2017 19:08:07' prior: 16946568!
growTo: anInteger
	"Grow the collection by creating a new bigger collection and then
	copy over the contents from the old one. We grow by doubling the size.

	anInteger is the required minimal new size of the collection "

	| oldSize grownCollection newSize |
	oldSize _ collection size.
     newSize _ anInteger + (oldSize max: 20).
	grownCollection _ collection class new: newSize.
	collection _ grownCollection replaceFrom: 1 to: oldSize with: collection startingAt: 1.
	writeLimit _ collection size! !
!WriteStream methodsFor: 'private' stamp: 'jmv 3/12/2017 19:07:28' prior: 16946596!
                  pastEndPut: anObject
	"Grow the collection.
	Then we put <anObject> at the current write position."

	self growTo: collection size + 1.
	collection at: (position _ position + 1) put: anObject! !

----End fileIn of /home/juan/Rectifier/Cuis-Smalltalk-Dev/CoreUpdates/3064-WriteStreamTweaks-JuanVuletich-2017Mar13-16h06m-jmv.1.cs.st----!

----SNAPSHOT----#(13 March 2017 4:27:36.062745 pm) Cuis5.0-3064-spur-64.image priorSource: 306889!

----QUIT----#(13 March 2017 4:27:47.296681 pm) Cuis5.0-3064-spur-64.image priorSource: 308719!

----STARTUP----#(19 March 2017 8:11:18.86056 pm) as /root/PayloadSoftware/Cuis-Smalltalk-Dev/Cuis5.0-3064-spur-64.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3064] on 15 March 2017 at 2:07:10 pm'!
!RealEstateAgent class methodsFor: 'as yet unclassified' stamp: 'jmv 3/15/2017 14:06:54' prior: 50337461!
            maximumUsableAreaInWorld: aWorldOrNil

	| allowedArea |
	allowedArea _ Display boundingBox.
	aWorldOrNil ifNotNil: [
		allowedArea _ allowedArea intersect: aWorldOrNil viewBox.
		aWorldOrNil taskbar ifNotNil: [ :tb |
			tb morphBoundsInWorld ifNotNil: [ :r |
				allowedArea _ (allowedArea areasOutside: r) first ]]].
	^allowedArea
! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3065-TaskbarFix-JuanVuletich-2017Mar15-14h03m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3064] on 17 March 2017 at 10:25:22 am'!
!Debugger methodsFor: 'method creation' stamp: 'HAW 3/17/2017 10:24:51' prior: 50336720!
                    createMethodWhenDoesNotUndertand

	| message chosenClass interruptedContext |
	
	"The doesNotUndertand context must be selected - Hernan"
	contextStackIndex = 1 ifFalse: [ self contextStackIndex: 1 oldContextWas: self selectedContext ].
		
	interruptedContext _ self interruptedContext.
	message _ interruptedContext tempAt: 1.
	
	chosenClass _ self
		askForSuperclassOf: interruptedContext receiver class
		toImplement: message selector
		ifCancel: [^self].
	
	self implement: message inClass: chosenClass context: self selectedContext

! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3066-CreateMissingMethodInDebuggerFix-HernanWilkinson-2017Mar16-20h05m-HAW.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3064] on 18 March 2017 at 10:47:28 am'!
!SmalltalkEditor class methodsFor: 'keyboard shortcut tables' stamp: 'HAW 3/18/2017 10:44:48' prior: 50338485!
                       cmdShortcutsSpec
	"
	Editor initialize
	"
	"arranged in QWERTY keyboard order"
	^#(
		#(		$r	#acceptAndDebugTest:		'Saves method and debugs it')
		#(		$t	#acceptAndTest:				'Saves method, runs it as test and then all tests in class. Opens debugger if error')
		#(		$y	#acceptAndTestAll:				'Saves method, runs it as test and then all tests in class category. Opens debugger if error')
		#(		$i	#inspectIt:							'Inspect it (selection is a valid expression, or selection is over an inspect-ilst)')
		#(		$p	#printIt:								'Print it (selection is a valid expression)')

		#(		$s	#save:								'Save (i.e. accept)')
		#(		$d	#doIt:								'Do it (selection is a valid expression)')
		#(		$l	#cancelEdits:						'Cancel')

		#(		$b	#browseIt:							'Browse it (selection is a class name or cursor is over a class-list or message-list)')
		#(		$n	#sendersOfIt:						'Senders of it (selection is a message selector or cursor is over a class-list or message-list)')
		#(		$m	#implementorsOfIt:				'Implementors of it (selection is a message selector or cursor is over a class-list or message-list)')

		#(		$E	#methodStringsContainingit:'Method strings containing it')
		#(		$T	#displayIfTrue:					'Insert #ifTrue:')
		#(		$I	#exploreIt:							'Inspect via Object Explorer')

		#(		$A	#argAdvance:						'Advance argument')
		#(		$D	#debugIt:							'Debug it')
		#(		$F	#displayIfFalse:					'Insert #ifFalse:')
		#(		$G	#fileItIn:							'File in selection')

		#(		$V	#pasteInitials:					'Paste author initials')
		#(		$N	#referencesToIt:					'References to it (selection is a class name, or cursor is over a class-list or message-list)')
	)! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3067-FixATypo-HernanWilkinson-2017Mar18-10h44m-HAW.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3064] on 18 March 2017 at 8:30:03 pm'!
!TheWorldMenu methodsFor: 'construction' stamp: 'HAW 3/18/2017 20:26:59' prior: 16934784!
                            buildWorldMenu
	"Build the menu that is put up when the screen-desktop is clicked on"

	| menu |
	menu _ MenuMorph new defaultTarget: self.
	self colorForDebugging: menu.
	menu addStayUpIcons.
	self fillIn: menu
		from: {
				{ 'Open...'. { self. #openWindow}}.
				{ 'New morph...'. { self. #newMorph}.
					'Offers a variety of ways to create new objects'}.
				{ 'Preferences...'. { self. #preferencesDo}.
					'put up a menu offering many controls over appearance and system preferences.'}.
				{ 'Windows...'. { self. #windowsDo}}.
				{ 'Help...'. { self. #helpDo}.
					'puts up a menu of useful items for updating the system, determining what version you are running, and much else'}.
				nil.
				{ 'Changes...'. { self. #changesDo}}.
				{ 'Debug...'. { self. #debugDo}.
					'a menu of debugging items'}.
				{ 'Restore Display (r)'. { myWorld. #restoreMorphicDisplay}.
					'repaint the screen -- useful for removing unwanted display artifacts, lingering cursors, etc.'}.
				nil.
				{ 'Save'. { Smalltalk . #saveSession}.
					'save the current version of the image on disk'}.
				{ 'Save as...'. { Smalltalk . #saveAs}.
					'save the current version of the image on disk under a new name.'}.
				{ 'Save as New Version'. { Smalltalk . #saveAsNewVersion}.
					'give the current image a new version-stamped name\and save it under that name on disk.\Clear all user preferences and user state (class vars).' withNewLines}.
				{ 'Save and Quit'. { self. #saveAndQuit}.
					'save the image and quit out of Cuis.'}.				
				{ 'Quit'. { self. #quitSession}.
					'quit out of Cuis.'}}.
	^menu! !

TheWorldMenu removeSelector: #saveAndQuitSession!

TheWorldMenu removeSelector: #saveMenu!

TheWorldMenu removeSelector: #saveMenu!

TheWorldMenu removeSelector: #saveOptionsDo!

TheWorldMenu removeSelector: #saveOptionsDo!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3068-SaveMenuIntegrationInWorldMenu-HernanWilkinson-2017Mar18-10h53m-HAW.1.cs.st----!

----SNAPSHOT----#(19 March 2017 8:11:24.98593 pm) Cuis5.0-3068-spur-64.image priorSource: 308819!

----QUIT----#(19 March 2017 8:11:36.879466 pm) Cuis5.0-3068-spur-64.image priorSource: 314821!

----STARTUP----#(16 April 2017 9:01:55.583301 pm) as /root/PayloadSoftware/Cuis-Smalltalk-Dev/Cuis5.0-3068-spur-64.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3068] on 26 March 2017 at 11:30:12 pm'!
!Theme class methodsFor: 'class initialization' stamp: 'jmv 3/26/2017 23:25:17' prior: 16936878!
                              currentTheme: aTheme

	CurrentTheme := aTheme new.
	SHTextStylerST80 initialize.
	self runningWorld ifNotNil: [ :w |
		w backgroundImage ifNil: [
			w color: CurrentTheme background ]].
	SystemWindow initialize.
	BitBltCanvas releaseClassCachedState.
	self runningWorld ifNotNil: [ :w |
		CurrentTheme useTaskbar
			ifTrue: [w showTaskbar]
			ifFalse: [w hideTaskbar].
		w restoreMorphicDisplay ].
	
	^ CurrentTheme! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3069-Theme-fix-JuanVuletich-2017Mar26-23h30m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3064] on 25 March 2017 at 10:48:23 am'!
!BasicClassOrganizer methodsFor: 'accessing' stamp: 'HAW 3/25/2017 10:48:00' prior: 16782575!
                             classComment: aString 
	"Store the comment, aString, associated with the object that refers to the 
	receiver."

	aString ifNil: [ ^classComment _ nil ].
	
	aString isRemote
		ifTrue: [classComment _ aString]
		ifFalse: [aString size = 0
			ifTrue: [classComment _ nil]
			ifFalse: [
				self error: 'use aClass classComment:'.
				classComment _ RemoteString newString: aString onFileNumber: 2]]
				"Later add priorSource and date and initials?"! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3070-ClassCommentSetterFix-HernanWilkinson-2017Mar25-10h47m-HAW.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3064] on 27 March 2017 at 9:11:54 am'!
!Delay class methodsFor: 'instance creation' stamp: 'HAW 3/27/2017 09:08:00' prior: 16832891!
               forDuration: aDuration

	^ self forMilliseconds: aDuration totalMilliseconds! !

Duration removeSelector: #totalMilliSeconds!

Duration removeSelector: #totalMilliSeconds!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3071-Remove-totalMilliSeconds-HernanWilkinson-2017Mar27-09h08m-HAW.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3068] on 30 March 2017 at 8:42:47 am'!
!Morph methodsFor: 'user interface' stamp: 'jmv 3/30/2017 08:41:08'!
                            toggleCollapseOrShow
	"If collapsed, show me.
	If visible, collapse me."

	self visible
		ifTrue:  [ self collapse ]
		ifFalse: [ self showAndComeToFront ]! !
!Morph methodsFor: 'user interface' stamp: 'jmv 3/30/2017 08:38:46' prior: 50337398!
            collapse
	"If taskbar not visible, just hide."

	self hide.
	self taskbar
		ifNotNil: [ :tb | tb wasCollapsed: self ]! !
!Morph methodsFor: 'user interface' stamp: 'jmv 3/30/2017 08:38:12' prior: 50337113!
                  showAndComeToFront
	"Make me visible if not, set me on top of all other sibling morphs."
	self show; comeToFront! !
!TaskbarMorph methodsFor: 'services' stamp: 'jmv 3/30/2017 08:41:28' prior: 50337694!
                      addButtonFor: aMorph

	| button |
	aMorph == self ifFalse: [
		button _ PluggableButtonMorph
			model: aMorph
			stateGetter: nil
			action: #toggleCollapseOrShow.
		button
			color: self color;
			icon: (aMorph imageForm: 32);
			setBalloonText: aMorph label.
		button icon: button magnifiedIcon.
		viewBox
			addMorph: button
			fixedWidth: self defaultHeight ]! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3072-taskbarButtonTogglesCollapsing-JuanVuletich-2017Mar30-08h36m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3072] on 30 March 2017 at 8:57:52 am'!
!TaskbarMorph methodsFor: 'services' stamp: 'jmv 3/30/2017 08:54:49'!
                     aboutToCollapse: aMorph
	"Add a button for aMorph if not already there (see #taskbarIncludesAllWindows)"

	(self buttonFor: aMorph) ifNil: [
		self addButtonFor: aMorph ]! !
!Morph methodsFor: 'user interface' stamp: 'jmv 3/30/2017 08:55:31' prior: 50341576!
                             collapse
	"If taskbar not visible, just hide."

	self taskbar
		ifNotNil: [ :tb | tb aboutToCollapse: self ].
	self hide! !

TaskbarMorph removeSelector: #wasCollapsed:!

TaskbarMorph removeSelector: #wasCollapsed:!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3073-TaskbarFix-JuanVuletich-2017Mar30-08h57m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3064] on 29 March 2017 at 5:18:04 pm'!

Object subclass: #ExceptionHandlingCondition
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Exceptions Kernel'!

!classDefinition: #ExceptionHandlingCondition category: #'Exceptions Kernel'!
Object subclass: #ExceptionHandlingCondition
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Exceptions Kernel'!
!ExceptionHandlingCondition commentStamp: '<historical>' prior: 0!
       I represent the protocol expected to be as condition on the exception handling message on:do:
I also define the protocol to create and combine exceptions handling conditions.
See methods #, and #- for a complemented documentation!
!ExceptionHandlingCondition commentStamp: '<historical>' prior: 50341649!
               I represent the protocol expected to be as condition on the exception handling message on:do:
I also define the protocol to create and combine exceptions handling conditions.
See methods #, and #- for a complemented documentation!

Smalltalk renameClassNamed: #ExceptionFilter as: #FilterExceptionHandlingCondition!

ExceptionHandlingCondition subclass: #FilterExceptionHandlingCondition
	instanceVariableNames: 'handleCondition filterCondition'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Exceptions Kernel'!

!classDefinition: #FilterExceptionHandlingCondition category: #'Exceptions Kernel'!
ExceptionHandlingCondition subclass: #FilterExceptionHandlingCondition
	instanceVariableNames: 'handleCondition filterCondition'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Exceptions Kernel'!

Smalltalk renameClassNamed: #ExceptionAdd as: #OrExceptionHandlingCondition!

ExceptionHandlingCondition subclass: #OrExceptionHandlingCondition
	instanceVariableNames: 'leftCondition rightCondition'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Exceptions Kernel'!

!classDefinition: #OrExceptionHandlingCondition category: #'Exceptions Kernel'!
ExceptionHandlingCondition subclass: #OrExceptionHandlingCondition
	instanceVariableNames: 'leftCondition rightCondition'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Exceptions Kernel'!
!BlockClosure methodsFor: 'error handing' stamp: 'HAW 3/29/2017 15:16:01'!
                     handles: anException

	"This allows a block to be the handling condition of an exception handling.
	See Exception class>>handles:"
	
	^self value: anException ! !
!Exception class methodsFor: 'handling condition creation' stamp: 'HAW 3/28/2017 15:48:57' prior: 16840211!
                 , anExceptionHandlingCondition

	"See ExceptionHandlingCondition>>,"
	
	^anExceptionHandlingCondition createOrConditionWithExceptionType: self! !
!Exception class methodsFor: 'handling condition creation' stamp: 'HAW 3/28/2017 15:49:08'!
                  - anExceptionHandlingCondition

	"See ExceptionHandlingCondition>>-"

	^anExceptionHandlingCondition createFilterConditionWithExceptionType: self! !
!Exception class methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 11:23:04'!
     createFilterConditionWithExceptionType: anExceptionType

	^FilterExceptionHandlingCondition handling: anExceptionType filtering: self! !
!Exception class methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 11:26:42'!
                 createFilterConditionWithFilterCondition: aFilterExceptionHandlingCondition 
	
	^FilterExceptionHandlingCondition handling: aFilterExceptionHandlingCondition filtering: self! !
!Exception class methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 15:40:33'!
         createFilterConditionWithOrCondition: anOrExceptionHandlingCondition 
	
	^FilterExceptionHandlingCondition handling: anOrExceptionHandlingCondition filtering: self! !
!Exception class methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 15:37:59'!
                   createOrConditionWithExceptionType: anExceptionType

	^OrExceptionHandlingCondition handling: anExceptionType or: self
! !
!Exception class methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 15:48:29'!
                               createOrConditionWithFilterCondition: aFilterExceptionHandlingCondition 
	
	^aFilterExceptionHandlingCondition handleCondition, self - aFilterExceptionHandlingCondition filterCondition 
	
	! !
!Exception class methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 11:09:54'!
                         createOrConditionWithOrCondition: anOrExceptionHandlingCondition 
	
	^OrExceptionHandlingCondition handling: anOrExceptionHandlingCondition or: self! !
!ExceptionHandlingCondition methodsFor: 'error handling' stamp: 'HAW 3/28/2017 17:29:18'!
              handles: anException 
	
	"Must return true if anException must be handle
	See also Exception class>>handles: anException"
	
	self subclassResponsibility ! !
!ExceptionHandlingCondition methodsFor: 'handling condition creation' stamp: 'HAW 3/28/2017 17:17:36'!
                            , anExceptionHandlingCondition

	"Creates a handling condition that will return true if either part of the condition handles the exception.
	It behaves like an or
	The following example will handle the exception
	[ Error signal ]
	   on:  Error, Halt 
	  do: [ :anError | ... ]
	
	The following example will also handle the exception:
	[ Halt signal ]
	   on:  Error, Halt
	  do: [ :anError | ... ]"
	
	self subclassResponsibility 
	! !
!ExceptionHandlingCondition methodsFor: 'handling condition creation' stamp: 'HAW 3/29/2017 13:59:37'!
    - anExceptionHandlingCondition

	"Creates a handling condition that will not handle exceptions that meet the right side of the condition
	The following example will not handle the exception
	[ 1/0 ]
	   on:  Error - ZeroDivide 
	  do: [ :anError | ... ]
	
	The following example will handle the exception:
	[ Error signal ]
	   on:  Error - ZeroDivide 
	  do: [ :anError | ... ]
	
	Due to inconsisties that can arrise with combining #, with #- the implementation orders the in such a way that 'or conditions' go first 
	and 'filter conditions' go last. Doing so (Error - Notification) , (UnhandledError - ZeroDivide)  is converted to  Error, UnhandledError - Notification - ZeroDivide 
	Inconsisties can arrise because ZeroDivide is a subclass of Error and therefore if the condition is not ordered correctly a ZeroDivide could be handled.
	This inconsisty can be found in Pharo where the condition (Error - Notification) , (UnhandledError - ZeroDivide) does not filter ZeroDivide but 
	the condition Error, UnhandledError - Notification - ZeroDivide does filter it.
	That is the reason the implementation uses double dispatch
	"
	
	self subclassResponsibility 
	! !
!ExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/29/2017 13:31:13'!
createFilterConditionWithExceptionType: anExceptionType

	self subclassResponsibility ! !
!ExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/29/2017 13:33:31'!
                     createFilterConditionWithFilterCondition: aFilterExceptionHandlingCondition 

	self subclassResponsibility ! !
!ExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/29/2017 13:33:39'!
createFilterConditionWithOrCondition: anOrExceptionHandlingCondition 

	self subclassResponsibility ! !
!ExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/29/2017 13:33:51'!
       createOrConditionWithExceptionType: anExceptionType

	self subclassResponsibility ! !
!ExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/29/2017 13:34:31'!
                         createOrConditionWithFilterCondition: aFilterExceptionHandlingCondition 

	self subclassResponsibility ! !
!ExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/29/2017 13:34:42'!
    createOrConditionWithOrCondition: anOrExceptionHandlingCondition 

	self subclassResponsibility ! !
!FilterExceptionHandlingCondition methodsFor: 'accessing' stamp: 'HAW 3/28/2017 17:20:21'!
 filterCondition
	
	^filterCondition ! !
!FilterExceptionHandlingCondition methodsFor: 'accessing' stamp: 'HAW 3/28/2017 17:20:26'!
                             handleCondition
	
	^handleCondition ! !
!FilterExceptionHandlingCondition methodsFor: 'error handling' stamp: 'HAW 3/28/2017 17:20:41'!
                        handles: anException 
	
	^ (filterCondition handles: anException) not and: [ handleCondition handles: anException ]! !
!FilterExceptionHandlingCondition methodsFor: 'initialization' stamp: 'HAW 3/29/2017 13:45:21'!
         initializeHandling: aHandleCondition filtering: aFilterCondition 

	handleCondition _ aHandleCondition.
	filterCondition _ aFilterCondition ! !
!FilterExceptionHandlingCondition methodsFor: 'handling condition creation' stamp: 'HAW 3/29/2017 13:59:08'!
   , anExceptionHandlingCondition

	"See ExceptionHandlingCondition>>#- for an explanation of why double dispatch is used as implementation"
	
	^anExceptionHandlingCondition createOrConditionWithFilterCondition: self! !
!FilterExceptionHandlingCondition methodsFor: 'handling condition creation' stamp: 'HAW 3/29/2017 13:59:00'!
                          - anExceptionHandlingCondition

	"See ExceptionHandlingCondition>>#- for an explanation of why double dispatch is used as implementation"
	
	^anExceptionHandlingCondition createFilterConditionWithFilterCondition: self! !
!FilterExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 17:56:46'!
            createFilterConditionWithExceptionType: anExceptionType

	^self class 
		handling: anExceptionType, filterCondition 
		filtering: handleCondition ! !
!FilterExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 17:19:24'!
                   createFilterConditionWithFilterCondition: aFilterExceptionHandlingCondition 
	
	^aFilterExceptionHandlingCondition - handleCondition, filterCondition ! !
!FilterExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 17:19:48'!
               createFilterConditionWithOrCondition: anOrExceptionHandlingCondition 
	
	^anOrExceptionHandlingCondition, filterCondition - handleCondition ! !
!FilterExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 17:19:56'!
                         createOrConditionWithExceptionType: anExceptionType

	^anExceptionType - handleCondition - filterCondition ! !
!FilterExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 17:20:04'!
                          createOrConditionWithFilterCondition: aFilterExceptionHandlingCondition 
	
	^aFilterExceptionHandlingCondition handleCondition,handleCondition - aFilterExceptionHandlingCondition filterCondition - filterCondition ! !
!FilterExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/29/2017 15:32:33'!
                createOrConditionWithOrCondition: anOrExceptionHandlingCondition 
	
	^anOrExceptionHandlingCondition, handleCondition - filterCondition ! !
!FilterExceptionHandlingCondition methodsFor: 'printing' stamp: 'HAW 3/28/2017 17:20:55'!
                          printOn: aStream

	aStream
		print: handleCondition ;
		nextPutAll: ' - ';
		print: filterCondition ! !
!FilterExceptionHandlingCondition class methodsFor: 'instance creation' stamp: 'HAW 3/28/2017 17:18:11'!
               handling: aHandleCondition filtering: aFilterCondition 
	
	^self new initializeHandling: aHandleCondition filtering: aFilterCondition 
! !
!OrExceptionHandlingCondition methodsFor: 'accessing' stamp: 'HAW 3/28/2017 17:55:27'!
                              leftCondition

	^leftCondition ! !
!OrExceptionHandlingCondition methodsFor: 'accessing' stamp: 'HAW 3/28/2017 17:56:11'!
      rightCondition

	^rightCondition ! !
!OrExceptionHandlingCondition methodsFor: 'error handling' stamp: 'HAW 3/28/2017 17:31:39'!
                               handles: anException

	^ (leftCondition handles: anException) or: [ rightCondition handles: anException ]! !
!OrExceptionHandlingCondition methodsFor: 'initialization' stamp: 'HAW 3/28/2017 17:32:20'!
                       initializeHandling: aLeftCondition or: aRightCondition

	leftCondition _ aLeftCondition.
	rightCondition _ aRightCondition ! !
!OrExceptionHandlingCondition methodsFor: 'handling condition creation' stamp: 'HAW 3/29/2017 13:59:16'!
                        , anExceptionHandlingCondition

	"See ExceptionHandlingCondition>>#- for an explanation of why double dispatch is used as implementation"
	
	^anExceptionHandlingCondition createOrConditionWithOrCondition: self
	! !
!OrExceptionHandlingCondition methodsFor: 'handling condition creation' stamp: 'HAW 3/29/2017 13:59:22'!
- anExceptionHandlingCondition

	"See ExceptionHandlingCondition>>#- for an explanation of why double dispatch is used as implementation"
	
	^anExceptionHandlingCondition createFilterConditionWithOrCondition: self
	! !
!OrExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 17:32:37'!
                  createFilterConditionWithExceptionType: anExceptionType

	^FilterExceptionHandlingCondition 
		handling: anExceptionType - leftCondition 
		filtering: rightCondition ! !
!OrExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 17:33:37'!
   createFilterConditionWithFilterCondition: aFilterExceptionHandlingCondition 
	
	^aFilterExceptionHandlingCondition - leftCondition - rightCondition ! !
!OrExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 17:34:05'!
                     createFilterConditionWithOrCondition: anOrExceptionHandlingCondition 
	
	^ anOrExceptionHandlingCondition - leftCondition - rightCondition ! !
!OrExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 11:16:37'!
                              createOrConditionWithExceptionType: anExceptionType

	^self class handling: anExceptionType or: self! !
!OrExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 14:56:09'!
     createOrConditionWithFilterCondition: aFilterExceptionHandlingCondition 
	
	^self, aFilterExceptionHandlingCondition ! !
!OrExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/28/2017 11:20:32'!
                    createOrConditionWithOrCondition: anOrExceptionHandlingCondition 
	
	^self class handling: anOrExceptionHandlingCondition or: self! !
!OrExceptionHandlingCondition methodsFor: 'printing' stamp: 'HAW 3/28/2017 17:54:46'!
    printOn: aStream
	
	aStream
		print: leftCondition;
		nextPutAll: ', ';
		print: rightCondition ! !
!OrExceptionHandlingCondition class methodsFor: 'instance creation' stamp: 'HAW 3/27/2017 15:47:32'!
                       handling: anExceptionClass or: anotherExceptionClass
 
	^self new initializeHandling: anExceptionClass or: anotherExceptionClass
! !

OrExceptionHandlingCondition removeSelector: #createOrHandlingConditionWithOrHandlingCondition:!

Exception class removeSelector: #createFilterConditionWithExceptionClass:!

Exception class removeSelector: #createHandlingConditionWithExceptionClass:!

Exception class removeSelector: #handling:!

Exception class removeSelector: #orHandlingExceptionClass:!

Smalltalk removeClassNamed: #ExceptionSet!

Smalltalk removeClassNamed: #ExceptionSet!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3074-ExceptionHandlingConditionEnh-HernanWilkinson-2017Mar26-18h04m-HAW.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3064] on 29 March 2017 at 6:09:56 pm'!
!FilterExceptionHandlingCondition methodsFor: 'handling condition creation - private' stamp: 'HAW 3/29/2017 17:59:55' prior: 50341963!
                              createOrConditionWithExceptionType: anExceptionType

	^anExceptionType, handleCondition - filterCondition ! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3075-ExceptionHandlingConditionFix-HernanWilkinson-2017Mar29-17h18m-HAW.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3068] on 16 April 2017 at 7:53:58 pm'!
!TextEditor methodsFor: 'menu messages' stamp: 'jmv 4/16/2017 19:53:14' prior: 16932110!
 compareToClipboard
	"Check to see if whether the receiver's text is the same as the text currently on the clipboard, and inform the user."
	| s1 s2 |
	s1 _ self clipboardStringOrText string.
	s2 _ self selection ifEmpty: [self privateCurrentString].
	s1 = s2 ifTrue: [^ self inform: 'Exact match'].

	(TextModel new contents:
		(DifferenceFinder displayPatchFrom: s1 to: s2 tryWords: true))
			openLabel: 'Comparison to Clipboard Text'! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3076-CompareToClipboardComparesSelection-JuanVuletich-2017Apr16-19h53m-jmv.1.cs.st----!

----SNAPSHOT----#(16 April 2017 9:02:02.273545 pm) Cuis5.0-3076-spur-64.image priorSource: 314920!

----QUIT----#(16 April 2017 9:02:15.23247 pm) Cuis5.0-3076-spur-64.image priorSource: 336694!

----STARTUP----#(14 May 2017 7:55:36.65277 pm) as /root/PayloadSoftware/Cuis-Smalltalk-Dev/Cuis5.0-3076-spur-64.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3076] on 13 May 2017 at 12:54:11 pm'!
!Integer methodsFor: 'printing' stamp: 'jmv 5/9/2017 19:45:38'!
                   printOn: aStream length: minimum zeroPadded: zeroFlag
	"
	7 printOn: Transcript length: 4 padded: true. Transcript newLine.
	"
	self printOn: aStream base: 10 length: minimum padded: zeroFlag! !
!Character methodsFor: 'accessing' stamp: 'jmv 5/9/2017 19:49:32' prior: 16800371!
          digitValue
	"Answer 0-9 if the receiver is $0-$9, 10-35 if it is $A-$Z, and < 0 
	otherwise. This is used to parse literal numbers of radix 2-36.
	$0 numericValue = 48
	$9 numericValue = 57
	$A numericValue = 65
	$Z numericValue = 90 
	$7 digitValue = 7 
	"

	| nv |
	nv _ self numericValue.
	(nv between: 48 and: 57)
		ifTrue: [ ^ nv - 48 ].
	(nv between: 65 and: 90)
		ifTrue: [ ^ nv - 55 ].
	^ -1! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3077-Integer-printPadded-JuanVuletich-2017May13-12h51m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3076] on 13 May 2017 at 1:02:33 pm'!
!Timespan class methodsFor: 'squeak protocol' stamp: 'jmv 5/9/2017 19:54:38'!
                      fromString: aString
	"Please call with specific subclass."

	^ self readFrom: aString readStream! !
!Week class methodsFor: 'squeak protocol' stamp: 'jmv 5/12/2017 17:48:37'!
                 readFrom: aStream 
	"Read a Week from the stream in any of the forms:  
		<year>-W<week>			(2009-W01) (ISO8601)"
	| weekNumber yearNumber firstAsNumber firstAsNumberSign |
	firstAsNumberSign := aStream peek = $- ifTrue: [-1] ifFalse: [1].
	[aStream peek isAlphaNumeric] whileFalse: [aStream skip: 1].
	aStream peek isDigit ifTrue: [
		firstAsNumber := (Integer readFrom: aStream) * firstAsNumberSign.
		(firstAsNumber < 0 or: [firstAsNumber > 12])
			ifTrue: [yearNumber := firstAsNumber]].

	[aStream peek isAlphaNumeric] whileFalse: [aStream skip: 1].
	aStream next = $W ifFalse: [
		self error: 'Invalid Format' ].

	weekNumber _ Integer readFrom: aStream.
	weekNumber < 1 ifTrue: [ self error: 'Invalid Format' ].
	(yearNumber < 100 and: [yearNumber >= 0])  ifTrue: [
		yearNumber _ yearNumber < 69 
			ifTrue: [2000 + yearNumber]
			ifFalse: [1900 + yearNumber]].

	^ self yearNumber: yearNumber weekNumber: weekNumber! !
!Week class methodsFor: 'squeak protocol' stamp: 'jmv 5/13/2017 10:54:55'!
                      yearNumber: yearNumber weekNumber: weekNumber

	| firstOfJanuary firstThursday thisThursday |
	firstOfJanuary _ DateAndTime year: yearNumber month: 1 day: 1.
	firstThursday _ firstOfJanuary + (4 - firstOfJanuary dayOfWeek \\ 7) days.
	thisThursday _ firstThursday + ((weekNumber-1) * 7) days.

	thisThursday yearNumber = yearNumber
		ifFalse: [ self error: 'Week does not exist' ].

	^ self including: thisThursday! !
!Year class methodsFor: 'squeak protocol' stamp: 'jmv 5/12/2017 16:41:15'!
                   readFrom: aStream 

	| year sign |
	sign := aStream peek = $- ifTrue: [-1] ifFalse: [1].
	[aStream peek isDigit] whileFalse: [aStream skip: 1].
	year := (Integer readFrom: aStream) * sign.
	^ self yearNumber: year! !
!String methodsFor: 'converting' stamp: 'jmv 5/12/2017 11:24:09'!
     asMonth
	"Many allowed forms, see Month>>#readFrom:
		'July 1998' asMonth.
		'1998/7'asMonth.
	"

	^ Month fromString: self! !
!String methodsFor: 'converting' stamp: 'jmv 5/12/2017 16:39:13'!
                               asWeek
	"
		'2008-W52' asWeek.
		'2008-W53' asWeek. 'Invalid format!!'.
		'2009-W01' asWeek
		'2009-W02' asWeek
		'2009-W53' asWeek
		'2010-W01' asWeek
		'2010-W02' asWeek
		'2008-W52' asWeek start.
		'2009-W01' asWeek start
		'2009-W02' asWeek start
		'2009-W53' asWeek start
		'2010-W01' asWeek start
		'2010-W02' asWeek start
	"

	^ Week fromString: self! !
!String methodsFor: 'converting' stamp: 'jmv 5/12/2017 16:37:23'!
                     asYear
	"
		'2008' asYear.
		'2008' asYear start.
	"

	^ Year fromString: self! !
!DateAndTime methodsFor: 'ansi protocol' stamp: 'jmv 5/12/2017 10:55:06' prior: 16828675!
                    dayOfWeek

	"
	Sunday=1, ... , Saturday=7
	Monday=1, ... , Sunday=7
	'12 May 2017 ' asDate dayOfWeek = 5
	"

	^ (jdn rem: 7) + 1! !
!DateAndTime methodsFor: 'ansi protocol' stamp: 'jmv 5/12/2017 10:53:00' prior: 16828685!
  dayOfWeekName
	"
	'12 May 2017 ' asDate dayOfWeek = 5 
	'12 May 2017 ' asDate dayOfWeekName = #Friday 
	"

	^ Week nameOfDay: self dayOfWeek
! !
!Duration methodsFor: 'squeak protocol' stamp: 'jmv 5/12/2017 10:59:51' prior: 16836040!
                      printOn: aStream
	"Format as per ANSI 5.8.2.16: [-]D:HH:MM:SS[.S]
	(Duration days: 2 hours: 3 minutes: 16 seconds: 43) printString =  '2:03:16:43' 
	"
	| d h m s n |
	d _ self days abs.
	h _ self hours abs.
	m _ self minutes abs.
 	s _ self seconds abs truncated.
	n _ self nanoSeconds abs. 	self negative ifTrue: [ aStream nextPut: $- ].
	d printOn: aStream. aStream nextPut: $:.
	h printOn: aStream length: 2 zeroPadded: true.aStream nextPut: $:.
	m printOn: aStream length: 2 zeroPadded: true.aStream nextPut: $:.
	s printOn: aStream length: 2 zeroPadded: true.
	n = 0 ifFalse: [
		| z ps |
		aStream nextPut: $..
		ps _ n printString padded: #left to: 9 with: $0. 
		z _ ps findLast: [ :c | c digitValue > 0 ].
		ps from: 1 to: z do: [ :c | aStream nextPut: c ] ]! !
!Date methodsFor: 'smalltalk-80' stamp: 'jmv 5/12/2017 10:54:58' prior: 16828235!
           weekdayIndex
	"Sunday=1, ... , Saturday=7
	Monday=1, ... , Sunday=7
	'12 May 2017 ' asDate weekdayIndex = 5
	"

	^ self dayOfWeek! !
!Date class methodsFor: 'squeak protocol' stamp: 'jmv 5/10/2017 21:56:27' prior: 16828417!
readFrom: aStream 
	"Read a Date from the stream in any of the forms:
		<day> <month> <year>		(15 April 1982; 15-APR-82; 15.4.82; 15APR82)  
		<month> <day> <year>		(April 15, 1982; 4/15/82)
		<year>-<month>-<day>		(1982-04-15) (ISO8601)"
	| day month year firstAsNumber firstAsNumberSign |
	firstAsNumberSign := aStream peek = $- ifTrue: [-1] ifFalse: [1].
	[aStream peek isAlphaNumeric] whileFalse: [aStream skip: 1].
	aStream peek isDigit ifTrue: [
		firstAsNumber := (Integer readFrom: aStream) * firstAsNumberSign.
		(firstAsNumber < 0 or: [firstAsNumber > 31])
			ifTrue: [year := firstAsNumber]].

	[aStream peek isAlphaNumeric] whileFalse: [aStream skip: 1].
	aStream peek isLetter
		ifTrue: ["MonthName-DD-YY or DD-MonthName-YY or YY-MonthName-DD"
			month _ String streamContents: [ :strm |
				[ aStream peek isLetter ] whileTrue: [ strm nextPut: aStream next ]].
			[aStream peek isAlphaNumeric] whileFalse: [aStream skip: 1].
			firstAsNumber
				ifNil: ["MonthName DD YY"
					day := Integer readFrom: aStream]
				ifNotNil: [
					year ifNil: ["DD MonthName YY"
						day := firstAsNumber]]]
		ifFalse: ["MM-DD-YY or DD-MM-YY or YY-MM-DD"
			year 
				ifNil: ["MM-DD-YY or DD-MM-YY"
					firstAsNumber > 12
						ifTrue: ["DD-MM-YY"
							day := firstAsNumber.
							month := Month nameOfMonth: (Integer readFrom: aStream)]
						ifFalse: ["MM-DD-YY"
							month := Month nameOfMonth: firstAsNumber.
							day := Integer readFrom: aStream]]
				ifNotNil: ["YY-MM-DD"
					month := Month nameOfMonth: (Integer readFrom: aStream)]].

	[aStream peek isAlphaNumeric] whileFalse: [aStream skip: 1].
	year
		ifNil: [year := Integer readFrom: aStream]
		ifNotNil: [day := Integer readFrom: aStream].
	(year < 100 and: [year >= 0])  ifTrue: [
		year _  year < 69 
			ifTrue: [2000 + year]
			ifFalse: [1900 + year]].

	^ self year: year month: month day: day! !
!Month class methodsFor: 'squeak protocol' stamp: 'jmv 5/12/2017 11:28:03' prior: 16873841!
                   readFrom: aStream 
	"Read a Month from the stream in any of the forms:  
		<month> <year>			(April 1982; APR-82; 4.82; APR82)  
		<month> <year>			(April, 1982; 4/82)
		<year>-<month>			(1982-04) (ISO8601)"
	"
	Month readFrom: 'July 1998' readStream
	"
	| month year firstAsNumber firstAsNumberSign |
	firstAsNumberSign := aStream peek = $- ifTrue: [-1] ifFalse: [1].
	[aStream peek isAlphaNumeric] whileFalse: [aStream skip: 1].
	aStream peek isDigit ifTrue: [
		firstAsNumber := (Integer readFrom: aStream) * firstAsNumberSign.
		(firstAsNumber < 0 or: [firstAsNumber > 12])
			ifTrue: [year := firstAsNumber]].

	[aStream peek isAlphaNumeric] whileFalse: [aStream skip: 1].
	aStream peek isLetter
		ifTrue: ["MonthName-YY or YY-MonthName"
			month _ String streamContents: [ :strm |
				[ aStream peek isLetter ] whileTrue: [ strm nextPut: aStream next ]].
			[aStream peek isAlphaNumeric] whileFalse: [aStream skip: 1]]
		ifFalse: ["MM-YY or YY-MM"
			month _ year 
				ifNil: ["MM-YY"
					Month nameOfMonth: firstAsNumber ]
				ifNotNil: ["YY-MM"
					Month nameOfMonth: (Integer readFrom: aStream)]].

	year ifNil: [
		[aStream peek isAlphaNumeric] whileFalse: [aStream skip: 1].
		year := Integer readFrom: aStream].
	(year < 100 and: [year >= 0])  ifTrue: [
		year _ year < 69 
			ifTrue: [2000 + year]
			ifFalse: [1900 + year]].

	^ self month: month year: year! !
!Week methodsFor: 'squeak protocol' stamp: 'jmv 5/12/2017 11:53:32' prior: 16944751!
           printOn: aStream
	"
		'2008-W52' asWeek.
		'2009-W01' asWeek
		'2009-W02' asWeek
		'2009-W53' asWeek
		'2010-W01' asWeek
		'2010-W02' asWeek
	"
	| thursday |
	thursday _ self start + 3 days.
	thursday yearNumber printOn: aStream.
	aStream nextPutAll: '-W'.
	(thursday dayOfYear-1 // 7 + 1) printOn: aStream length: 2 zeroPadded: true! !
!Week class methodsFor: 'squeak protocol' stamp: 'jmv 5/12/2017 10:54:04' prior: 16944773!
                    indexOfDay: aSymbol
	"
	Week indexOfDay: #Sunday = 7
	Week nameOfDay: 7 = #Sunday 
	"

	^ self dayNames indexOf: aSymbol! !
!Week class methodsFor: 'smalltalk-80' stamp: 'jmv 5/12/2017 10:53:55' prior: 16944778!
            nameOfDay: anIndex
	"
	Week indexOfDay: #Sunday = 7
	Week nameOfDay: 7 = #Sunday 
	"

	^ self dayNames at: anIndex! !
!Week class methodsFor: 'inquiries' stamp: 'jmv 5/10/2017 22:25:02' prior: 16944786!
                     dayNames

	^ #(Monday Tuesday Wednesday Thursday Friday Saturday Sunday)! !
!String methodsFor: 'converting' stamp: 'jmv 5/12/2017 11:22:17' prior: 16916294!
  asDate
	"Many allowed forms, see Date>>#readFrom:
		'2014/6/30' asDate.
		'70/12/30' asDate.
		'12/30/70' asDate.
		'30/12/70' asDate.
		'4/5/6' asDate.
		'15 April 1982' asDate.
	"

	^ Date fromString: self! !

Date class removeSelector: #fromString:!

Date class removeSelector: #fromString:!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3078-WeekStartsOnMonday-NewWeekMonthYearCreationMethods-JuanVuletich-2017May13-12h54m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3076] on 13 May 2017 at 1:02:55 pm'!
!DateAndTime methodsFor: 'double dispatching' stamp: 'jmv 5/12/2017 17:17:21'!
  includingTimespanOf: aTimespanClass

	^ aTimespanClass includingDateAndTime: self! !
!Timespan methodsFor: 'double displatching' stamp: 'jmv 5/12/2017 17:17:18'!
                              includingTimespanOf: aTimespanClass

	^ aTimespanClass includingTimespan: self! !
!Timespan class methodsFor: 'instance creation' stamp: 'jmv 5/12/2017 16:48:47'!
                             includingDateAndTime: aDateAndTime

	^ self starting: aDateAndTime duration: Duration zero! !
!Timespan class methodsFor: 'instance creation' stamp: 'jmv 5/12/2017 17:22:59'!
                 includingTimespan: aDateAndTime

	| ending starting |
	starting _ self includingDateAndTime: aDateAndTime start.
	ending _ self includingDateAndTime: aDateAndTime end.
	starting = ending ifTrue: [ ^ starting ].
	self error: aDateAndTime printString, ' can not be included in a ', self name! !
!Date class methodsFor: 'instance creation' stamp: 'jmv 5/12/2017 16:48:52'!
              includingDateAndTime: aDateAndTime

	^self basicNew
 		start: aDateAndTime midnight;
		duration: (Duration days: 1);
		yourself! !
!Month class methodsFor: 'squeak protocol' stamp: 'jmv 5/12/2017 16:48:55'!
                 includingDateAndTime: aDateAndTime
	"Months start at day 1"
	| monthStart days |
	monthStart _ DateAndTime
				year: aDateAndTime yearNumber
				month: aDateAndTime monthIndex
				day: 1.
	days _ self daysInMonth: monthStart monthIndex forYear: monthStart yearNumber.
	^ self basicNew
 		start: monthStart;
		duration: (Duration days: days);
		yourself! !
!Week class methodsFor: 'squeak protocol' stamp: 'jmv 5/12/2017 18:05:57'!
                 includingDateAndTime: aDateAndTime
	"
	Week including: '12 May 2017 ' asDate start
	(Week including: '12 May 2017 ' asDate start) start dayOfWeekName = #Monday 
	"

	| midnight weekStart |
	midnight _ aDateAndTime midnight.
	weekStart _ midnight - (midnight dayOfWeek - 1) days.

	^ self basicNew
 		start: weekStart;
		duration: (Duration weeks: 1);
		yourself! !
!Year class methodsFor: 'squeak protocol' stamp: 'jmv 5/12/2017 18:00:49'!
        includingDateAndTime: aDateAndTime
	"Answer a calendar year"

	^ self yearNumber: aDateAndTime yearNumber! !
!Timespan class methodsFor: 'instance creation' stamp: 'jmv 5/12/2017 17:18:23' prior: 16938217!
                  including: aDateAndTime

	^ aDateAndTime includingTimespanOf: self! !
!Year class methodsFor: 'squeak protocol' stamp: 'jmv 5/12/2017 17:43:17' prior: 16946731!
                               yearNumber: aYear

	| yearStart |
	yearStart _ DateAndTime year: aYear month: 1 day: 1.
	^ self basicNew
 		start: yearStart;
		duration: (Duration days: (self daysInYear: yearStart yearNumber));
		yourself! !

Year class removeSelector: #including:!

Year class removeSelector: #including:!

Week class removeSelector: #including:!

Week class removeSelector: #including:!

Month class removeSelector: #including:!

Month class removeSelector: #including:!

Date class removeSelector: #including:!

Date class removeSelector: #including:!

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3079-TimespanCreation-includingTimespan-JuanVuletich-2017May13-13h02m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3079] on 13 May 2017 at 2:18:26 pm'!
!DateAndTime methodsFor: 'private' stamp: 'jmv 5/13/2017 10:58:22'!
        substractDateAndtime: operand
	"operand is a DateAndTime or a Duration"

	| lvalue rvalue |
	offset = operand offset
		ifTrue: [
			lvalue _ self.
			rvalue _ operand ]
		ifFalse: [
			lvalue _ self asUTC.
			rvalue _ operand asUTC ].
	^ Duration
		seconds: (Time secondsInDay *(lvalue julianDayNumber - rvalue julianDayNumber)) + 
					(lvalue secondsSinceMidnight - rvalue secondsSinceMidnight)
		nanoSeconds: lvalue nanoSecond - rvalue nanoSecond! !
!DateAndTime methodsFor: 'private' stamp: 'jmv 5/13/2017 10:58:31'!
                       substractDuration: operand
	"operand is a DateAndTime or a Duration"

	^self + operand negated! !
!DateAndTime methodsFor: 'double dispatching' stamp: 'jmv 5/13/2017 10:59:45'!
               substractFrom: aDateAndTime

	^ aDateAndTime substractDateAndtime: self! !
!Duration methodsFor: 'double dispatching' stamp: 'jmv 5/13/2017 11:03:50'!
         substractFrom: aDateAndTimeOrDate

	^aDateAndTimeOrDate substractDuration: self! !
!Timespan methodsFor: 'private' stamp: 'jmv 5/13/2017 11:09:07'!
            substractDuration: aDuration

	^self class classDefinesDuration
		ifTrue: [ self class including: start - aDuration ]
		ifFalse: [ self class starting: start - aDuration duration: duration ]! !
!Timespan methodsFor: 'private' stamp: 'jmv 5/13/2017 11:18:25'!
                             substractTimespan: aTimespan

	aTimespan duration = self duration ifFalse: [
		self error: 'Can not substract Timespans of different duration' ].
	
	^self start substractDateAndtime: aTimespan start! !
!Timespan methodsFor: 'double displatching' stamp: 'jmv 5/13/2017 11:08:17'!
         substractFrom: aTimespan

	^ aTimespan substractTimespan: self! !
!DateAndTime methodsFor: 'ansi protocol' stamp: 'jmv 5/13/2017 11:00:53' prior: 16828596!
    - operand
	"operand is a DateAndTime or a Duration.
	Double dispatch"

	^ operand substractFrom: self! !
!Timespan methodsFor: 'ansi protocol' stamp: 'jmv 5/13/2017 14:16:21' prior: 16937995!
- aDurationOrTimespan

	^ aDurationOrTimespan substractFrom: self! !
!Timespan methodsFor: 'squeak protocol' stamp: 'jmv 5/13/2017 11:13:39' prior: 16938027!
  includes: operand
	"Operand might be a Timespan or a DateAndtime"

	^ (operand is: #Timespan)
			ifTrue: [ (self includes: operand start)
						and: [ self includes: operand end ] ]
			ifFalse: [ operand between: start and: self end ]! !
!Timespan class methodsFor: 'instance creation' stamp: 'jmv 5/13/2017 11:12:44' prior: 50342535!
                 includingTimespan: aTimespan

	| ending starting |
	starting _ self includingDateAndTime: aTimespan start.
	ending _ self includingDateAndTime: aTimespan end.
	starting = ending ifTrue: [ ^ starting ].
	self error: aTimespan printString, ' can not be included in a ', self name! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3080-TimespanLessTimespan-JuanVuletich-2017May13-14h12m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3080] on 13 May 2017 at 7:48:17 pm'!
!Week methodsFor: 'public protocol' stamp: 'jmv 5/13/2017 14:37:37'!
                        weekNumber

	| thursday |
	thursday _ self start + 3 days.
	^thursday dayOfYear-1 // 7 + 1! !
!Week methodsFor: 'public protocol' stamp: 'jmv 5/13/2017 14:37:18'!
                             yearNumber

	| thursday |
	thursday _ self start + 3 days.
	^thursday yearNumber! !
!Year methodsFor: 'public protocol' stamp: 'jmv 5/13/2017 14:51:58'!
       yearNumber

	^ start yearNumber! !
!Week methodsFor: 'squeak protocol' stamp: 'jmv 5/13/2017 14:38:20' prior: 50342464!
        printOn: aStream
	"
		'2008-W52' asWeek.
		'2009-W01' asWeek
		'2009-W02' asWeek
		'2009-W53' asWeek
		'2010-W01' asWeek
		'2010-W02' asWeek
	"
	self yearNumber printOn: aStream.
	aStream nextPutAll: '-W'.
	self weekNumber printOn: aStream length: 2 zeroPadded: true! !
!Week class methodsFor: 'squeak protocol' stamp: 'jmv 5/13/2017 14:59:27' prior: 50342478!
                       indexOfDay: aSymbol
	"
	(Week indexOfDay: #Sunday) = 7
	(Week nameOfDay: 7) = #Sunday 
	"

	^ self dayNames indexOf: aSymbol! !

----End fileIn of /root/PayloadSoftware/Cuis-Smalltalk-Dev/CoreUpdates/3081-WeekYearTweaks-JuanVuletich-2017May13-19h46m-jmv.1.cs.st----!

Cursor webLink maskForm bits: (Form extent: 16@16 
			fromArray: (#(3072 7680 7680 7680 7680 8118 8191 32767 65535 65535 65535 65535 65535 32766 32766 16380 )  collect: [:bits | bits bitShift: 16])
			offset: 0@0) bits.
Smalltalk garbageCollect.!

Form allInstances!

----SNAPSHOT----#(14 May 2017 7:55:58.705571 pm) Cuis5.0-3081-spur-64.image priorSource: 336794!

----QUIT----#(14 May 2017 7:56:15.500912 pm) Cuis5.0-3081-spur-64.image priorSource: 355670!

----STARTUP----#(25 May 2017 1:37:22.074107 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!


TestCase subclass: #XXXTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #XXXTest category: #Distance!
TestCase subclass: #XXXTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 12:59:12'!
                  setUp
	aMeter := Distance amount: 1 unit: Meter.
	twoMeters := Distance amount: 2 unit: Meter.
	hundredCentimeters := Distance amount: 100 unit: Centimeter.
	twoHundredCentimeters := Distance amount: 200 unit: Centimeter.
	thousandMillimeters := Distance amount: 1000 unit: Millimeter.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:54:21'!
                   test01MeterIsEqualToHimself

	self assert: aMeter = aMeter! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:00:10'!
                      test02DifferentTwoMetersObjectAreEqual

	| anotherTwoMeters|
	anotherTwoMeters := Distance amount: 2 unit: Meter.
	self assert: twoMeters = anotherTwoMeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:55:02'!
                    test03AMeterPlusAMeterEqualsTwoMeters

	self assert: (aMeter + aMeter) = twoMeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:24:40'!
                              test04CannotCreateMetersWithNegativeAmount

	self should: [Distance amount: -1 unit: Meter.] raise: Error description: 'Cannot create distances with negative amount'! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:01:29'!
           test05AMeterEqualsToHundredCentimeters

	self assert: aMeter = hundredCentimeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:58:16'!
                               test06TwoMetersEqualsToTwoHundredCentimeters

	self assert: twoMeters = twoHundredCentimeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:58:18'!
                   test07TwoHundredCentimetersEqualsToTwoMeters

	self assert: twoHundredCentimeters = twoMeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:01:54'!
                   test08AHundredCentimetersIsDifferentToTwoMeters

	self deny: hundredCentimeters = twoMeters ! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:20:16'!
                    test09HundredCentimetersEqualsToThousandMillimeters

	self assert: hundredCentimeters = thousandMillimeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:20:30'!
     test10ThousandMillimetersEqualsToHundredCentimeters

	self assert: thousandMillimeters =  hundredCentimeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:01:08'!
    test11ThousandMillimetersEqualsToFiftyCentimetersPlusFiftyCentimeters
	
	| fiftyCentimeters |
	fiftyCentimeters := Distance amount: 50 unit: Centimeter.
	self assert: thousandMillimeters =  (fiftyCentimeters + fiftyCentimeters)! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:01:23'!
             test12ThousandMillimetersPlusThousandMillimetersEqualsTwoThousandMillimeters
	
	| twoThousandMillimeters |
	
	twoThousandMillimeters := Distance amount: 2000 unit: Millimeter.
	self assert: (thousandMillimeters + thousandMillimeters) = twoThousandMillimeters! !

Object subclass: #Centimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Centimeter category: #Distance!
Object subclass: #Centimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!Centimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:23:04'!
                + aCentimeter 
	^ self class newWithAmount: amount + (aCentimeter amount)! !
!Centimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:42:50'!
    = xxx
	^ amount = xxx toCentimeters amount! !
!Centimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:23:41'!
   initializeWith: anAmount
	amount := anAmount! !
!Centimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:07:05'!
 toMeter
	^ Meter newWithAmount: amount / 100.! !
!Centimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:18:35'!
toMillimeter
	^ Millimeter newWithAmount: amount * 10! !
!Centimeter methodsFor: 'accessing' stamp: 'GDS 5/23/2017 19:27:02'!
  amount
	^ amount! !

"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!

Centimeter class
	instanceVariableNames: ''!

!classDefinition: 'Centimeter class' category: #Distance!
Centimeter class
	instanceVariableNames: ''!
!Centimeter class methodsFor: 'instance creation' stamp: 'GDS 5/23/2017 20:08:18'!
        newWithAmount: anAmount
	^ self new initializeWith: anAmount.! !

Object subclass: #Distance
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Distance category: #Distance!
Object subclass: #Distance
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:23:45'!
                   + aDistance 
	^ Distance amount: amount + aDistance amount unit: Millimeter! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:21:46'!
    = aDistance 
	^ amount = (aDistance amount)! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:17:31'!
    initializeWithAmount: anAmount
	amount := anAmount! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:03:59'!
                             initializeWithAmount: anAmount andUnit: aUnit
	amount := anAmount.
	unit := aUnit! !
!Distance methodsFor: 'accessing' stamp: 'GDS 5/25/2017 13:20:17'!
        amount
	^ amount! !

"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!

Distance class
	instanceVariableNames: ''!

!classDefinition: 'Distance class' category: #Distance!
Distance class
	instanceVariableNames: ''!
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:25:05'!
              amount: anAmount unit: aUnit
	| anAmountTranslatedToMillimeters |
	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	anAmountTranslatedToMillimeters := 1.
	( aUnit isKindOf: Meter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1000].
	( aUnit isKindOf: Centimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 10].
	( aUnit isKindOf: Millimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1].
	^ self new initializeWithAmount: anAmountTranslatedToMillimeters.! !

Object subclass: #Meter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Meter category: #Distance!
Object subclass: #Meter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!Meter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:07:09'!
                       + aMeter 
	^ self class newWithAmount: amount + aMeter amount! !
!Meter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:28:06'!
                     = xxx
	^ amount = (xxx toMeter amount)! !
!Meter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:06:46'!
            initializeWith: anAmount 
	amount := anAmount.! !
!Meter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:07:13'!
    toCentimeters
	^ Centimeter newWithAmount: amount * 100! !
!Meter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:29:44'!
                           toMeter
	^ self! !
!Meter methodsFor: 'accessing' stamp: 'GDS 5/23/2017 19:07:15'!
             amount
	^ amount! !

"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!

Meter class
	instanceVariableNames: ''!

!classDefinition: 'Meter class' category: #Distance!
Meter class
	instanceVariableNames: ''!
!Meter class methodsFor: 'instance creation' stamp: 'GDS 5/23/2017 20:06:54'!
                            newWithAmount: anAmount
	anAmount < 0 ifTrue: [self error: 'Cannot create meters with negative amount'].
	^ self new initializeWith: anAmount.! !

Object subclass: #Millimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Millimeter category: #Distance!
Object subclass: #Millimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:39:52'!
    + xxx 

	^ self class newWithAmount: amount + xxx amount! !
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:17:37'!
                     = xxx
	^ amount = (xxx toMillimeter amount)! !
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:18:51'!
  amount
	^ amount! !
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:12:35'!
                             initializeWith: anAmount
	amount := anAmount! !
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:14:38'!
 toCentimeters
	^ Centimeter newWithAmount: amount / 10! !
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:40:24'!
                       toMillimeter

	^ self! !

"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!

Millimeter class
	instanceVariableNames: ''!

!classDefinition: 'Millimeter class' category: #Distance!
Millimeter class
	instanceVariableNames: ''!
!Millimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:11:57'!
 newWithAmount: anAmount
	^ self new initializeWith: anAmount! !

----End fileIn of /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Distance.st----!

( aUnit isKindOf: Centimeter)!

aMeter!

aClass!

self class!
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:50:32' prior: 50342971!
    amount: anAmount unit: aUnit
	| anAmountTranslatedToMillimeters |
	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	anAmountTranslatedToMillimeters := 1.
	( aUnit class isKindOf: Meter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1000].
	( aUnit class isKindOf: Centimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 10].
	( aUnit class isKindOf: Millimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1].
	^ self new initializeWithAmount: anAmountTranslatedToMillimeters.! !

aUnit class isKindOf: Meter!

self class!

aClass!
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:52:33' prior: 50343090!
    amount: anAmount unit: aUnit
	| anAmountTranslatedToMillimeters |
	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	anAmountTranslatedToMillimeters := 1.
	( (aUnit class) isKindOf: Meter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1000].
	( (aUnit class) isKindOf: Centimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 10].
	( (aUnit class) isKindOf: Millimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1].
	^ self new initializeWithAmount: anAmountTranslatedToMillimeters.! !
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:54:15' prior: 50343112!
                  amount: anAmount unit: aUnit
	| anAmountTranslatedToMillimeters |
	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	anAmountTranslatedToMillimeters := 1.
	( aUnit class = Meter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1000].
	( aUnit class = Centimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 10].
	( aUnit class = Millimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1].
	^ self new initializeWithAmount: anAmountTranslatedToMillimeters.! !

twoMeters!

hundredCentimeters!

aUnit class!
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:56:10' prior: 50343133!
 amount: anAmount unit: aUnit
	| anAmountTranslatedToMillimeters |
	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	anAmountTranslatedToMillimeters := 1.
	( aUnit  = Meter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1000].
	( aUnit  = Centimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 10].
	( aUnit  = Millimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1].
	^ self new initializeWithAmount: anAmountTranslatedToMillimeters.! !

Distance removeSelector: #initializeWithAmount:andUnit:!

Object subclass: #Distance
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Distance category: #Distance!
Object subclass: #Distance
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

Centimeter class removeSelector: #newWithAmount:!

Centimeter removeSelector: #initializeWith:!

Centimeter removeSelector: #=!

Centimeter removeSelector: #+!

Centimeter removeSelector: #amount!

Meter removeSelector: #+!

Meter removeSelector: #amount!

Meter removeSelector: #=!

Meter removeSelector: #initializeWith:!

Meter class removeSelector: #newWithAmount:!

Millimeter class removeSelector: #newWithAmount:!

Millimeter removeSelector: #=!

Millimeter removeSelector: #amount!

Millimeter removeSelector: #+!

Millimeter removeSelector: #initializeWith:!

----SNAPSHOT----#(25 May 2017 2:46:43.776952 pm) Cuis5.0-3081-spur-64.image priorSource: 355768!

----SNAPSHOT----#(25 May 2017 6:03:37.645851 pm) Cuis5.0-3081-spur-64.image priorSource: 369637!
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:10:13' prior: 50343154!
                   amount: anAmount unit: aUnit
	| anAmountTranslatedToMillimeters |
	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	
	
	
	anAmountTranslatedToMillimeters := 1.
	( aUnit  = Meter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1000].
	( aUnit  = Centimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 10].
	( aUnit  = Millimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1].
	^ self new initializeWithAmount: (aUnit translateThisAmountToMillimeters: anAmount).! !

"E" XXXTest debug: #test01MeterIsEqualToHimself!
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:10:47'!
       translateThisAmountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:11:31' prior: 50343230!
                  translateThisAmountToMillimeters: anAmount
	^ anAmount * 1000! !
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:11:46'!
          translateThisAmountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:12:26' prior: 50343241!
             translateThisAmountToMillimeters: anAmount
	^ anAmount * 10.! !
!Millimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:12:47'!
           translateThisAmountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Millimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:13:02' prior: 50343252!
             translateThisAmountToMillimeters: anAmount
	^ anAmount! !
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:13:30' prior: 50343209!
   amount: anAmount unit: aUnit

	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	^ self new initializeWithAmount: (aUnit translateThisAmountToMillimeters: anAmount).! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:20:36'!
         test13	
	
	self assert: twoMeters - hundredCentimeters = thousandMillimeters! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:20:42'!
   - aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:21:12' prior: 50343277!
                         - aDistance 
	^ amount - aDistance amount! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:21:59' prior: 50343282!
                      - aDistance 
	^ self class amount: amount - aDistance amount unit: Millimeter! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:24:06' prior: 50343272!
                   test13	
	
	self assert: aMeter * 2 = twoMeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:24:12'!
  test14
	
	self assert: aMeter * 2 = twoMeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:25:17' prior: 50343293!
                   test13	
	
	self assert: twoMeters - hundredCentimeters = thousandMillimeters! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:25:24'!
   * aSmallInteger 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:28:46' prior: 50343307!
                     * aNumber 
	^ self class amount: amount * aNumber unit: Millimeter.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:30:23'!
             test13TwoMetersMinusHundredCentimetersEqualsThousandMillimeters
	
	self assert: twoMeters - hundredCentimeters = thousandMillimeters! !

XXXTest removeSelector: #test13!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:31:21'!
          test14AMeterTimesTwoEqualsTwoMeters
	
	self assert: aMeter * 2 = twoMeters! !

XXXTest removeSelector: #test14!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:36:15'!
    test15
	
	self assert: 2 * aMeter = twoMeters! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:37:29'!
  adaptToNumber: aSmallInteger andSend: aSymbol 
	self shouldBeImplemented! !

amount!

aSmallInteger !

aSymbol !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:39:48' prior: 50343335!
                  adaptToNumber: aSmallInteger andSend: aSymbol 
	^ Distance amount: aSmallInteger * amount unit: Millimeter.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:41:10'!
     test16
	
	| halfAMeter |
	self assert: aMeter / 2 = halfAMeter! !

!classDefinition: #XXXTest category: #Distance!
TestCase subclass: #XXXTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:41:45' prior: 50342790!
                             setUp
	halfAMeter := Distance amount: 1/2 unit: Meter.
	aMeter := Distance amount: 1 unit: Meter.
	twoMeters := Distance amount: 2 unit: Meter.
	hundredCentimeters := Distance amount: 100 unit: Centimeter.
	twoHundredCentimeters := Distance amount: 200 unit: Centimeter.
	thousandMillimeters := Distance amount: 1000 unit: Millimeter.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:41:55' prior: 50343348!
                  test16
	
	self assert: aMeter / 2 = halfAMeter! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:42:30'!
 / aSmallInteger 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:43:02' prior: 50343380!
                     / aSmallInteger 
	^ Distance amount: amount / aSmallInteger unit: Millimeter.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:45:06'!
   test15TwoTimesAMeterEqualsTwoMeters
	
	self assert: 2 * aMeter = twoMeters! !

XXXTest removeSelector: #test15!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 18:46:13'!
    test16AMeterDividedByTwoEqualsHalfAMeter
	
	self assert: aMeter / 2 = halfAMeter! !

XXXTest removeSelector: #test16!

----SNAPSHOT----#(25 May 2017 6:54:12.195755 pm) Cuis5.0-3081-spur-64.image priorSource: 369735!

----SNAPSHOT----#(25 May 2017 7:01:19.69348 pm) Cuis5.0-3081-spur-64.image priorSource: 376053!

Centimeter removeSelector: #toMeter!

Centimeter removeSelector: #toMillimeter!

Meter removeSelector: #toMeter!

Meter removeSelector: #toCentimeters!

Millimeter removeSelector: #toMillimeter!

Millimeter removeSelector: #toCentimeters!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:03:56'!
           test17

	| tenKilometers |
	self assert:  tenKilometers  > aMeter! !

!classDefinition: #XXXTest category: #Distance!
TestCase subclass: #XXXTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Kilometer category: #Distance!
Object subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:04:24' prior: 50343362!
                             setUp
	halfAMeter := Distance amount: 1/2 unit: Meter.
	aMeter := Distance amount: 1 unit: Meter.
	twoMeters := Distance amount: 2 unit: Meter.
	hundredCentimeters := Distance amount: 100 unit: Centimeter.
	twoHundredCentimeters := Distance amount: 200 unit: Centimeter.
	thousandMillimeters := Distance amount: 1000 unit: Millimeter.
	tenKilometers := Distance amount: 10 unit: Kilometer.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:05:36' prior: 50343416!
                           test17

	self assert:  tenKilometers  > aMeter! !
!Kilometer class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:05:48'!
                          translateThisAmountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Kilometer class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:06:13' prior: 50343457!
              translateThisAmountToMillimeters: anAmount
	^ anAmount * 100000! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:06:28'!
                > aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:06:47' prior: 50343468!
                         > aDistance 
	^ amount < aDistance amount.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:07:15' prior: 50343473!
                     > aDistance 
	^ amount > aDistance amount.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:07:44'!
      test18

	self assert:   aMeter < twoMeters! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:07:51'!
     < aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:08:12' prior: 50343486!
                         < aDistance 
	^ amount < aDistance amount.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:18:50'!
      test19

	self assert: tenKilometers >= aMeter! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:18:57'!
  >= aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:19:09' prior: 50343499!
                        >= aDistance 
	^ amount >= aDistance amount.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:19:28'!
    test20

	self assert:   aMeter <= twoMeters! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:19:33'!
    <= aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:19:46' prior: 50343512!
                        <= aDistance 
	^ amount <= aDistance amount.! !

!classDefinition: #DistanceUnit category: #Distance!
Object subclass: #DistanceUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

DistanceUnit subclass: #Centimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Centimeter category: #Distance!
DistanceUnit subclass: #Centimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

DistanceUnit subclass: #Meter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Meter category: #Distance!
DistanceUnit subclass: #Meter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

DistanceUnit subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Kilometer category: #Distance!
DistanceUnit subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

DistanceUnit subclass: #Millimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Millimeter category: #Distance!
DistanceUnit subclass: #Millimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!DistanceUnit class methodsFor: 'no messages' stamp: 'GDS 5/25/2017 19:24:40'!
              translateThisAmountToMillimeters: anAmount
	self subclassResponsibility! !

TestCase subclass: #DistanceTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #DistanceTest category: #Distance!
TestCase subclass: #DistanceTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

Smalltalk removeClassNamed: #XXXTest!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:30:29' prior: 50342942!
            + aDistance 
	^ self class amount: amount + aDistance amount unit: Millimeter! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:30:37' prior: 50343385!
                  / aSmallInteger 
	^ self class amount: amount / aSmallInteger unit: Millimeter.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:30:45' prior: 50343342!
                adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class amount: aSmallInteger * amount unit: Millimeter.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:36:06' prior: 50343596!
                  / aNumber 
	^ self class amount: amount / aNumber unit: Millimeter.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:36:16' prior: 50343602!
                            adaptToNumber: aNumber andSend: aSymbol 
	^ self class amount: aNumber * amount unit: Millimeter.! !

----SNAPSHOT----#(25 May 2017 7:38:10.086268 pm) Cuis5.0-3081-spur-64.image priorSource: 376151!

----SNAPSHOT----#(25 May 2017 7:43:19.363469 pm) Cuis5.0-3081-spur-64.image priorSource: 383044!

'From Cuis 5.0 of 7 November 2016 [latest update: #3081] on 16 May 2017 at 10:43:45 am'!
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 16896077!
             defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !

----End fileIn of /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/CoreUpdates/3082-displayProgressAt-slownessOnMacFix-JuanVuletich-2017May16-10h38m-jmv.1.cs.st----!

'From Cuis 5.0 of 7 November 2016 [latest update: #3082] on 24 May 2017 at 12:34:49 am'!
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06'!
              sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 16805949!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 16807219!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 16924088!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 16797810!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !

ArrayedCollection removeSelector: #asSortedArray!

ArrayedCollection removeSelector: #asSortedArray!

Collection removeSelector: #asSortedArray!

Collection removeSelector: #asSortedArray!

----End fileIn of /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/CoreUpdates/3083-remove-asSortedArray-JuanVuletich-2017May24-00h34m-jmv.1.cs.st----!
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 50343631!
           defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06' prior: 50343713!
    sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 50343721!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 50343742!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 50343760!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 50343785!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 50343831!
       defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06' prior: 50343905!
    sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 50343913!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 50343934!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 50343952!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 50343977!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 50344012!
       defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06' prior: 50344086!
    sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 50344094!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 50344115!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 50344133!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 50344158!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 50344193!
       defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06' prior: 50344267!
    sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 50344275!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 50344296!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 50344314!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 50344339!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 50344374!
       defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06' prior: 50344448!
    sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 50344456!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 50344477!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 50344495!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 50344520!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !

!classDefinition: #XXXTest category: #Distance!
TestCase subclass: #XXXTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Kilometer category: #Distance!
Object subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:04:24'!
         setUp
	halfAMeter := Distance amount: 1/2 unit: Meter.
	aMeter := Distance amount: 1 unit: Meter.
	twoMeters := Distance amount: 2 unit: Meter.
	hundredCentimeters := Distance amount: 100 unit: Centimeter.
	twoHundredCentimeters := Distance amount: 200 unit: Centimeter.
	thousandMillimeters := Distance amount: 1000 unit: Millimeter.
	tenKilometers := Distance amount: 10 unit: Kilometer.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:05:36'!
           test17

	self assert:  tenKilometers  > aMeter! !
!Kilometer class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:05:48' prior: 50343463!
          translateThisAmountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Kilometer class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:06:13' prior: 50344769!
              translateThisAmountToMillimeters: anAmount
	^ anAmount * 100000! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:06:28' prior: 50343478!
> aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:06:47' prior: 50344780!
                         > aDistance 
	^ amount < aDistance amount.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:07:15' prior: 50344785!
                     > aDistance 
	^ amount > aDistance amount.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:07:44'!
      test18

	self assert:   aMeter < twoMeters! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:07:51' prior: 50343491!
                     < aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:08:12' prior: 50344799!
                         < aDistance 
	^ amount < aDistance amount.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:18:50'!
      test19

	self assert: tenKilometers >= aMeter! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:18:57' prior: 50343504!
                  >= aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:19:09' prior: 50344813!
                        >= aDistance 
	^ amount >= aDistance amount.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:19:28'!
    test20

	self assert:   aMeter <= twoMeters! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:19:33' prior: 50343517!
                    <= aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:19:46' prior: 50344827!
                        <= aDistance 
	^ amount <= aDistance amount.! !

!classDefinition: #DistanceUnit category: #Distance!
Object subclass: #DistanceUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Centimeter category: #Distance!
DistanceUnit subclass: #Centimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Centimeter category: #Distance!
DistanceUnit subclass: #Centimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Meter category: #Distance!
DistanceUnit subclass: #Meter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Meter category: #Distance!
DistanceUnit subclass: #Meter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Kilometer category: #Distance!
DistanceUnit subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Kilometer category: #Distance!
DistanceUnit subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Millimeter category: #Distance!
DistanceUnit subclass: #Millimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Millimeter category: #Distance!
DistanceUnit subclass: #Millimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!DistanceUnit class methodsFor: 'no messages' stamp: 'GDS 5/25/2017 19:24:40' prior: 50343567!
                        translateThisAmountToMillimeters: anAmount
	self subclassResponsibility! !

!classDefinition: #DistanceTest category: #Distance!
TestCase subclass: #DistanceTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #DistanceTest category: #Distance!
TestCase subclass: #DistanceTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

Smalltalk removeClassNamed: #XXXTest!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:30:29' prior: 50343590!
                       + aDistance 
	^ self class amount: amount + aDistance amount unit: Millimeter! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:30:37' prior: 50343609!
                  / aSmallInteger 
	^ self class amount: amount / aSmallInteger unit: Millimeter.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:30:45' prior: 50343615!
                adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class amount: aSmallInteger * amount unit: Millimeter.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:36:06' prior: 50344920!
                  / aNumber 
	^ self class amount: amount / aNumber unit: Millimeter.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 19:36:16' prior: 50344926!
                            adaptToNumber: aNumber andSend: aSymbol 
	^ self class amount: aNumber * amount unit: Millimeter.! !
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 50344555!
           defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06' prior: 50344629!
    sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 50344637!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 50344658!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 50344676!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 50344701!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 50344946!
       defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06' prior: 50345020!
    sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 50345028!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 50345049!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 50345067!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 50345092!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 50345127!
       defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06' prior: 50345201!
    sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 50345209!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 50345230!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 50345248!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 50345273!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 50345308!
       defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06' prior: 50345382!
    sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 50345390!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 50345411!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 50345429!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 50345454!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 50345489!
       defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06' prior: 50345563!
    sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 50345571!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 50345592!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 50345610!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 50345635!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !
!ProgressInitiationException methodsFor: 'as yet unclassified' stamp: 'jmv 5/16/2017 10:43:40' prior: 50345670!
       defaultAction

	| delta textFrame barFrame outerFrame result range width filledWidth f h textWidth textForm innerBarFrame oldFilledWidth oldFilledWidth2 prevContents |
	f _ AbstractFont default.
	h _ f height * 3//2.
	textWidth _ (f widthOfString: progressTitle) + h.
	width _ 150 max: textWidth.

	textForm _ Form extent: width@h depth: 32.
	textForm fillBlack.
	textForm fillWhite: (textForm boundingBox insetBy: 2).
	progressTitle displayOn: textForm at: (width-textWidth+h//2@4).
	barFrame _ Rectangle center: aPoint extent: width@h.
	textFrame _ 0@0 extent: width@h.
	textFrame _ textFrame
					aligned: textFrame bottomCenter
					with: barFrame topCenter + (0@2).
	outerFrame _ barFrame merge: textFrame.
	delta _ outerFrame amountToTranslateWithin: Display boundingBox.
	barFrame _ barFrame translatedBy: delta.
	textFrame _ textFrame translatedBy: delta.
	outerFrame _ outerFrame translatedBy: delta.
	prevContents _ Form fromDisplay: outerFrame.
	range _ maxVal = minVal ifTrue: [1] ifFalse: [maxVal - minVal].  "Avoid div by 0"
	innerBarFrame _ barFrame insetBy: 2.
	textForm displayAt: textFrame topLeft.
	Display fillBlack: barFrame.
	Display fillWhite: innerBarFrame.
	oldFilledWidth _ 0.
	oldFilledWidth2 _ 0.
	result _ workBlock value:  "Supply the bar-update block for evaluation in the work block"
		[ :barVal |
		barVal
			ifNotNil: [ currentVal _ barVal ]
			ifNil: [
				currentVal _ currentVal + 1.
				currentVal >= maxVal
					ifTrue: [ currentVal _ minVal ]].
		filledWidth _ ((barFrame width-4) asFloat * ((currentVal-minVal) asFloat / range min: 1.0)) asInteger.
		filledWidth  > oldFilledWidth ifTrue: [
			textForm displayAt: textFrame topLeft.
			Display fillBlack: barFrame.
			Display fillWhite: innerBarFrame.
			Display fillGray: (barFrame topLeft + (2@2) extent: filledWidth@17).
			filledWidth -200 > oldFilledWidth2
				ifFalse: [
					"Usually just request an update, to be done asynchronously."
					DisplayScreen screenUpdateRequired: outerFrame ]
				ifTrue: [
					"Once in a while, force a real screen update (warning: really slow on MacOS if done too often)"
					Display forceToScreen: outerFrame. oldFilledWidth2 _ filledWidth ].
			oldFilledWidth _ filledWidth ]].
	prevContents displayAt: outerFrame topLeft.
	self resume: result! !
!Collection methodsFor: 'sorting' stamp: 'jmv 5/24/2017 00:28:06' prior: 50345744!
    sorted
	"Return a new sequenceable collection which contains the same elements as self but its elements are sorted "

	^self sorted: nil! !
!ClassDescription methodsFor: 'instance variables' stamp: 'jmv 5/24/2017 00:29:04' prior: 50345752!
                chooseInstVarAlphabeticallyThenDo: aBlock
	| allVars index |
	"Put up a menu of all the instance variables in the receiver, presented in alphabetical order, and when the user chooses one, evaluate aBlock with the chosen variable as its parameter."

	allVars _ self allInstVarNames sorted.
	allVars isEmpty ifTrue: [^ self inform: 'There are no
instance variables'].

	index _ (PopUpMenu labelArray: allVars lines: #()) startUpWithCaption: 'Instance variables in
', self name.
	index = 0 ifTrue: [^ self].
	aBlock value: (allVars at: index)! !
!ClassDescription methodsFor: 'method dictionary' stamp: 'jmv 5/24/2017 00:28:55' prior: 50345773!
                              allMethodsInCategory: aSymbol
	"Answer a list of all the method categories of the receiver and all its superclasses"

	| aColl |
	aColl _ OrderedCollection new.
	self withAllSuperclasses do:
		[:aClass | aColl addAll:
			(aSymbol == ClassOrganizer allCategory
				ifTrue:
					[aClass organization allMethodSelectors]
				ifFalse:
					[aClass organization listAtCategoryNamed: aSymbol])].
	^ aColl asSet sorted

"TileMorph allMethodsInCategory: #initialization"! !
!SystemDictionary methodsFor: 'browsing' stamp: 'jmv 5/24/2017 00:29:09' prior: 50345791!
                    browseClassesWithNamesContaining: aString caseSensitive: caseSensitive 
	"Smalltalk browseClassesWithNamesContaining: 'eMorph' caseSensitive: true "
	"Launch a class-list list browser on all classes whose names containg aString as a substring."

	| suffix aList |
	suffix _ caseSensitive
				ifTrue: [' (case-sensitive)']
				ifFalse: [' (use shift for case-sensitive)'].
	aList _ OrderedCollection new.
	Smalltalk allClassesDo: [ :class |
		(class name includesSubstring: aString caseSensitive: caseSensitive)
			ifTrue: [aList add: class name]].
	aList size > 0
		ifTrue: [HierarchyBrowserWindow forClassesNamed: aList asSet sorted title: 'Classes whose names contain ' , aString , suffix]! !
!ChangeSet methodsFor: 'method changes' stamp: 'jmv 5/24/2017 00:28:50' prior: 50345816!
                changedMessageList
	"Used by a message set browser to access the list view information."

	| messageList |
	messageList _ OrderedCollection new.
	changeRecords associationsDo: [ :clAssoc | | classNameInFull classNameInParts |
		classNameInFull _ clAssoc key asString.
		classNameInParts _ classNameInFull findTokens: ' '.

		(clAssoc value allChangeTypes includes: #comment) ifTrue: [
			messageList add:
				(MethodReference new
					setClassSymbol: classNameInParts first asSymbol
					classIsMeta: false 
					methodSymbol: #Comment 
					stringVersion: classNameInFull, ' Comment')].

		clAssoc value methodChangeTypes associationsDo: [ :mAssoc |
			(#(remove addedThenRemoved movedToOtherPackage) includes: mAssoc value) ifFalse: [
				messageList add:
					(MethodReference new
						setClassSymbol: classNameInParts first asSymbol
						classIsMeta: classNameInParts size > 1 
						methodSymbol: mAssoc key 
						stringVersion: classNameInFull, ' ' , mAssoc key)]]].
	^ messageList sorted! !

!classDefinition: #Kilometer category: #Distance!
DistanceUnit subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

----QUIT/NOSAVE----#(25 May 2017 8:00:20.552161 pm) Cuis5.0-3081-spur-64.image priorSource: 383142!

----STARTUP----#(25 May 2017 8:00:23.613244 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!


Smalltalk removeClassNamed: #Millimeter!

Smalltalk removeClassNamed: #Meter!

Smalltalk removeClassNamed: #Kilometer!

Smalltalk removeClassNamed: #Centimeter!

Smalltalk removeClassNamed: #DistanceUnit!

Smalltalk removeClassNamed: #Distance!

Smalltalk removeClassNamed: #DistanceTest!

TestCase subclass: #XXXTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #XXXTest category: #Distance!
TestCase subclass: #XXXTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 12:59:12'!
    setUp
	aMeter := Distance amount: 1 unit: Meter.
	twoMeters := Distance amount: 2 unit: Meter.
	hundredCentimeters := Distance amount: 100 unit: Centimeter.
	twoHundredCentimeters := Distance amount: 200 unit: Centimeter.
	thousandMillimeters := Distance amount: 1000 unit: Millimeter.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:54:21'!
                   test01MeterIsEqualToHimself

	self assert: aMeter = aMeter! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:00:10'!
                      test02DifferentTwoMetersObjectAreEqual

	| anotherTwoMeters|
	anotherTwoMeters := Distance amount: 2 unit: Meter.
	self assert: twoMeters = anotherTwoMeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:55:02'!
                    test03AMeterPlusAMeterEqualsTwoMeters

	self assert: (aMeter + aMeter) = twoMeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:24:40'!
                              test04CannotCreateMetersWithNegativeAmount

	self should: [Distance amount: -1 unit: Meter.] raise: Error description: 'Cannot create distances with negative amount'! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:01:29'!
           test05AMeterEqualsToHundredCentimeters

	self assert: aMeter = hundredCentimeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:58:16'!
                               test06TwoMetersEqualsToTwoHundredCentimeters

	self assert: twoMeters = twoHundredCentimeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:58:18'!
                   test07TwoHundredCentimetersEqualsToTwoMeters

	self assert: twoHundredCentimeters = twoMeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:01:54'!
                   test08AHundredCentimetersIsDifferentToTwoMeters

	self deny: hundredCentimeters = twoMeters ! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:20:16'!
                    test09HundredCentimetersEqualsToThousandMillimeters

	self assert: hundredCentimeters = thousandMillimeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:20:30'!
     test10ThousandMillimetersEqualsToHundredCentimeters

	self assert: thousandMillimeters =  hundredCentimeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:01:08'!
    test11ThousandMillimetersEqualsToFiftyCentimetersPlusFiftyCentimeters
	
	| fiftyCentimeters |
	fiftyCentimeters := Distance amount: 50 unit: Centimeter.
	self assert: thousandMillimeters =  (fiftyCentimeters + fiftyCentimeters)! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:01:23'!
             test12ThousandMillimetersPlusThousandMillimetersEqualsTwoThousandMillimeters
	
	| twoThousandMillimeters |
	
	twoThousandMillimeters := Distance amount: 2000 unit: Millimeter.
	self assert: (thousandMillimeters + thousandMillimeters) = twoThousandMillimeters! !

Object subclass: #Centimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Centimeter category: #Distance!
Object subclass: #Centimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!Centimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:23:04'!
                + aCentimeter 
	^ self class newWithAmount: amount + (aCentimeter amount)! !
!Centimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:42:50'!
    = xxx
	^ amount = xxx toCentimeters amount! !
!Centimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:23:41'!
   initializeWith: anAmount
	amount := anAmount! !
!Centimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:07:05'!
 toMeter
	^ Meter newWithAmount: amount / 100.! !
!Centimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:18:35'!
toMillimeter
	^ Millimeter newWithAmount: amount * 10! !
!Centimeter methodsFor: 'accessing' stamp: 'GDS 5/23/2017 19:27:02'!
  amount
	^ amount! !

"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!

Centimeter class
	instanceVariableNames: ''!

!classDefinition: 'Centimeter class' category: #Distance!
Centimeter class
	instanceVariableNames: ''!
!Centimeter class methodsFor: 'instance creation' stamp: 'GDS 5/23/2017 20:08:18'!
        newWithAmount: anAmount
	^ self new initializeWith: anAmount.! !

Object subclass: #Distance
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Distance category: #Distance!
Object subclass: #Distance
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:23:45'!
                   + aDistance 
	^ Distance amount: amount + aDistance amount unit: Millimeter! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:21:46'!
    = aDistance 
	^ amount = (aDistance amount)! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:17:31'!
    initializeWithAmount: anAmount
	amount := anAmount! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:03:59'!
                             initializeWithAmount: anAmount andUnit: aUnit
	amount := anAmount.
	unit := aUnit! !
!Distance methodsFor: 'accessing' stamp: 'GDS 5/25/2017 13:20:17'!
        amount
	^ amount! !

"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!

Distance class
	instanceVariableNames: ''!

!classDefinition: 'Distance class' category: #Distance!
Distance class
	instanceVariableNames: ''!
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 13:25:05'!
              amount: anAmount unit: aUnit
	| anAmountTranslatedToMillimeters |
	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	anAmountTranslatedToMillimeters := 1.
	( aUnit isKindOf: Meter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1000].
	( aUnit isKindOf: Centimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 10].
	( aUnit isKindOf: Millimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1].
	^ self new initializeWithAmount: anAmountTranslatedToMillimeters.! !

Object subclass: #Meter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Meter category: #Distance!
Object subclass: #Meter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!Meter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:07:09'!
                       + aMeter 
	^ self class newWithAmount: amount + aMeter amount! !
!Meter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:28:06'!
                     = xxx
	^ amount = (xxx toMeter amount)! !
!Meter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:06:46'!
            initializeWith: anAmount 
	amount := anAmount.! !
!Meter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:07:13'!
    toCentimeters
	^ Centimeter newWithAmount: amount * 100! !
!Meter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 19:29:44'!
                           toMeter
	^ self! !
!Meter methodsFor: 'accessing' stamp: 'GDS 5/23/2017 19:07:15'!
             amount
	^ amount! !

"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!

Meter class
	instanceVariableNames: ''!

!classDefinition: 'Meter class' category: #Distance!
Meter class
	instanceVariableNames: ''!
!Meter class methodsFor: 'instance creation' stamp: 'GDS 5/23/2017 20:06:54'!
                            newWithAmount: anAmount
	anAmount < 0 ifTrue: [self error: 'Cannot create meters with negative amount'].
	^ self new initializeWith: anAmount.! !

Object subclass: #Millimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Millimeter category: #Distance!
Object subclass: #Millimeter
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:39:52'!
    + xxx 

	^ self class newWithAmount: amount + xxx amount! !
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:17:37'!
                     = xxx
	^ amount = (xxx toMillimeter amount)! !
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:18:51'!
  amount
	^ amount! !
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:12:35'!
                             initializeWith: anAmount
	amount := anAmount! !
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:14:38'!
 toCentimeters
	^ Centimeter newWithAmount: amount / 10! !
!Millimeter methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:40:24'!
                       toMillimeter

	^ self! !

"-- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- -- "!

Millimeter class
	instanceVariableNames: ''!

!classDefinition: 'Millimeter class' category: #Distance!
Millimeter class
	instanceVariableNames: ''!
!Millimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/23/2017 20:11:57'!
 newWithAmount: anAmount
	^ self new initializeWith: anAmount! !

----End fileIn of /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Distance.st----!
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:03:37' prior: 50346248!
   amount: anAmount unit: aUnit
	| anAmountTranslatedToMillimeters |
	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	anAmountTranslatedToMillimeters := 1.
	( aUnit isKindOf: Meter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1000].
	( aUnit isKindOf: Centimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 10].
	( aUnit isKindOf: Millimeter) ifTrue: [ anAmountTranslatedToMillimeters := anAmount * 1].
	^ self new initializeWithAmount: (aUnit translateThisAmountToMillimeters: anAmount).! !

"E" XXXTest debug: #test02DifferentTwoMetersObjectAreEqual!
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:04:16'!
             translateThisAmountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:04:54' prior: 50346387!
                  translateThisAmountToMillimeters: anAmount
	^ anAmount * 100! !
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:05:03'!
           translateThisAmountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:05:27' prior: 50346398!
             translateThisAmountToMillimeters: anAmount
	^ anAmount * 10! !
!Millimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:05:35'!
            translateThisAmountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Millimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:05:54' prior: 50346409!
             translateThisAmountToMillimeters: anAmount 
	^ anAmount! !
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:06:51' prior: 50346393!
     translateThisAmountToMillimeters: anAmount
	^ anAmount * 1000! !
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:07:04' prior: 50346365!
                            amount: anAmount unit: aUnit

	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	^ self new initializeWithAmount: (aUnit translateThisAmountToMillimeters: anAmount).! !

Meter removeSelector: #+!

Meter removeSelector: #=!

Meter removeSelector: #amount!

Object subclass: #Meter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Meter category: #Distance!
Object subclass: #Meter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

Object subclass: #Centimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Centimeter category: #Distance!
Object subclass: #Centimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

Object subclass: #Millimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Millimeter category: #Distance!
Object subclass: #Millimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

Millimeter removeSelector: #+!

Millimeter removeSelector: #=!

Millimeter removeSelector: #amount!

Millimeter removeSelector: #initializeWith:!

Meter removeSelector: #initializeWith:!

Centimeter removeSelector: #=!

Centimeter removeSelector: #+!

Centimeter removeSelector: #amount!

Centimeter removeSelector: #initializeWith:!

Centimeter class removeSelector: #newWithAmount:!

Meter class removeSelector: #newWithAmount:!

Millimeter class removeSelector: #newWithAmount:!

Distance removeSelector: #initializeWithAmount:andUnit:!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:12:04'!
                        test13
	
	self assert:  (twoMeters - hundredCentimeters) = thousandMillimeters! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:12:13'!
 - aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:12:53' prior: 50346488!
                         - aDistance 
	^ self class amount: amount - aDistance amount unit: Millimeter.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:13:22'!
  test14
	
	self assert:  aMeter * 2 = twoMeters! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:13:28'!
 * aSmallInteger 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:13:58' prior: 50346502!
                     * anAmount 
	^ self class amount: amount * anAmount unit: Millimeter.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:14:25'!
           test15
	
	self assert:  2 * aMeter = twoMeters! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:14:31'!
 adaptToNumber: aSmallInteger andSend: aSymbol 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:15:11' prior: 50346516!
                       adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class amount: aSmallInteger * amount unit: Millimeter.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:15:38'!
   test16
	
	| halfAMeter |
	self assert: aMeter / 2 = halfAMeter! !

!classDefinition: #XXXTest category: #Distance!
TestCase subclass: #XXXTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:16:03' prior: 50346067!
                             setUp
	aMeter := Distance amount: 1 unit: Meter.
	halfAMeter := Distance amount: 1/2 unit: Meter.
	twoMeters := Distance amount: 2 unit: Meter.
	hundredCentimeters := Distance amount: 100 unit: Centimeter.
	twoHundredCentimeters := Distance amount: 200 unit: Centimeter.
	thousandMillimeters := Distance amount: 1000 unit: Millimeter.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:16:11' prior: 50346528!
                  test16
	
	self assert: aMeter / 2 = halfAMeter! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:16:17'!
 / aSmallInteger 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:16:52' prior: 50346560!
                     / aNumber 
	^ self class amount: amount / aNumber unit: Millimeter.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:18:09'!
             test13TwoMetersMinusHundredCentimetersEqualsAThousandMillimeters
	
	self assert:  (twoMeters - hundredCentimeters) = thousandMillimeters! !

XXXTest removeSelector: #test13!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:18:28'!
      test14AMeterTimesTwoEqualsTwoMeters
	
	self assert:  aMeter * 2 = twoMeters! !

XXXTest removeSelector: #test14!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:18:42'!
   test15TwoTimesAMeterEqualsTwoMeters
	
	self assert:  2 * aMeter = twoMeters! !

XXXTest removeSelector: #test15!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:18:55'!
   test16AMeterDividedByTwoEqualsHalfAMeter
	
	self assert: aMeter / 2 = halfAMeter! !

XXXTest removeSelector: #test16!

Centimeter removeSelector: #toMeter!

Centimeter removeSelector: #toMillimeter!

Meter removeSelector: #toMeter!

Meter removeSelector: #toCentimeters!

Millimeter removeSelector: #toMillimeter!

Millimeter removeSelector: #toCentimeters!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:20:14'!
              test17
	
	| tenKilometers |
	self assert: tenKilometers > aMeter! !

!classDefinition: #XXXTest category: #Distance!
TestCase subclass: #XXXTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Kilometer category: #Distance!
Object subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:20:41' prior: 50346542!
                              setUp
	aMeter := Distance amount: 1 unit: Meter.
	halfAMeter := Distance amount: 1/2 unit: Meter.
	twoMeters := Distance amount: 2 unit: Meter.
	hundredCentimeters := Distance amount: 100 unit: Centimeter.
	twoHundredCentimeters := Distance amount: 200 unit: Centimeter.
	thousandMillimeters := Distance amount: 1000 unit: Millimeter.
	tenKilometers := Distance amount: 10 unit: Kilometer.! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:20:57' prior: 50346604!
                           test17
	
	self assert: tenKilometers > aMeter! !
!Kilometer class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:21:09'!
                           translateThisAmountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Kilometer class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:21:49' prior: 50346645!
              translateThisAmountToMillimeters: anAmount
	^ anAmount * 100000! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:21:55'!
                > aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:22:10' prior: 50346656!
                         > aDistance 
	^ amount > aDistance amount! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:22:31' prior: 50346640!
                       test17
	
	self assert: aMeter < twoMeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:22:35'!
       test18
	
	self assert: aMeter < twoMeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:22:54' prior: 50346666!
                       test17
	
	self assert: tenKilometers > aMeter! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:23:02'!
  < aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:23:56' prior: 50346679!
                         < aDistance 
	^ amount < aDistance amount! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:24:28'!
       test19
	
	self assert: tenKilometers >= aMeter ! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:24:36'!
>= aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:24:53' prior: 50346692!
                        >= aDistance 
	^ amount >= aDistance amount! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:25:04'!
     test20
	
	self assert: tenKilometers >= aMeter ! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:25:27' prior: 50346701!
                 test20
	
	self assert: aMeter <= twoMeters ! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:25:33'!
    <= aDistance 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:25:47' prior: 50346710!
                        <= aDistance 
	^ amount <= aDistance amount! !

----SNAPSHOT----#(25 May 2017 8:25:58.951103 pm) Cuis5.0-3081-spur-64.image priorSource: 383142!

!classDefinition: #DistanceUnit category: #Distance!
Object subclass: #DistanceUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

DistanceUnit subclass: #Centimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Centimeter category: #Distance!
DistanceUnit subclass: #Centimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

DistanceUnit subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Kilometer category: #Distance!
DistanceUnit subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

DistanceUnit subclass: #Meter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Meter category: #Distance!
DistanceUnit subclass: #Meter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

DistanceUnit subclass: #Millimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #Millimeter category: #Distance!
DistanceUnit subclass: #Millimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!DistanceUnit class methodsFor: 'no messages' stamp: 'GDS 5/25/2017 20:27:16'!
                 translateThisAmountToMillimeters: anAmount
	self subclassResponsibility ! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:28:27'!
        test17TenKilometersIsGreaterThanAMeter
	
	self assert: tenKilometers > aMeter! !

XXXTest removeSelector: #test17!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:28:45'!
 test18AMeterIsLesserThanTwoMeters
	
	self assert: aMeter < twoMeters! !

XXXTest removeSelector: #test18!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:28:59'!
          test19TenKilometersIsGreaterOrEqualThanAMeter
	
	self assert: tenKilometers >= aMeter ! !

XXXTest removeSelector: #test19!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:29:16'!
                        test20AMeterIsLowerOrEqualThanTwoMeters
	
	self assert: aMeter <= twoMeters ! !

XXXTest removeSelector: #test20!

----SNAPSHOT----#(25 May 2017 8:29:22.368122 pm) Cuis5.0-3081-spur-64.image priorSource: 482190!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:30:26' prior: 50346219!
               + aDistance 
	^ self class amount: amount + aDistance amount unit: Millimeter! !

----SNAPSHOT----#(25 May 2017 8:32:20.887284 pm) Cuis5.0-3081-spur-64.image priorSource: 484689!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:33:29' prior: 50346624!
                 setUp
	aMeter := 1 meters.
	halfAMeter := 1/2 meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.! !

"E" XXXTest debug: #test01MeterIsEqualToHimself!
!Number methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:33:55'!
                    meters
	self shouldBeImplemented! !
!Number methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:34:32' prior: 50346822!
 meters
	^ Distance amount: self * 1000! !
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:34:43'!
   amount: aSmallInteger 
	self shouldBeImplemented! !
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:35:16' prior: 50346830!
         amount: anAmount
	^ self ! !
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:35:45' prior: 50346835!
amount: anAmount
	^ self new initializeWithAmount: anAmount! !

"E" XXXTest debug: #test01MeterIsEqualToHimself!
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:36:27' prior: 50346810!
                   setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.! !

"E" XXXTest debug: #test01MeterIsEqualToHimself!
!Number methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:36:39'!
                  centimeters
	self shouldBeImplemented! !
!Number methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:36:54' prior: 50346858!
                            centimeters
	^ Distance amount: self * 10! !
!Number methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:37:03'!
        millimeters
	self shouldBeImplemented! !
!Number methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:37:15' prior: 50346867!
                            millimeters
	^ Distance amount: self! !
!Number methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:37:21'!
             kilometers
	self shouldBeImplemented! !
!Number methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:37:33' prior: 50346876!
                             kilometers
	^ Distance amount: self * 100000! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:38:04' prior: 50346084!
                    test02DifferentTwoMetersObjectAreEqual

	| anotherTwoMeters|
	anotherTwoMeters := 2 meters.
	self assert: twoMeters = anotherTwoMeters! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:38:14' prior: 50346098!
                          test04CannotCreateMetersWithNegativeAmount

	self should: [-1 meters] raise: Error description: 'Cannot create distances with negative amount'! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:38:33' prior: 50346142!
                  test11ThousandMillimetersEqualsToFiftyCentimetersPlusFiftyCentimeters
	
	| fiftyCentimeters |
	fiftyCentimeters := 50 centimeters.
	self assert: thousandMillimeters =  (fiftyCentimeters + fiftyCentimeters)! !
!XXXTest methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:38:45' prior: 50346152!
                   test12ThousandMillimetersPlusThousandMillimetersEqualsTwoThousandMillimeters
	
	| twoThousandMillimeters |
	
	twoThousandMillimeters := 2000 millimeters.
	self assert: (thousandMillimeters + thousandMillimeters) = twoThousandMillimeters! !
!Distance class methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:39:40' prior: 50346839!
             amount: anAmount
	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	^ self new initializeWithAmount: anAmount! !

Distance class removeSelector: #amount:unit:!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:40:07' prior: 50346507!
 * anAmount 
	^ self class amount: amount * anAmount.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:40:12' prior: 50346801!
           + aDistance 
	^ self class amount: amount + aDistance amount.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:40:16' prior: 50346493!
  - aDistance 
	^ self class amount: amount - aDistance amount.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:40:21' prior: 50346565!
  / aNumber 
	^ self class amount: amount / aNumber.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 20:40:28' prior: 50346522!
             adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class amount: aSmallInteger * amount.! !

Smalltalk removeClassNamed: #Centimeter!

Smalltalk removeClassNamed: #Kilometer!

Smalltalk removeClassNamed: #Meter!

Smalltalk removeClassNamed: #Millimeter!

Smalltalk removeClassNamed: #DistanceUnit!

----SNAPSHOT----#(25 May 2017 8:42:57.531723 pm) Cuis5.0-3081-spur-64.image priorSource: 484976!

----SNAPSHOT----#(25 May 2017 8:59:41.027965 pm) Cuis5.0-3081-spur-64.image priorSource: 490029!

----SNAPSHOT----#(25 May 2017 9:07:50.548781 pm) Cuis5.0-3081-spur-64.image priorSource: 490127!

----SNAPSHOT----#(25 May 2017 9:08:21.210223 pm) Cuis5.0-3081-spur-64.image priorSource: 490225!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 21:11:37'!
     test21

	self assert: (1 meters to: 3 meters).! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 21:15:33' prior: 50346976!
                         test21
	| lalala |
	lalala := (1 meters to: 3 meters).
	self assert: false.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 21:19:04' prior: 50346981!
                            test21
	| lalala |
	lalala := (1 meters to: 3 meters).
	self assert: lalala size = 3.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 21:19:55' prior: 50346987!
                  test21
	| lalala |
	lalala := (1 meters to: 3 meters).
	self assert: lalala size = 3.
	self assert: lalala first = 1.
	self assert: lalala second = 2.
	self assert: lalala third = 3.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 21:21:19' prior: 50346993!
                 test21
	| lalala |
	lalala := (1 meters to: 3 meters).
	self assert: lalala size = 3.
	self assert: (lalala at: 1) = 1.
	self assert: (lalala at: 2) = 2.
	self assert: (lalala at: 3) = 3.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 21:22:09' prior: 50347002!
          test21
	| lalala |
	lalala := (1 meters to: 3 meters).
	self assert: lalala size = 3.
	self assert: (lalala at: 1) = 1 meters.
	self assert: (lalala at: 2) = 2 meters.
	self assert: (lalala at: 3) = 3 meters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 21:22:30' prior: 50347011!
                     test21
	| lalala |
	lalala := 1 meters to: 3 meters.
	self assert: lalala size = 3.
	self assert: (lalala at: 1) = 1 meters.
	self assert: (lalala at: 2) = 2 meters.
	self assert: (lalala at: 3) = 3 meters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 21:23:23' prior: 50347021!
                       test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters.
	! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/25/2017 21:23:37'!
                             to: aDistance 
	self shouldBeImplemented! !

----SNAPSHOT----#(25 May 2017 9:25:55.46585 pm) Cuis5.0-3081-spur-64.image priorSource: 490323!

----QUIT----#(25 May 2017 9:25:57.713056 pm) Cuis5.0-3081-spur-64.image priorSource: 492779!

----STARTUP----#(29 May 2017 5:53:00.127179 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!

!UndefinedObject methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 18:00:25'!
                          isTerminated
	self shouldBeImplemented! !
!UndefinedObject methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 18:00:31' prior: 50347061!
                  isTerminated
! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 18:14:25' prior: 50347046!
                  to: aDistance 
	^ Interval from: amount / 1000 to: aDistance amount /1000! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:16:08' prior: 50347031!
                              test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters.
	! !

fromOneMeterToThreeMetersInterval size!

fromOneMeterToThreeMetersInterval size = 3.!

(fromOneMeterToThreeMetersInterval at: 1)!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 18:19:22' prior: 50347070!
          to: aDistance 
	^ Interval from: self to: aDistance! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 18:20:17' prior: 50347095!
            to: aDistance 
	^ Interval from: amount to: aDistance amount / 1000! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:20:59' prior: 50347076!
    test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3.
	! !

fromOneMeterToThreeMetersInterval size!

fromOneMeterToThreeMetersInterval size!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 18:25:26' prior: 50347100!
                to: aDistance 
	^ Interval from: amount / amount to: aDistance amount / 1000! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 18:25:29' prior: 50347122!
                   to: aDistance 
	^ Interval from: amount / 1000 to: aDistance amount / 1000! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:26:04' prior: 50347105!
                             test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:28:08'!
                          test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 100 centimeters to: 300 centimeters.
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3.
	! !

DistanceTest removeSelector: #test22!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:29:29' prior: 50347134!
                     test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:30:32'!
                    test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:39:43' prior: 50347180!
             test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2.
	self assert: (fromOneMeterToThreeMetersInterval last) = 3.
	! !

1 meters to: 3 meters.!

self first!

self last!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:40:55' prior: 50347197!
                            test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval first) = 1.
	self assert: (fromOneMeterToThreeMetersInterval last) = 3.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:41:23' prior: 50347216!
           test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 200.
	self assert: (fromOneMeterToThreeMetersInterval first) = 1.
	self assert: (fromOneMeterToThreeMetersInterval last) = 3.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:41:54' prior: 50347231!
         test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 200.
	self assert: (fromOneMeterToThreeMetersInterval first) = 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers.
	! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 18:51:17'!
                         to: aDistance by: aDistance2 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 18:51:34' prior: 50347262!
        to: aDistance by: aDistanceCount 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 18:54:20' prior: 50347267!
    to: aDistance by: aDistanceStep 
	^ Interval from: amount to: aDistance amount by: aDistanceStep amount! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:54:44' prior: 50347246!
test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 200.
	self assert: (fromOneMeterToThreeMetersInterval first) = 5 centimeters amount.
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers amount.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:54:51' prior: 50347164!
   test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:54:59' prior: 50347294!
                      test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3.
	! !

fromOneMeterToThreeMetersInterval size!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 18:55:27' prior: 50347278!
                           test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 5 centimeters amount.
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers amount.
	! !

----SNAPSHOT----#(29 May 2017 7:03:50.172046 pm) Cuis5.0-3081-spur-64.image priorSource: 492876!

(fromOneMeterToThreeMetersInterval first)!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 19:10:50' prior: 50347329!
                 test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers amount.
	! !

(fromOneMeterToThreeMetersInterval last)!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 19:18:33' prior: 50347348!
                         test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters) amount.
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters) amount.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 19:18:49' prior: 50347364!
                              test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters) amount.
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters) amount.
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers amount.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 19:22:07'!
              test23
	| fromOneMeterToThreeMetersInterval |
	1 meters to: 10 kilometers by: 5 centimeters do: [ | iterationCounter | iterationCounter := iterationCounter + 1]. 
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters) amount.
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters) amount.
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers amount.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 19:22:47' prior: 50347407!
                             test23
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	1 meters to: 10 kilometers by: 5 centimeters do: [ iterationCounter := iterationCounter + 1]. 
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters) amount.
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters) amount.
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers amount.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 19:23:04' prior: 50347430!
 test23
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	1 meters to: 10 kilometers by: 5 centimeters do: [ iterationCounter := iterationCounter + 1]. 
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters) amount.
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters) amount.
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers amount.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 19:23:35' prior: 50347452!
             test23
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	1 meters to: 10 kilometers by: 5 centimeters do: [ iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:23:47'!
                to: aDistance by: aDistance2 do: aBlockClosure 
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:25:49' prior: 50347490!
                      to: aDistance by: aDistanceStep do: aBlockClosure 
	(self to: aDistance by: aDistanceStep) do: aBlockClosure ! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 19:27:58' prior: 50347477!
                          test23
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers by: 5 centimeters do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 19:41:44'!
                  test23ToByDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers by: 5 centimeters do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !

DistanceTest removeSelector: #test23!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:44:06' prior: 50347272!
   to: aDistance by: aDistanceStep 
	^ Interval from: self to: aDistance by: aDistanceStep! !

"E" DistanceTest debug: #test22!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:45:15' prior: 50347534!
      to: aDistance by: aDistanceStep 
	^ Interval from: self to: aDistance by: aDistanceStep amount! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:45:18' prior: 50347541!
 to: aDistance by: aDistanceStep 
	^ Interval from: self to: aDistance amount by: aDistanceStep amount! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:45:22' prior: 50347547!
                          to: aDistance by: aDistanceStep 
	^ Interval from: amount to: aDistance amount by: aDistanceStep amount! !

Object subclass: #DistanceFactory
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #DistanceFactory category: #Distance!
Object subclass: #DistanceFactory
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

Object subclass: #DistanceFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!

!classDefinition: #DistanceFactory category: #Distance!
Object subclass: #DistanceFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance'!
!DistanceFactory methodsFor: 'nil' stamp: 'GDS 5/29/2017 19:57:00'!
                               minusOneMeter
	! !
!DistanceFactory methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:58:02' prior: 50347581!
         minusOneMeter
	^ -1 meters! !
!DistanceFactory methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:58:17'!
              oneCentimeter
	^ 1 centimeters.! !
!DistanceFactory methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:58:30'!
         oneHundredCentimeters
	^ 100 centimeters.! !
!DistanceFactory methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:58:43'!
                               oneMeter
	^ 1 meters.! !
!DistanceFactory methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:58:56'!
                   twoHundredCentimeters
	^ 200 centimeters.! !
!DistanceFactory methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:59:08'!
                               twoMeters
	^ 2 meters.! !
!DistanceFactory methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 19:59:17'!
                  zeroMeters
	^ 0 meters.! !

----SNAPSHOT----#(29 May 2017 8:01:27.902007 pm) Cuis5.0-3081-spur-64.image priorSource: 502155!

----SNAPSHOT----#(29 May 2017 8:01:30.065043 pm) Cuis5.0-3081-spur-64.image priorSource: 510842!

Object subclass: #DistanceFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #DistanceFactory category: #'Distance-Solution'!
Object subclass: #DistanceFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

TestCase subclass: #DistanceTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #DistanceTest category: #'Distance-Solution'!
TestCase subclass: #DistanceTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

Object subclass: #Distance
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Distance category: #'Distance-Solution'!
Object subclass: #Distance
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

----SNAPSHOT----#(29 May 2017 8:02:25.75101 pm) Cuis5.0-3081-spur-64.image priorSource: 510940!

!classDefinition: #Centimeters category: #'Distance-Solution'!
Object subclass: #Centimeters
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 5/29/2017 20:05:28' prior: 50346863!
      centimeters
	^ Distance withAmount: self andUnit: Centimeters! !

Smalltalk removeClassNamed: #Centimeters!

!classDefinition: #Centimeter category: #'Distance-Solution'!
Object subclass: #Centimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 5/29/2017 20:06:46' prior: 50347669!
                     centimeters
	^ Distance withAmount: self andUnit: Centimeter! !

!classDefinition: #Kilometer category: #'Distance-Solution'!
Object subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 5/29/2017 20:07:10' prior: 50346881!
   kilometers
	^ Distance withAmount: self andUnit: Kilometer! !

!classDefinition: #Meter category: #'Distance-Solution'!
Object subclass: #Meter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 5/29/2017 20:07:31' prior: 50346826!
             meters
	^ Distance withAmount: self andUnit: Meter! !

!classDefinition: #Millimeter category: #'Distance-Solution'!
Object subclass: #Millimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 5/29/2017 20:07:49' prior: 50346872!
           millimeters
	^ Distance withAmount: self andUnit: Millimeter! !

"E" DistanceTest debug: #test01MeterIsEqualToHimself!
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/29/2017 20:09:00'!
                        withAmount: aSmallInteger andUnit: aClass 
	self shouldBeImplemented! !
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/29/2017 20:09:19' prior: 50347722!
                       withAmount: anAmount andUnit: aDistanceUnit 
	self shouldBeImplemented! !
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/29/2017 20:10:42' prior: 50347728!
                     withAmount: anAmount andUnit: aDistanceUnit 
	^ self new initializeWithAmount: (aDistanceUnit amountToMillimeters: anAmount)! !
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:10:56'!
                amountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:11:17' prior: 50347741!
                               amountToMillimeters: anAmount
	^ anAmount * 100! !
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:11:26'!
                        amountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:11:48' prior: 50347752!
                          amountToMillimeters: anAmount
	^ anAmount * 100! !
!Millimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:12:03'!
                        amountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Millimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:12:12' prior: 50347763!
                          amountToMillimeters: anAmount
	^ self! !
!Kilometer class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:12:20'!
   amountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!Kilometer class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:12:30' prior: 50347773!
                           amountToMillimeters: anAmount
	^ self * 100000! !
!Kilometer class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:12:44' prior: 50347779!
          amountToMillimeters: anAmount
	^ anAmount * 100000! !

"E" DistanceTest debug: #test01MeterIsEqualToHimself!

"E" DistanceTest debug: #test12ThousandMillimetersPlusThousandMillimetersEqualsTwoThousandMillimeters!
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:13:30' prior: 50347747!
           amountToMillimeters: anAmount
	^ anAmount * 1000! !

"E" DistanceTest debug: #test12ThousandMillimetersPlusThousandMillimetersEqualsTwoThousandMillimeters!
!Millimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:14:29' prior: 50347769!
                               amountToMillimeters: anAmount
	^ anAmount! !

"E" DistanceTest debug: #test13TwoMetersMinusHundredCentimetersEqualsAThousandMillimeters!

amount - aDistance amount!

aDistance amount!

amount!
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:16:43' prior: 50347758!
                          amountToMillimeters: anAmount
	^ anAmount * 10! !
!Kilometer class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:17:07' prior: 50347784!
          amountToMillimeters: anAmount
	^ anAmount * 1000000! !
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/29/2017 20:18:00' prior: 50347734!
        withAmount: anAmount andUnit: aDistanceUnit 
	anAmount < 0 ifTrue: [self error: 'Cannot create distances with negative amount'].
	^ self new initializeWithAmount: (aDistanceUnit amountToMillimeters: anAmount)! !
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/29/2017 20:18:59' prior: 50347823!
           withAmount: anAmount andUnit: aDistanceUnit 

	^ self amount: (aDistanceUnit amountToMillimeters: anAmount)! !

Object subclass: #DistanceUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #DistanceUnit category: #'Distance-Solution'!
Object subclass: #DistanceUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

DistanceUnit subclass: #Millimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Millimeter category: #'Distance-Solution'!
DistanceUnit subclass: #Millimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

DistanceUnit subclass: #Meter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Meter category: #'Distance-Solution'!
DistanceUnit subclass: #Meter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

DistanceUnit subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Kilometer category: #'Distance-Solution'!
DistanceUnit subclass: #Kilometer
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

DistanceUnit subclass: #NameOfSubclass
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #NameOfSubclass category: #'Distance-Solution'!
DistanceUnit subclass: #NameOfSubclass
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

Smalltalk removeClassNamed: #NameOfSubclass!

DistanceUnit subclass: #Centimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Centimeter category: #'Distance-Solution'!
DistanceUnit subclass: #Centimeter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!DistanceUnit class methodsFor: 'no messages' stamp: 'GDS 5/29/2017 20:21:15'!
                amountToMillimeters: anAmount
	^ self subclassResponsibility ! !

----SNAPSHOT----#(29 May 2017 8:25:10.990497 pm) Cuis5.0-3081-spur-64.image priorSource: 512279!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:31:05' prior: 50347311!
        test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:33:38' prior: 50347128!
                              to: aDistance 
	^ Interval from: self to: aDistance! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:34:36'!
                            abs
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:34:54' prior: 50347935!
  abs
	^ amount abs! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:36:14' prior: 50347913!
                      test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters.! !

fromOneMeterToThreeMetersInterval size!

1 meters to: 3 meters.!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:40:07' prior: 50347943!
               test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3.! !

Distance removeSelector: #abs!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:46:04'!
              abs
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:46:17' prior: 50347979!
  abs
	^ self! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:46:55' prior: 50347983!
                    abs
	^ amount! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:47:27' prior: 50347962!
                          test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters amount.! !

Distance removeSelector: #abs!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:49:38' prior: 50347930!
                    to: aDistance 
	^ Interval from: amount / 1000 to: aDistance amount / 1000! !

1 meters amount!

fromOneMeterToThreeMetersInterval at: 1!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:50:34' prior: 50348010!
                         to: aDistance 
	^ Interval from: amount to: aDistance amount! !

----STARTUP----#(29 May 2017 8:51:28.062131 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!

!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:51:45' prior: 50347311!
    test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: fromOneMeterToThreeMetersInterval size = 3.
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters amount.
	! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:52:08' prior: 50347128!
                  to: aDistance 
	^ Interval from: amount to: aDistance amount! !

1 meters amount!

fromOneMeterToThreeMetersInterval at: 1!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:52:30' prior: 50348027!
               test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters amount.
	! !

2 meters amount!

fromOneMeterToThreeMetersInterval at: 2!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:53:02' prior: 50348045!
                to: aDistance 
	^ Interval from: amount to: aDistance amount by: 1000! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:56:10' prior: 50347517!
  test23ToByDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers by: 5 centimeters do: [ :anAmount | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !

----SNAPSHOT----#(29 May 2017 8:56:56.419518 pm) Cuis5.0-3081-spur-64.image priorSource: 520288!

Interval subclass: #DistanceInterval
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #DistanceInterval category: #'Distance-Solution'!
Interval subclass: #DistanceInterval
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:57:33' prior: 50348052!
               test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters amount.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:57:46' prior: 50348105!
            test21
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:57:53' prior: 50347386!
 test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters amount.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters) amount.
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:57:57' prior: 50348136!
            test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: Interval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:58:04' prior: 50348075!
                          test23ToByDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers by: 5 centimeters do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 20:58:13' prior: 50348157!
                  test22
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers.! !

"F" DistanceTest debug: #test21!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 20:58:37' prior: 50348070!
        to: aDistance 
	^ DistanceInterval from: amount to: aDistance amount by: 1000! !
!DistanceInterval class methodsFor: 'no messages' stamp: 'GDS 5/29/2017 21:00:37'!
                            from: startDistance to: stopDistance

	^self new  setFrom: startDistance to: stopDistance count: (stopDistance-startDistance) + 1 millimeters! !
!DistanceInterval class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:00:38' prior: 50348222!
    from: startDistance to: stopDistance

	^self new  setFrom: startDistance to: stopDistance count: (stopDistance-startDistance) + 1 millimeters.! !

"F" DistanceTest debug: #test21!
!DistanceInterval class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:01:15' prior: 50348230!
 from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: (stopDistance-startDistance) + 1 millimeters.! !
!DistanceInterval methodsFor: 'nil' stamp: 'GDS 5/29/2017 21:02:55'!
          setFrom: startDistance to: stopDistance count: countInteger

	start _ startDistance.
	stop _ startDistance.
	count _ countInteger! !
!DistanceInterval class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:03:07' prior: 50348239!
                from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: (stopDistance-startDistance) + 1 millimeters amount.! !
!DistanceInterval class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:03:14' prior: 50348254!
                             from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) + 1 millimeters) amount.! !

"F" DistanceTest debug: #test21!
!DistanceInterval methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:03:53' prior: 50348246!
                               setFrom: startDistance to: stopDistance count: countInteger

	start _ startDistance.
	stop _ stopDistance.
	count _ countInteger! !

"F" DistanceTest debug: #test21!

fromOneMeterToThreeMetersInterval at: 1!

"F" DistanceTest debug: #test21!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:06:51' prior: 50348216!
                 to: aDistance 
	^ DistanceInterval from: amount to: aDistance amount! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:06:59' prior: 50348284!
                           to: aDistance 
	^ DistanceInterval from: self to: aDistance! !

"F" DistanceTest debug: #test21!

fromOneMeterToThreeMetersInterval at: 1!

fromOneMeterToThreeMetersInterval at: 2!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:09:40' prior: 50348290!
              to: aDistance 
	^ DistanceInterval from: self to: aDistance! !

"F" DistanceTest debug: #test21!

((stop-start)/(count-1)*(i-1))!

((stop-start)/(count-1)*(i-1))!
!DistanceInterval class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:14:14' prior: 50348263!
                  from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) + 1 meters) amount / 1000.! !
!DistanceInterval class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:16:06' prior: 50348308!
                         from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / 100) + 1.! !

"F" DistanceTest debug: #test21!
!DistanceInterval class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:16:37' prior: 50348317!
                               from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / 1000) + 1.! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:20:55' prior: 50347554!
              to: aDistance by: aDistanceStep 
	^ DistanceInterval from: self to: aDistance by: aDistanceStep! !
!DistanceInterval class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:22:04'!
  from: startDistance to: stopDistance by: stepDistance
	| count end |
	count _ stopDistance - startDistance / stepDistance + 1.
	(count closeTo: count rounded)
		ifTrue: [
			count _ count rounded.
			end _ stopDistance ]
		ifFalse: [
			count _ count truncated.
			end _ count-1 * stepDistance + startDistance ].
	^self from: startDistance to: end count: count! !
!DistanceInterval class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:22:45' prior: 50348341!
         from: startDistance to: stopDistance by: stepDistance
	| count end |
	count _ ((stopDistance amount - startDistance amount) / stepDistance amount) + 1.
	(count closeTo: count rounded)
		ifTrue: [
			count _ count rounded.
			end _ stopDistance ]
		ifFalse: [
			count _ count truncated.
			end _ count-1 * stepDistance + startDistance ].
	^self from: startDistance to: end count: count! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:28:16'!
                      test22Centimeters
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:28:22'!
      test23
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:28:26'!
  test24ToByDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers by: 5 centimeters do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !

DistanceTest removeSelector: #test23ToByDoAppliesOperationsToEveryDistanceInInterval!

DistanceTest removeSelector: #test22!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:28:50' prior: 50348371!
                    test22Centimeters
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 centimeters to: 3 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:29:41' prior: 50348426!
            test22Centimeters
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 centimeters to: 3 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 centimeters.
	! !

(stopDistance-startDistance) amount / 1000!
!DistanceInterval class methodsFor: 'as yet unclassified' stamp: 'GDS 5/29/2017 21:34:59' prior: 50348327!
                          from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / 1000) + 1.! !

----SNAPSHOT----#(29 May 2017 9:45:18.383871 pm) Cuis5.0-3081-spur-64.image priorSource: 526071!

----SNAPSHOT----#(29 May 2017 9:50:03.450169 pm) Cuis5.0-3081-spur-64.image priorSource: 538164!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:51:01'!
  test2OneMeterToThreeMetersIntervallHasOneMeterTwoMetersAndThreeMetersInIt
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:51:08'!
              test21OneMeterToThreeMetersIntervallHasOneMeterTwoMetersAndThreeMetersInIt
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters.
	! !

DistanceTest removeSelector: #test2OneMeterToThreeMetersIntervallHasOneMeterTwoMetersAndThreeMetersInIt!

DistanceTest removeSelector: #test21!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:51:52'!
                            test22OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 centimeters to: 3 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 centimeters.
	! !

DistanceTest removeSelector: #test22Centimeters!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:53:33'!
          test23OneMeterToTenKilometersBy5CentimetersIntervalHasElementsWith5CentimetersBetweenEachElement
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers.! !

DistanceTest removeSelector: #test23!

----SNAPSHOT----#(29 May 2017 9:54:03.016766 pm) Cuis5.0-3081-spur-64.image priorSource: 538262!
!Distance class methodsFor: 'private' stamp: 'GDS 5/29/2017 21:55:11' prior: 50346923!
             amount: anAmount
	anAmount < 0 ifTrue: [ self cannotCreateDistancesWithNegativeAmount ].
	^ self new initializeWithAmount: anAmount! !
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/29/2017 21:55:38' prior: 50347833!
                        withAmount: anAmount andUnit: aDistanceUnit 

	^ self error: 'Cannot create distances with negative amount'! !
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/29/2017 21:55:56'!
xxx

	^ self error: 'Cannot create distances with negative amount'! !
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/29/2017 21:55:38' prior: 50348569!
                         withAmount: anAmount andUnit: aDistanceUnit 

	^ self error: 'Cannot create distances with negative amount'! !
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/29/2017 21:55:38' prior: 50348581!
                withAmount: anAmount andUnit: aDistanceUnit 

	^ self error: 'Cannot create distances with negative amount'! !
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/29/2017 20:18:59' prior: 50348588!
                withAmount: anAmount andUnit: aDistanceUnit 

	^ self amount: (aDistanceUnit amountToMillimeters: anAmount)! !
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/29/2017 21:58:09'!
cannotCreateDistancesWithNegativeAmount

	^ self error: 'Cannot create distances with negative amount'! !

Distance class removeSelector: #xxx!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:59:35' prior: 50348513!
                           test22OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:59:41' prior: 50348609!
     test22OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 centimeters to: 3 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 meters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:59:46' prior: 50348627!
test22OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 centimeters to: 3 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 centimeters.
	! !

----SNAPSHOT----#(29 May 2017 10:00:20.114762 pm) Cuis5.0-3081-spur-64.image priorSource: 541017!

----QUIT----#(29 May 2017 10:00:43.813038 pm) Cuis5.0-3081-spur-64.image priorSource: 544414!

----STARTUP----#(30 May 2017 4:12:30.761319 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!

!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 16:14:02'!
                   test24OneMeterToTenKilometersBy5CentimetersIntervalHasElementsWith5CentimetersBetweenEachElement
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 16:14:08'!
        test25ToByDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers by: 5 centimeters do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !

DistanceTest removeSelector: #test24ToByDoAppliesOperationsToEveryDistanceInInterval!

DistanceTest removeSelector: #test23OneMeterToTenKilometersBy5CentimetersIntervalHasElementsWith5CentimetersBetweenEachElement!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 16:14:24'!
          test23
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 centimeters to: 3 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 centimeters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 16:15:30' prior: 50348719!
        test23
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 50 centimeters to: 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 50 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 60 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 70 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 4) = 80 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 5) = 90 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 6) = 100 centimeters.
	! !

"E" DistanceTest debug: #test22OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt!
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 5/30/2017 16:19:23' prior: 50348461!
                        from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / startDistance normalizeMillimetersToDistanceUnit) + 1.! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 5/30/2017 16:20:17' prior: 50348763!
                      from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / 1000) + 1.! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 5/30/2017 16:20:22' prior: 50348773!
  from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / 1000) + 1.! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 5/30/2017 16:21:22' prior: 50348781!
  from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / startDistance xxx) + 1.! !

"E" DistanceTest debug: #test21OneMeterToThreeMetersIntervallHasOneMeterTwoMetersAndThreeMetersInIt!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:21:39'!
           xxx
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:23:55' prior: 50348800!
  xxx
	^ unit normalizedUnitAmount! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:24:55' prior: 50348804!
                               xxx
	^ unit normalizedUnitValue! !

"E" DistanceTest debug: #test21OneMeterToThreeMetersIntervallHasOneMeterTwoMetersAndThreeMetersInIt!
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 16:26:43' prior: 50346932!
                             * anAmount 
	^ self class withAmount: amount * anAmount andUnit: Millimeter.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 16:27:04' prior: 50346937!
                      + aDistance 
	^ self class withAmount: amount + aDistance amount andUnit: Millimeter.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 16:27:11' prior: 50346942!
             - aDistance 
	^ self class withAmount: amount - aDistance amount andUnit: Millimeter.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 16:27:21' prior: 50346947!
             / aNumber 
	^ self class withAmount: amount / aNumber andUnit: Millimeter.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 16:27:29' prior: 50346952!
                        adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class withAmount: aSmallInteger * amount andUnit: Millimeter.! !

"E" DistanceTest debug: #test21OneMeterToThreeMetersIntervallHasOneMeterTwoMetersAndThreeMetersInIt!

!classDefinition: 'Distance class' category: #'Distance-Solution'!
Distance class
	instanceVariableNames: 'unit'!
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/30/2017 16:30:06' prior: 50348595!
              withAmount: anAmount andUnit: aDistanceUnit 
	unit := aDistanceUnit
	^ self amount: (aDistanceUnit amountToMillimeters: anAmount)! !

Distance class
	instanceVariableNames: ''!

!classDefinition: 'Distance class' category: #'Distance-Solution'!
Distance class
	instanceVariableNames: ''!
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/30/2017 16:31:54' prior: 50348855!
                               withAmount: anAmount andUnit: aDistanceUnit 
	anAmount < 0 ifTrue: [ self cannotCreateDistancesWithNegativeAmount ].
	^ self new initializeWithAmount: (aDistanceUnit amountToMillimeters: anAmount) andUnit: aDistanceUnit.! !

Distance class removeSelector: #amount:!
!Distance methodsFor: 'initialization' stamp: 'GDS 5/30/2017 16:32:27'!
              initializeWithAmount: anAmount andUnit: aDistanceUnit
	amount := anAmount.
	unit := aDistanceUnit.! !

Distance removeSelector: #initializeWithAmount:!

"E" DistanceTest debug: #test21OneMeterToThreeMetersIntervallHasOneMeterTwoMetersAndThreeMetersInIt!
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:33:00'!
                  normalizedUnitValue
	self shouldBeImplemented! !
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:33:11' prior: 50348890!
               normalizedUnitValue
	^ 1000! !

"E" DistanceTest debug: #test22OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt!
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:33:29'!
              normalizedUnitValue
	self shouldBeImplemented! !
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:33:37' prior: 50348903!
          normalizedUnitValue
	^ 100! !

(stopDistance-startDistance) amount / startDistance xxx!

(stopDistance-startDistance) amount!

(stopDistance-startDistance) amount!
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:36:06' prior: 50348908!
                       normalizedUnitValue
	^ 10! !

fromOneMeterToThreeMetersInterval at: 2!

start + ((stop-start)/(count-1)*(i-1))!

((stop-start)/(count-1)*(i-1))!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 16:39:29' prior: 50348735!
                          test23
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 50 centimeters to: 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 50 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 51 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 52 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 4) = 80 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 5) = 90 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval last) = 100 centimeters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 16:39:57' prior: 50348925!
           test23
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 50 centimeters to: 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 50 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 51 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 52 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 50) = 99 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval last) = 100 centimeters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 16:40:56'!
    test23FiftyCentimetersToOneMeterIntervalHasElementsWithOneCentimeterBetweenEachElement
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 50 centimeters to: 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 50 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 51 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 52 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 50) = 99 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval last) = 100 centimeters.
	! !

DistanceTest removeSelector: #test23!
!DistanceUnit class methodsFor: 'converting' stamp: 'GDS 5/30/2017 16:41:31'!
    normalizedUnitValue
	^ self subclassResponsibility ! !
!Kilometer class methodsFor: 'converting' stamp: 'GDS 5/30/2017 16:41:58'!
                              normalizedUnitValue
	^ 10! !
!Kilometer class methodsFor: 'converting' stamp: 'GDS 5/30/2017 16:42:25' prior: 50348997!
        normalizedUnitValue
	^ 1000000! !
!Kilometer class methodsFor: 'converting' stamp: 'GDS 5/30/2017 16:42:37' prior: 50347818!
   amountToMillimeters: anAmount
	^ anAmount * self normalizedUnitValue! !
!Meter class methodsFor: 'converting' stamp: 'GDS 5/30/2017 16:42:51' prior: 50347794!
 amountToMillimeters: anAmount
	^ anAmount * self normalizedUnitValue! !
!Millimeter class methodsFor: 'converting' stamp: 'GDS 5/30/2017 16:43:07'!
            normalizedUnitValue
	^ 1! !
!Centimeter class methodsFor: 'converting' stamp: 'GDS 5/30/2017 16:43:24' prior: 50347813!
        amountToMillimeters: anAmount
	^ anAmount * self normalizedUnitValue! !
!Millimeter class methodsFor: 'converting' stamp: 'GDS 5/30/2017 16:43:41' prior: 50347803!
                            amountToMillimeters: anAmount
	^ anAmount * self normalizedUnitValue! !
!DistanceUnit class methodsFor: 'converting' stamp: 'GDS 5/30/2017 16:44:05' prior: 50347905!
                          amountToMillimeters: anAmount
	^ anAmount * self normalizedUnitValue! !

Kilometer class removeSelector: #amountToMillimeters:!

Meter class removeSelector: #amountToMillimeters:!

Millimeter class removeSelector: #amountToMillimeters:!

Centimeter class removeSelector: #amountToMillimeters:!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:47:24'!
             unitNormalizedValue
	^ unit normalizedUnitValue! !

Distance removeSelector: #xxx!
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 5/30/2017 16:47:41' prior: 50348789!
    from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / startDistance unitNormalizedValue) + 1.! !
!DistanceUnit class methodsFor: 'normalization' stamp: 'GDS 5/30/2017 16:48:07'!
                             normalizedValue
	^ self subclassResponsibility ! !

DistanceUnit class removeSelector: #normalizedUnitValue!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:48:16' prior: 50349043!
                      unitNormalizedValue
	^ unit normalizedValue! !
!DistanceUnit class methodsFor: 'converting' stamp: 'GDS 5/30/2017 16:48:23' prior: 50349031!
                   amountToMillimeters: anAmount
	^ anAmount * self normalizedValue! !

"E" DistanceTest debug: #test02DifferentTwoMetersObjectAreEqual!
!Millimeter class methodsFor: 'normalization' stamp: 'GDS 5/30/2017 16:49:00'!
           normalizedValue
	^ 1! !

Millimeter class removeSelector: #normalizedUnitValue!
!Centimeter class methodsFor: 'normalization' stamp: 'GDS 5/30/2017 16:49:12'!
 normalizedValue
	^ 10! !
!Centimeter class methodsFor: 'normalization' stamp: 'GDS 5/30/2017 16:49:16' prior: 50349082!
        normalizedValue
	^ 10! !
!Kilometer class methodsFor: 'normalization' stamp: 'GDS 5/30/2017 16:49:21'!
                         normalizedValue
	^ 1000000! !
!Meter class methodsFor: 'normalization' stamp: 'GDS 5/30/2017 16:49:25'!
                        normalizedValue
	^ 1000! !

Meter class removeSelector: #normalizedUnitValue!

Kilometer class removeSelector: #normalizedUnitValue!

Centimeter class removeSelector: #normalizedUnitValue!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 16:51:02'!
                              test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !

aDistance!

----STARTUP----#(30 May 2017 4:53:38.570801 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!

!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 5/30/2017 16:55:16' prior: 50348461!
                               from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / startDistance normalizedUnitValue) + 1.! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 5/30/2017 16:55:19' prior: 50349124!
     from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / startDistance  normalizedUnitValue) + 1.! !

"E" DistanceTest debug: #test21OneMeterToThreeMetersIntervallHasOneMeterTwoMetersAndThreeMetersInIt!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:55:30'!
                          normalizedUnitValue
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:55:48' prior: 50349145!
                  normalizedUnitValue
	^ unit normalizedUnit! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 16:55:53' prior: 50349150!
                     normalizedUnitValue
	^ unit normalizedValue! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 16:56:36' prior: 50346932!
                       * anAmount 
	^ self class withAmount: amount * anAmount andUnit: Millimeter .! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 16:56:53' prior: 50346937!
                     + aDistance 
	^ self class withAmount: amount + aDistance amount andUnit: Millimeter.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 16:57:02' prior: 50346942!
             - aDistance 
	^ self class withAmount: amount - aDistance amount andUnit: Millimeter.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 16:57:26' prior: 50346947!
             / aNumber 
	^ self class withAmount: amount / aNumber andUnit: Millimeter.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 16:57:57' prior: 50346952!
                        adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class withAmount: aSmallInteger * amount andUnit: Millimeter.! !
!Distance class methodsFor: 'instance creation' stamp: 'GDS 5/30/2017 16:59:59' prior: 50348595!
       withAmount: anAmount andUnit: aDistanceUnit 
	anAmount < 0 ifTrue: [ self cannotCreateDistancesWithNegativeAmount ].
	^ self new initializeWithAmount: (aDistanceUnit amountToMillimeters: anAmount) andUnit: aDistanceUnit! !

Distance class removeSelector: #amount:!

Object subclass: #Distance
	instanceVariableNames: 'amountInMillimeters unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Distance category: #'Distance-Solution'!
Object subclass: #Distance
	instanceVariableNames: 'amountInMillimeters unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 17:01:18' prior: 50349160!
       * anAmount 
	^ self class withAmount: amountInMillimeters * anAmount andUnit: Millimeter .! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 17:01:27' prior: 50349172!
        - aDistance 
	^ self class withAmount: amountInMillimeters - aDistance amount andUnit: Millimeter.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 17:01:34' prior: 50349178!
/ aNumber 
	^ self class withAmount: amountInMillimeters / aNumber andUnit: Millimeter.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 17:01:40' prior: 50349184!
           adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class withAmount: aSmallInteger * amountInMillimeters andUnit: Millimeter.! !
!Distance methodsFor: 'initialization' stamp: 'GDS 5/30/2017 17:02:00' prior: 50346228!
   initializeWithAmount: anAmount
	amountInMillimeters := anAmount! !
!Distance methodsFor: 'initialization' stamp: 'GDS 5/30/2017 17:02:18'!
                     initializeWithAmount: anAmount andUnit: aDistanceUnit
	amountInMillimeters := anAmount.
	unit := aDistanceUnit.! !
!Distance methodsFor: 'accessing' stamp: 'GDS 5/30/2017 17:02:24' prior: 50346238!
                          amount
	^ amountInMillimeters! !
!Distance methodsFor: 'comparators' stamp: 'GDS 5/30/2017 17:02:31' prior: 50346684!
          < aDistance 
	^ amountInMillimeters < aDistance amount! !
!Distance methodsFor: 'comparators' stamp: 'GDS 5/30/2017 17:02:41' prior: 50346715!
                 <= aDistance 
	^ amountInMillimeters <= aDistance amount! !
!Distance methodsFor: 'comparators' stamp: 'GDS 5/30/2017 17:02:46' prior: 50346224!
               = aDistance 
	^ amountInMillimeters = (aDistance amount)! !
!Distance methodsFor: 'comparators' stamp: 'GDS 5/30/2017 17:02:50' prior: 50346661!
               > aDistance 
	^ amountInMillimeters > aDistance amount! !
!Distance methodsFor: 'comparators' stamp: 'GDS 5/30/2017 17:02:54' prior: 50346697!
                 >= aDistance 
	^ amountInMillimeters >= aDistance amount! !

"E" DistanceTest debug: #test03AMeterPlusAMeterEqualsTwoMeters!
!Distance methodsFor: 'maths operations' stamp: 'GDS 5/30/2017 17:03:21' prior: 50349166!
         + aDistance 
	^ self class withAmount: amountInMillimeters + aDistance amount andUnit: Millimeter.! !

"E" DistanceTest debug: #test21OneMeterToThreeMetersIntervallHasOneMeterTwoMetersAndThreeMetersInIt!
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 17:03:40'!
    normalizedValue
	self shouldBeImplemented! !
!Meter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 17:03:51' prior: 50349291!
                   normalizedValue
	^ 1000! !

"E" DistanceTest debug: #test22OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt!
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 17:04:00'!
                  normalizedValue
	self shouldBeImplemented! !
!Centimeter class methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 17:04:05' prior: 50349304!
              normalizedValue
	^ 10! !
!Millimeter class methodsFor: 'converting' stamp: 'GDS 5/30/2017 17:04:28'!
                           normalizedValue
	^ 1000! !
!Kilometer class methodsFor: 'converting' stamp: 'GDS 5/30/2017 17:04:36'!
                          normalizedValue
	^ 1000000! !
!DistanceUnit class methodsFor: 'converting' stamp: 'GDS 5/30/2017 17:04:48'!
                    normalizedValue
	^ self subclassResponsibility ! !
!Meter class methodsFor: 'converting' stamp: 'GDS 5/30/2017 17:05:01' prior: 50347794!
                      amountToMillimeters: anAmount
	^ anAmount * self normalizedValue! !
!Millimeter class methodsFor: 'converting' stamp: 'GDS 5/30/2017 17:05:17' prior: 50347803!
amountToMillimeters: anAmount
	^ anAmount * self normalizedValue! !
!Centimeter class methodsFor: 'converting' stamp: 'GDS 5/30/2017 17:05:26' prior: 50347813!
amountToMillimeters: anAmount
	^ anAmount * self normalizedValue ! !
!Kilometer class methodsFor: 'converting' stamp: 'GDS 5/30/2017 17:05:34' prior: 50347818!
amountToMillimeters: anAmount
	^ anAmount * self normalizedValue! !
!DistanceUnit class methodsFor: 'converting' stamp: 'GDS 5/30/2017 17:05:47' prior: 50347905!
                              amountToMillimeters: anAmount
	^ anAmount * self normalizedValue! !

Meter class removeSelector: #amountToMillimeters:!

Millimeter class removeSelector: #amountToMillimeters:!

Kilometer class removeSelector: #amountToMillimeters:!

Centimeter class removeSelector: #amountToMillimeters:!

"F" DistanceTest debug: #test03AMeterPlusAMeterEqualsTwoMeters!

"F" DistanceTest debug: #test09HundredCentimetersEqualsToThousandMillimeters!

"F" DistanceTest debug: #test12ThousandMillimetersPlusThousandMillimetersEqualsTwoThousandMillimeters!

"F" DistanceTest debug: #test09HundredCentimetersEqualsToThousandMillimeters!
!Millimeter class methodsFor: 'converting' stamp: 'GDS 5/30/2017 17:08:23' prior: 50349313!
                           normalizedValue
	^ 1! !

----SNAPSHOT----#(30 May 2017 5:09:34.505308 pm) Cuis5.0-3081-spur-64.image priorSource: 544513!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:10:00'!
 test26ToByDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers by: 5 centimeters do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !

DistanceTest removeSelector: #test24ToByDoAppliesOperationsToEveryDistanceInInterval!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:10:08'!
           test25OneMeterToTenKilometersBy5CentimetersIntervalHasElementsWith5CentimetersBetweenEachElement
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers.! !

DistanceTest removeSelector: #test23OneMeterToTenKilometersBy5CentimetersIntervalHasElementsWith5CentimetersBetweenEachElement!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:10:43' prior: 50348645!
                       test22OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 50 centimeters to: 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 50 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 51 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 52 centimeters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/29/2017 21:51:52' prior: 50349422!
             test22OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 centimeters to: 3 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 1 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 2 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 3 centimeters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:11:49'!
                            test23OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 50 centimeters to: 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 50 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 51 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 52 centimeters.
	! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:12:14' prior: 50349460!
             test23OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 50 centimeters to: 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval at: 1) = 50 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = 51 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 3) = 52 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval at: 50) = 99 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval last) = 1 meters.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:12:29'!
                 test24OneMeterToTenKilometersBy5CentimetersIntervalHasElementsWith5CentimetersBetweenEachElement
	| fromOneMeterToThreeMetersInterval |
	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToThreeMetersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToThreeMetersInterval first) = 1 meters.
	self assert: (fromOneMeterToThreeMetersInterval at: 2) = (1 meters + 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters).
	self assert: (fromOneMeterToThreeMetersInterval last) = 10 kilometers.! !

DistanceTest removeSelector: #test25OneMeterToTenKilometersBy5CentimetersIntervalHasElementsWith5CentimetersBetweenEachElement!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:12:35'!
       test25ToByDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers by: 5 centimeters do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !

DistanceTest removeSelector: #test26ToByDoAppliesOperationsToEveryDistanceInInterval!

----SNAPSHOT----#(30 May 2017 5:12:40.867423 pm) Cuis5.0-3081-spur-64.image priorSource: 567127!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:12:49' prior: 50349529!
                         test25ToByDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:13:03' prior: 50349551!
    test25ToByDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers by: 5 centimeters do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:13:14'!
  test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !

----SNAPSHOT----#(30 May 2017 5:13:22.175572 pm) Cuis5.0-3081-spur-64.image priorSource: 572687!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:13:42' prior: 50349581!
    test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!Distance methodsFor: 'distance intervals' stamp: 'GDS 5/30/2017 17:15:52'!
 to: aDistance do: aBlockClosure 
	(self to: aDistance) do: aBlockClosure ! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:18:29' prior: 50349599!
                              test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | ]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !

----SNAPSHOT----#(30 May 2017 5:18:46.223174 pm) Cuis5.0-3081-spur-64.image priorSource: 574244!

----QUIT----#(30 May 2017 5:18:49.091572 pm) Cuis5.0-3081-spur-64.image priorSource: 575402!

----STARTUP----#(30 May 2017 5:18:51.696467 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!

!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:19:00' prior: 50349619!
                         test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | iterationCounter := iterationCounter ]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:19:17' prior: 50349643!
                           test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: (10 kilometers) do: [ :aDistance | iterationCounter := iterationCounter ]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:19:29' prior: 50349658!
                         test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | iterationCounter := iterationCounter ]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:19:40' prior: 50349673!
                           test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | iterationCounter := iterationCounter + 1 ]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:19:43' prior: 50349688!
                       test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | iterationCounter := iterationCounter ]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:20:00' prior: 50349703!
                           test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | iterationCounter := iterationCounter +1 ]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!Distance methodsFor: 'distance intervals' stamp: 'GDS 5/30/2017 17:21:01' prior: 50349613!
                 to: aDistance do: aBlockClosure 
	(self to: aDistance) do: aBlockClosure ! !

----STARTUP----#(30 May 2017 5:21:39.44284 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!

!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:21:59' prior: 50349619!
                        test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | iterationCounter := iterationCounter ]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:23:02' prior: 50349743!
                           test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter|
	iterationCounter := 0. 
	1 meters to: 10 kilometers do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:24:34' prior: 50349758!
                        test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter oneMeter |
	iterationCounter := 0. 
	
	oneMeter to: tenKilometers do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:24:50' prior: 50349773!
            test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter oneMeter |
	iterationCounter := 0. 
	oneMeter := 1 meters.
	oneMeter to: tenKilometers do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:25:37' prior: 50349788!
                       test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter |
	iterationCounter := 0. 

	aMeter to: tenKilometers do: [ :aDistance | iterationCounter := iterationCounter + 1]. 

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !

aMeter to: tenKilometers!

start amount!

stop amount !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 5/30/2017 17:35:11' prior: 50349613!
                       to: aDistance do: aBlockClosure 
	self halt.
	(self to: aDistance) do: aBlockClosure ! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:36:57' prior: 50349804!
                  test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter |
	iterationCounter := 0. 

	aMeter to: tenKilometers do: [ :aDistance | iterationCounter := iterationCounter + 1 ].

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:37:20' prior: 50349827!
                        test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter |
	iterationCounter := 0. 

	aMeter to: tenKilometers do: [ iterationCounter := iterationCounter + 1 ].

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !

(self to: aDistance)!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:38:47' prior: 50349842!
              test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter |
	iterationCounter := 0. 

	aMeter to: tenKilometers do: [ :lalaa | iterationCounter := iterationCounter + 1 ].

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:39:14' prior: 50349857!
                            test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter |
	iterationCounter := 0. 

	aMeter to: tenKilometers do: [ :lalaa | iterationCounter := iterationCounter + 1 ].

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!Distance methodsFor: 'distance intervals' stamp: 'GDS 5/30/2017 17:42:30' prior: 50349821!
                     to: aDistance do: aBlockClosure 
	(self to: aDistance) do: aBlockClosure ! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:47:46' prior: 50349872!
                              test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter |
	iterationCounter := 0. 

	aMeter to: tenKilometers do: [ :aDistance | iterationCounter := iterationCounter + 1 ].

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:49:43' prior: 50349893!
                        test26ToDoAppliesOperationsToEveryDistanceInInterval
	| fromOneMeterToThreeMetersInterval  iterationCounter |
	iterationCounter := 0. 

	aMeter to: tenKilometers do: [ :aDistance |
										 iterationCounter := iterationCounter + 1 ].

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter 
! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 5/30/2017 17:54:09' prior: 50349908!
             test26ToDoAppliesOperationsToEveryDistanceInInterval
	" Este test esta fallando y no sabemos el motivo. El debugger empieza a usar mensajes extraos y no entra en el mensaje to: do: 
	
	| fromOneMeterToThreeMetersInterval  iterationCounter |
	iterationCounter := 0. 

	aMeter to: tenKilometers do: [ :aDistance |
										 iterationCounter := iterationCounter + 1 ].

	fromOneMeterToThreeMetersInterval := 1 meters to: 10 kilometers.
	
	self assert: fromOneMeterToThreeMetersInterval size = iterationCounter "
	
! !

----SNAPSHOT----#(30 May 2017 5:54:22.916947 pm) Cuis5.0-3081-spur-64.image priorSource: 575500!

----SNAPSHOT----#(30 May 2017 5:55:55.405 pm) Cuis5.0-3081-spur-64.image priorSource: 585316!

----STARTUP----#(1 June 2017 7:03:06.678887 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!


TestCase subclass: #CatedraDistanceTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Exercise'!

!classDefinition: #CatedraDistanceTest category: #'Distance-Exercise'!
TestCase subclass: #CatedraDistanceTest
	instanceVariableNames: 'factory'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Exercise'!
!CatedraDistanceTest methodsFor: '1 - Test equality' stamp: 'HernanWilkinson 4/18/2011 15:04'!
                           test01ObjectsRepresentingSameDistanceShouldBeEqual

	self assert: self oneMeter = self oneMeter.
	self assert: self oneHundredCentimeters = self oneHundredCentimeters.
	

! !
!CatedraDistanceTest methodsFor: '1 - Test equality' stamp: 'HernanWilkinson 4/18/2011 16:50'!
                  test02DiferentDistancesShouldNotBeEqual

	self deny: self oneMeter = self twoMeters.
	self deny: self twoMeters = self oneMeter! !
!CatedraDistanceTest methodsFor: '1 - Test equality' stamp: 'HernanWilkinson 4/18/2011 16:50'!
                              test03SameDistanceExpressWithDifferentUnitsShouldBeEqual

	self assert: self oneMeter = self oneHundredCentimeters.
	self assert: self twoMeters = self twoHundredCentimeters.

! !
!CatedraDistanceTest methodsFor: '1 - Test equality' stamp: 'HernanWilkinson 4/19/2011 10:28'!
             test04EqualsShouldBeCommutative

	self assert: (self oneMeter = self oneHundredCentimeters and: [ self oneHundredCentimeters = self oneMeter ]).
	self assert: (self twoMeters = self twoHundredCentimeters and:  [ self twoHundredCentimeters = self twoMeters ]).

! !
!CatedraDistanceTest methodsFor: '2 - Converting/accesing/printing' stamp: 'HernanWilkinson 4/19/2011 10:26'!
         test05UnitStringRepresentationShouldBeHumanReadable

	self assert: self meter printString = 'meter'.
	self assert: self centimeter printString = 'centimeter'.
	self assert: self decimeter printString = 'decimeter'.
	self assert: self millimeter printString = 'milimeter'.
	self assert: self decameter printString = 'decameter'.
	self assert: self hectometer printString = 'hectometer'.
	self assert: self kilometer printString = 'kilometer'.	! !
!CatedraDistanceTest methodsFor: '2 - Converting/accesing/printing' stamp: 'HAW 5/31/2017 11:17:17'!
                             test06DistanceStringRepresentationShouldBeHumanReadable

	self assert: self oneMeter printString = '1 meter'.
	self assert: self twoMeters printString = '2 meters'.
	self assert: self oneHundredCentimeters printString = '100 centimeters'.
	
! !
!CatedraDistanceTest methodsFor: '2 - Converting/accesing/printing' stamp: 'HernanWilkinson 4/19/2011 10:26'!
                             test07aDistanceAmountShouldBeTheExpectedAmount

	self assert: self oneMeter amount = 1.
	self assert: self twoMeters amount = 2.
	self assert: self oneHundredCentimeters amount = 100.
	self assert: self twoHundredCentimeters amount = 200.
! !
!CatedraDistanceTest methodsFor: '2 - Converting/accesing/printing' stamp: 'HernanWilkinson 4/19/2011 10:27'!
                               test07bDistanceUnitShouldBeTheExpectedUnit

	self assert: self oneMeter unit = self meter.
	self assert: self twoMeters unit = self meter.
	self assert: self oneHundredCentimeters unit = self centimeter.
	self assert: self twoHundredCentimeters unit = self centimeter.! !
!CatedraDistanceTest methodsFor: '2 - Converting/accesing/printing' stamp: 'HAW 5/31/2017 11:12:16'!
           test07cDifferentDistanceUnitsShouldBeDifferent

	| units unitsSet |
	
	units := self distanceUnits.
	unitsSet := units asSet.
	
	self assert: units size equals: unitsSet size.
	self assert: (unitsSet includesAllOf: units).! !
!CatedraDistanceTest methodsFor: '2 - Converting/accesing/printing' stamp: 'HernanWilkinson 4/19/2011 10:27'!
                test07dDistancesCanBeConvertedToDifferentUnits

	"A partir de los test de igualdad, se deben haber dado cuenta que debemos poder
	convertir distancias a distintas unidades... y que ademas dos distancias de distintas unidades
	pueden ser iguales... Por lo tanto por qu no hacer esta caracteristica de las distancias explicita?
	Veran que luego se torna muy util
	
	Respecto de como esta escrito el test, para no tener que escribir los assert para oneMeter y oneHundredCentimeters 
	creo un array y lo recorro... Se podria escribir menos aun en este test?
	
	Y por qu se asserta sobre el amount y luego la unidad y no directametne sobre la distancia completa. ej:
	self assert: (aDistance converTo: self meter) = self oneMeter
	"
	
	(Array with: self oneMeter with: self oneHundredCentimeters) do: [ :aDistance |
		self assert: (aDistance convertTo: self meter) amount = 1.
		self assert: (aDistance convertTo: self meter) unit = self meter.
		
		self assert: (aDistance convertTo: self decimeter) amount = 10.
		self assert: (aDistance convertTo: self decimeter) unit = self decimeter.
		
		self assert: (aDistance convertTo: self centimeter) amount = 100.
		self assert: (aDistance convertTo: self centimeter) unit = self centimeter.
		
		self assert: (aDistance convertTo: self millimeter) amount = 1000.
		self assert: (aDistance convertTo: self millimeter) unit = self millimeter.
	
		self assert: (aDistance convertTo: self decameter) amount = (1/10).
		self assert: (aDistance convertTo: self decameter) unit = self decameter.
		
		self assert: (aDistance convertTo: self hectometer) amount = (1/100).
		self assert: (aDistance convertTo: self hectometer) unit = self hectometer.
	
		self assert: (aDistance convertTo: self kilometer) amount = (1/1000).
		self assert: (aDistance convertTo: self kilometer) unit = self kilometer ]! !
!CatedraDistanceTest methodsFor: '3 - Test equality - implementation details' stamp: 'HernanWilkinson 4/19/2011 10:27'!
                 test08aComparingDistancesWithOtherObjectsShouldReturnFalse

	"El igual no debe generar ningun tipo de error por mas que se comparen objetos
	de distintos tipos
	Fijense como se crea una instancia de Object sin ningun tipo de problema... qu representa?"

	self deny: self oneMeter = Object new.
	self deny: Object new = self oneMeter! !
!CatedraDistanceTest methodsFor: '3 - Test equality - implementation details' stamp: 'HernanWilkinson 4/19/2011 10:27'!
                    test08bDistancesThatAreEqualShouldReturnTheSameHash

	"Debido a como funcionan los diccionarios, cuando dos objetos son iguales deben
	tener es mismo hash. La inversa no es verdad"
	
	self assert: self oneMeter hash=self oneMeter hash.
	self assert: self oneMeter hash=self oneHundredCentimeters hash.

	
	
! !
!CatedraDistanceTest methodsFor: '3 - Test equality - implementation details' stamp: 'HernanWilkinson 4/19/2011 10:27'!
                 test08cCopiesOfTheSameDistanceShouldBeEqual

	"Dos objetos que ocupan distintas posiciones de memoria pero representan
	la misma entidad de la realidad, deben devolver true cuando se los compara por igual, puesto
	que representan la misma entidad de la realidad.
	Por lo tanto, el mensaje #= significa 'representan el mismo ente de la realidad?'
	mientras que el mensaje #== significa ocupan la misma posicion de memoria?"

	| originalOneMeter copiedOneMeter |

	"Al objeto oneMeter lo copio para asegurarme de tener uno oneMeter en otra posicion de memoria"

	originalOneMeter := self oneMeter.
	copiedOneMeter := originalOneMeter copy.

	"Me aseguro que ocupen distinta posicion de memoria"
	self deny: originalOneMeter == copiedOneMeter.

	"Ahora me aseguro que sean iguales"
	self assert: originalOneMeter = copiedOneMeter! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:34'!
                  test09AddingDistancesOfSameUnitShouldReturnADistanceRepresentingTheAddingDistances

	self assert: (self oneMeter + self oneMeter) = self twoMeters

! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:34'!
                            test10AddingDistancesOfDifferentUnitShouldReturnADistanceRepresentingTheAddingDistances

	self assert: (self oneMeter + self oneHundredCentimeters) = self twoMeters.
	self assert: (self oneMeter + self oneHundredCentimeters) = self twoHundredCentimeters.

! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:35'!
                test11AddingDistancesIsCommutative

	self assert: (self oneMeter + self twoMeters)=(self twoMeters + self oneMeter)


! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:35'!
                          test12AddingDistancesIsAssociative

	self assert: 
		((self oneMeter + self oneMeter) + self twoMeters) = 
		(self oneMeter + (self oneMeter + self twoMeters))


! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:41'!
              test12aAddingDistancesKeepsDistanceInmutability

	| oneMeter |
	
	oneMeter := self oneMeter.
	oneMeter + oneMeter.
	
	self assert: oneMeter = self oneMeter.
	


! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:36'!
               test13aNegatingADistanceNegatesItsAmount

	self assert: self oneMeter negated = self minusOneMeter.
	
! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:36'!
          test13bNegatingADistanceIsReflective

	self assert: self oneMeter negated negated=self oneMeter.
	
! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:38'!
             test14SubtractingDistancesOfSameUnitShouldReturnADistanceRepresentingTheSubtractedDistances

	self assert: (self twoMeters - self oneMeter) = self oneMeter.
	self assert: (self oneMeter - self oneMeter) = self zeroMeters.
	self assert: (self oneMeter - self twoMeters) = self oneMeter negated
	

	! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:40'!
       test15SubtractingDistancesOfDifferentUnitShouldReturnADistanceRepresentingTheSubtractedDistances

	self assert: (self twoMeters - self oneHundredCentimeters) = self oneMeter.
	self assert: (self oneMeter - self oneHundredCentimeters) = self zeroMeters.
	self assert: (self oneHundredCentimeters - self twoMeters) = self oneMeter negated
	

	! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:40'!
                           test16SubtractingDistancesIsAssociative

	self assert: 
		((self twoMeters - self oneMeter) - self oneMeter) = 
		(self twoMeters - (self oneMeter + self oneMeter)).

	

	! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:41'!
     test16aSubtractingDistancesKeepsDistanceInmutability

	| oneMeter |
	
	oneMeter := self oneMeter.
	oneMeter - oneMeter.
	
	self assert: oneMeter = self oneMeter.
	


! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:45'!
          test17aDistancesCanBeMultiplyByAnInteger

	self assert: self oneMeter * 1 = self oneMeter.
	self assert: self oneMeter * 2 = self twoMeters.
	self assert: self oneMeter * 0 = self zeroMeters.
! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HAW 5/31/2017 11:16:54'!
                         test17bDistancesCanBeMultiplyByAFraction

	self assert: (self oneMeter * (2/3)) amount = (2/3).
	self assert: (self twoMeters * (2/3)) amount = (2 * (2/3)).
! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HAW 5/31/2017 11:17:22'!
                            test17cDistancesCanBeMultiplyByAFloat

	self assert: (self oneMeter * 2.5) amount = 2.5.
	self assert: (self twoMeters * 2.5) amount = (2 * 2.5).
! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:47'!
                              test18MultiplicationKeepsDistanceInmutability

	| oneMeter |
	
	oneMeter := self oneMeter.
	oneMeter * 2.
	
	self assert: oneMeter = self oneMeter.
	


! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:48'!
                        test19aDistancesCanBeDividedByAnInteger

	self assert: (self oneMeter / 1) = self oneMeter.
	self assert: (self twoMeters / 2) = self oneMeter.


! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/21/2011 17:24'!
                              test19bDistancesCanBeDividedByAFraction

	self assert: (self twoMeters / (1/3)) amount = 6.




! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:49'!
                test19cDistancesCanBeDividedByAFloat

	self assert: (self twoMeters / 2.5) amount = (2/2.5).




! !
!CatedraDistanceTest methodsFor: '4 - Test arithmetic operations' stamp: 'HernanWilkinson 4/18/2011 15:49'!
               test20DivisionKeepsDistanceInmutability

	| oneMeter |
	
	oneMeter := self oneMeter.
	oneMeter / 2.
	
	self assert: oneMeter = self oneMeter.
	


! !
!CatedraDistanceTest methodsFor: '5 - Test magnitude protocol' stamp: 'HAW 5/31/2017 11:19:04'!
          test21DistancesProvideATotalOrder

	self assert: (self distanceExamples allSatisfy: [ :aDistance | aDistance < (aDistance + self oneMeter)])

! !
!CatedraDistanceTest methodsFor: '5 - Test magnitude protocol' stamp: 'HAW 5/31/2017 11:19:09'!
              test22DistancesCanBeComparedWithGreaterThan

	self assert: (self distanceExamples allSatisfy: [ :aDistance | (aDistance + self oneMeter) > aDistance ])
! !
!CatedraDistanceTest methodsFor: '5 - Test magnitude protocol' stamp: 'HAW 5/31/2017 11:19:16'!
    test23DistancesCanBeComparedWithLessThanOrEqual

	self assert: (self distanceExamples allSatisfy: [ :aDistance | aDistance <= aDistance and: [aDistance <= (aDistance + self oneMeter)]])

	
! !
!CatedraDistanceTest methodsFor: '5 - Test magnitude protocol' stamp: 'HAW 5/31/2017 11:19:20'!
                               test24DistancesCanBeComparedWithGreaterThanOrEqual

	self assert: (self distanceExamples allSatisfy: [ :aDistance | aDistance >= aDistance and: [(aDistance + self oneMeter) >= aDistance]])
! !
!CatedraDistanceTest methodsFor: '5 - Test magnitude protocol' stamp: 'HernanWilkinson 4/18/2011 16:13'!
                      test25MaxReturnsTheMaximumBetweenTwoDistances

	self assert: (self twoMeters max: self oneMeter) = self twoMeters.
	self assert: (self oneMeter max: self twoMeters) = self twoMeters.

	self assert: (self twoMeters max: self oneHundredCentimeters) = self twoMeters.
	self assert: (self oneHundredCentimeters max: self twoMeters) = self twoMeters.

	
! !
!CatedraDistanceTest methodsFor: '5 - Test magnitude protocol' stamp: 'HernanWilkinson 4/18/2011 16:14'!
                      test26MinReturnsTheMinimumBetweenTwoDistances

	self assert: (self twoMeters min: self oneMeter) = self oneMeter.
	self assert: (self oneMeter min: self twoMeters) = self oneMeter.

	self assert: (self twoMeters min: self oneHundredCentimeters) = self oneHundredCentimeters.
	self assert: (self oneHundredCentimeters min: self twoMeters) = self oneHundredCentimeters.

	
! !
!CatedraDistanceTest methodsFor: '5 - Test magnitude protocol' stamp: 'HernanWilkinson 4/18/2011 16:14'!
test27BetweenAndReturnsTrueIfADistanceIsBetweenOtherTwoDistances

	self assert: (self oneMeter between: self zeroMeters and: self twoMeters).
	self assert: (self oneHundredCentimeters between: self zeroMeters and: self twoMeters).
	
	self deny: (self twoMeters between: self zeroMeters and: self oneMeter).
	self deny: (self twoHundredCentimeters between: self zeroMeters and: self oneMeter).

! !
!CatedraDistanceTest methodsFor: '6 - Test interval protocol' stamp: 'HernanWilkinson 4/18/2011 16:16'!
          test28IntervalOfDistancesCanBeCreatedBecauseTheyDefineATotalOrder

	self assert: (self oneMeter to: self twoMeters) from=self oneMeter.
	self assert: (self oneMeter to: self twoMeters) to=self twoMeters.
	self assert: (self oneMeter to: self twoMeters) by=self oneMeter.	

	self assert: (self oneHundredCentimeters to: self twoMeters) from=self oneMeter.
	self assert: (self oneHundredCentimeters to: self twoMeters) to=self twoMeters.
	self assert: (self oneHundredCentimeters to: self twoMeters) by=self oneCentimeter.	
	! !
!CatedraDistanceTest methodsFor: '6 - Test interval protocol' stamp: 'HernanWilkinson 4/18/2011 16:16'!
         test29DistanceIntervalStepCanBeAnyDistance

	self assert: (self zeroMeters to: (self twoMeters * 2) by: self twoMeters) from=self zeroMeters.
	self assert: (self zeroMeters to: (self twoMeters * 2) by: self twoMeters) to=(self twoMeters * 2).
	self assert: (self zeroMeters to: (self twoMeters * 2) by: self twoMeters) by=self twoMeters.

	self assert: ((self twoMeters * 2) to: self zeroMeters by: self twoMeters negated) from=(self twoMeters * 2).
	self assert: ((self twoMeters * 2) to: self zeroMeters by: self twoMeters negated) to=self zeroMeters.
	self assert: ((self twoMeters * 2) to: self zeroMeters by: self twoMeters negated) by=self twoMeters negated

	! !
!CatedraDistanceTest methodsFor: '6 - Test interval protocol' stamp: 'HernanWilkinson 4/18/2011 16:17'!
                          test30DistanceIntervalSizeReturnsTheNumberOfDistancesOfTheInterval

	self assert: (self zeroMeters to: (self twoMeters * 2) ) size =5.
	self assert: ((self twoMeters * 2) to: self zeroMeters by: self oneMeter negated) size =5.
! !
!CatedraDistanceTest methodsFor: '6 - Test interval protocol' stamp: 'HernanWilkinson 4/18/2011 16:19'!
                 test31DistanceIntervalCanBeEnumeratedUsingDo

	| value |
	
	value := 1.
	(self oneMeter to: (self oneMeter * 10)) do: [ :aDistance |
		self assert: aDistance amount = value.
		value := value + 1 ].
	
	self assert: value = 11
! !
!CatedraDistanceTest methodsFor: '6 - Test interval protocol' stamp: 'HernanWilkinson 4/18/2011 16:27'!
                   test32DistanceIntervalCanBeEnumeratedWithSpecificStep

	| value initialDistance byDistance finalDistance |
	
	initialDistance := self oneMeter.
	byDistance := self twoMeters.
	finalDistance := initialDistance * 9.
	value := initialDistance amount.
		
	(initialDistance to: finalDistance by:  byDistance) do: [ :aDistance |
		self assert: aDistance amount = value.
		value := value + byDistance amount ].
	
	self assert:  value = (finalDistance amount + byDistance amount)
! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'HAW 5/31/2017 12:35:39'!
                 centimeter

	self error: 'Este metodo debe devolver el objeto que la unidad de distancia centimetro'! !
!CatedraDistanceTest methodsFor: 'distance units'!
     decameter
	
	self error: 'Este metodo debe devolver el objeto que la unidad de distancia decametro'! !
!CatedraDistanceTest methodsFor: 'distance units'!
      decimeter
	
	self error: 'Este metodo debe devolver el objeto que la unidad de distancia decimetro'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'HAW 5/31/2017 12:37:50'!
      distanceUnits 

	"Quin se anima a explicar cmo funciona este mtodo? 
	Por qu est hecho as? "
		
	| unitsCategory unitMessageNames |
	
	unitsCategory := self class organization categoryOfElement: thisContext method selector.
	unitMessageNames := (self class organization listAtCategoryNamed:  unitsCategory) reject: [ :aMessageName | aMessageName = thisContext method selector ].
	
	 ^ unitMessageNames collect: [ :aMessageName | self perform: aMessageName ]
	
! !
!CatedraDistanceTest methodsFor: 'distance units'!
                     hectometer
	
	self error: 'Este metodo debe devolver el objeto que la unidad de distancia hectometro'! !
!CatedraDistanceTest methodsFor: 'distance units'!
    kilometer
	
	self error: 'Este metodo debe devolver el objeto que la unidad de distancia kilometro'! !
!CatedraDistanceTest methodsFor: 'distance units'!
      meter

	self error: 'Este metodo debe devolver el objeto que la unidad de distancia metro'! !
!CatedraDistanceTest methodsFor: 'distance units'!
               millimeter
	
	self error: 'Este metodo debe devolver el objeto que la unidad de distancia millimetro'! !
!CatedraDistanceTest methodsFor: 'distance measures' stamp: 'HAW 5/31/2017 11:20:12'!
 distanceExamples

	"Quin se anima a explicar cmo funciona este mtodo? 
	Por qu est hecho as? "
		
	| distanceCategory distanceMessageNames |
	
	distanceCategory := self class organization categoryOfElement: thisContext method selector.
	distanceMessageNames := (self class organization listAtCategoryNamed:  distanceCategory) reject: [ :aMessageName | aMessageName = thisContext method selector ].
	
	 ^ distanceMessageNames collect: [ :aMessageName | self perform: aMessageName ]
	
! !
!CatedraDistanceTest methodsFor: 'distance measures' stamp: 'HAW 5/31/2017 11:03:32'!
                           minusOneMeter 
	
	^factory minusOneMeter! !
!CatedraDistanceTest methodsFor: 'distance measures' stamp: 'HAW 5/31/2017 11:03:45'!
                              oneCentimeter
	
	^factory oneCentimeter ! !
!CatedraDistanceTest methodsFor: 'distance measures' stamp: 'HAW 5/31/2017 11:03:53'!
                              oneHundredCentimeters
	
	^factory oneHundredCentimeters ! !
!CatedraDistanceTest methodsFor: 'distance measures' stamp: 'HAW 5/31/2017 11:04:03'!
              oneMeter
	
	^factory oneMeter ! !
!CatedraDistanceTest methodsFor: 'distance measures' stamp: 'HAW 5/31/2017 11:04:18'!
        twoHundredCentimeters
	
	^factory twoHundredCentimeters ! !
!CatedraDistanceTest methodsFor: 'distance measures' stamp: 'HAW 5/31/2017 11:04:29'!
              twoMeters
	
	^factory twoMeters ! !
!CatedraDistanceTest methodsFor: 'distance measures' stamp: 'HAW 5/31/2017 11:04:38'!
      zeroMeters

	^factory zeroMeters ! !
!CatedraDistanceTest methodsFor: 'setup' stamp: 'HAW 5/31/2017 11:06:46'!
                 setUp

	| factoryClass |
	
	factoryClass := Smalltalk classNamed: #DistanceFactory.
	self assert: factoryClass notNil description: 'No se entrego la clase DistanceFactory'.
	
	factory := factoryClass new.! !

CatedraDistanceTest subclass: #TestWhenClassPerUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Exercise'!

!classDefinition: #TestWhenClassPerUnit category: #'Distance-Exercise'!
CatedraDistanceTest subclass: #TestWhenClassPerUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Exercise'!
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'HAW 5/31/2017 11:25:39'!
                        centimeter
	
	^Centimeter ! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'HAW 5/31/2017 11:25:39'!
              decameter
	
	^Decameter ! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'HAW 5/31/2017 11:25:39'!
                decimeter
	
	^Decimeter ! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'HAW 5/31/2017 11:25:39'!
                hectometer
	
	^Hectometer ! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'HAW 5/31/2017 11:25:39'!
              kilometer
	
	^Kilometer ! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'HAW 5/31/2017 11:25:39'!
                meter

	^Meter ! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'HAW 5/31/2017 11:25:39'!
                         millimeter
	
	^Milimeter ! !

----End fileIn of /home/sherman1000/Desktop/Facu/POO/Talleres/POO-2017/04-Distance/Distance-Exercise.st----!

"E" CatedraDistanceTest debug: #test05UnitStringRepresentationShouldBeHumanReadable!

"E" CatedraDistanceTest debug: #test05UnitStringRepresentationShouldBeHumanReadable!
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:12:33' prior: 50350574!
       meter

	^ Meter! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:12:43' prior: 50350579!
           millimeter
	
	^ Millimeter! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:13:14' prior: 50350569!
kilometer
	
	^ Kilometer! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:13:21' prior: 50350531!
  centimeter

	^ Centimeter! !

"E" CatedraDistanceTest debug: #test07bDistanceUnitShoulddBeTheExpectedUnit!
!Distance methodsFor: 'accessing' stamp: 'GDS 6/1/2017 19:15:12'!
                   unit
	^ unit! !

"E" CatedraDistanceTest debug: #test07cDifferentDistanceUnitsShouldBeDifferent!

"E" CatedraDistanceTest debug: #test22DistancesCanBeComparedWithGreaterThan!
!Distance class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 19:16:27' prior: 50349191!
                 withAmount: anAmount andUnit: aDistanceUnit 

	^ self new initializeWithAmount: (aDistanceUnit amountToMillimeters: anAmount) andUnit: aDistanceUnit! !

Distance class removeSelector: #cannotCreateDistancesWithNegativeAmount!

"E" CatedraDistanceTest debug: #test15SubtractingDistancesOfDifferentUnitShouldReturnADistanceRepresentingTheSubtractedDistances!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 19:16:56'!
               negated
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 19:18:31' prior: 50350736!
                               negated
	^ self class withAmount: amountInMillimeters negated andUnit: unit! !

"E" CatedraDistanceTest debug: #test07cDifferentDistanceUnitsShouldBeDifferent!

"E" TestWhenClassPerUnit debug: #test25MaxReturnsTheMaximumBetweenTwoDistances!

Magnitude subclass: #Distance
	instanceVariableNames: 'amountInMillimeters unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Distance category: #'Distance-Solution'!
Magnitude subclass: #Distance
	instanceVariableNames: 'amountInMillimeters unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

"E" TestWhenClassPerUnit debug: #test29DistanceIntervalStepCanBeAnyDistance!
!DistanceInterval methodsFor: 'initialization' stamp: 'GDS 6/1/2017 19:21:40'!
                      from

	^ start.! !
!CatedraDistanceTest methodsFor: '6 - Test interval protocol' stamp: 'GDS 6/1/2017 19:23:11' prior: 50350466!
                               test29DistanceIntervalStepCanBeAnyDistance

	self assert: (self zeroMeters to: (self twoMeters * 2) by: self twoMeters) from=self zeroMeters.
	self assert: (self zeroMeters to: (self twoMeters * 2) by: self twoMeters) to=(self twoMeters * 2).
	self assert: (self zeroMeters to: (self twoMeters * 2) by: self twoMeters) by=self twoMeters.

	self assert: ((self twoMeters * 2) to: self zeroMeters by: self twoMeters negated) from=(self twoMeters * 2).
	self assert: ((self twoMeters * 2) to: self zeroMeters by: self twoMeters negated) to=self zeroMeters.
	self assert: ((self twoMeters * 2) to: self zeroMeters by: self twoMeters negated) by=self twoMeters negated! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 19:25:25' prior: 50348356!
                             from: startDistance to: stopDistance by: stepDistance
	| count end |
	count _ ((stopDistance amount - startDistance amount) / stepDistance amount) + 1.
	(count closeTo: count rounded)
		ifTrue: [
			count _ count rounded.
			end _ stopDistance ]
		ifFalse: [
			count _ count truncated.
			end _ count-1 * stepDistance + startDistance ].
	^self from: startDistance to: end count: count step: stepDistance.! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 19:25:57' prior: 50350796!
                               from: startDistance to: stopDistance by: stepDistance
	| count end |
	count _ ((stopDistance amount - startDistance amount) / stepDistance amount) + 1.
	(count closeTo: count rounded)
		ifTrue: [
			count _ count rounded.
			end _ stopDistance ]
		ifFalse: [
			count _ count truncated.
			end _ count-1 * stepDistance + startDistance ].
	^self from: startDistance to: end count: count.! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 19:26:41' prior: 50350813!
                  from: startDistance to: stopDistance by: stepDistance
	| count end |
	count _ ((stopDistance amount - startDistance amount) / stepDistance amount) + 1.
	(count closeTo: count rounded)
		ifTrue: [
			count _ count rounded.
			end _ stopDistance ]
		ifFalse: [
			count _ count truncated.
			end _ count-1 * stepDistance + startDistance ].
	^ self from: startDistance to: end count: count.! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 19:29:03' prior: 50350829!
                 from: startDistance to: stopDistance by: stepDistance
	| count end |
	count _ ((stopDistance amount - startDistance amount) / stepDistance amount) + 1.
	(count closeTo: count rounded)
		ifTrue: [
			count _ count rounded.
			end _ stopDistance ]
		ifFalse: [
			count _ count truncated.
			end _ count-1 * stepDistance + startDistance ].
	^ self from: startDistance to: end count: count.! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 19:29:41' prior: 50350845!
                 from: startDistance to: stopDistance by: stepDistance
	| count end |
	count _ ((stopDistance amount - startDistance amount) / stepDistance amount) + 1.
	(count closeTo: count rounded)
		ifTrue: [
			count _ count rounded.
			end _ stopDistance ]
		ifFalse: [
			count _ count truncated.
			end _ count-1 * stepDistance + startDistance ].
	^ self from: startDistance to: end count: count step: stepDistance .
	! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 19:29:48' prior: 50350861!
                           from: startDistance to: stopDistance by: stepDistance
	| count end |
	count _ ((stopDistance amount - startDistance amount) / stepDistance amount) + 1.
	(count closeTo: count rounded)
		ifTrue: [
			count _ count rounded.
			end _ stopDistance ]
		ifFalse: [
			count _ count truncated.
			end _ count-1 * stepDistance + startDistance ].
	^ self from: startDistance to: end count: count step: stepDistance.
	! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 19:30:59'!
            from: startDistance to: stopDistance count: count step: stepDistance 
	^self new setFrom: startDistance to: stopDistance count: count step: stepDistance.
	! !

!classDefinition: #DistanceInterval category: #'Distance-Solution'!
Interval subclass: #DistanceInterval
	instanceVariableNames: 'step'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!DistanceInterval methodsFor: 'initialization' stamp: 'GDS 6/1/2017 19:31:32'!
                           setFrom: startDistance to: stopDistance count: countInteger step: stepDistance

	start _ startDistance.
	stop _ stopDistance.
	count _ countInteger.
	step _ stepDistance ! !

"E" CatedraDistanceTest debug: #test07dDistancesCanBeConvertedToDifferentUnits!

"F" CatedraDistanceTest debug: #test13aNegatingADistanceNegatesItsAmount!

"E" TestWhenClassPerUnit debug: #test29DistanceIntervalStepCanBeAnyDistance!

"F" TestWhenClassPerUnit debug: #test30DistanceIntervalSizeReturnsTheNumberOfDistancesOfTheInterval!

"E" CatedraDistanceTest debug: #test07cDifferentDistanceUnitsShouldBeDifferent!

"E" CatedraDistanceTest debug: #test07dDistancesCanBeConvertedToDifferentUnits!
!Distance methodsFor: 'converting' stamp: 'GDS 6/1/2017 19:32:55'!
                             convertTo: aClass 
	self shouldBeImplemented! !
!DistanceInterval methodsFor: 'initialization' stamp: 'GDS 6/1/2017 19:33:39'!
 to
	^ stop.! !
!DistanceInterval methodsFor: 'initialization' stamp: 'GDS 6/1/2017 19:33:44'!
  by
	^ step.! !

"E" CatedraDistanceTest debug: #test07cDifferentDistanceUnitsShouldBeDifferent!

Object subclass: #DistanceUnit
	instanceVariableNames: 'name convertionFactor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #DistanceUnit category: #'Distance-Solution'!
Object subclass: #DistanceUnit
	instanceVariableNames: 'name convertionFactor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

Object subclass: #DistanceUnit
	instanceVariableNames: 'name conversionFactor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #DistanceUnit category: #'Distance-Solution'!
Object subclass: #DistanceUnit
	instanceVariableNames: 'name conversionFactor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!DistanceUnit class methodsFor: 'converting' stamp: 'GDS 6/1/2017 19:36:27'!
                           withName: name andConversionFactor: aConversionFactor
	^ self new withName: name andConversionFactor: aConversionFactor! !
!DistanceUnit methodsFor: 'no messages' stamp: 'GDS 6/1/2017 19:37:11'!
                             withName: aName andConversionFactor: aConversionFactor
	name := aName.
	conversionFactor := aConversionFactor.! !
!DistanceUnit class methodsFor: 'converting' stamp: 'GDS 6/1/2017 19:37:25' prior: 50350970!
                 withName: aName andConversionFactor: aConversionFactor
	^ self new withName: aName andConversionFactor: aConversionFactor! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 19:39:20' prior: 50347715!
          millimeters
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 19:39:38' prior: 50347704!
                    meters
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'meters' andConversionFactor: 1/1000)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 19:39:50' prior: 50347693!
                         kilometers
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'kilometers' andConversionFactor: 1000000)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 19:39:57' prior: 50347682!
                centimeters
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1/10)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 19:40:13' prior: 50351005!
                  kilometers
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'kilometers' andConversionFactor: 1/1000000)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 19:40:18' prior: 50351012!
              centimeters
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'centimeter' andConversionFactor: 1/10)! !

"E" CatedraDistanceTest debug: #test01ObjectsRepresentingSameDistanceShouldBeEqual!
!DistanceUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 19:41:02'!
      amountToMillimeters: aSmallInteger 
	self shouldBeImplemented! !
!DistanceUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 19:42:06' prior: 50351035!
                               amountToMillimeters: anAmount
	^ anAmount * conversionFactor.! !

"E" CatedraDistanceTest debug: #test07cDifferentDistanceUnitsShouldBeDifferent!
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:42:50' prior: 50350703!
            kilometer
	
	^ (DistanceUnit withName: 'kilometer' andConversionFactor: 1/1000000)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:43:06' prior: 50350695!
        meter

	^ (DistanceUnit withName: 'meter' andConversionFactor: 1/1000)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:43:12' prior: 50350699!
                    millimeter
	
	^ (DistanceUnit withName: 'millimeter' andConversionFactor: 1)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:43:34' prior: 50350707!
              centimeter

	^ (DistanceUnit withName: 'centimeter' andConversionFactor: 1/10)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:44:22' prior: 50350536!
            decameter
	
	^ (DistanceUnit withName: 'centimeter' andConversionFactor: 1/10)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:44:47' prior: 50351073!
            decameter
	
	^ (DistanceUnit withName: 'decameter' andConversionFactor: 1/10000)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:45:07' prior: 50350541!
          decimeter
	
	^ (DistanceUnit withName: 'decameter' andConversionFactor: 1/100)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:45:10' prior: 50351085!
            decimeter
	
	^ (DistanceUnit withName: 'decimeter' andConversionFactor: 1/100)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 19:45:24' prior: 50350564!
            hectometer
	
	^ (DistanceUnit withName: 'hectometer' andConversionFactor: 1/100000)! !

"E" CatedraDistanceTest debug: #test07dDistancesCanBeConvertedToDifferentUnits!

"E" CatedraDistanceTest debug: #test28IntervalOfDistancesCanBeCreatedBecauseTheyDefineATotalOrder!
!Distance methodsFor: 'value normalization' stamp: 'GDS 6/1/2017 19:46:32' prior: 50349155!
                        normalizedUnitValue
	^ unit conversionFactor.! !
!DistanceUnit methodsFor: 'accessing' stamp: 'GDS 6/1/2017 19:46:39'!
         conversionFactor
	self shouldBeImplemented! !
!DistanceUnit methodsFor: 'accessing' stamp: 'GDS 6/1/2017 19:46:57' prior: 50351113!
                            conversionFactor

	^ conversionFactor! !

(self oneMeter to: self twoMeters) by!
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 19:49:44' prior: 50349133!
       from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / startDistance  normalizedUnitValue) + 1 step: (DistanceUnit withName:  startDistance unit name andConversionFactor: startDistance unit conversionFactor).! !

"E" CatedraDistanceTest debug: #test07dDistancesCanBeConvertedToDifferentUnits!

"E" CatedraDistanceTest debug: #test08aComparingDistancesWithOtherObjectsShouldReturnFalse!

"E" CatedraDistanceTest debug: #test08aComparingDistancesWithOtherObjectsShouldReturnFalse!
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 19:53:26' prior: 50349265!
                             = aDistance 

	(aDistance isKindOf: self class) ifFalse: [ 	self error: 'Cannot compare different type objects' ].
	^ amountInMillimeters = (aDistance amount)

! !

"E" CatedraDistanceTest debug: #test08aComparingDistancesWithOtherObjectsShouldReturnFalse!
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 19:54:15' prior: 50351145!
           = aDistance 

	^ (aDistance isKindOf: self class) and: [amountInMillimeters = (aDistance amount)].

! !

"F" CatedraDistanceTest debug: #test03SameDistanceExpressWithDifferentUnitsShouldBeEqual!

aDistance isKindOf: self class!

amountInMillimeters = (aDistance amount)!

aDistance amount!
!DistanceUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 19:57:32' prior: 50351041!
                              amountToMillimeters: anAmount
	^ anAmount / conversionFactor.! !

Smalltalk removeClassNamed: #Millimeter!

Smalltalk removeClassNamed: #Meter!

Smalltalk removeClassNamed: #Kilometer!

Smalltalk removeClassNamed: #Centimeter!

"E" CatedraDistanceTest debug: #test09AddingDistancesOfSameUnitShouldReturnADistanceRepresentingTheAddingDistances!
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 19:58:26' prior: 50349214!
               * anAmount 
	^ self class withAmount: amountInMillimeters * anAmount andUnit: unit.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 19:58:31' prior: 50349282!
                + aDistance 
	^ self class withAmount: amountInMillimeters + aDistance amount andUnit: unit.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 19:58:34' prior: 50349220!
       - aDistance 
	^ self class withAmount: amountInMillimeters - aDistance amount andUnit: unit.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 19:58:38' prior: 50349226!
       / aNumber 
	^ self class withAmount: amountInMillimeters / aNumber andUnit: unit.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 19:58:47' prior: 50349232!
                  adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class withAmount: aSmallInteger * amountInMillimeters andUnit: unit.! !

"E" TestWhenClassPerUnit debug: #test07dDistancesCanBeConvertedToDifferentUnits!

"F" CatedraDistanceTest debug: #test05UnitStringRepresentationShouldBeHumanReadable!

self meter!
!DistanceUnit methodsFor: 'nil' stamp: 'GDS 6/1/2017 19:59:56'!
            printString
	^ name! !

"E" TestWhenClassPerUnit debug: #test07dDistancesCanBeConvertedToDifferentUnits!

"F" CatedraDistanceTest debug: #test12AddingDistancesIsAssociative!

"F" CatedraDistanceTest debug: #test09AddingDistancesOfSameUnitShouldReturnADistanceRepresentingTheAddingDistances!

"F" CatedraDistanceTest debug: #test10AddingDistancesOfDifferentUnitShouldReturnADistanceRepresentingTheAddingDistances!

amountInMillimeters = (aDistance amount)!

aDistance amount!
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:05:35' prior: 50351183!
            * anAmount 
	^ self class withAmount: amountInMillimeters * anAmount andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:05:39' prior: 50351189!
                        + aDistance 
	^ self class withAmount: amountInMillimeters + aDistance amount andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:05:46' prior: 50351195!
               - aDistance 
	^ self class withAmount: amountInMillimeters - aDistance amount andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:05:50' prior: 50351201!
               / aNumber 
	^ self class withAmount: amountInMillimeters / aNumber andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:05:54' prior: 50351207!
                          adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class withAmount: aSmallInteger * amountInMillimeters andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !

"E" TestWhenClassPerUnit debug: #test08bDistancesThatAreEqualShouldReturnTheSameHash!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 20:06:17'!
      hash
	self shouldBeImplemented! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 20:06:47' prior: 50351280!
  hash
	^ amountInMillimeters! !

"F" CatedraDistanceTest debug: #test13bNegatingADistanceIsReflective!
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 20:08:00' prior: 50350741!
                              negated
	^ self class withAmount: amountInMillimeters negated andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !

"F" CatedraDistanceTest debug: #test17bDistancesCanBeMultiplyByAFraction!

(self oneMeter * (2/3)) amount!
!Distance class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 20:11:52' prior: 50350722!
            withAmount: anAmount andUnit: aDistanceUnit 

	^ self new initializeWithAmount: (aDistanceUnit amountToMeters: anAmount) andUnit: aDistanceUnit! !
!DistanceUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 20:12:17'!
                             amountToMeters: anAmount
	^ anAmount / conversionFactor.! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 20:12:37' prior: 50350998!
           meters
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'meters' andConversionFactor: 1)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 20:12:59' prior: 50350991!
                              millimeters
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1/1000).! !
!DistanceUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 20:13:38' prior: 50351310!
        amountToMeters: anAmount
	^ anAmount * conversionFactor.! !

DistanceUnit removeSelector: #amountToMillimeters:!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 20:14:00' prior: 50351019!
                      kilometers
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'kilometers' andConversionFactor: 1/1000)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 20:14:10' prior: 50351026!
                 centimeters
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'centimeter' andConversionFactor: 1/1000)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 20:14:39' prior: 50351343!
                centimeters
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'centimeter' andConversionFactor: 1/100)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 20:14:52' prior: 50351336!
                 kilometers
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'kilometers' andConversionFactor: 1000)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:15:15' prior: 50351067!
          centimeter

	^ (DistanceUnit withName: 'centimeter' andConversionFactor: 1/100)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:15:21' prior: 50351079!
           decameter
	
	^ (DistanceUnit withName: 'decameter' andConversionFactor: 1/10)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:15:26' prior: 50351370!
             decameter
	
	^ (DistanceUnit withName: 'decameter' andConversionFactor: 10)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:15:30' prior: 50351091!
               decimeter
	
	^ (DistanceUnit withName: 'decimeter' andConversionFactor: 1/10)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:15:38' prior: 50351097!
             hectometer
	
	^ (DistanceUnit withName: 'hectometer' andConversionFactor: 100)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:15:44' prior: 50351049!
            kilometer
	
	^ (DistanceUnit withName: 'kilometer' andConversionFactor: 1000)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:15:50' prior: 50351055!
             meter

	^ (DistanceUnit withName: 'meter' andConversionFactor: 1)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:15:55' prior: 50351061!
                         millimeter
	
	^ (DistanceUnit withName: 'millimeter' andConversionFactor: 1/1000)! !

"F" TestWhenClassPerUnit debug: #test28IntervalOfDistancesCanBeCreatedBecauseTheyDefineATotalOrder!
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 20:18:01' prior: 50351124!
                              from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / startDistance  normalizedUnitValue) + 1 step: (Distance 	withAmount: 1 andUnit: (DistanceUnit withName:  startDistance unit name andConversionFactor: startDistance unit conversionFactor)).! !

"F" TestWhenClassPerUnit debug: #test07bDistanceUnitShouldBeTheExpectedUnit!
!DistanceUnit methodsFor: 'accessing' stamp: 'GDS 6/1/2017 20:19:18'!
     = aDistanceUnit 

	^ (aDistanceUnit isKindOf: self class) and: [name = (aDistanceUnit name)].
! !
!DistanceUnit methodsFor: 'accessing' stamp: 'GDS 6/1/2017 20:19:56' prior: 50351431!
        = aDistanceUnit 

	^ (aDistanceUnit isKindOf: self class) and: [name = (aDistanceUnit name) and: [ conversionFactor = aDistanceUnit conversionFactor ]].
! !

"F" TestWhenClassPerUnit debug: #test07bDistanceUnitShouldBeTheExpectedUnit!

(aDistanceUnit isKindOf: self class)!

"F" TestWhenClassPerUnit debug: #test07bDistanceUnitShouldBeTheExpectedUnit!
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:22:08' prior: 50350674!
                             kilometer
	
	^ (DistanceUnit withName: 'kilometer' andConversionFactor: 1000)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:22:18' prior: 50350678!
            meter

	^ (DistanceUnit withName: 'meter' andConversionFactor: 1)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:22:31' prior: 50350682!
                        millimeter
	
	^ (DistanceUnit withName: 'millimeter' andConversionFactor: 1/1000)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:22:42' prior: 50350670!
        hectometer
	
	^ (DistanceUnit withName: 'hectometer' andConversionFactor: 100)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:22:49' prior: 50350666!
           decimeter
	
	^ (DistanceUnit withName: 'decimeter' andConversionFactor: 100)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:22:54' prior: 50351476!
             decimeter
	
	^ (DistanceUnit withName: 'decimeter' andConversionFactor: 1/10)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:23:00' prior: 50350662!
            decameter
	
	^ (DistanceUnit withName: 'hectometer' andConversionFactor: 10)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:23:08' prior: 50350658!
             centimeter
	
	^ (DistanceUnit withName: 'hectometer' andConversionFactor: 1/100)! !

"F" TestWhenClassPerUnit debug: #test07bDistanceUnitShouldBeTheExpectedUnit!
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:24:11' prior: 50351488!
                           decameter
	
	^ (DistanceUnit withName: 'hectometer' andConversionFactor: 10)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 20:24:22' prior: 50351315!
                       meters
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/1/2017 20:24:27' prior: 50351357!
                               kilometers
	^ Distance withAmount: self andUnit: (DistanceUnit withName: 'kilometer' andConversionFactor: 1000)! !

"F" TestWhenClassPerUnit debug: #test07bDistanceUnitShouldBeTheExpectedUnit!
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:25:22' prior: 50351494!
                            centimeter
	
	^ (DistanceUnit withName: 'centimeter' andConversionFactor: 1/100)! !

"F" TestWhenClassPerUnit debug: #test07aDistanceAmountShouldBeTheExpectedAmount!
!Distance class methodsFor: 'instance creation' stamp: 'GDS 6/1/2017 20:27:01' prior: 50351302!
                          withAmount: anAmount andUnit: aDistanceUnit 

	^ self new initializeWithAmount: anAmount andUnit: aDistanceUnit! !

Magnitude subclass: #Distance
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Distance category: #'Distance-Solution'!
Magnitude subclass: #Distance
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Distance methodsFor: 'initialization' stamp: 'GDS 6/1/2017 20:27:41' prior: 50349239!
                    initializeWithAmount: anAmount
	amount := anAmount! !
!Distance methodsFor: 'initialization' stamp: 'GDS 6/1/2017 20:27:47' prior: 50349244!
                   initializeWithAmount: anAmount andUnit: aDistanceUnit
	amount := anAmount.
	unit := aDistanceUnit.! !

Distance removeSelector: #initializeWithAmount:!
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:29:35' prior: 50351237!
               * anAmount 
	^ self class withAmount: amount * anAmount andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:29:44' prior: 50351245!
     + aDistance 
	^ self class withAmount: amount + aDistance amount andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:29:54' prior: 50351261!
                            / aNumber 
	^ self class withAmount: amount / aNumber andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:29:58' prior: 50351253!
       - aDistance 
	^ self class withAmount: amount - aDistance amount andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:30:01' prior: 50351269!
                            adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class withAmount: aSmallInteger * amount andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 20:30:14' prior: 50349255!
  < aDistance 
	^ amount < aDistance amount! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 20:30:17' prior: 50349260!
                               <= aDistance 
	^ amount <= aDistance amount! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 20:30:23' prior: 50351156!
                             = aDistance 

	^ (aDistance isKindOf: self class) and: [amount = (aDistance amount)].

! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 20:30:26' prior: 50349270!
                 > aDistance 
	^ amount > aDistance amount! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 20:30:29' prior: 50349275!
                               >= aDistance 
	^ amount >= aDistance amount! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 20:30:37' prior: 50351284!
                     hash
	^ amount! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 20:30:43' prior: 50351291!
                  negated
	^ self class withAmount: amount negated andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1).! !
!Distance methodsFor: 'as yet unclassified' stamp: 'GDS 6/1/2017 20:30:56' prior: 50351630!
         hash
	^ amount * unit conversionFactor! !
!Distance methodsFor: 'accessing' stamp: 'GDS 6/1/2017 20:31:06' prior: 50349251!
    amount
	^ amount! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:31:48' prior: 50351566!
                   * anAmount 
	^ self class withAmount: amount * anAmount andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:31:52' prior: 50351573!
          + aDistance 
	^ self class withAmount: amount + aDistance amount andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:32:04' prior: 50351588!
 - aDistance 
	^ self class withAmount: amount - aDistance amount andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:32:12' prior: 50351581!
 / aNumber 
	^ self class withAmount: amount / aNumber andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:32:16' prior: 50351596!
            adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class withAmount: aSmallInteger * amount andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !

"E" CatedraDistanceTest debug: #test07dDistancesCanBeConvertedToDifferentUnits!
!Distance methodsFor: 'converting' stamp: 'GDS 6/1/2017 20:33:53' prior: 50350933!
                       convertTo: aDistanceUnit 

	^ amount * aDistanceUnit conversionFactor! !
!Distance methodsFor: 'converting' stamp: 'GDS 6/1/2017 20:34:35' prior: 50351688!
    convertTo: aDistanceUnit 

	^ amount * unit conversionFactor! !
!Distance methodsFor: 'converting' stamp: 'GDS 6/1/2017 20:34:58' prior: 50351693!
             convertTo: aDistanceUnit 

	^ amount * unit conversionFactor * aDistanceUnit conversionFactor! !
!Distance methodsFor: 'converting' stamp: 'GDS 6/1/2017 20:35:09' prior: 50351698!
            convertTo: aDistanceUnit 

	^ amount * (unit conversionFactor) * (aDistanceUnit conversionFactor)! !
!Distance methodsFor: 'converting' stamp: 'GDS 6/1/2017 20:36:10' prior: 50351704!
        convertTo: aDistanceUnit 

	^ self class withAmount:  amount * (unit conversionFactor) * (aDistanceUnit conversionFactor) andUnit: aDistanceUnit! !

----SNAPSHOT----#(1 June 2017 8:38:22.686492 pm) Cuis5.0-3081-spur-64.image priorSource: 585414!

unit name !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/1/2017 20:41:47' prior: 50351503!
                          decameter
	
	^ (DistanceUnit withName: 'decameter' andConversionFactor: 10)! !

	^ (DistanceUnit withName: 'decimeter' andConversionFactor: 1/10)!

amount * (unit conversionFactor)!

(aDistanceUnit conversionFactor) !

----SNAPSHOT----#(1 June 2017 8:43:23.452059 pm) Cuis5.0-3081-spur-64.image priorSource: 642131!

----SNAPSHOT----#(1 June 2017 8:43:57.136029 pm) Cuis5.0-3081-spur-64.image priorSource: 642585!

"F" CatedraDistanceTest debug: #test03SameDistanceExpressWithDifferentUnitsShouldBeEqual!
!Distance methodsFor: 'converting' stamp: 'GDS 6/1/2017 20:44:26' prior: 50351710!
                    convertTo: aDistanceUnit 

	^ self class withAmount:  amount * (unit conversionFactor) / (aDistanceUnit conversionFactor) andUnit: aDistanceUnit! !

"F" CatedraDistanceTest debug: #test03SameDistanceExpressWithDifferentUnitsShouldBeEqual!
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 20:46:08' prior: 50351614!
                             = aDistance 

	^ (aDistance isKindOf: self class) and: [amount = (aDistance amount convertTo: unit)].

! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 20:46:34' prior: 50351752!
 = aDistance 

	^ (aDistance isKindOf: self class) and: [amount = (aDistance convertTo: unit) amount].

! !

"F" CatedraDistanceTest debug: #test05UnitStringRepresentationShouldBeHumanReadable!
!CatedraDistanceTest methodsFor: '2 - Converting/accesing/printing' stamp: 'GDS 6/1/2017 20:47:12' prior: 50350003!
           test05UnitStringRepresentationShouldBeHumanReadable

	self assert: self meter printString = 'meter'.
	self assert: self centimeter printString = 'centimeter'.
	self assert: self decimeter printString = 'decimeter'.
	self assert: self millimeter printString = 'millimeter'.
	self assert: self decameter printString = 'decameter'.
	self assert: self hectometer printString = 'hectometer'.
	self assert: self kilometer printString = 'kilometer'.	! !

"F" CatedraDistanceTest debug: #test06DistanceStringRepresentationShouldBeHumanReadable!
!Distance methodsFor: 'converting' stamp: 'GDS 6/1/2017 20:48:40'!
    printString

	^ amount printString , ' ', unit printString! !

"F" CatedraDistanceTest debug: #test06DistanceStringRepresentationShouldBeHumanReadable!
!Distance methodsFor: 'converting' stamp: 'GDS 6/1/2017 20:51:50' prior: 50351787!
                     printString

	| amountAsString unitAsString |
	amountAsString := amount printString.
	unitAsString := unit printString.
	
	(amount > 1) ifTrue: [ unitAsString := unitAsString , 's' ].! !
!Distance methodsFor: 'converting' stamp: 'GDS 6/1/2017 20:52:22' prior: 50351795!
                  printString

	| amountAsString unitAsString |
	
	amountAsString := amount printString.
	unitAsString := unit printString.
	
	(amount > 1) ifTrue: [ unitAsString := unitAsString , 's' ].
	
	^ amountAsString , ' ' , unitAsString ! !

"F" CatedraDistanceTest debug: #test10AddingDistancesOfDifferentUnitShouldReturnADistanceRepresentingTheAddingDistances!
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:53:36' prior: 50351656!
      + aDistance 
	^ self class withAmount: amount / unit conversionFactor + aDistance amount andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:53:42' prior: 50351818!
         + aDistance 
	^ self class withAmount: amount / (unit conversionFactor) + aDistance amount andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:54:05' prior: 50351826!
       + aDistance 
	^ self class withAmount: amount / (unit conversionFactor) + aDistance amount / (aDistance unit conversionFactor) andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:54:17' prior: 50351834!
   + aDistance 
	^ self class withAmount: amount / (unit conversionFactor) + aDistance amount / (aDistance unit conversionFactor) andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:54:29' prior: 50351843!
   + aDistance 
	^ self class withAmount: amount / (unit conversionFactor) + aDistance amount / aDistance unit conversionFactor andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:54:47' prior: 50351852!
     + aDistance 
	^ self class withAmount: amount / unit conversionFactor + aDistance amount / aDistance unit conversionFactor andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:55:01' prior: 50351861!
       + aDistance 
	^ self class withAmount: (amount / unit conversionFactor) + aDistance amount / aDistance unit conversionFactor andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:55:09' prior: 50351870!
     + aDistance 
	^ self class withAmount: (amount / unit conversionFactor) + (aDistance amount / aDistance unit conversionFactor) andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !

(self oneMeter + self oneHundredCentimeters)!

(self oneMeter + self oneHundredCentimeters)!

unit name!
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:55:54' prior: 50351879!
                         + aDistance 
	^ self class withAmount: (amount / unit conversionFactor) + (aDistance amount / aDistance unit conversionFactor) andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:56:16' prior: 50351892!
   + aDistance 
	^ self class withAmount: (amount * unit conversionFactor) + (aDistance amount / aDistance unit conversionFactor) andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:56:18' prior: 50351901!
   + aDistance 
	^ self class withAmount: (amount * unit conversionFactor) + (aDistance amount * aDistance unit conversionFactor) andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !

"F" CatedraDistanceTest debug: #test15SubtractingDistancesOfDifferentUnitShouldReturnADistanceRepresentingTheSubtractedDistances!
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:57:01' prior: 50351663!
- aDistance 
	^ self class withAmount: (amount * unit conversionFactor) - (aDistance amount * aDistance unit conversionFactor) andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1).! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:57:30' prior: 50351670!
   / aNumber 
	^ self class withAmount: amount / aNumber andUnit: unit.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:57:48' prior: 50351649!
                               * anAmount 
	^ self class withAmount: amount * anAmount andUnit: unit.! !
!Distance methodsFor: 'maths operations' stamp: 'GDS 6/1/2017 20:57:57' prior: 50351677!
                             adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class withAmount: aSmallInteger * amount andUnit: unit.! !

"F" CatedraDistanceTest debug: #test21DistancesProvideATotalOrder!
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 20:59:11' prior: 50351604!
                      < aDistance 

	^ amount * unit conversionFactor < aDistance amount * aDistance unit conversionFactor! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 20:59:25' prior: 50351609!
    <= aDistance 

		^ amount * unit conversionFactor <= aDistance amount * aDistance unit conversionFactor! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 21:00:01' prior: 50351620!
 > aDistance 

		^ amount * unit conversionFactor < aDistance amount * aDistance unit conversionFactor! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 21:00:06' prior: 50351965!
   > aDistance 

		^ amount * unit conversionFactor > aDistance amount * aDistance unit conversionFactor! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 21:00:14' prior: 50351625!
   >= aDistance 

	^ amount * unit conversionFactor >= aDistance amount * aDistance unit conversionFactor! !

"E" CatedraDistanceTest debug: #test21DistancesProvideATotalOrder!
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 21:01:02' prior: 50351953!
                              < aDistance 

	^ (amount * unit conversionFactor) < (aDistance amount * aDistance unit conversionFactor)! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 21:01:20' prior: 50351959!
<= aDistance 

		^ amount * unit conversionFactor <= (aDistance amount * aDistance unit conversionFactor)! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 21:01:29' prior: 50351992!
                               <= aDistance 

		^ (amount * unit conversionFactor) <= (aDistance amount * aDistance unit conversionFactor)! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 21:01:36' prior: 50351971!
                             > aDistance 

		^ (amount * unit conversionFactor) > aDistance amount * aDistance unit conversionFactor! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 21:01:40' prior: 50352006!
 > aDistance 

		^ (amount * unit conversionFactor) > (aDistance amount * aDistance unit conversionFactor)! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 21:01:49' prior: 50351977!
                               >= aDistance 

	^ (amount * unit conversionFactor) >= aDistance amount * aDistance unit conversionFactor! !
!Distance methodsFor: 'comparators' stamp: 'GDS 6/1/2017 21:01:56' prior: 50352019!
>= aDistance 

	^ (amount * unit conversionFactor) >= (aDistance amount * aDistance unit conversionFactor)! !

----SNAPSHOT----#(1 June 2017 9:02:45.558994 pm) Cuis5.0-3081-spur-64.image priorSource: 642683!

----SNAPSHOT----#(1 June 2017 9:04:03.485427 pm) Cuis5.0-3081-spur-64.image priorSource: 652173!

----QUIT----#(1 June 2017 9:05:45.13036 pm) Cuis5.0-3081-spur-64.image priorSource: 652271!

----STARTUP----#(2 June 2017 6:39:37.393029 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!

!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/2/2017 18:44:38' prior: 50351416!
  from: startDistance to: stopDistance

	^self new setFrom: startDistance to: stopDistance count: ((stopDistance-startDistance) amount / startDistance  unit conversionFactor) + 1 step: (Distance 	withAmount: 1 andUnit: (DistanceUnit withName:  startDistance unit name andConversionFactor: startDistance unit conversionFactor)).! !

Distance removeSelector: #normalizedUnitValue!

DistanceInterval removeSelector: #setFrom:to:count:!
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/2/2017 18:48:51' prior: 50352045!
         from: startDistance to: stopDistance

	| count |
	count := ((stopDistance-startDistance) amount / startDistance  unit conversionFactor) + 1.
	^self new setFrom: startDistance to: stopDistance count: count step: (Distance 	withAmount: 1 andUnit: (DistanceUnit withName:  startDistance unit name andConversionFactor: startDistance unit conversionFactor)).! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/2/2017 18:49:46' prior: 50352062!
                   from: startDistance to: stopDistance
	| count |
	
	count := ((stopDistance-startDistance) amount / startDistance  unit conversionFactor) + 1.
	^self new setFrom: startDistance to: stopDistance count: count step: (Distance withAmount: 1 andUnit: (DistanceUnit withName:  startDistance unit name andConversionFactor: startDistance unit conversionFactor)).! !
!DistanceInterval class methodsFor: 'instance creation' stamp: 'GDS 6/2/2017 18:50:11' prior: 50352077!
                   from: startDistance to: stopDistance
	| count |
	
	count := ((stopDistance-startDistance) amount / startDistance  unit conversionFactor) + 1.
	^self new setFrom: startDistance to: stopDistance count: count step: (Distance withAmount: 1 andUnit: startDistance unit).! !
!DistanceUnit methodsFor: 'accessing' stamp: 'GDS 6/2/2017 18:50:43' prior: 50351437!
                             = aDistanceUnit 

	^ (aDistanceUnit isKindOf: self class) and: [name = aDistanceUnit name and: [ conversionFactor = aDistanceUnit conversionFactor ]].
! !

TestCase subclass: #MoneyTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #MoneyTest category: #'Distance-Solution'!
TestCase subclass: #MoneyTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MoneyTest methodsFor: 'nil' stamp: 'GDS 6/2/2017 18:59:32'!
                           test01! !
!MoneyTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 18:59:35' prior: 50352122!
                         test01
	! !

Smalltalk removeClassNamed: #MoneyTest!

TestCase subclass: #WeightMeasureTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #WeightMeasureTest category: #'Distance-Solution'!
TestCase subclass: #WeightMeasureTest
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!WeightMeasureTest methodsFor: 'nil' stamp: 'GDS 6/2/2017 19:01:02'!
 test01! !

!classDefinition: #WeightMeasureTest category: #'Distance-Solution'!
TestCase subclass: #WeightMeasureTest
	instanceVariableNames: 'aKilogram'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #WeightMeasureTest category: #'Distance-Solution'!
TestCase subclass: #WeightMeasureTest
	instanceVariableNames: 'aKilogram hundredGrams'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #WeightMeasureTest category: #'Distance-Solution'!
TestCase subclass: #WeightMeasureTest
	instanceVariableNames: 'aKilogram hundredGrams oneThousandOneHundredGrams'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:03:11' prior: 50352141!
  test01
	self assert: (aKilogram + hundredGrams) = oneThousandOneHundredGrams ! !

!classDefinition: #WeightMeasureTest category: #'Distance-Solution'!
TestCase subclass: #WeightMeasureTest
	instanceVariableNames: 'aKilogram hundredGrams oneThousandOneHundredGrams oneKilogram'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:04:38'!
        setUp
	aKilogram := 1 kilograms.
	hundredGrams := 100 grams
! !
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:04:42' prior: 50352181!
                           setUp
	aKilogram := 1 kilograms.
	hundredGrams := 100 grams.
! !
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:05:04' prior: 50352187!
                          setUp
	aKilogram := 1 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
! !

DistanceTest removeSelector: #test04CannotCreateMetersWithNegativeAmount!

(aDistance isKindOf: self class)!

amount = (aDistance convertTo: unit) amount!

(aDistance convertTo: unit) amount!

----SNAPSHOT----#(2 June 2017 7:06:40.299189 pm) Cuis5.0-3081-spur-64.image priorSource: 652369!

(10 kilometers - 5 centimeters)!

	self assert: (fromOneMeterToThreeMetersInterval at: fromOneMeterToThreeMetersInterval size - 1) = (10 kilometers - 5 centimeters).!
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 6/2/2017 19:09:04' prior: 50349502!
                     test24OneMeterToTenKilometersBy5CentimetersIntervalHasElementsWith5CentimetersBetweenEachElement
	| fromOneMeterToTenKilometersInterval |
	fromOneMeterToTenKilometersInterval := 1 meters to: 10 kilometers by: 5 centimeters.
	self assert: (fromOneMeterToTenKilometersInterval isKindOf: DistanceInterval).
	self assert: (fromOneMeterToTenKilometersInterval first) = 1 meters.
	self assert: (fromOneMeterToTenKilometersInterval at: 2) = (1 meters + 5 centimeters).
	self assert: (fromOneMeterToTenKilometersInterval at: fromOneMeterToTenKilometersInterval size - 1) = (10 kilometers - 5 centimeters).
	self assert: (fromOneMeterToTenKilometersInterval last) = 10 kilometers.! !

(10 kilometers - 5 centimeters)!

unit name!

self asFloat!

(fromOneMeterToTenKilometersInterval at: fromOneMeterToTenKilometersInterval size - 1)!

fromOneMeterToTenKilometersInterval at: fromOneMeterToTenKilometersInterval size - 1!

fromOneMeterToTenKilometersInterval at: fromOneMeterToTenKilometersInterval size - 1!

fromOneMeterToTenKilometersInterval at: fromOneMeterToTenKilometersInterval size!

fromOneMeterToTenKilometersInterval!

self asOrderedCollection!

(1 to: 5) asOrderedCollection!

unit name!
!Distance methodsFor: 'converting' stamp: 'GDS 6/2/2017 19:16:43'!
                      printOn: allalsslalas 

	| amountAsString unitAsString |
	
	amountAsString := amount printString.
	unitAsString := unit printString.
	
	(amount > 1) ifTrue: [ unitAsString := unitAsString , 's' ].
	
	^ amountAsString , ' ' , unitAsString ! !
!Distance methodsFor: 'converting' stamp: 'GDS 6/2/2017 19:17:06' prior: 50352254!
                           printOn: aStream 

	| amountAsString unitAsString |
	
	amountAsString := amount printString.
	unitAsString := unit printString.
	
	(amount > 1) ifTrue: [ unitAsString := unitAsString , 's' ].
	
	^ amountAsString , ' ' , unitAsString ! !
!Distance methodsFor: 'converting' stamp: 'GDS 6/2/2017 19:19:31' prior: 50352265!
printOn: aStream 
	| amountAsString unitAsString |
	
	amountAsString := amount printString.
	unitAsString := unit printString.
	
	(amount > 1) ifTrue: [ unitAsString := unitAsString , 's' ].
	
	aStream nextPutAll: ' amount ', amountAsString.
	aStream nextPutAll: ' unit ', unitAsString.
	^ aStream ! !

----SNAPSHOT----#(2 June 2017 7:19:46.529771 pm) Cuis5.0-3081-spur-64.image priorSource: 657740!

fromOneMeterToTenKilometersInterval size - 1!

fromOneMeterToTenKilometersInterval!

"E" WeightMeasureTest debug: #test01!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/2/2017 19:21:05'!
           kilograms
	self shouldBeImplemented! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/2/2017 19:21:45' prior: 50352294!
kilograms
	^ DistanceUnit withName: 'kilogram' andConversionFactor: 1000! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/2/2017 19:21:53'!
           grams
	self shouldBeImplemented! !

!classDefinition: #WeightMeasure category: #'Distance-Solution'!
Object subclass: #WeightMeasure
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #WeightUnit category: #'Distance-Solution'!
Object subclass: #WeightUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/2/2017 19:23:31' prior: 50352303!
                    grams
	^ WeightMeasure withAmount: self andUnit: (WeightUnit withName: 'gram' andConversionFactor: 1).! !

----SNAPSHOT----#(2 June 2017 7:24:10.555512 pm) Cuis5.0-3081-spur-64.image priorSource: 660365!

fromOneMeterToTenKilometersInterval!

	Morph  allInstancesDo: [ :morph | morph close]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph remove]!

	Morph  allInstancesDo: [ :morph | morph close]!

	Morph  allInstancesDo: [ :morph | morph close]!

self close!

self remove!

self delete!

self delete!

self class allInstancesDo: [:each | each delete]!

self title!

self class allInstancesDo: [:each | each delete]!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/2/2017 19:31:19' prior: 50352298!
            kilograms
	^ WeightMeasure withAmount: self andUnit: (WeightUnit withName: 'kilogram' andConversionFactor: 1000).! !
!WeightUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:32:02'!
                       withName: aString andConversionFactor: aSmallInteger 
	self shouldBeImplemented! !
!WeightUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:32:59' prior: 50352378!
         withName: aName andConversionFactor: aConversionFactor
	^ self new withName: aName andConversionFactor: aConversionFactor ! !
!WeightUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:33:07'!
                    withName: aString andConversionFactor: aSmallInteger 
	self shouldBeImplemented! !

!classDefinition: #WeightUnit category: #'Distance-Solution'!
Object subclass: #WeightUnit
	instanceVariableNames: 'name'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #WeightUnit category: #'Distance-Solution'!
Object subclass: #WeightUnit
	instanceVariableNames: 'name conversionFactor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!WeightUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:34:00' prior: 50352391!
            withName: aName andConversionFactor: aConversionFactor
	name := aName.
	conversionFactor := aConversionFactor.! !
!WeightMeasure class methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:34:11'!
                       withAmount: aSmallInteger andUnit: aWeightUnit 
	self shouldBeImplemented! !
!WeightMeasure class methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:34:40' prior: 50352417!
            withAmount: anAmount andUnit: aWeightUnit 
	^ self new withAmount: anAmount andUnit: aWeightUnit ! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:34:47'!
          withAmount: aSmallInteger andUnit: aWeightUnit 
	self shouldBeImplemented! !

!classDefinition: #WeightMeasure category: #'Distance-Solution'!
Object subclass: #WeightMeasure
	instanceVariableNames: 'amount'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #WeightMeasure category: #'Distance-Solution'!
Object subclass: #WeightMeasure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:35:06' prior: 50352429!
           withAmount: anAmount andUnit: aWeightUnit 
	amount := anAmount .
	unit := aWeightUnit .! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:35:16'!
                    + aWeightMeasure 
	self shouldBeImplemented! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:36:46' prior: 50352454!
                + aWeightMeasure 
	^ WeightMeasure withAmount: 1100 andUnit: (WeightUnit withName: 'grams' andConversionFactor: 1).! !

oneThousandOneHundredGrams!
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:37:31' prior: 50352459!
           + aWeightMeasure 
	^ WeightMeasure withAmount: 1100 andUnit: (WeightUnit withName: 'gram' andConversionFactor: 1).! !
!WeightUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:38:09'!
                            = aWeightUnit 

	^ (aWeightUnit isKindOf: self class) and: [name = aWeightUnit name and: [ conversionFactor = aWeightUnit conversionFactor ]].! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:38:35'!
                             = aWeightMeasure

	^ (aWeightMeasure isKindOf: self class) and: [amount = (aWeightMeasure convertTo: unit) amount].! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:39:01' prior: 50352482!
        = aWeightMeasure

	^ (aWeightMeasure isKindOf: self class) and: [amount = aWeightMeasure amount].! !
!WeightMeasure methodsFor: 'accessing' stamp: 'GDS 6/2/2017 19:39:22'!
                    amount
	self shouldBeImplemented! !
!WeightMeasure methodsFor: 'accessing' stamp: 'GDS 6/2/2017 19:39:30' prior: 50352495!
     amount
	^ amount! !

!classDefinition: #WeightMeasureTest category: #'Distance-Solution'!
TestCase subclass: #WeightMeasureTest
	instanceVariableNames: 'aKilogram hundredGrams oneThousandOneHundredGrams oneKilogram twoKilograms'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:45:49'!
                        test02
	self assert: (aKilogram + aKilogram) = twoKilograms! !
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:46:07' prior: 50352193!
                            setUp
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:47:32' prior: 50352467!
                     + aWeightMeasure 
	^ WeightMeasure withAmount: amount + aWeightMeasure amount andUnit: unit! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:49:12' prior: 50352526!
+ aWeightMeasure 

	^ self class withAmount: (amount * unit conversionFactor) + (aWeightMeasure amount * aWeightMeasure unit conversionFactor)andUnit: (WeightUnit withName: 'gram' andConversionFactor: 1).! !
!WeightUnit methodsFor: 'accessing' stamp: 'GDS 6/2/2017 19:49:20'!
            conversionFactor
	self shouldBeImplemented! !
!WeightUnit methodsFor: 'accessing' stamp: 'GDS 6/2/2017 19:49:29' prior: 50352541!
                              conversionFactor
	^ conversionFactor ! !
!WeightMeasure methodsFor: 'accessing' stamp: 'GDS 6/2/2017 19:49:35'!
                unit
	self shouldBeImplemented! !
!WeightMeasure methodsFor: 'accessing' stamp: 'GDS 6/2/2017 19:49:46' prior: 50352550!
       unit
	^ unit! !

self class withAmount: (amount * unit conversionFactor) + (aWeightMeasure amount * aWeightMeasure unit conversionFactor)andUnit: (WeightUnit withName: 'gram' andConversionFactor: 1)!

self class withAmount: (amount * unit conversionFactor) + (aWeightMeasure amount * aWeightMeasure unit conversionFactor)andUnit: (WeightUnit withName: 'gram' andConversionFactor: 1)!
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:51:56' prior: 50352489!
                               = aWeightMeasure

	^ (aWeightMeasure isKindOf: self class) and: [amount = (aWeightMeasure convertTo: unit) amount].! !

"E" WeightMeasureTest debug: #test01!
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:52:08'!
                 convertTo: aWeightUnit 
	self shouldBeImplemented! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/2/2017 19:52:30' prior: 50352578!
          convertTo: aWeightUnit 
	^ self class withAmount:  amount * (unit conversionFactor) / (aWeightUnit conversionFactor) andUnit: aWeightUnit! !

----SNAPSHOT----#(2 June 2017 7:52:50.034749 pm) Cuis5.0-3081-spur-64.image priorSource: 661609!

----SNAPSHOT----#(2 June 2017 7:53:59.173978 pm) Cuis5.0-3081-spur-64.image priorSource: 670060!

----QUIT----#(2 June 2017 7:54:02.521702 pm) Cuis5.0-3081-spur-64.image priorSource: 670158!

----STARTUP----#(4 June 2017 11:09:04.095883 am) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!


!classDefinition: #WeightMeasureTest category: #'Distance-Solution'!
TestCase subclass: #WeightMeasureTest
	instanceVariableNames: 'aKilogram hundredGrams oneThousandOneHundredGrams oneKilogram twoKilograms zeroKilograms'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:10:04'!
       test03
	self assert: (aKilogram - aKilogram) = zeroKilograms! !
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:10:35' prior: 50352518!
                           setUp
	zeroKilograms := 0 kilograms.
	oneKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
! !
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:11:23' prior: 50352619!
                setUp
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:11:32'!
      - aWeightMeasure 
	self shouldBeImplemented! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:12:39' prior: 50352636!
                - aWeightMeasure 
		^ self class withAmount: (amount * unit conversionFactor) - (aWeightMeasure amount * aWeightMeasure unit conversionFactor) andUnit: (WeightUnit withName: 'gram' andConversionFactor: 1).! !
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:17:11'!
                          test04
	self assert: aKilogram * 2 = twoKilograms.! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:17:21'!
                         * aSmallInteger 
	self shouldBeImplemented! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:17:52' prior: 50352656!
                 * aSmallInteger 
	^ self class withAmount: amount * aSmallInteger andUnit: unit.! !
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:18:18'!
                       test05
	self assert: 2 * aKilogram = twoKilograms.! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:18:23'!
                         adaptToNumber: aSmallInteger andSend: aSymbol 
	self shouldBeImplemented! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:18:42' prior: 50352672!
                   adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class withAmount: aSmallInteger * amount andUnit: unit.! !
!WeightMeasureTest methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:20:36'!
                         test06
	self assert: twoKilograms / 2 = aKilogram .! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:20:45'!
                        / aSmallInteger 
	self shouldBeImplemented! !

self class allInstancesDo: [:each | each delete]!
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:22:11' prior: 50352690!
                              / aNumber 
	^ self class withAmount: amount / aNumber andUnit: unit.! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:22:25' prior: 50352661!
                       * aNumber 
	^ self class withAmount: amount * aNumber andUnit: unit.! !
!WeightMeasure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:22:29' prior: 50352678!
                       adaptToNumber: aNumber andSend: aSymbol 
	^ self class withAmount: aNumber * amount andUnit: unit.! !

Object subclass: #tMeasure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

Object subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Measure category: #'Distance-Solution'!
Object subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Measure methodsFor: 'no messages' stamp: 'GDS 6/4/2017 11:31:12'!
              withName: aName andAmount: anAmount andUnit: aWeightUnit 
	amount := anAmount .
	unit := aWeightUnit .! !

!classDefinition: #Measure category: #'Distance-Solution'!
Object subclass: #Measure
	instanceVariableNames: 'amount unit name'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:31:25' prior: 50352730!
            withName: aName andAmount: anAmount andUnit: aWeightUnit 
	name := aName.
	amount := anAmount .
	unit := aWeightUnit .! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:31:48'!
                           withAmount: anAmount andUnit: aWeightUnit 
	amount := anAmount .
	unit := aWeightUnit .! !

Measure removeSelector: #withName:andAmount:andUnit:!
!Measure class methodsFor: 'no messages' stamp: 'GDS 6/4/2017 11:32:23'!
     withAmount: anAmount andUnit: aDistanceUnit 

	^ self new initializeWithAmount: anAmount andUnit: aDistanceUnit! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:32:59'!
  * anAmount 
	^ self class withAmount: amount * anAmount andUnit: unit.! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:34:03'!
           + aMeasure
	^ self class withAmount: (amount * unit conversionFactor) + (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit defaultName andConversionFactor: 1).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:34:51'!
              - aMeasure
	^ self class withAmount: (amount * unit conversionFactor) - (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit class defaultName andConversionFactor: 1).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:34:56' prior: 50352768!
                        + aMeasure
	^ self class withAmount: (amount * unit conversionFactor) + (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit class defaultName andConversionFactor: 1).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:35:12'!
        / aNumber 
	^ self class withAmount: amount / aNumber andUnit: unit.! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:35:44'!
             adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class withAmount: aSmallInteger * amount andUnit: unit.! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:36:07'!
   unit
	^ unit! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:36:31'!
     convertTo: aUnit
	^ self class withAmount:  amount * (unit conversionFactor) / (aUnit conversionFactor) andUnit: aUnit! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:36:43'!
                           amount
	^ amount! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:37:08'!
 = aMeasure

	^ (aMeasure isKindOf: self class) and: [amount = (aMeasure convertTo: unit) amount].! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 11:37:59' prior: 50352320!
  grams
	^ Measure withAmount: self andUnit: (WeightUnit withName: 'gram' andConversionFactor: 1).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 11:38:04' prior: 50352371!
   kilograms
	^ Measure withAmount: self andUnit: (WeightUnit withName: 'kilogram' andConversionFactor: 1000).! !

Object subclass: #WeightMeasure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #WeightMeasure category: #'Distance-Solution'!
Object subclass: #WeightMeasure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

"E" WeightMeasureTest debug: #test01!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:38:58'!
                    initializeWithAmount: anAmount andUnit: aWeightUnit 
	amount := anAmount .
	unit := aWeightUnit .! !

Measure removeSelector: #withAmount:andUnit:!

"E" WeightMeasureTest debug: #test01!
!WeightUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:39:12'!
                 defaultName
	self shouldBeImplemented! !
!WeightUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:39:25' prior: 50352860!
                   defaultName

	^ 'gram'! !

Smalltalk removeClassNamed: #WeightMeasure!

Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit name'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Measure category: #'Distance-Solution'!
Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit name'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

DistanceTest removeSelector: #test24OneMeterToTenKilometersBy5CentimetersIntervalHasElementsWith5CentimetersBetweenEachElement!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:42:42'!
    < aMeasure

	^ (amount * unit conversionFactor) < (aMeasure amount * aMeasure unit conversionFactor)! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:43:50'!
             hash

	^ unit name hash + amount hash ! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:44:33'!
           negated

	^ self class withAmount: amount negated andUnit: (unit class withName: unit defaultName andConversionFactor: 1).! !
!DistanceUnit class methodsFor: 'normalization' stamp: 'GDS 6/4/2017 11:45:36'!
                  defaultName

	^ 'meter'! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:47:03'!
                          printString

	| amountAsString unitAsString |
	
	amountAsString := amount printString.
	unitAsString := unit printString.
	
	(amount > 1) ifTrue: [ unitAsString := unitAsString , 's' ].
	
	^ amountAsString , ' ' , unitAsString ! !

Distance removeSelector: #to:by:do:!

Distance removeSelector: #to:by:!

Distance removeSelector: #to:do:!

Distance removeSelector: #to:!

Smalltalk removeClassNamed: #DistanceInterval!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:48:32'!
                  printOn: aStream 
	| amountAsString unitAsString |
	
	amountAsString := amount printString.
	unitAsString := unit printString.
	
	(amount > 1) ifTrue: [ unitAsString := unitAsString , 's' ].
	
	aStream nextPutAll: ' amount ', amountAsString.
	aStream nextPutAll: ' unit ', unitAsString.
	^ aStream ! !

DistanceTest removeSelector: #test21OneMeterToThreeMetersIntervallHasOneMeterTwoMetersAndThreeMetersInIt!

DistanceTest removeSelector: #test22OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt!

DistanceTest removeSelector: #test23OneCentimeterToThreeCentimetersIntervalHasOneCentimeterTwoCentimetersAndThreeCentimetersInIt!

DistanceTest removeSelector: #test26ToDoAppliesOperationsToEveryDistanceInInterval!

DistanceTest removeSelector: #test25ToByDoAppliesOperationsToEveryDistanceInInterval!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 11:49:38' prior: 50351322!
                            millimeters
	^ Measure withAmount: self andUnit: (DistanceUnit withName: 'millimeter' andConversionFactor: 1/1000).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 11:49:44' prior: 50351509!
                meters
	^ Measure withAmount: self andUnit: (DistanceUnit withName: 'meter' andConversionFactor: 1)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 11:49:48' prior: 50351516!
kilometers
	^ Measure withAmount: self andUnit: (DistanceUnit withName: 'kilometer' andConversionFactor: 1000)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 11:49:53' prior: 50351350!
                     centimeters
	^ Measure withAmount: self andUnit: (DistanceUnit withName: 'centimeter' andConversionFactor: 1/100)! !

Smalltalk removeClassNamed: #Distance!

Object subclass: #MeasuretUnit
	instanceVariableNames: 'name conversionFactor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #MeasuretUnit category: #'Distance-Solution'!
Object subclass: #MeasuretUnit
	instanceVariableNames: 'name conversionFactor'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

Smalltalk removeClassNamed: #MeasuretUnit!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 11:53:22' prior: 50352959!
  meters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'meter' andConversionFactor: 1)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 11:53:31' prior: 50352972!
 centimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'centimeter' andConversionFactor: 1/100)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 11:53:34' prior: 50352952!
                   millimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 11:53:37' prior: 50352965!
                 kilometers
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilometer' andConversionFactor: 1000)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:53:48' prior: 50351406!
             millimeter
	
	^ (MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:53:49' prior: 50353020!
          millimeter
	
	^ (MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:53:53' prior: 50351364!
          centimeter

	^ (MeasureUnit withName: 'centimeter' andConversionFactor: 1/100)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:53:56' prior: 50351400!
            meter

	^ (MeasureUnit withName: 'meter' andConversionFactor: 1)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:54:00' prior: 50351388!
                          hectometer
	
	^ (MeasureUnit withName: 'hectometer' andConversionFactor: 100)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:54:03' prior: 50351394!
             kilometer
	
	^ (MeasureUnit withName: 'kilometer' andConversionFactor: 1000)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:54:06' prior: 50351376!
              decameter
	
	^ (MeasureUnit withName: 'decameter' andConversionFactor: 10)! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:54:08' prior: 50351382!
                decimeter
	
	^ (MeasureUnit withName: 'decimeter' andConversionFactor: 1/10)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:54:11' prior: 50351526!
             centimeter
	
	^ (MeasureUnit withName: 'centimeter' andConversionFactor: 1/100)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:54:14' prior: 50351458!
          meter

	^ (MeasureUnit withName: 'meter' andConversionFactor: 1)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:54:16' prior: 50351722!
                         decameter
	
	^ (MeasureUnit withName: 'decameter' andConversionFactor: 10)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:54:18' prior: 50351464!
               millimeter
	
	^ (MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:54:27' prior: 50351452!
         kilometer
	
	^ (MeasureUnit withName: 'kilometer' andConversionFactor: 1000)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:54:30' prior: 50351470!
             hectometer
	
	^ (MeasureUnit withName: 'hectometer' andConversionFactor: 100)! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:54:33' prior: 50351482!
            decimeter
	
	^ (MeasureUnit withName: 'decimeter' andConversionFactor: 1/10)! !

MeasureUnit removeSelector: #amountToMeters:!
!MeasureUnit methodsFor: 'comparing' stamp: 'GDS 6/4/2017 11:55:26' prior: 50352104!
            = aMeasureUnit 

	^ (aMeasureUnit isKindOf: self class) and: [name = aMeasureUnit name and: [ conversionFactor = aMeasureUnit conversionFactor ]].
! !

MeasureUnit class removeSelector: #normalizedValue!

MeasureUnit class removeSelector: #amountToMillimeters:!
!MeasureUnit class methodsFor: 'instance creation' stamp: 'GDS 6/4/2017 11:58:12'!
       withName: aName andConversionFactor: aConversionFactor andDefaultName: aDefaultName
	^ self new withName: aName andConversionFactor: aConversionFactor! !
!MeasureUnit class methodsFor: 'instance creation' stamp: 'GDS 6/4/2017 11:58:23' prior: 50353122!
   withName: aName andConversionFactor: aConversionFactor andDefaultName: aDefaultName
	^ self new withName: aName andConversionFactor: aConversionFactor andDefaultName: aDefaultName 
	! !

MeasureUnit class removeSelector: #withName:andConversionFactor:!

!classDefinition: #MeasureUnit category: #'Distance-Solution'!
Object subclass: #MeasureUnit
	instanceVariableNames: 'name conversionFactor defaultName'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureUnit methodsFor: 'initialization' stamp: 'GDS 6/4/2017 11:58:52'!
                 withName: aName andConversionFactor: aConversionFactor andDefaultName: aDefaultName
	name := aName.
	conversionFactor := aConversionFactor.
	defaultName := aDefaultName ! !

MeasureUnit removeSelector: #withName:andConversionFactor:!
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:59:29' prior: 50353032!
                    centimeter

	^ MeasureUnit withName: 'centimeter' andConversionFactor: 1/100 andDefaultName: 'meter'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 11:59:49' prior: 50353056!
                      decameter
	
	^ MeasureUnit withName: 'decameter' andConversionFactor: 10 andDefaultName: 'meter'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:00:02' prior: 50353062!
                          decimeter
	
	^ MeasureUnit withName: 'decimeter' andConversionFactor: 1/10 andDefaultName: 'meter'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:00:11' prior: 50353044!
                        hectometer
	
	^ MeasureUnit withName: 'hectometer' andConversionFactor: 100 andDefaultName: 'meter'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:00:15' prior: 50353050!
                       kilometer
	
	^ MeasureUnit withName: 'kilometer' andConversionFactor: 1000 andDefaultName: 'meter'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:00:21' prior: 50353038!
                        meter

	^ MeasureUnit withName: 'meter' andConversionFactor: 1! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:00:22' prior: 50353194!
                            meter

	^ MeasureUnit withName: 'meter' andConversionFactor: 1 andDefaultName: 'meter'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:00:28' prior: 50353026!
    millimeter
	
	^ MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000 andDefaultName: 'meter'! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:00:51' prior: 50352787!
                           + aMeasure
	^ self class withAmount: (amount * unit conversionFactor) + (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit class defaultName andConversionFactor: 1 andDefaultName: unit defaultName).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:00:55' prior: 50352777!
                       - aMeasure
	^ self class withAmount: (amount * unit conversionFactor) - (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit class defaultName andConversionFactor: 1 andDefaultName: unit defaultName).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:01:00' prior: 50352895!
                       negated

	^ self class withAmount: amount negated andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:01:10' prior: 50352999!
        centimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'centimeter' andConversionFactor: 1/100 andDefaultName: 'meters')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:01:24' prior: 50352826!
                          grams
	^ Measure withAmount: self andUnit: (WeightUnit withName: 'gram' andConversionFactor: 1 andDefaultName: 'gram').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:01:35' prior: 50352832!
            kilograms
	^ Measure withAmount: self andUnit: (WeightUnit withName: 'kilogram' andConversionFactor: 1000 andDefaultName: 'gram').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:01:38' prior: 50353013!
 kilometers
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilometer' andConversionFactor: 1000 andDefaultName: 'meters')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:01:41' prior: 50352993!
                             meters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'meter' andConversionFactor: 1 andDefaultName: 'meters')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:01:45' prior: 50353006!
        millimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000 andDefaultName: 'meters').! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:01:49' prior: 50353068!
              centimeter
	
	^ (MeasureUnit withName: 'centimeter' andConversionFactor: 1/100 andDefaultName: 'meters')! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:01:55' prior: 50353080!
                 decameter
	
	^ MeasureUnit withName: 'decameter' andConversionFactor: 10 andDefaultName: 'meters'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:02:00' prior: 50353288!
                        centimeter
	
	^ MeasureUnit withName: 'centimeter' andConversionFactor: 1/100 andDefaultName: 'meters'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:02:08' prior: 50353104!
                   decimeter
	
	^ MeasureUnit withName: 'decimeter' andConversionFactor: 1/10 andDefaultName: 'meters'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:02:14' prior: 50353098!
                      hectometer
	
	^ MeasureUnit withName: 'hectometer' andConversionFactor: 100 andDefaultName: 'meters'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:02:19' prior: 50353092!
                     kilometer
	
	^ MeasureUnit withName: 'kilometer' andConversionFactor: 1000 andDefaultName: 'meters'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:02:26' prior: 50353074!
                      meter

	^ MeasureUnit withName: 'meter' andConversionFactor: 1 andDefaultName: 'meter'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:02:32' prior: 50353323!
   kilometer
	
	^ MeasureUnit withName: 'kilometer' andConversionFactor: 1000 andDefaultName: 'meter'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:02:38' prior: 50353316!
                       hectometer
	
	^ MeasureUnit withName: 'hectometer' andConversionFactor: 100 andDefaultName: 'meter'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:02:43' prior: 50353309!
                      decimeter
	
	^ MeasureUnit withName: 'decimeter' andConversionFactor: 1/10 andDefaultName: 'meter'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:02:49' prior: 50353295!
                       decameter
	
	^ MeasureUnit withName: 'decameter' andConversionFactor: 10 andDefaultName: 'meter'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:02:57' prior: 50353302!
                         centimeter
	
	^ MeasureUnit withName: 'centimeter' andConversionFactor: 1/100 andDefaultName: 'meter'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:03:11' prior: 50353086!
                    millimeter
	
	^ MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000 andDefaultName: 'meters'! !
!WeightUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:03:21' prior: 50352384!
                 withName: aName andConversionFactor: aConversionFactor
	^ self new withName: aName andConversionFactor: aConversionFactor andDefaultName: 'meters'! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:03:28' prior: 50353280!
                 millimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000 andDefaultName: 'meter').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:03:32' prior: 50353273!
                         meters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'meter' andConversionFactor: 1 andDefaultName: 'meter')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:03:35' prior: 50353265!
         kilometers
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilometer' andConversionFactor: 1000 andDefaultName: 'meter')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:03:41' prior: 50353243!
                              centimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'centimeter' andConversionFactor: 1/100 andDefaultName: 'meter')! !

!classDefinition: 'MeasureUnit class' category: #'Distance-Solution'!
MeasureUnit class
	instanceVariableNames: 'defaultName'!
!MeasureUnit class methodsFor: 'normalization' stamp: 'GDS 6/4/2017 12:04:14' prior: 50352902!
                     defaultName

	^ defaultName! !

MeasureUnit class
	instanceVariableNames: ''!

!classDefinition: 'MeasureUnit class' category: #'Distance-Solution'!
MeasureUnit class
	instanceVariableNames: ''!

Smalltalk removeClassNamed: #MeasureUnit!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:06:48' prior: 50353251!
                         grams
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'gram' andConversionFactor: 1 andDefaultName: 'gram').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:06:54' prior: 50353258!
           kilograms
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilogram' andConversionFactor: 1000 andDefaultName: 'gram').! !

!classDefinition: #MeasureUnit category: #'Distance-Solution'!
Object subclass: #MeasureUnit
	instanceVariableNames: 'name conversionFactor defaultName'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:07:15'!
  withName: aName andConversionFactor: aConversionFactor andDefaultName: aDefaultName
	name := aName.
	conversionFactor := aConversionFactor.
	defaultName := aDefaultName ! !

MeasureUnit removeSelector: #withName:andConversionFactor:!
!MeasureUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:07:38'!
 withName: aName andConversionFactor: aConversionFactor andDefaultName: aDefaultName
	^ self new withName: aName andConversionFactor: aConversionFactor andDefaultName: aDefaultName! !

MeasureUnit class removeSelector: #withName:andConversionFactor:!

MeasureUnit class removeSelector: #defaultName!
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:08:12'!
      defaultName
	
		^ defaultName ! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:08:22'!
               name
	
		^ name! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:08:34' prior: 50352546!
              conversionFactor
	
		^ conversionFactor ! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:08:49' prior: 50353483!
                     conversionFactor
	
		^ conversionFactor ! !

"E" WeightMeasureTest debug: #test01!

"E" WeightMeasureTest debug: #test01!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:09:19' prior: 50353213!
           + aMeasure
	^ self class withAmount: (amount * unit conversionFactor) + (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName).! !

"E" DistanceTest debug: #test01MeterIsEqualToHimself!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:10:49' prior: 50353224!
      - aMeasure
	^ self class withAmount: (amount * unit conversionFactor) - (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName).! !

"E" DistanceTest debug: #test01MeterIsEqualToHimself!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:11:29' prior: 50353409!
        centimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'centimeter' andConversionFactor: 1/100 andDefaultName: 'meter')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:11:36' prior: 50353401!
                           kilometers
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilometer' andConversionFactor: 1000 andDefaultName: 'meter')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:11:41' prior: 50353394!
                              meters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'meter' andConversionFactor: 1 andDefaultName: 'meter')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:11:46' prior: 50353386!
         millimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000 andDefaultName: 'meter').! !

----SNAPSHOT----#(4 June 2017 12:11:59.024871 pm) Cuis5.0-3081-spur-64.image priorSource: 670256!

!classDefinition: #DistanceTest category: #'Distance-Solution'!
TestCase subclass: #DistanceTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #DistanceTest category: #'Distance-Solution'!
TestCase subclass: #DistanceTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #DistanceTest category: #'Distance-Solution'!
TestCase subclass: #DistanceTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #DistanceTest category: #'Distance-Solution'!
TestCase subclass: #DistanceTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #DistanceTest category: #'Distance-Solution'!
TestCase subclass: #DistanceTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!DistanceTest methodsFor: 'setup' stamp: 'GDS 6/4/2017 12:12:38' prior: 50346846!
                              setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:13:04'!
            test21
	
	self assert: (aKilogram + hundredGrams) = oneThousandOneHundredGrams ! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:13:20'!
         test22
	
		self assert: (aKilogram + aKilogram) = twoKilograms! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:13:22' prior: 50353627!
          test22
	
	self assert: (aKilogram + aKilogram) = twoKilograms! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:13:36'!
                           test23
	
	self assert: (aKilogram - aKilogram) = zeroKilograms! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:13:50'!
                          test24
	
	self assert: aKilogram * 2 = twoKilograms.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:14:06'!
    test25
	
	self assert: 2 * aKilogram = twoKilograms.! !
!DistanceTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:14:20'!
    test26
	
	self assert: twoKilograms / 2 = aKilogram .! !

Smalltalk removeClassNamed: #WeightMeasureTest!

----SNAPSHOT----#(4 June 2017 12:15:02.721275 pm) Cuis5.0-3081-spur-64.image priorSource: 700749!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:16:08'!
                test27
	
	self assert: 10 pesos + 50 dolarss = 10 pesos + 50 dolars.! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:16:13' prior: 50353659!
     test27
	
	self assert: 10 pesos + 50 dolars = 10 pesos + 50 dolars.! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:16:21'!
                pesos
	self shouldBeImplemented! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:17:08' prior: 50353669!
    pesos
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'peso' andConversionFactor: 1 andDefaultName: 'peso')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:17:18'!
                            dolars
	self shouldBeImplemented! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:17:50' prior: 50353680!
   dolars
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'dolar' andConversionFactor: 1 andDefaultName: 'dolar')! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:18:15' prior: 50353664!
               test27
	
	self assert: 10 pesos + 50 dolars = (10 pesos + 50 dolars).! !

10 pesos + 50 dolars!

unit name!

Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Measure category: #'Distance-Solution'!
Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:26:01' prior: 50353691!
  test27
	
	self deny: 10 pesos + 50 dolars = (10 pesos + 50 pesos).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:31:47' prior: 50353495!
                               + aMeasure
	(self canAdd: aMeasure) ifFalse: [ ^ self error: 'Cannot add measures of two different types'] .
	^ self class withAmount: (amount * unit conversionFactor) + (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName).! !

!classDefinition: #XXX category: #'Distance-Solution'!
Object subclass: #XXX
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:34:37' prior: 50353714!
    + aMeasure
	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (amount * unit conversionFactor) + (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:35:00'!
 canAdd: aMeasure 
	self shouldBeImplemented! !

!classDefinition: #Measure category: #'Distance-Solution'!
Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit category'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:40:44' prior: 50353745!
canAdd: aMeasure 
	^ category = aMeasure category! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:40:56'!
category
	self shouldBeImplemented! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:41:04' prior: 50353760!
                               category
	^ category! !
!MeasureUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:41:54'!
                   withName: aName andConversionFactor: aConversionFactor andDefaultName: aDefaultName andCategory: aCategory
	^ self new withName: aName andConversionFactor: aConversionFactor andDefaultName: aDefaultName andCategory: aCategory ! !

MeasureUnit class removeSelector: #withName:andConversionFactor:andDefaultName:!
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:42:18' prior: 50353159!
      centimeter

	^ MeasureUnit withName: 'centimeter' andConversionFactor: 1/100 andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:42:24' prior: 50353166!
                              decameter
	
	^ MeasureUnit withName: 'decameter' andConversionFactor: 10 andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:42:28' prior: 50353173!
  decimeter
	
	^ MeasureUnit withName: 'decimeter' andConversionFactor: 1/10 andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:42:30' prior: 50353180!
hectometer
	
	^ MeasureUnit withName: 'hectometer' andConversionFactor: 100 andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:42:33' prior: 50353187!
                               kilometer
	
	^ MeasureUnit withName: 'kilometer' andConversionFactor: 1000 andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:42:35' prior: 50353200!
meter

	^ MeasureUnit withName: 'meter' andConversionFactor: 1 andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:42:42' prior: 50353206!
            millimeter
	
	^ MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000 andDefaultName: 'meter' andCategory: 'distance'! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:42:59' prior: 50353733!
   + aMeasure
	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (amount * unit conversionFactor) + (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:43:08' prior: 50353507!
                      - aMeasure
	^ self class withAmount: (amount * unit conversionFactor) - (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:43:13' prior: 50353235!
  negated

	^ self class withAmount: amount negated andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: 'distance').! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:43:17' prior: 50353858!
              negated

	^ self class withAmount: amount negated andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:43:22' prior: 50353519!
             centimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'centimeter' andConversionFactor: 1/100 andDefaultName: 'meter' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:43:28' prior: 50353684!
   dolars
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'dolar' andConversionFactor: 1 andDefaultName: 'dolar' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:43:31' prior: 50353884!
                 dolars
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'dolar' andConversionFactor: 1 andDefaultName: 'dolar' andCategory: 'dolars')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:43:38' prior: 50353432!
                   grams
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'gram' andConversionFactor: 1 andDefaultName: 'gram' andCategory: 'weight').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:43:46' prior: 50353439!
                     kilograms
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilogram' andConversionFactor: 1000 andDefaultName: 'gram' andCategory: 'weight').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:43:50' prior: 50353527!
          kilometers
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilometer' andConversionFactor: 1000 andDefaultName: 'meter' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:43:56' prior: 50353535!
      meters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'meter' andConversionFactor: 1 andDefaultName: 'meter' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:44:00' prior: 50353542!
                 millimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000 andDefaultName: 'meter' andCategory: 'distance').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:44:09' prior: 50353673!
 pesos
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'peso' andConversionFactor: 1 andDefaultName: 'peso' andCategory: 'pesos')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:44:20' prior: 50353892!
                       dolars
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'dolar' andConversionFactor: 1 andDefaultName: 'dolar' andCategory: 'dolar')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 12:44:24' prior: 50353940!
                    pesos
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'peso' andConversionFactor: 1 andDefaultName: 'peso' andCategory: 'peso')! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:44:28' prior: 50353364!
              centimeter
	
	^ MeasureUnit withName: 'centimeter' andConversionFactor: 1/100 andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:44:30' prior: 50353357!
                            decameter
	
	^ MeasureUnit withName: 'decameter' andConversionFactor: 10 andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:44:33' prior: 50353350!
 decimeter
	
	^ MeasureUnit withName: 'decimeter' andConversionFactor: 1/10 andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:44:36' prior: 50353343!
                               hectometer
	
	^ MeasureUnit withName: 'hectometer' andConversionFactor: 100 andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:44:39' prior: 50353336!
                              kilometer
	
	^ MeasureUnit withName: 'kilometer' andConversionFactor: 1000 andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:44:46' prior: 50353330!
                               meter

	^ MeasureUnit withName: 'meter' andConversionFactor: 1 andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:44:49' prior: 50353371!
           millimeter
	
	^ MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000 andDefaultName: 'meters' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 12:45:12' prior: 50354010!
                          millimeter
	
	^ MeasureUnit withName: 'millimeter' andConversionFactor: 1/1000 andDefaultName: 'meter' andCategory: 'distance'! !

!classDefinition: #MeasureUnit category: #'Distance-Solution'!
Object subclass: #MeasureUnit
	instanceVariableNames: 'name conversionFactor defaultName category'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:46:00'!
                              withName: aName andConversionFactor: aConversionFactor andDefaultName: aDefaultName andCategory: aCategory
	name := aName.
	conversionFactor := aConversionFactor.
	defaultName := aDefaultName.
	category  := aCategory.! !

MeasureUnit removeSelector: #withName:andConversionFactor:andDefaultName:!

"E" MeasureTest debug: #test03AMeterPlusAMeterEqualsTwoMeters!
!MeasureUnit methodsFor: 'accessing' stamp: 'GDS 6/4/2017 12:46:37'!
                  category
	self shouldBeImplemented! !
!MeasureUnit methodsFor: 'accessing' stamp: 'GDS 6/4/2017 12:46:44' prior: 50354047!
     category
	^ category ! !

self restart!
!XXX class methodsFor: 'no messages' stamp: 'GDS 6/4/2017 12:48:33'!
                   with: aMeasure andOther: anotherMeasure
	
	^ self new initializeWith: aMeasure and: anotherMeasure ! !

!classDefinition: #XXX category: #'Distance-Solution'!
Object subclass: #XXX
	instanceVariableNames: 'firstMeasure'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #XXX category: #'Distance-Solution'!
Object subclass: #XXX
	instanceVariableNames: 'firstMeasure secondMeasure'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!XXX methodsFor: 'nil' stamp: 'GDS 6/4/2017 12:49:27'!
              initializeWith: aMeasure and: anotherMeasure
	
	firstMeasure := aMeasure.
	secondMeasure := anotherMeasure .! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:50:25'!
         = anotherXXX

	^ (anotherXXX isKindOf: self class) and: [firstMeasure = anotherXXX firstMeasure.! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:50:45' prior: 50354079!
     = anotherXXX

	^ (anotherXXX isKindOf: self class) and: [firstMeasure = anotherXXX firstMeasure and: [ secondMeasure = anotherXXX secondMeasure]] .! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:51:06'!
  firstMeasure

	^ firstMeasure ! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:51:13'!
                       secondMeasure

	^ secondMeasure ! !

self canAdd: aMeasure!

10 pesos!

Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Measure category: #'Distance-Solution'!
Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:54:19' prior: 50353756!
                               canAdd: aMeasure 
	^ unit category = aMeasure unit category! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:54:56'!
                              test28
	
	self assert: 10 pesos + 50 dolars = (10 pesos + 50 dolars).! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 12:55:12' prior: 50354118!
    test28
	
	self assert: 10 pesos + 50 dolars = (50 dolars + 10 pesos).! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:59:09' prior: 50354085!
= anotherXXX

	^ (anotherXXX isKindOf: self class) or: [firstMeasure = anotherXXX firstMeasure and: [ secondMeasure = anotherXXX secondMeasure ]] or: [firstMeasure = anotherXXX secondMeasure and: [ secondMeasure = anotherXXX firstMeasure]].! !

Measure removeSelector: #category!

anotherXXX isKindOf: self class!
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:01:21' prior: 50354128!
               = anotherXXX

	^ (anotherXXX isKindOf: self class) and: [[firstMeasure = anotherXXX firstMeasure and: [ secondMeasure = anotherXXX secondMeasure ]] or: [firstMeasure = anotherXXX secondMeasure and: [ secondMeasure = anotherXXX firstMeasure]]].! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:02:59' prior: 50354141!
                  = anotherXXX
	(anotherXXX isKindOf: self class) ifFalse: [^ false].
	^  (firstMeasure = anotherXXX firstMeasure) and: [ secondMeasure = anotherXXX secondMeasure or: [firstMeasure = anotherXXX secondMeasure and: [ secondMeasure = anotherXXX firstMeasure]]].! !

(firstMeasure = anotherXXX firstMeasure)!
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:04:41' prior: 50354152!
                          = anotherXXX
	(anotherXXX isKindOf: self class) ifFalse: [^ false].
	^ ((firstMeasure = anotherXXX firstMeasure) and: [ secondMeasure = anotherXXX secondMeasure]) or: [firstMeasure = anotherXXX secondMeasure and: [ secondMeasure = anotherXXX firstMeasure]].! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:04:47' prior: 50354165!
    = anotherXXX
	(anotherXXX isKindOf: self class) ifFalse: [^ false].
	^ (firstMeasure = anotherXXX firstMeasure and: [ secondMeasure = anotherXXX secondMeasure]) or: [firstMeasure = anotherXXX secondMeasure and: [ secondMeasure = anotherXXX firstMeasure]].! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:05:53' prior: 50354176!
      = anotherXXX
	^ (anotherXXX isKindOf: self class)  and: ((firstMeasure = anotherXXX firstMeasure and: [ secondMeasure = anotherXXX secondMeasure]) or: [firstMeasure = anotherXXX secondMeasure and: [ secondMeasure = anotherXXX firstMeasure]]).! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:05:55' prior: 50354187!
                   = anotherXXX

	^ (anotherXXX isKindOf: self class)  and: ((firstMeasure = anotherXXX firstMeasure and: [ secondMeasure = anotherXXX secondMeasure]) or: [firstMeasure = anotherXXX secondMeasure and: [ secondMeasure = anotherXXX firstMeasure]]).! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:06:34' prior: 50354198!
                  = anotherXXX

	^ (anotherXXX isKindOf: self class) and: ((firstMeasure = anotherXXX firstMeasure and: [ secondMeasure = anotherXXX secondMeasure]) or: ([firstMeasure = anotherXXX secondMeasure and: [ secondMeasure = anotherXXX firstMeasure]])).! !

(10 pesos + 50 pesos)!

(anotherXXX isKindOf: self class)!

(anotherXXX isKindOf: self class) !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:08:22' prior: 50354209!
                = anotherXXX

	^ (anotherXXX isKindOf: self class) and: [true].! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:08:51' prior: 50354223!
      = anotherXXX

	^ (anotherXXX isKindOf: self class) and: ((firstMeasure = anotherXXX firstMeasure and: [ secondMeasure = anotherXXX secondMeasure]) or: ([firstMeasure = anotherXXX secondMeasure and: [ secondMeasure = anotherXXX firstMeasure]])).! !

(anotherXXX isKindOf: self class)!
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:10:26' prior: 50354228!
             = anotherXXX

	^ (anotherXXX isKindOf: self class) and: [((firstMeasure = anotherXXX firstMeasure and: [ secondMeasure = anotherXXX secondMeasure]) or: ([firstMeasure = anotherXXX secondMeasure and: [ secondMeasure = anotherXXX firstMeasure]]))].! !

!classDefinition: #MeasureTest category: #'Distance-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:15:45'!
                              test29

	self should: [tenPesos convertTo: (MeasureUnit withName: 'meter' andConversionFactor: 1 andDefaultName: 'meter' andCategory: 'distance') ] raise: Error - MessageNotUnderstood description: 'Cannot convert to unit'.! !

!classDefinition: #MeasureTest category: #'Distance-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/4/2017 13:15:58' prior: 50353607!
                              setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	meterUnit := MeasureUnit withName: 'meter' andConversionFactor: 1 andDefaultName: 'meter' andCategory: 'distance'! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:16:13' prior: 50354263!
          test29

	self should: [tenPesos convertTo: meterUnit ] raise: Error - MessageNotUnderstood description: 'Cannot convert to unit'.! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/4/2017 13:16:38' prior: 50354286!
          setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionFactor: 1 andDefaultName: 'meter' andCategory: 'distance'! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:17:56' prior: 50354305!
                   test29

	self should: [tenPesos convertTo: meterUnit ] raise: (Error - MessageNotUnderstood) description: 'Cannot convert to unit'.! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:19:33' prior: 50352810!
                              convertTo: aUnit
	
	(self canConvert: aUnit) ifFalse: [ self error: ''].
	^ self class withAmount:  amount * (unit conversionFactor) / (aUnit conversionFactor) andUnit: aUnit! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:19:48' prior: 50354340!
                   convertTo: aUnit
	
	(self canConvert: aUnit) ifFalse: [ self error: 'Cannot convert to unit'].
	^ self class withAmount:  amount * (unit conversionFactor) / (aUnit conversionFactor) andUnit: aUnit! !

"E" MeasureTest debug: #test29!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:20:06'!
            canConvert: aMeasureUnit 
	self shouldBeImplemented! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:20:24' prior: 50354359!
              canConvert: aMeasureUnit 
	^ false! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:20:53' prior: 50354364!
                               canConvert: aMeasureUnit 
	^ unit category = aMeasureUnit category! !

(aMeasure isKindOf: self class)!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:23:58' prior: 50352820!
                             = aMeasure

	^ (aMeasure isKindOf: self class) and: [unit category = aMeasure unit category and: [amount = (aMeasure convertTo: unit) amount]].! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:24:10' prior: 50354376!
                  = aMeasure

	^ (aMeasure isKindOf: self class) and: [(unit category = aMeasure unit category) and: [amount = (aMeasure convertTo: unit) amount]].! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:24:43'!
        test30
	
	self deny: 10 pesos - 50 dolars = (10 pesos - 50 pesos).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:25:08' prior: 50353847!
                               - aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (amount * unit conversionFactor) - (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:25:12' prior: 50353833!
                     + aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (amount * unit conversionFactor) + (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:25:34'!
             test31
	
	self deny: 10 pesos - 50 dolars = (10 pesos - 50 pesos).! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:26:01' prior: 50354424!
       test31
	
	self assert: 10 pesos - 50 dolars = (50 dolars - 10 pesos).! !

MeasureTest removeSelector: #test31!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:27:39'!
              test21TheSumOfTwoMeasuresThatCanBeAddedWorks
	
	self assert: (aKilogram + hundredGrams) = oneThousandOneHundredGrams ! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:27:43'!
    test21TheSumOfTwoMeasuresThatCanBeAddedWork
	
	self assert: (aKilogram + hundredGrams) = oneThousandOneHundredGrams ! !

MeasureTest removeSelector: #test21TheSumOfTwoMeasuresThatCanBeAddedWorks!

MeasureTest removeSelector: #test21!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:28:17'!
                   test22TheSumOfSameMeasureWorks
	
	self assert: (aKilogram + aKilogram) = twoKilograms! !

MeasureTest removeSelector: #test22!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:28:22'!
                              test21TheSumOfTwoMeasuresThatCanBeAddedWorks
	
	self assert: (aKilogram + hundredGrams) = oneThousandOneHundredGrams ! !

MeasureTest removeSelector: #test21TheSumOfTwoMeasuresThatCanBeAddedWork!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:28:58'!
                         test23TheDifferenceBetweenSameMeasureWorks
	
	self assert: (aKilogram - aKilogram) = zeroKilograms! !

MeasureTest removeSelector: #test23!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:29:23'!
                 test24TheMultiplicationOfAMeasureWithAScalarWorks
	
	self assert: aKilogram * 2 = twoKilograms.! !

MeasureTest removeSelector: #test24!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:29:39'!
                    test25TheMultiplicationOfAScalarWithAMeasureWorks
	
	self assert: 2 * aKilogram = twoKilograms.! !

MeasureTest removeSelector: #test25!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:29:53'!
                    test26DividingAMeasureByAScalarWorks
	
	self assert: twoKilograms / 2 = aKilogram .! !

MeasureTest removeSelector: #test26!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:32:30'!
test27TheSumOfTwoMeasuresOfDifferentTypeAreDifferent
	
	self deny: 10 pesos + 50 dolars = (10 pesos + 50 pesos).! !

MeasureTest removeSelector: #test27!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:34:44'!
   test27
	
	self deny: 10 pesos + 50 dolars = (10 pesos + 50 pesos).! !

MeasureTest removeSelector: #test27TheSumOfTwoMeasuresOfDifferentTypeAreDifferent!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:35:55'!
   test27TheSumOfTwoMeasuresWithDifferentTypeCannotBeComparedToASumOfMeasuresWithSameType
	
	self deny: 10 pesos + 50 dolars = (10 pesos + 50 pesos).! !

MeasureTest removeSelector: #test27!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:36:15'!
 test27TheSumOfTwoMeasuresWithDifferentTypeIsNotEqualsToASumOfMeasuresWithSameType
	
	self deny: 10 pesos + 50 dolars = (10 pesos + 50 pesos).! !

MeasureTest removeSelector: #test27TheSumOfTwoMeasuresWithDifferentTypeCannotBeComparedToASumOfMeasuresWithSameType!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:37:38'!
                      test28TheSumOfTwoMeasuresWithDifferentIsCommutative
	
	self assert: 10 pesos + 50 dolars = (50 dolars + 10 pesos).
	self assert: 50 dolars + 10 pesos  = (50 dolars + 10 pesos).! !

MeasureTest removeSelector: #test28!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:39:24'!
   test25TheMultiplicationOfAScalarWithAMeasureIsCommutative	

	self assert: 2 * aKilogram = twoKilograms.
	self assert: aKilogram * 2 = twoKilograms.! !

MeasureTest removeSelector: #test25TheMultiplicationOfAScalarWithAMeasureWorks!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:39:58'!
                     test29CannotConvertFromAnyMeasureToAnyUnit

	self should: [tenPesos convertTo: meterUnit ] raise: (Error - MessageNotUnderstood) description: 'Cannot convert to unit'.! !

MeasureTest removeSelector: #test29!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:40:14' prior: 50354391!
                            test30
	
	self deny: 10 pesos - 50 dolars = (10 pesos - 50 pesos).! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:40:33'!
                       test29CannotConvertAMeasureToAUnitThatHasDifferentCategory

	self should: [tenPesos convertTo: meterUnit ] raise: (Error - MessageNotUnderstood) description: 'Cannot convert to unit'.! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:40:37'!
  test29CannotConvertAMeasureToAUnitThatHasDifferentType

	self should: [tenPesos convertTo: meterUnit ] raise: (Error - MessageNotUnderstood) description: 'Cannot convert to unit'.! !

MeasureTest removeSelector: #test29CannotConvertAMeasureToAUnitThatHasDifferentCategory!

MeasureTest removeSelector: #test29CannotConvertFromAnyMeasureToAnyUnit!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:41:19'!
  test30TheDifferenceOfTwoMeasuresWithDifferentTypeIsNotEqualsToASumOfMeasuresWithSameType
	
	self deny: 10 pesos - 50 dolars = (10 pesos - 50 pesos).! !

MeasureTest removeSelector: #test30!

10 pesos - 50 pesos!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:44:46'!
         test31
	
	self assert: 0 meters = 0 pesos.! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:46:15' prior: 50354384!
                       = aMeasure
	
	(amount = 0 and: [aMeasure amount = 0]) ifTrue: [^ true].
	^ (aMeasure isKindOf: self class) and: [(unit category = aMeasure unit category) and: [amount = (aMeasure convertTo: unit) amount]].! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:46:51'!
            test31NothingIsSameToNothing
	
	self assert: 0 meters = 0 pesos.! !

MeasureTest removeSelector: #test31!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:48:16' prior: 50354605!
   test31NothingIsSameToNothing
	
	self assert: -273.15 celsius = -459.67 fahrenheit.! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 13:48:30'!
 celsius
	self shouldBeImplemented! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 13:50:55' prior: 50354616!
  celsius
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'celsius' andConversionFactor: [:temperature | temperature + 273.15] andDefaultName: 'kelvin' andCategory: 'temperature')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 13:51:09'!
                      fahrenheit
	self shouldBeImplemented! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 13:51:48' prior: 50354629!
                               fahrenheit
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'fahrenheit' andConversionFactor: [] andDefaultName: 'kelvin' andCategory: 'temperature')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 13:52:38' prior: 50354634!
   fahrenheit
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'fahrenheit' andConversionFactor: [:temperature | (temperature + 459.67) * (5/9)] andDefaultName: 'kelvin' andCategory: 'temperature')! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:54:10' prior: 50354411!
                    + aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (amount * unit conversionFactor) + (aMeasure amount convertionMethod) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:54:22' prior: 50354652!
     + aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (amount * unit conversionFactor) + (aMeasure amount conversionMethod) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:55:10' prior: 50354665!
     + aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (amount * unit conversionFactor) + (aMeasure applyConversionMethod) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:56:39' prior: 50354678!
       + aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (self convertToDefault) + (aMeasure convertToDefault) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:56:52' prior: 50354691!
                     + aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (self convertToDefault) + (aMeasure convertToDefaultUnit) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:56:57' prior: 50354704!
                 + aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (self convertToDefaultUnit) + (aMeasure convertToDefaultUnit) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:57:22' prior: 50354397!
             - aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (self convertToDefaultUnit) - (aMeasure amount * aMeasure unit conversionFactor) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:57:36' prior: 50354730!
                          - aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (self convertToDefaultUnit) - (aMeasure amount * aMeasure convertToDefaultUnit) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:57:50' prior: 50352885!
                           < aMeasure

	^ (amount * unit conversionFactor) < (aMeasure amount * aMeasure convertToDefaultUnit)! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:58:10' prior: 50354758!
                              < aMeasure

	^ (self convertToDefaultUnit) < (aMeasure amount * aMeasure convertToDefaultUnit)! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:58:14' prior: 50354765!
   < aMeasure

	^ self convertToDefaultUnit < (aMeasure amount * aMeasure convertToDefaultUnit)! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:58:23' prior: 50354771!
     < aMeasure

	^ self convertToDefaultUnit < aMeasure convertToDefaultUnit! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:59:29' prior: 50354349!
                         convertTo: aUnit
	
	(self canConvert: aUnit) ifFalse: [ self error: 'Cannot convert to unit'].
	^ self class withAmount:  self convertToDefaultUnit / (aUnit conversionFactor) andUnit: aUnit! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:00:24' prior: 50354783!
    convertTo: aUnit
	
	(self canConvert: aUnit) ifFalse: [ self error: 'Cannot convert to unit'].
	^ self class withAmount:  self convertToDefaultUnit amount andUnit: aUnit! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:00:49' prior: 50354792!
                        convertTo: aUnit
	
	(self canConvert: aUnit) ifFalse: [ self error: 'Cannot convert to unit'].
	^ self class withAmount:  self convertToDefaultUnit / unit conversionFactor andUnit: aUnit! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:05:04' prior: 50354801!
       convertTo: aUnit
	
	(self canConvert: aUnit) ifFalse: [ self error: 'Cannot convert to unit'].
	^ self class withAmount:  self convertToDefaultUnit / (aUnit applyConversionMethodTo: self convertToDefaultUnit) andUnit: aUnit! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:05:19' prior: 50354810!
  convertTo: aUnit
	
	(self canConvert: aUnit) ifFalse: [ self error: 'Cannot convert to unit'].
	^ self class withAmount:  (aUnit applyConversionMethodTo: self convertToDefaultUnit) andUnit: aUnit! !

"E" MeasureTest debug: #test30TheDifferenceOfTwoMeasuresWithDifferentTypeIsNotEqualsToASumOfMeasuresWithSameType!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:06:30'!
                           convertToDefaultUnit
	self shouldBeImplemented! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:06:51' prior: 50354833!
                   convertToDefaultUnit
	^ self applyConversionMethodTo: amount! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:07:00'!
                     applyConversionMethodTo: aSmallInteger 
	self shouldBeImplemented! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:07:27' prior: 50354843!
applyConversionMethodTo: aMeasure
	^ true! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:07:30' prior: 50354838!
                        convertToDefaultUnit
	^ self applyConversionMethodTo: self! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:07:52' prior: 50354853!
       convertToDefaultUnit
	^ self applyConversionMethodTo: amount! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:07:59' prior: 50354848!
     applyConversionMethodTo: aNumber
	^ true! !

!classDefinition: #Measure category: #'Distance-Solution'!
Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit conversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:08:12' prior: 50354863!
                           applyConversionMethodTo: aNumber
	^ conversionMethod! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:08:18' prior: 50354875!
             applyConversionMethodTo: aNumber
	^ conversionMethod value: aNumber! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:09:21' prior: 50354858!
                              convertToDefaultUnit
	^ self unit applyConversionMethodTo: amount! !

!classDefinition: #MeasureUnit category: #'Distance-Solution'!
Object subclass: #MeasureUnit
	instanceVariableNames: 'name conversionFactor defaultName category conversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:09:45'!
          applyConversionMethodTo: aNumber

	^ conversionMethod value: aNumber! !

Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Measure category: #'Distance-Solution'!
Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

Measure removeSelector: #applyConversionMethodTo:!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:10:46' prior: 50354886!
          convertToDefaultUnit
	^ self class new initializeWith: (unit applyConversionMethodTo: amount) and: unit! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:11:33' prior: 50354917!
                          convertToDefaultUnit
	^ self class new initializeWith: (unit applyConversionMethodTo: amount) and: (MeasureUnit withName: ''  andConversionFactor: 1 andDefaultName: '' andCategory: '')! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:11:34' prior: 50354924!
         convertToDefaultUnit
	^ self class new initializeWith: (unit applyConversionMethodTo: amount) and: (MeasureUnit withName: '' andConversionFactor: 1 andDefaultName: '' andCategory: '')! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:12:11' prior: 50354933!
          convertToDefaultUnit
	^ self class new initializeWith: (unit applyConversionMethodTo: amount) and: (MeasureUnit withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category)! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:12:45' prior: 50354717!
   + aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (self convertToDefaultUnit amount) + (aMeasure convertToDefaultUnit amount) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:12:53' prior: 50354744!
                               - aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (self convertToDefaultUnit amount) - (aMeasure amount * aMeasure convertToDefaultUnit) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:13:03' prior: 50354966!
                    - aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (self convertToDefaultUnit amount) - (aMeasure convertToDefaultUnit amount) andUnit: (unit class withName: unit defaultName andConversionFactor: 1 andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:13:23' prior: 50354777!
                               < aMeasure

	^ self convertToDefaultUnit amount < aMeasure convertToDefaultUnit amount! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:13:34' prior: 50354820!
           convertTo: aUnit
	
	(self canConvert: aUnit) ifFalse: [ self error: 'Cannot convert to unit'].
	^ self class withAmount:  (aUnit applyConversionMethodTo: self convertToDefaultUnit amount) andUnit: aUnit! !

----SNAPSHOT----#(4 June 2017 2:13:55.894189 pm) Cuis5.0-3081-spur-64.image priorSource: 704169!
!MeasureUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:14:12'!
                           withName: aName andConversionMethod: aConversionMethod andDefaultName: aDefaultName andCategory: aCategory
	^ self new withName: aName andConversionFactor: aConversionMethod andDefaultName: aDefaultName andCategory: aCategory ! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:14:54' prior: 50353782!
                        centimeter

	^ MeasureUnit withName: 'centimeter' andConversionMethod: [:distanceAmount | distanceAmount/100] andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:14:58' prior: 50355024!
                             centimeter

	^ MeasureUnit withName: 'centimeter' andConversionMethod: [:distanceAmount | distanceAmount / 100] andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:15:16' prior: 50355033!
                           centimeter

	^ MeasureUnit withName: 'centimeter' andConversionMethod: [:distanceAmount | distanceAmount * 100] andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:15:39' prior: 50355042!
                           centimeter

	^ MeasureUnit withName: 'centimeter' andConversionMethod: [:distanceAmount | distanceAmount / 100] andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:16:32' prior: 50353790!
                           decameter
	
	^ MeasureUnit withName: 'decameter' andConversionMethod: [:distanceAmount | distanceAmount / 10] andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:17:14' prior: 50355060!
                             decameter
	
	^ MeasureUnit withName: 'decameter' andConversionMethod: [:distanceAmount | distanceAmount * 10] andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:17:30' prior: 50355069!
                             decameter
	
	^ MeasureUnit withName: 'decameter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 10] andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:17:35' prior: 50355051!
         centimeter

	^ MeasureUnit withName: 'centimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 100] andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:17:46' prior: 50353797!
       decimeter
	
	^ MeasureUnit withName: 'decimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 10] andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:17:56' prior: 50353804!
         hectometer
	
	^ MeasureUnit withName: 'hectometer' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 100]andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:17:58' prior: 50355105!
       hectometer
	
	^ MeasureUnit withName: 'hectometer' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 100] andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:18:08' prior: 50353812!
      kilometer
	
	^ MeasureUnit withName: 'kilometer' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1000] andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:18:17' prior: 50353819!
       meter

	^ MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]andDefaultName: 'meter' andCategory: 'distance'! !
!CatedraDistanceTest methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:18:27' prior: 50353826!
                    millimeter
	
	^ MeasureUnit withName: 'millimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 1000] andDefaultName: 'meter' andCategory: 'distance'! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:18:48' prior: 50354952!
            + aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (self convertToDefaultUnit amount) + (aMeasure convertToDefaultUnit amount) andUnit: (unit class withName: unit defaultName andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:20:33' prior: 50354980!
      - aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class withAmount: (self convertToDefaultUnit amount) - (aMeasure convertToDefaultUnit amount) andUnit: (unit class withName: unit defaultName andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andDefaultName: unit defaultName andCategory: unit category).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:20:40' prior: 50354942!
      convertToDefaultUnit
	^ self class new initializeWith: (unit applyConversionMethodTo: amount) and: (MeasureUnit withName: unit defaultName andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andDefaultName: unit defaultName andCategory: unit category)! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:20:47' prior: 50353867!
          negated

	^ self class withAmount: amount negated andUnit: (unit class withName: unit defaultName andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andDefaultName: unit defaultName andCategory: unit category).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/4/2017 14:21:05' prior: 50354312!
                            setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andDefaultName: 'meter' andCategory: 'distance'! !
!MeasureUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:21:51' prior: 50353769!
        withName: aName andConversionFactor: aConversionFactor andDefaultName: aDefaultName andCategory: aCategory
	^ self new withName: aName andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andDefaultName: aDefaultName andCategory: aCategory ! !
!MeasureUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:21:56' prior: 50355013!
            withName: aName andConversionMethod: aConversionMethod andDefaultName: aDefaultName andCategory: aCategory
	^ self new withName: aName andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andDefaultName: aDefaultName andCategory: aCategory ! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:22:21' prior: 50354620!
                        celsius
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'celsius' andConversionMethod: [:temperature | temperature + 273.15] andDefaultName: 'kelvin' andCategory: 'temperature')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:23:30' prior: 50353876!
      centimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'centimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 100] andDefaultName: 'meter' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:23:57' prior: 50353948!
            dolars
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'dolar' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andDefaultName: 'dolar' andCategory: 'dolar')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:24:11' prior: 50355268!
                           dolars
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'dolar' andConversionMethod: [:dolarAmountInThisUnit | dolarAmountInThisUnit * 1] andDefaultName: 'dolar' andCategory: 'dolar')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:24:26' prior: 50355249!
 celsius
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'celsius' andConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit + 273.15] andDefaultName: 'kelvin' andCategory: 'temperature')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:25:01' prior: 50354642!
    fahrenheit
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'fahrenheit' andConversionMethod: [:temperatureAmountInThisUnit | (temperatureAmountInThisUnit + 459.67) * (5/9)] andDefaultName: 'kelvin' andCategory: 'temperature')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:26:13' prior: 50353900!
                      grams
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'gram' andConversionMethod: [:weightAmountInThisUnit | weightAmountInThisUnit * 1] andDefaultName: 'gram' andCategory: 'weight').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:26:46' prior: 50353908!
kilograms
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilogram' andConversionMethod: [:weightAmountInThisUnit | weightAmountInThisUnit * 1000]andDefaultName: 'gram' andCategory: 'weight').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:26:48' prior: 50355317!
                      kilograms
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilogram' andConversionMethod: [:weightAmountInThisUnit | weightAmountInThisUnit * 1000] andDefaultName: 'gram' andCategory: 'weight').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:27:10' prior: 50353916!
                     kilometers
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilometer' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 1000] andDefaultName: 'meter' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:27:26' prior: 50353924!
             meters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andDefaultName: 'meter' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:27:46' prior: 50353932!
                       millimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'millimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 1000]  andDefaultName: 'meter' andCategory: 'distance').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 14:28:27' prior: 50353956!
         pesos
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andDefaultName: 'peso' andCategory: 'peso')! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:29:20' prior: 50353964!
                           centimeter
	
	^ MeasureUnit withName: 'centimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 100]  andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:30:00' prior: 50353972!
    decameter
	
	^ MeasureUnit withName: 'decameter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 10]  andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:30:07' prior: 50353979!
       decimeter
	
	^ MeasureUnit withName: 'decimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 10]  andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:30:16' prior: 50353987!
       hectometer
	
	^ MeasureUnit withName: 'hectometer' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 100]  andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:30:25' prior: 50353995!
    kilometer
	
	^ MeasureUnit withName: 'kilometer' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1000] andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:30:43' prior: 50354003!
      meter

	^ MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andDefaultName: 'meter' andCategory: 'distance'! !
!TestWhenClassPerUnit methodsFor: 'distance units' stamp: 'GDS 6/4/2017 14:30:50' prior: 50354018!
                 millimeter
	
	^ MeasureUnit withName: 'millimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 1000]  andDefaultName: 'meter' andCategory: 'distance'! !

MeasureUnit class removeSelector: #withName:andConversionFactor:andDefaultName:andCategory:!

"E" MeasureTest debug: #test31NothingIsSameToNothing!
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:32:38'!
  withName: aName andConversionMethod: aConversionMethod andDefaultName: aDefaultName andCategory: aCategory
	name := aName.
	conversionMethod := aConversionMethod.
	defaultName := aDefaultName.
	category  := aCategory.! !

Object subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName category conversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #MeasureUnit category: #'Distance-Solution'!
Object subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName category conversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

MeasureUnit removeSelector: #withName:andConversionFactor:andDefaultName:andCategory:!

"E" MeasureTest debug: #test31NothingIsSameToNothing!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:34:54' prior: 50355180!
                      convertToDefaultUnit

	^ self class new initializeWithAmount: (unit applyConversionMethodTo: amount) andUnit: (MeasureUnit withName: unit defaultName andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andDefaultName: unit defaultName andCategory: unit category)! !

"F" MeasureTest debug: #test05AMeterEqualsToHundredCentimeters!

"F" MeasureTest debug: #test05AMeterEqualsToHundredCentimeters!

(aMeasure isKindOf: self class)!

(unit category = aMeasure unit category)!

(self canConvert: aUnit)!

aUnit applyConversionMethodTo: self convertToDefaultUnit amount!

self convertToDefaultUnit!

hundredCentimeters!

amount = (aMeasure convertTo: unit) amount!

self convertToDefaultUnit !
!MeasureUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:44:02' prior: 50355237!
              withName: aName andConversionMethod: aConversionMethod andDefaultName: aDefaultName andCategory: aCategory
	^ self new withName: aName andConversionMethod: aConversionMethod andDefaultName: aDefaultName andCategory: aCategory ! !

"F" MeasureTest debug: #test07TwoHundredCentimetersEqualsToTwoMeters!

self convertToDefaultUnit!

MeasureTest class!

"F" MeasureTest debug: #test07TwoHundredCentimetersEqualsToTwoMeters!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 14:47:41'!
                         test32
	
	self assert: -273.15 celsius = -459.67 fahrenheit.! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 14:48:00' prior: 50354611!
             test31NothingIsSameToNothing
	
	self assert: 0 pesos = 0 meters.! !

----SNAPSHOT----#(4 June 2017 2:59:25.084796 pm) Cuis5.0-3081-spur-64.image priorSource: 747469!

"F" MeasureTest debug: #test07TwoHundredCentimetersEqualsToTwoMeters!

(aMeasure convertTo: unit) amount!

self convertToDefaultUnit amount!

unit applyConversionMethodTo: amount!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 15:09:33' prior: 50355472!
          convertToDefaultUnit

	^ self class new initializeWithAmount: (unit applyConversionMethodTo: amount) andUnit: (MeasureUnit withName: unit defaultName andConversionMethod: unit conversionMethod andDefaultName: unit defaultName andCategory: unit category)! !
!MeasureUnit methodsFor: 'accessing' stamp: 'GDS 6/4/2017 15:09:53'!
                          conversionMethod
	
		^ conversionMethod! !

MeasureUnit removeSelector: #conversionFactor!
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 15:10:12' prior: 50352474!
      = aWeightUnit 

	^ (aWeightUnit isKindOf: self class) and: [name = aWeightUnit name and: [ conversionMethod = aWeightUnit conversionMethod ]].! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 15:10:52' prior: 50355550!
               = aWeightUnit 

	^ (aWeightUnit isKindOf: self class) and: [name = aWeightUnit name and: [ category = aWeightUnit category ]].! !

"F" MeasureTest debug: #test32!

self convertToDefaultUnit amount!

----SNAPSHOT----#(4 June 2017 3:23:52.038547 pm) Cuis5.0-3081-spur-64.image priorSource: 763939!

Number!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:25:47' prior: 50355287!
                      celsius
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'celsius' andConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit - 273.15] andDefaultName: 'kelvin' andCategory: 'temperature')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:25:52' prior: 50355258!
    centimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'centimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 100] andDefaultName: 'meter' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:25:59' prior: 50355297!
            fahrenheit
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'fahrenheit' andConversionMethod: [:temperatureAmountInThisUnit | (temperatureAmountInThisUnit - 459.67) * (5/9)] andDefaultName: 'kelvin' andCategory: 'temperature')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:26:05' prior: 50355327!
                      kilograms
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilogram' andConversionMethod: [:weightAmountInThisUnit | weightAmountInThisUnit / 1000] andDefaultName: 'gram' andCategory: 'weight').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:26:10' prior: 50355337!
                     kilometers
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilometer' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1000] andDefaultName: 'meter' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:26:15' prior: 50355357!
             millimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'millimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1000]  andDefaultName: 'meter' andCategory: 'distance').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:26:19' prior: 50355367!
         pesos
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit / 1] andDefaultName: 'peso' andCategory: 'peso')! !

TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'
	
	Number!

"F" MeasureTest debug: #test05AMeterEqualsToHundredCentimeters!
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:27:28' prior: 50355632!
          pesos
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andDefaultName: 'peso' andCategory: 'peso')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:27:35' prior: 50355622!
     millimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'millimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 1000]  andDefaultName: 'meter' andCategory: 'distance').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:27:42' prior: 50355612!
         kilometers
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilometer' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 1000] andDefaultName: 'meter' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:27:45' prior: 50355673!
             kilometers
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilometer' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1000] andDefaultName: 'meter' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:28:13' prior: 50355571!
             celsius
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'celsius' andConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit + 273.15] andDefaultName: 'kelvin' andCategory: 'temperature')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:28:59' prior: 50355663!
    millimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'millimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1000]  andDefaultName: 'meter' andCategory: 'distance').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:29:31' prior: 50355703!
         millimeters
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'millimeter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 1000]  andDefaultName: 'meter' andCategory: 'distance').! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:29:52' prior: 50355683!
         kilometers
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'kilometer' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 1000] andDefaultName: 'meter' andCategory: 'distance')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:30:17' prior: 50355693!
             celsius
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'celsius' andConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit - 273.15] andDefaultName: 'kelvin' andCategory: 'temperature')! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/4/2017 15:31:17' prior: 50355591!
    fahrenheit
	^ Measure withAmount: self andUnit: (MeasureUnit withName: 'fahrenheit' andConversionMethod: [:temperatureAmountInThisUnit | (temperatureAmountInThisUnit + 459.67) * (5/9)] andDefaultName: 'kelvin' andCategory: 'temperature')! !

----SNAPSHOT----#(4 June 2017 3:31:52.844843 pm) Cuis5.0-3081-spur-64.image priorSource: 765317!

----SNAPSHOT----#(4 June 2017 3:35:48.957798 pm) Cuis5.0-3081-spur-64.image priorSource: 771280!

----SNAPSHOT----#(4 June 2017 3:59:08.257709 pm) Cuis5.0-3081-spur-64.image priorSource: 771378!

----SNAPSHOT----#(4 June 2017 4:16:12.517983 pm) Cuis5.0-3081-spur-64.image priorSource: 771476!

----QUIT----#(4 June 2017 4:16:21.266581 pm) Cuis5.0-3081-spur-64.image priorSource: 771574!

----STARTUP----#(5 June 2017 7:42:43.327778 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!


'From Cuis 5.0 of 7 November 2016 [latest update: #3086] on 4 June 2017 at 9:11:57 pm'!

'Description Please enter a description for this package'!

Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Measure category: #'Distance-Solution'!
Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

Measure class
	instanceVariableNames: ''!

!classDefinition: 'Measure class' category: #'Distance-Solution'!
Measure class
	instanceVariableNames: ''!

TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #MeasureTest category: #'Distance-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

MeasureTest class
	instanceVariableNames: ''!

!classDefinition: 'MeasureTest class' category: #'Distance-Solution'!
MeasureTest class
	instanceVariableNames: ''!

Object subclass: #DistanceFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #DistanceFactory category: #'Distance-Solution'!
Object subclass: #DistanceFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

DistanceFactory class
	instanceVariableNames: ''!

!classDefinition: 'DistanceFactory class' category: #'Distance-Solution'!
DistanceFactory class
	instanceVariableNames: ''!

Object subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName category amountThatRepresentsNothing conversionMethod inverseConversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #MeasureUnit category: #'Distance-Solution'!
Object subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName category amountThatRepresentsNothing conversionMethod inverseConversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

MeasureUnit class
	instanceVariableNames: ''!

!classDefinition: 'MeasureUnit class' category: #'Distance-Solution'!
MeasureUnit class
	instanceVariableNames: ''!

Object subclass: #XXX
	instanceVariableNames: 'firstMeasure secondMeasure'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #XXX category: #'Distance-Solution'!
Object subclass: #XXX
	instanceVariableNames: 'firstMeasure secondMeasure'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

XXX class
	instanceVariableNames: ''!

!classDefinition: 'XXX class' category: #'Distance-Solution'!
XXX class
	instanceVariableNames: ''!
!Number methodsFor: '*Distance-Solution' stamp: 'TVC 6/4/2017 20:52:53' prior: 50355733!
         celsius
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'celsius' 
				andConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit + 273.15] 
				andInverseConversionMethod: [:temperatureAmountInDefaultUnit | temperatureAmountInDefaultUnit - 273.15] 
				andAmountValueThatRepresentsNothing: -273.15
				andDefaultName: 'kelvin' 
				andCategory: 'temperature'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'TVC 6/4/2017 20:52:42' prior: 50355581!
   centimeters
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'centimeter' 
				andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 100] 
				andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 100] 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				andCategory: 'distance'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'TVC 6/4/2017 20:53:31' prior: 50355278!
                          dolars
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'dolar' 
				andConversionMethod: [:dolarAmountInThisUnit | dolarAmountInThisUnit * 1] 
				andInverseConversionMethod: [:dolarAmountInDefaultUnit | dolarAmountInDefaultUnit / 1] 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'dolar' 
				andCategory: 'dolar'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'TVC 6/4/2017 20:54:15' prior: 50355743!
                       fahrenheit
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'fahrenheit' 
				andConversionMethod: [:temperatureAmountInThisUnit | (temperatureAmountInThisUnit + 459.67) * (5/9)]
				andInverseConversionMethod: [:temperatureAmountInDefaultUnit | (temperatureAmountInDefaultUnit * (9/5)) - 459.67] 
				andAmountValueThatRepresentsNothing: -459.67
				andDefaultName: 'kelvin' 
				andCategory: 'temperature'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'TVC 6/4/2017 20:54:56' prior: 50355308!
            grams
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'gram' 
				andConversionMethod: [:weightAmountInThisUnit | weightAmountInThisUnit * 1] 
				andInverseConversionMethod: [:weightAmountInDefaultUnit | weightAmountInDefaultUnit / 1] 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'gram' 
				andCategory: 'weight'
				).! !
!Number methodsFor: '*Distance-Solution' stamp: 'TVC 6/4/2017 20:55:40'!
    kelvin

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'kelvin' 
				andConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit] 
				andInverseConversionMethod: [:temperatureAmountInDefaultUnit | temperatureAmountInDefaultUnit] 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'kelvin' 
				andCategory: 'temperature'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'TVC 6/4/2017 20:56:25' prior: 50355602!
                            kilograms
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'kilogram' 
				andConversionMethod: [:weightAmountInThisUnit | weightAmountInThisUnit * 1000] 
				andInverseConversionMethod: [:weightAmountInDefaultUnit | weightAmountInDefaultUnit / 1000] 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'gram' 
				andCategory: 'weight'
				).! !
!Number methodsFor: '*Distance-Solution' stamp: 'TVC 6/4/2017 20:57:11' prior: 50355723!
      kilometers
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'kilometer' 
				andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1000] 
				andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1000] 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				andCategory: 'distance'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'TVC 6/4/2017 20:58:19' prior: 50355347!
                          meters
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'meter' 
				andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  
				andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				andCategory: 'distance'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'TVC 6/4/2017 20:58:45' prior: 50355713!
       millimeters
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'millimeter' 
				andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 1000]  
				andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 1000] 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				andCategory: 'distance'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'TVC 6/4/2017 20:59:08' prior: 50355654!
                       pesos
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'peso' 
				andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] 
				andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit * 1] 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'peso' 
				andCategory: 'peso')! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:32:59' prior: 50352763!
                              * anAmount 
	^ self class withAmount: amount * anAmount andUnit: unit.! !
!Measure methodsFor: 'as yet unclassified' stamp: 'TVC 6/4/2017 20:46:20' prior: 50355150!
                           + aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class 
		withAmount: (self convertToDefaultUnit amount) + (aMeasure convertToDefaultUnit amount) 
		andUnit: (
			unit class withName: unit defaultName 
			andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] 
			andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] 
			andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing 
			andDefaultName: unit defaultName 
			andCategory: unit category
			).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'TVC 6/4/2017 20:46:46' prior: 50355165!
 - aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ XXX with: self andOther: aMeasure ] .
	^ self class 
		withAmount: (self convertToDefaultUnit amount) - (aMeasure convertToDefaultUnit amount) 
		andUnit: (
			unit class withName: unit defaultName 
			andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] 
			andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] 
			andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing 
			andDefaultName: unit defaultName 
			andCategory: unit category
			).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:35:12' prior: 50352796!
 / aNumber 
	^ self class withAmount: amount / aNumber andUnit: unit.! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:13:23' prior: 50354994!
                             < aMeasure

	^ self convertToDefaultUnit amount < aMeasure convertToDefaultUnit amount! !
!Measure methodsFor: 'as yet unclassified' stamp: 'TVC 6/4/2017 20:38:00' prior: 50354596!
           = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [(unit category = aMeasure unit category) and: [amount = (aMeasure convertTo: unit) amount]]
	].! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:35:44' prior: 50352801!
                         adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self class withAmount: aSmallInteger * amount andUnit: unit.! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:36:43' prior: 50352817!
                   amount
	^ amount! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:54:19' prior: 50354113!
                 canAdd: aMeasure 
	^ unit category = aMeasure unit category! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:20:53' prior: 50354369!
      canConvert: aMeasureUnit 
	^ unit category = aMeasureUnit category! !
!Measure methodsFor: 'as yet unclassified' stamp: 'TVC 6/4/2017 19:05:42' prior: 50355000!
                               convertTo: aUnit
	
	(self canConvert: aUnit) ifFalse: [ self error: 'Cannot convert to unit'].
	^ self class withAmount:  (aUnit applyInverseConversionMethodTo: self convertToDefaultUnit amount) andUnit: aUnit! !
!Measure methodsFor: 'as yet unclassified' stamp: 'TVC 6/4/2017 20:48:40' prior: 50355533!
                convertToDefaultUnit

	^ self class new 
		initializeWithAmount: (unit applyConversionMethodTo: amount) 
		andUnit: (
			MeasureUnit 
				withName: unit defaultName 
				andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] 
				andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] 
				andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing
				andDefaultName: unit defaultName 
				andCategory: unit category
			)! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:43:50' prior: 50352891!
                 hash

	^ unit name hash + amount hash ! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:38:58' prior: 50352851!
                           initializeWithAmount: anAmount andUnit: aWeightUnit 
	amount := anAmount .
	unit := aWeightUnit .! !
!Measure methodsFor: 'as yet unclassified' stamp: 'TVC 6/4/2017 20:39:32'!
                isNothing

	^ amount = unit amountThatRepresentsNothing! !
!Measure methodsFor: 'as yet unclassified' stamp: 'TVC 6/4/2017 19:26:01' prior: 50355192!
          negated

	^ self class withAmount: amount negated andUnit: unit.! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:48:32' prior: 50352922!
 printOn: aStream 
	| amountAsString unitAsString |
	
	amountAsString := amount printString.
	unitAsString := unit printString.
	
	(amount > 1) ifTrue: [ unitAsString := unitAsString , 's' ].
	
	aStream nextPutAll: ' amount ', amountAsString.
	aStream nextPutAll: ' unit ', unitAsString.
	^ aStream ! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:47:03' prior: 50352906!
                       printString

	| amountAsString unitAsString |
	
	amountAsString := amount printString.
	unitAsString := unit printString.
	
	(amount > 1) ifTrue: [ unitAsString := unitAsString , 's' ].
	
	^ amountAsString , ' ' , unitAsString ! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:36:07' prior: 50352807!
                              unit
	^ unit! !
!Measure class methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 11:32:23' prior: 50352757!
               withAmount: anAmount andUnit: aDistanceUnit 

	^ self new initializeWithAmount: anAmount andUnit: aDistanceUnit! !
!MeasureTest methodsFor: 'setup' stamp: 'TVC 6/4/2017 20:49:03' prior: 50355203!
                            setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/23/2017 19:54:21' prior: 50346079!
                     test01MeterIsEqualToHimself

	self assert: aMeter = aMeter! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 20:38:04' prior: 50346886!
              test02DifferentTwoMetersObjectAreEqual

	| anotherTwoMeters|
	anotherTwoMeters := 2 meters.
	self assert: twoMeters = anotherTwoMeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/23/2017 19:55:02' prior: 50346092!
  test03AMeterPlusAMeterEqualsTwoMeters

	self assert: (aMeter + aMeter) = twoMeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/23/2017 20:01:29' prior: 50346106!
                      test05AMeterEqualsToHundredCentimeters

	self assert: aMeter = hundredCentimeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/23/2017 19:58:16' prior: 50346112!
                       test06TwoMetersEqualsToTwoHundredCentimeters

	self assert: twoMeters = twoHundredCentimeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/23/2017 19:58:18' prior: 50346118!
           test07TwoHundredCentimetersEqualsToTwoMeters

	self assert: twoHundredCentimeters = twoMeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/23/2017 20:01:54' prior: 50346124!
           test08AHundredCentimetersIsDifferentToTwoMeters

	self deny: hundredCentimeters = twoMeters ! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/23/2017 20:20:16' prior: 50346130!
            test09HundredCentimetersEqualsToThousandMillimeters

	self assert: hundredCentimeters = thousandMillimeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/23/2017 20:20:30' prior: 50346136!
                             test10ThousandMillimetersEqualsToHundredCentimeters

	self assert: thousandMillimeters =  hundredCentimeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 20:38:33' prior: 50346902!
                            test11ThousandMillimetersEqualsToFiftyCentimetersPlusFiftyCentimeters
	
	| fiftyCentimeters |
	fiftyCentimeters := 50 centimeters.
	self assert: thousandMillimeters =  (fiftyCentimeters + fiftyCentimeters)! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 20:38:45' prior: 50346912!
                           test12ThousandMillimetersPlusThousandMillimetersEqualsTwoThousandMillimeters
	
	| twoThousandMillimeters |
	
	twoThousandMillimeters := 2000 millimeters.
	self assert: (thousandMillimeters + thousandMillimeters) = twoThousandMillimeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 20:18:09' prior: 50346570!
                            test13TwoMetersMinusHundredCentimetersEqualsAThousandMillimeters
	
	self assert:  (twoMeters - hundredCentimeters) = thousandMillimeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 20:18:28' prior: 50346578!
test14AMeterTimesTwoEqualsTwoMeters
	
	self assert:  aMeter * 2 = twoMeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 20:18:42' prior: 50346584!
                             test15TwoTimesAMeterEqualsTwoMeters
	
	self assert:  2 * aMeter = twoMeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 20:18:55' prior: 50346590!
                             test16AMeterDividedByTwoEqualsHalfAMeter
	
	self assert: aMeter / 2 = halfAMeter! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 20:28:27' prior: 50346772!
                        test17TenKilometersIsGreaterThanAMeter
	
	self assert: tenKilometers > aMeter! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 20:28:45' prior: 50346778!
                           test18AMeterIsLesserThanTwoMeters
	
	self assert: aMeter < twoMeters! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 20:28:59' prior: 50346784!
    test19TenKilometersIsGreaterOrEqualThanAMeter
	
	self assert: tenKilometers >= aMeter ! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 5/25/2017 20:29:16' prior: 50346791!
                  test20AMeterIsLowerOrEqualThanTwoMeters
	
	self assert: aMeter <= twoMeters ! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:28:22' prior: 50354458!
                             test21TheSumOfTwoMeasuresThatCanBeAddedWorks
	
	self assert: (aKilogram + hundredGrams) = oneThousandOneHundredGrams ! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:28:17' prior: 50354451!
                    test22TheSumOfSameMeasureWorks
	
	self assert: (aKilogram + aKilogram) = twoKilograms! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:28:58' prior: 50354467!
                    test23TheDifferenceBetweenSameMeasureWorks
	
	self assert: (aKilogram - aKilogram) = zeroKilograms! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:29:23' prior: 50354474!
       test24TheMultiplicationOfAMeasureWithAScalarWorks
	
	self assert: aKilogram * 2 = twoKilograms.! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:39:24' prior: 50354536!
          test25TheMultiplicationOfAScalarWithAMeasureIsCommutative	

	self assert: 2 * aKilogram = twoKilograms.
	self assert: aKilogram * 2 = twoKilograms.! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:29:53' prior: 50354488!
                      test26DividingAMeasureByAScalarWorks
	
	self assert: twoKilograms / 2 = aKilogram .! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:36:15' prior: 50354516!
                      test27TheSumOfTwoMeasuresWithDifferentTypeIsNotEqualsToASumOfMeasuresWithSameType
	
	self deny: 10 pesos + 50 dolars = (10 pesos + 50 pesos).! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:37:38' prior: 50354527!
                            test28TheSumOfTwoMeasuresWithDifferentIsCommutative
	
	self assert: 10 pesos + 50 dolars = (50 dolars + 10 pesos).
	self assert: 50 dolars + 10 pesos  = (50 dolars + 10 pesos).! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:40:37' prior: 50354569!
                         test29CannotConvertAMeasureToAUnitThatHasDifferentType

	self should: [tenPesos convertTo: meterUnit ] raise: (Error - MessageNotUnderstood) description: 'Cannot convert to unit'.! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/4/2017 13:41:19' prior: 50354582!
                      test30TheDifferenceOfTwoMeasuresWithDifferentTypeIsNotEqualsToASumOfMeasuresWithSameType
	
	self deny: 10 pesos - 50 dolars = (10 pesos - 50 pesos).! !
!MeasureTest methodsFor: 'Testing' stamp: 'TVC 6/4/2017 19:58:11'!
     test31NothingIsEqualToNothing
	
	self assert: 0 pesos = 0 meters.! !
!MeasureTest methodsFor: 'Testing' stamp: 'TVC 6/4/2017 20:20:10'!
                        test32MeasuresCanRepresentNothingWithOtherValueThan0
	
	self deny: 0 celsius = 0 fahrenheit.! !
!MeasureTest methodsFor: 'Testing' stamp: 'TVC 6/4/2017 21:05:15'!
                             test33NothingForTemperaturesIsRepresentedByItsCorrectPhysicsEstimatedValue
	
	self assert: 0 kelvin = -273.15 celsius.
	self assert: 0 kelvin = -459.67 fahrenheit.! !
!DistanceFactory methodsFor: 'instances-creation' stamp: 'GDS 5/29/2017 19:58:02' prior: 50347585!
                      minusOneMeter
	^ -1 meters! !
!DistanceFactory methodsFor: 'instances-creation' stamp: 'GDS 5/29/2017 19:58:17' prior: 50347589!
                               oneCentimeter
	^ 1 centimeters.! !
!DistanceFactory methodsFor: 'instances-creation' stamp: 'GDS 5/29/2017 19:58:30' prior: 50347593!
                          oneHundredCentimeters
	^ 100 centimeters.! !
!DistanceFactory methodsFor: 'instances-creation' stamp: 'GDS 5/29/2017 19:58:43' prior: 50347598!
                oneMeter
	^ 1 meters.! !
!DistanceFactory methodsFor: 'instances-creation' stamp: 'GDS 5/29/2017 19:58:56' prior: 50347602!
    twoHundredCentimeters
	^ 200 centimeters.! !
!DistanceFactory methodsFor: 'instances-creation' stamp: 'GDS 5/29/2017 19:59:08' prior: 50347607!
                twoMeters
	^ 2 meters.! !
!DistanceFactory methodsFor: 'instances-creation' stamp: 'GDS 5/29/2017 19:59:17' prior: 50347611!
   zeroMeters
	^ 0 meters.! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 15:10:52' prior: 50355558!
      = aWeightUnit 

	^ (aWeightUnit isKindOf: self class) and: [name = aWeightUnit name and: [ category = aWeightUnit category ]].! !
!MeasureUnit methodsFor: 'accessing' stamp: 'TVC 6/4/2017 20:43:25'!
                         amountThatRepresentsNothing

	^ amountThatRepresentsNothing ! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 14:09:45' prior: 50354899!
 applyConversionMethodTo: aNumber

	^ conversionMethod value: aNumber! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'TVC 6/4/2017 19:12:23'!
         applyInverseConversionMethodTo: aNumber 
	
	^ inverseConversionMethod value: aNumber! !
!MeasureUnit methodsFor: 'accessing' stamp: 'GDS 6/4/2017 12:46:44' prior: 50354051!
                   category
	^ category ! !
!MeasureUnit methodsFor: 'accessing' stamp: 'GDS 6/4/2017 15:09:53' prior: 50355544!
                  conversionMethod
	
		^ conversionMethod! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:08:12' prior: 50353475!
                      defaultName
	
		^ defaultName ! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:08:22' prior: 50353479!
                               name
	
		^ name! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'TVC 6/4/2017 21:00:08'!
                              withName: aName andConversionMethod: aConversionMethod andInverseConversionMethod: anInverseConversionMethod andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName andCategory: aCategory
	name := aName.
	conversionMethod := aConversionMethod.
	inverseConversionMethod := anInverseConversionMethod.
	amountThatRepresentsNothing := anAmount.
	defaultName := aDefaultName.
	category  := aCategory.! !
!MeasureUnit class methodsFor: 'as yet unclassified' stamp: 'TVC 6/4/2017 20:40:43'!
         withName: aName andConversionMethod: aConversionMethod andInverseConversionMethod: anInverseConversionMethod andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName andCategory: aCategory
	^ self new withName: aName andConversionMethod: aConversionMethod andInverseConversionMethod: anInverseConversionMethod andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName andCategory: aCategory ! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 13:10:26' prior: 50354240!
                           = anotherXXX

	^ (anotherXXX isKindOf: self class) and: [((firstMeasure = anotherXXX firstMeasure and: [ secondMeasure = anotherXXX secondMeasure]) or: ([firstMeasure = anotherXXX secondMeasure and: [ secondMeasure = anotherXXX firstMeasure]]))].! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:51:06' prior: 50354092!
               firstMeasure

	^ firstMeasure ! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:49:27' prior: 50354073!
       initializeWith: aMeasure and: anotherMeasure
	
	firstMeasure := aMeasure.
	secondMeasure := anotherMeasure .! !
!XXX methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:51:13' prior: 50354096!
                         secondMeasure

	^ secondMeasure ! !
!XXX class methodsFor: 'as yet unclassified' stamp: 'GDS 6/4/2017 12:48:33' prior: 50354055!
                               with: aMeasure andOther: anotherMeasure
	
	^ self new initializeWith: aMeasure and: anotherMeasure ! !

----End fileIn of /home/sherman1000/Desktop/Facu/POO/POO-2017/05-Measure/Distance-Solution.pck.st----!

MeasureUnit class removeSelector: #withName:andConversionMethod:andDefaultName:andCategory:!

MeasureTest removeSelector: #test31NothingIsSameToNothing!

MeasureTest removeSelector: #test32!

MeasureUnit removeSelector: #withName:andConversionMethod:andDefaultName:andCategory:!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 19:59:44'!
                      test34
	
	self assert: 10* 1= 10 meters.
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:00:06' prior: 50356617!
test34
	
	self assert: 10 * meterUnit = 10 meters.
! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/5/2017 20:02:44'!
                          adaptToNumber: aSmallInteger andSend: aSymbol 
	self shouldBeImplemented! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/5/2017 20:03:08' prior: 50356626!
                     adaptToNumber: aSmallInteger andSend: aSymbol 
	^ aSmallInteger meters! !

!classDefinition: #MeasureTest category: #'Distance-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit pesosUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:03:34'!
                          test35
	
	self assert: 10 * pesosUnit = 10 meters.
! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/5/2017 20:05:17' prior: 50356223!
                        setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'pesos'! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/5/2017 20:06:05' prior: 50356655!
                        setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:06:24' prior: 50356650!
                       test35
	
	self assert: 10 * pesosUnit = 10 pesos.
! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/5/2017 20:11:08' prior: 50356632!
           adaptToNumber: aSmallInteger andSend: aSymbol 
	^ Measure withAmount: aSmallInteger andUnit: self! !

!classDefinition: #MeasureTest category: #'Distance-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit pesosUnit secondUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:12:37'!
                    test36
	
	self assert: 10 * meterUnit/secondUnit = 10 pesos.
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:12:50' prior: 50356749!
            test36
	
	self assert: 10 * meterUnit/secondUnit = 10 pesos.
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:13:05'!
                            test34CanMultiplyANumberWithAUnit
	
	self assert: 10 * meterUnit = 10 meters.
! !

MeasureTest removeSelector: #test34!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:13:21'!
     test34CanMultiplyANumberWithAMeterUnit
	
	self assert: 10 * meterUnit = 10 meters.
! !

MeasureTest removeSelector: #test34CanMultiplyANumberWithAUnit!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:13:45'!
     test35CanMultiplyANumberWithAPesosUnit
	
	self assert: 10 * pesosUnit = 10 pesos.
! !

MeasureTest removeSelector: #test35!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:14:05' prior: 50356765!
                 test34CanMultiplyANumberWithAMeterUnit
	
	self assert: 10 * meterUnit = 10 meters.
	self assert: 10 * pesosUnit = 10 pesos.
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:14:24'!
                             test34CanCreateAMeasureByMultiplyingANumberByItsUnit 
	
	self assert: 10 * meterUnit = 10 meters.
	self assert: 10 * pesosUnit = 10 pesos.
! !

MeasureTest removeSelector: #test34CanMultiplyANumberWithAMeterUnit!

MeasureTest removeSelector: #test35CanMultiplyANumberWithAPesosUnit!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:14:32'!
  test35
	
	self assert: 10 * meterUnit/secondUnit = 10 pesos.
! !

MeasureTest removeSelector: #test36!

!classDefinition: #MeasureTest category: #'Distance-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit pesosUnit secondUnit tenMetersPerSecond'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:15:18' prior: 50356797!
               test35
	
	self assert: 10 * meterUnit/secondUnit = tenMetersPerSecond.
! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/5/2017 20:18:19' prior: 50356690!
    setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (MeasureUnit withName: 'meterPerSecond' andConversionMethod:  1andInverseConversionMethod:  1andAmountValueThatRepresentsNothing:  1andDefaultName: 1 andCategory: 1)! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/5/2017 20:20:20' prior: 50356822!
                           setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (MeasureUnit withName: 'meterPerSecond' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod:  [:velocityAmountInDefaultUnit | velocityAmountInDefaultUnit  / 1] andAmountValueThatRepresentsNothing:  0 andDefaultName: 'meterPerSecond' andCategory: 'velocity')! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/5/2017 20:20:28' prior: 50356864!
              setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (MeasureUnit withName: 'meterPerSecond' andConversionMethod: [:velocityAmountInThisUnit | velocityAmountInThisUnit * 1] andInverseConversionMethod:  [:velocityAmountInDefaultUnit | velocityAmountInDefaultUnit  / 1] andAmountValueThatRepresentsNothing:  0 andDefaultName: 'meterPerSecond' andCategory: 'velocity')! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:21:58' prior: 50356817!
      test35
	
	self assert: 10 * meterUnit/secondUnit = tenMetersPerSecond.
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:23:33' prior: 50356956!
  test35
	
	self assert: 10 * (meterUnit/secondUnit) = tenMetersPerSecond.
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/5/2017 20:25:27' prior: 50356961!
test35
	
	self assert: 10 * meterUnit/secondUnit = tenMetersPerSecond.
! !

!classDefinition: #CompoundUnit category: #'Distance-Solution'!
Object subclass: #CompoundUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/5/2017 20:29:18' prior: 50356094!
                 / aNumber 
	(aNumber isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aNumber andUnit: unit].
	^ self class withAmount: amount andUnit: (CompoundUnit withUnit: unit and: aNumber).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/5/2017 20:29:53' prior: 50356978!
                               / aDividend 
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	^ self class withAmount: amount andUnit: (CompoundUnit withUnit: unit and: aDividend).! !
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/5/2017 20:31:47'!
                            withUnit: aMeasureUnit and: anUndefinedObject 
	self shouldBeImplemented! !
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/5/2017 20:32:41' prior: 50356998!
              withUnit: aMeasureUnit and: anotherMeasureUnit 
	^ self new initializeWith: aMeasureUnit and: anotherMeasureUnit! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/5/2017 20:32:51'!
                            initializeWith: aMeasureUnit and: anUndefinedObject 
	self shouldBeImplemented! !

!classDefinition: #CompoundUnit category: #'Distance-Solution'!
Object subclass: #CompoundUnit
	instanceVariableNames: 'measureUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #CompoundUnit category: #'Distance-Solution'!
Object subclass: #CompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/5/2017 20:34:33' prior: 50357011!
                    initializeWith: aMeasureUnit and: anotherMeasureUnit 
	measureUnit := aMeasureUnit.
	secondMeasureUnit := anotherMeasureUnit! !
!CompoundUnit methodsFor: 'accessing' stamp: 'GDS 6/5/2017 20:35:11'!
                          amountThatRepresentsNothing
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'accessing' stamp: 'GDS 6/5/2017 20:35:27' prior: 50357038!
                 amountThatRepresentsNothing
	^ measureUnit amountThatRepresentsNothing! !

----SNAPSHOT----#(5 June 2017 9:03:53.246847 pm) Cuis5.0-3081-spur-64.image priorSource: 771672!

----QUIT----#(5 June 2017 9:03:56.850981 pm) Cuis5.0-3081-spur-64.image priorSource: 812713!

----STARTUP----#(6 June 2017 6:20:05.540652 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!

!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 18:29:37' prior: 50356106!
                    = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [(unit hasSameCategoryAs: aMeasure unit ) and: [amount = (aMeasure convertTo: unit) amount]]
	].! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 18:29:58'!
    hasSameCategoryAs: aMeasureUnit 
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 18:30:06' prior: 50357068!
  hasSameCategoryAs: aMeasureUnit 
	^ true! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 18:30:46' prior: 50356132!
                         canConvert: aMeasureUnit 
	^ unit hasSameCategoryAs: aMeasureUnit category! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 18:30:49' prior: 50357078!
                       canConvert: aMeasureUnit 
	^ unit hasSameCategoryAs: aMeasureUnit! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 18:30:57'!
            hasSameCategoryAs: aCompoundUnit 
	self shouldBeImplemented! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 18:31:52' prior: 50357089!
  hasSameCategoryAs: aMeasureUnit
	(aMeasureUnit isKindOf: aMeasureUnit) ifTrue: [^ category = aMeasureUnit category].! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 18:32:03' prior: 50357094!
         hasSameCategoryAs: aMeasureUnit
	(aMeasureUnit isKindOf: aMeasureUnit) ifTrue: [^ category = aMeasureUnit category].
	^ true! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 18:32:32' prior: 50357101!
 hasSameCategoryAs: aMeasureUnit
	(aMeasureUnit isKindOf: aMeasureUnit) ifTrue: [^ category = aMeasureUnit category].
	^ false! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/6/2017 18:34:34' prior: 50356910!
              setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit)! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/6/2017 18:34:48' prior: 50357115!
              setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit)! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/6/2017 18:34:52' prior: 50357153!
              setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit)! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/6/2017 18:35:10' prior: 50357200!
            setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit)! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/6/2017 18:35:17' prior: 50357247!
              setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit)! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/6/2017 18:35:28' prior: 50357294!
             setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit)! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/6/2017 18:35:37' prior: 50357341!
                    setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'peso'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit)! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/6/2017 18:35:42' prior: 50357388!
                  setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit)! !

----SNAPSHOT----#(6 June 2017 6:37:49.014865 pm) Cuis5.0-3081-spur-64.image priorSource: 812811!
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:16:48'!
                 applyConversionMethodTo: aSmallInteger 
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:17:30' prior: 50357485!
                           applyConversionMethodTo: aSmallInteger 
	^ measureUnit applyConversionMethodTo: aSmallInteger ! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:19:12'!
              defaultName
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:19:26' prior: 50357497!
                       defaultName
	^ 'This should be implemented'! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:19:49'!
 category
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:20:10' prior: 50357506!
                          category
	^ 'THIS ALSO SHOULD BE IMPLEMENTED'! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:20:42'!
                               applyInverseConversionMethodTo: aSmallInteger 
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:20:57' prior: 50357516!
                    applyInverseConversionMethodTo: aSmallInteger 
	^ measureUnit applyInverseConversionMethodTo: aSmallInteger ! !

"F" MeasureTest debug: #test01MeterIsEqualToHimself!
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:22:05' prior: 50357108!
                           hasSameCategoryAs: aMeasureUnit
	(aMeasureUnit isKindOf: MeasureUnit) ifTrue: [^ category = aMeasureUnit category].
	^ false! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:22:12' prior: 50357531!
 hasSameCategoryAs: aMeasureUnit
	(aMeasureUnit isKindOf: self class) ifTrue: [^ category = aMeasureUnit category].
	^ false! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:34:44'!
                              test36
	
	self assert: 10 * (meterUnit/secondUnit) = tenMetersPerSecond.
! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:34:58'!
    / aMeasureUnit 
	self shouldBeImplemented! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:35:55' prior: 50357550!
                    / aMeasureUnit 
	^ CompoundUnit withUnit: self and: aMeasureUnit.! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:36:25'!
           adaptToNumber: aSmallInteger andSend: aSymbol 
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:37:38' prior: 50357560!
                    adaptToNumber: aSmallInteger andSend: aSymbol 
	^ true! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:37:57' prior: 50357566!
      adaptToNumber: aSmallInteger andSend: aSymbol 
	^ Measure withAmount: aSmallInteger andUnit: self! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:38:23'!
                        test37
	
	self assert: (meterUnit/secondUnit) * 10 = tenMetersPerSecond.
! !

MeasureTest removeSelector: #test37!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:39:09' prior: 50357545!
                          test36
	

! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:39:17' prior: 50356966!
                               test35
	
	self assert: 10 * meterUnit/secondUnit = tenMetersPerSecond.
	self assert: 10 * (meterUnit/secondUnit) = tenMetersPerSecond.
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:39:35'!
                  test35DifferentWaysToCreateMeasureWithCompoundUnit
	
	self assert: 10 * meterUnit/secondUnit = tenMetersPerSecond.
	self assert: 10 * (meterUnit/secondUnit) = tenMetersPerSecond.
! !

MeasureTest removeSelector: #test35!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:40:03'!
test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual
	
	self assert: 10 * meterUnit/secondUnit = tenMetersPerSecond.
	self assert: 10 * (meterUnit/secondUnit) = tenMetersPerSecond.
! !

MeasureTest removeSelector: #test35DifferentWaysToCreateMeasureWithCompoundUnit!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:40:59' prior: 50357584!
                            test36
	
	self assert: 10 * meterUnit * meterUnit = tenMetersPerSecond.
	self assert: 10 * (meterUnit/meterUnit) = tenMetersPerSecond.
! !

!classDefinition: #MeasureTest category: #'Distance-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit pesosUnit secondUnit tenMetersPerSecond tenSquareMeters'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:42:15' prior: 50357616!
                           test36
	
	self assert: 10 * meterUnit * meterUnit = tenSquareMeters.
	self assert: 10 * (meterUnit/meterUnit) = tenSquareMeters.
! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/6/2017 19:42:45' prior: 50357435!
          setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit).! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:54:11' prior: 50357638!
        test36
	
	self assert: 10 * meterUnit * meterUnit = tenSquareMeters.
	self assert: 10 * (meterUnit * meterUnit) = tenSquareMeters.
! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:55:10' prior: 50356046!
                              * aMultiplier 
	(aMultiplier isKindOf: Number) ifTrue: [
		^ self class withAmount: amount * aMultiplier andUnit: unit].
	^ self class withAmount: amount andUnit: (CompoundUnit withUnit: unit and: aMultiplier).! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:55:17'!
                           * aMeasureUnit 
	self shouldBeImplemented! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 19:55:34' prior: 50357713!
                    * aMeasureUnit 
	^ CompoundUnit withUnit: self and: aMeasureUnit.! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:56:11' prior: 50357604!
        test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual
	
	self assert: 10 * meterUnit/secondUnit = tenMetersPerSecond.
	self assert: 10 * (meterUnit/secondUnit) = tenMetersPerSecond.
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:56:18' prior: 50357723!
              test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual
	
	self assert: 10 * meterUnit/secondUnit = tenMetersPerSecond.
	self assert: 10 * (meterUnit/secondUnit) = tenMetersPerSecond.
	self assert: 10 * meterUnit * meterUnit = tenSquareMeters.
	self assert: 10 * (meterUnit * meterUnit) = tenSquareMeters.
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:56:20' prior: 50357732!
                    test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual
	
	self assert: 10 * meterUnit/secondUnit = tenMetersPerSecond.
	self assert: 10 * (meterUnit/secondUnit) = tenMetersPerSecond.
	
	self assert: 10 * meterUnit * meterUnit = tenSquareMeters.
	self assert: 10 * (meterUnit * meterUnit) = tenSquareMeters.
! !

MeasureTest removeSelector: #test36!

!classDefinition: #MeasureTest category: #'Distance-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit pesosUnit secondUnit tenMetersPerSecond tenSquareMeters tenSquareMetersPerSecond'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:57:15'!
                            test36
	
	self assert: 10 * meterUnit/secondUnit * meterUnit = tenSquareMetersPerSecond.
	self assert: 10 * (meterUnit/secondUnit) = tenMetersPerSecond.
	
	self assert: 10 * meterUnit * meterUnit = tenSquareMeters.
	self assert: 10 * (meterUnit * meterUnit) = tenSquareMeters.
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:57:41' prior: 50357774!
                    test36
	
	self assert: 10 * meterUnit/secondUnit * meterUnit = tenSquareMetersPerSecond.
	self assert: 10 * (meterUnit/secondUnit * meterUnit) = tenSquareMetersPerSecond.

! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 19:58:22' prior: 50357786!
                             test36
	
	self assert: 10 * meterUnit/secondUnit * meterUnit = tenSquareMetersPerSecond.
	self assert: 10 * (meterUnit/secondUnit * meterUnit) = tenSquareMetersPerSecond.
	self assert: 10 * (meterUnit * meterUnit /secondUnit) = tenSquareMetersPerSecond.
	self assert: 10 * meterUnit * meterUnit /secondUnit = tenSquareMetersPerSecond.

! !

10 * meterUnit/secondUnit * meterUnit!
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/6/2017 20:05:58' prior: 50357645!
                   setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit) and: secondUnit).! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 20:06:13'!
                  * aMeasureUnit 
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 20:06:37' prior: 50357865!
                   * aMeasureUnit 
	^ self class! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 20:07:10' prior: 50357870!
                               * aMeasureUnit 
	^ self class withUnit: self and: aMeasureUnit.! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 20:07:18'!
             / aMeasureUnit 
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 20:07:29' prior: 50357880!
                   / aMeasureUnit 
	^ self class! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 20:08:16' prior: 50357885!
                               / aMeasureUnit 
	^ self class withUnit: self and: aMeasureUnit ! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 20:22:36'!
                          test37
	
	self assert: hundredCentimeters / secondUnit = aMeter / secondUnit.
	
! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/6/2017 20:23:55' prior: 50357538!
             hasSameCategoryAs: aMeasureUnit
	(aMeasureUnit isKindOf: self class) ifTrue: [^ category = aMeasureUnit category].
	^ true! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 20:24:19' prior: 50357895!
               test37
	
	self assert: hundredCentimeters / secondUnit = (aMeter / secondUnit).
	
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 20:25:54'!
       test36CanCreateCompoundUnitsWithCoumpoundUnits
	
	self assert: 10 * meterUnit/secondUnit * meterUnit = tenSquareMetersPerSecond.
	self assert: 10 * (meterUnit/secondUnit * meterUnit) = tenSquareMetersPerSecond.
	self assert: 10 * (meterUnit * meterUnit /secondUnit) = tenSquareMetersPerSecond.
	self assert: 10 * meterUnit * meterUnit /secondUnit = tenSquareMetersPerSecond.

! !

MeasureTest removeSelector: #test36!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 20:45:10' prior: 50357908!
           test37
	
	self assert: aMeter * secondUnit / secondUnit = aMeter.
	
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 20:46:02' prior: 50357929!
     test37
	self fail.
	self assert: aMeter * secondUnit / secondUnit = aMeter.
	
! !

	self fail.!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 20:46:29' prior: 50357934!
             test37
	self assert: aMeter * secondUnit / secondUnit = aMeter.
	self fail.
	
! !

aMeter * secondUnit / secondUnit!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 20:53:39' prior: 50357940!
                        test37
	self assert: aMeter * secondUnit / secondUnit = aMeter.
	
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 20:54:12'!
                       test38
	self assert: aMeter * secondUnit / secondUnit = aMeter.
	
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 20:54:53' prior: 50357952!
       test38
	self assert: 10 meters + 10 meters + 10 dolars = 20 meters + 10 dolars
	
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/6/2017 20:55:11' prior: 50357957!
                        test38
	self assert: 10 meters + 10 meters + 10 dolars = (20 meters + 10 dolars)
	
! !

MeasureTest removeSelector: #test38!

----SNAPSHOT----#(6 June 2017 8:56:46.387758 pm) Cuis5.0-3081-spur-64.image priorSource: 826588!

----STARTUP----#(7 June 2017 6:39:43.717568 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!

!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/7/2017 18:49:16' prior: 50357947!
       test37
	self deny: aMeter * secondUnit / secondUnit = aMeter * secondUnit * secondUnit.
	
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/7/2017 18:49:28' prior: 50357977!
               test37
	self deny: aMeter * secondUnit / secondUnit = (aMeter * secondUnit * secondUnit).
	
! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:52:31' prior: 50357875!
* aMeasureUnit 
	^ self class withUnit: self and: aMeasureUnit andSymbol: #* .! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:52:43' prior: 50357890!
              / aMeasureUnit 
	^ self class withUnit: self and: aMeasureUnit andSymbol: #/! !
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:52:58'!
                          withUnit: aMeasureUnit and: anotherMeasureUnit andSymbol: aSymbol
	^ self new initializeWith: aMeasureUnit and: anotherMeasureUnit andSymbol: aSymbol ! !
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:53:18' prior: 50358001!
withUnit: aMeasureUnit and: anotherMeasureUnit andSymbol: anOperation
	^ self new initializeWith: aMeasureUnit and: anotherMeasureUnit andSymbol: anOperation! !
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:53:22'!
         withUnit: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation
	^ self new initializeWith: aMeasureUnit and: anotherMeasureUnit andSymbol: anOperation! !

CompoundUnit class removeSelector: #withUnit:and:andSymbol:!
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:53:36' prior: 50357989!
                              * aMeasureUnit 
	^ self class withUnit: self and: aMeasureUnit andOperation: #* .! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:53:41' prior: 50357995!
           / aMeasureUnit 
	^ self class withUnit: self and: aMeasureUnit andOperation: #/! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:53:55'!
                             initializeWith: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation
	measureUnit := aMeasureUnit.
	secondMeasureUnit := anotherMeasureUnit! !

!classDefinition: #CompoundUnit category: #'Distance-Solution'!
Object subclass: #CompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit operation'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:54:04' prior: 50358040!
                       initializeWith: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation
	measureUnit := aMeasureUnit.
	secondMeasureUnit := anotherMeasureUnit.
	operation := anOperation! !

CompoundUnit removeSelector: #initializeWith:and:!

CompoundUnit class removeSelector: #withUnit:and:!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:54:52' prior: 50357703!
         * aMultiplier 
	(aMultiplier isKindOf: Number) ifTrue: [
		^ self class withAmount: amount * aMultiplier andUnit: unit].
	^ self class withAmount: amount andUnit: (CompoundUnit withUnit: unit and: aMultiplier andOperation: #*).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:55:00' prior: 50356988!
                              / aDividend 
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	^ self class withAmount: amount andUnit: (CompoundUnit withUnit: unit and: aDividend andOperation: #/).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 18:55:22' prior: 50357810!
                setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit) and: secondUnit).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 18:55:26' prior: 50358089!
setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit) and: secondUnit).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 18:55:46' prior: 50358144!
               setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:55:53' prior: 50357718!
                               * aMeasureUnit 
	^ CompoundUnit withUnit: self and: aMeasureUnit andOperation: #*.! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:55:59' prior: 50357555!
           / aMeasureUnit 
	^ CompoundUnit withUnit: self and: aMeasureUnit andOperation: #*.! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:56:01' prior: 50358264!
           / aMeasureUnit 
	^ CompoundUnit withUnit: self and: aMeasureUnit andOperation: #/.! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:57:47'!
                          = compoundMeasure
	^ measureUnit = compoundMeasure measureUnit and: [secondMeasureUnit = compoundMeasure secondMeasure ]! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:57:58' prior: 50358276!
    = compoundMeasure
	^ measureUnit = compoundMeasure measureUnit and: [secondMeasureUnit = compoundMeasure secondMeasureUnit]! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:58:16' prior: 50358283!
 = compoundMeasure
	^ measureUnit = compoundMeasure measureUnit and: [secondMeasureUnit = compoundMeasure secondMeasureUnit and:[ operation = compoundMeasure operation]! !

"E" MeasureTest debug: #test17TenKilometersIsGreaterThanAMeter!
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 18:59:13' prior: 50358017!
              withUnit: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation
	^ self new initializeWith: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:02:21' prior: 50357073!
                         hasSameCategoryAs: aMeasureUnit 
	(aMeasureUnit  isKindOf: self class) ifFalse: [^aMeasureUnit = measureUnit ].! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:03:26' prior: 50358310!
             hasSameCategoryAs: aMeasureUnit 
	(aMeasureUnit  isKindOf: self class) ifFalse: [^aMeasureUnit = measureUnit ].
	^ measureUnit = aMeasureUnit measureUnit and: [secondMeasureUnit = aMeasureUnit secondMeasureUnit]. ! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:03:29' prior: 50358317!
       hasSameCategoryAs: aMeasureUnit 
	(aMeasureUnit  isKindOf: self class) ifFalse: [^aMeasureUnit = measureUnit ].
	^ measureUnit = aMeasureUnit measureUnit and: [secondMeasureUnit = aMeasureUnit secondMeasureUnit ]. ! !
!CompoundUnit methodsFor: 'accessing' stamp: 'GDS 6/7/2017 19:03:36'!
measureUnit
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'accessing' stamp: 'GDS 6/7/2017 19:03:46' prior: 50358336!
 measureUnit
	^ measureUnit ! !
!CompoundUnit methodsFor: 'accessing' stamp: 'GDS 6/7/2017 19:03:52'!
                           secondMeasureUnit
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'accessing' stamp: 'GDS 6/7/2017 19:03:58' prior: 50358344!
                           secondMeasureUnit
	^ secondMeasureUnit ! !

----STARTUP----#(7 June 2017 7:04:38.162849 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!

!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/7/2017 19:04:56' prior: 50357947!
                           test37
	self assert: aMeter * secondUnit / secondUnit = aMeter * secondUnit * secondUnit.
	
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/7/2017 19:04:59' prior: 50358358!
             test37
	self deny: aMeter * secondUnit / secondUnit = aMeter * secondUnit * secondUnit.
	
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/7/2017 19:05:10' prior: 50358364!
               test37
	self deny: aMeter * secondUnit / secondUnit = (aMeter * secondUnit * secondUnit).
	
! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:05:47' prior: 50357073!
hasSameCategoryAs: aMeasureUnit 
	(aMeasureUnit  isKindOf: self class) ifFalse: [^ measureUnit = aMeasureUnit ]! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:06:20' prior: 50358376!
             hasSameCategoryAs: aMeasureUnit 
	(aMeasureUnit  isKindOf: self class) ifFalse: [^ measureUnit = aMeasureUnit ].
	^ measureUnit = aMeasureUnit measureUnit and: [secondMeasureUnit = aMeasureUnit secondMeasureUnit]! !

----SNAPSHOT----#(7 June 2017 7:06:27.438507 pm) Cuis5.0-3081-spur-64.image priorSource: 842204!
!CompoundUnit methodsFor: 'accessing' stamp: 'GDS 6/7/2017 19:06:31'!
measureUnit
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'accessing' stamp: 'GDS 6/7/2017 19:06:37' prior: 50358395!
 measureUnit
	^ measureUnit ! !

"E" MeasureTest debug: #test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual!
!CompoundUnit methodsFor: 'accessing' stamp: 'GDS 6/7/2017 19:07:43'!
      secondMeasureUnit
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'accessing' stamp: 'GDS 6/7/2017 19:07:51' prior: 50358405!
                           secondMeasureUnit
	^ secondMeasureUnit ! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:09:01' prior: 50358383!
                     hasSameCategoryAs: aMeasureUnit 
	^ true! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:09:06' prior: 50358415!
                    hasSameCategoryAs: aMeasureUnit 

	^ true! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/7/2017 19:10:41' prior: 50358370!
test37
	self deny: aMeter * secondUnit / secondUnit = (aMeter * secondUnit / meterUnit ).
	
! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:13:36' prior: 50358420!
hasSameCategoryAs: aMeasureUnit 

	^ self category = aMeasureUnit category! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:13:58' prior: 50357511!
                  category
	^ '()'! !

!classDefinition: #CompoundUnit category: #'Distance-Solution'!
Object subclass: #CompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit operation'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:14:59' prior: 50358436!
                            category
	^ '(', measureUnit category,  operation, secondMeasureUnit category,  ')'! !

----SNAPSHOT----#(7 June 2017 7:15:15.62827 pm) Cuis5.0-3081-spur-64.image priorSource: 855735!
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:15:29'!
                  withUnit: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation
	^ self new initializeWith: aMeasureUnit and: anotherMeasureUnit! !
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:15:34' prior: 50358457!
             withUnit: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation
	^ self new initializeWith: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation ! !

CompoundUnit class removeSelector: #withUnit:and:!
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:16:02' prior: 50357875!
    * aMeasureUnit 
	^ self class withUnit: self and: aMeasureUnit andOperation: #*.! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:16:11' prior: 50357890!
            / aMeasureUnit 
	^ self class withUnit: self and: aMeasureUnit andOperation: #/. ! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:16:16' prior: 50357703!
                * aMultiplier 
	(aMultiplier isKindOf: Number) ifTrue: [
		^ self class withAmount: amount * aMultiplier andUnit: unit].
	^ self class withAmount: amount andUnit: (CompoundUnit withUnit: unit and: aMultiplier andOperation: #*).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:16:20' prior: 50356988!
                              / aDividend 
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	^ self class withAmount: amount andUnit: (CompoundUnit withUnit: unit and: aDividend andOperation: #*).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:16:25' prior: 50358498!
      / aDividend 
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	^ self class withAmount: amount andUnit: (CompoundUnit withUnit: unit and: aDividend andOperation: #/).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 19:16:34' prior: 50357810!
                setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit) and: secondUnit).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 19:16:41' prior: 50358518!
setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit) and: secondUnit).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 19:16:46' prior: 50358573!
               setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 19:16:49' prior: 50358629!
                              setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #*).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 19:16:51' prior: 50358686!
             setUp
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:16:55' prior: 50357718!
                               * aMeasureUnit 
	^ CompoundUnit withUnit: self and: aMeasureUnit andOperation: #*.! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:17:00' prior: 50357555!
           / aMeasureUnit 
	^ CompoundUnit withUnit: self and: aMeasureUnit andOperation: #*.! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:17:04' prior: 50358807!
           / aMeasureUnit 
	^ CompoundUnit withUnit: self and: aMeasureUnit andOperation: #/.! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:17:20'!
                          initializeWith: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation
	measureUnit := aMeasureUnit.
	secondMeasureUnit := anotherMeasureUnit! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:17:29' prior: 50358819!
       initializeWith: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation
	measureUnit := aMeasureUnit.
	secondMeasureUnit := anotherMeasureUnit.
	operation := anOperation ! !

CompoundUnit removeSelector: #initializeWith:and:!

self category!

aMeasureUnit category!

----SNAPSHOT----#(7 June 2017 7:24:33.404953 pm) Cuis5.0-3081-spur-64.image priorSource: 857686!
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:54:19' prior: 50358430!
             hasSameCategoryAs: aMeasureUnit 

	^ true! !

MeasureTest removeSelector: #test37!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:57:26' prior: 50356052!
                  + aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ MeasureOperation with: self andOther: aMeasure ] .
	^ self class 
		withAmount: (self convertToDefaultUnit amount) + (aMeasure convertToDefaultUnit amount) 
		andUnit: (
			unit class withName: unit defaultName 
			andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] 
			andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] 
			andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing 
			andDefaultName: unit defaultName 
			andCategory: unit category
			).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 19:57:31' prior: 50356073!
                    - aMeasure

	(self canAdd: aMeasure) ifFalse: [ ^ MeasureOperation with: self andOther: aMeasure ] .
	^ self class 
		withAmount: (self convertToDefaultUnit amount) - (aMeasure convertToDefaultUnit amount) 
		andUnit: (
			unit class withName: unit defaultName 
			andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] 
			andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] 
			andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing 
			andDefaultName: unit defaultName 
			andCategory: unit category
			).! !

Object subclass: #MeasureUnitBehavior
	instanceVariableNames: 'name defaultName category amountThatRepresentsNothing conversionMethod inverseConversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #MeasureUnitBehavior category: #'Distance-Solution'!
Object subclass: #MeasureUnitBehavior
	instanceVariableNames: 'name defaultName category amountThatRepresentsNothing conversionMethod inverseConversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

Object subclass: #MeasureUnitBehavior
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #MeasureUnitBehavior category: #'Distance-Solution'!
Object subclass: #MeasureUnitBehavior
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

MeasureUnitBehavior subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName category amountThatRepresentsNothing conversionMethod inverseConversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #MeasureUnit category: #'Distance-Solution'!
MeasureUnitBehavior subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName category amountThatRepresentsNothing conversionMethod inverseConversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

MeasureUnitBehavior subclass: #CompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit operation'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #CompoundUnit category: #'Distance-Solution'!
MeasureUnitBehavior subclass: #CompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit operation'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:07:58'!
                 withName: aName andAConverter: aConverter andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName andCategory: aCategory
	^ self new withName: aName andAConverte: aConverter andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName andCategory: aCategory ! !
!MeasureUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:08:02' prior: 50358951!
                    withName: aName andAConverter: aConverter andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName andCategory: aCategory
	^ self new withName: aName andAConverter: aConverter andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName andCategory: aCategory ! !

MeasureUnit class removeSelector: #withName:andConversionMethod:andInverseConversionMethod:andAmountValueThatRepresentsNothing:andDefaultName:andCategory:!

!classDefinition: #MeasureUnitConverter category: #'Distance-Solution'!
Object subclass: #MeasureUnitConverter
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:09:49' prior: 50358848!
       + aMeasure
	
	|aConverter| 
	MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	
	(self canAdd: aMeasure) ifFalse: [ ^ MeasureOperation with: self andOther: aMeasure ] .
	^ self class 
		withAmount: (self convertToDefaultUnit amount) + (aMeasure convertToDefaultUnit amount) 
		andUnit: (
			unit class withName: unit defaultName 
			andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] 
			andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] 
			andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing 
			andDefaultName: unit defaultName 
			andCategory: unit category
			).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:10:22' prior: 50358988!
                           + aMeasure
	
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	
	(self canAdd: aMeasure) ifFalse: [ ^ MeasureOperation with: self andOther: aMeasure ] .
	^ self class 
		withAmount: (self convertToDefaultUnit amount) + (aMeasure convertToDefaultUnit amount) 
		andUnit: (
			unit class withName: unit defaultName 
			andAConverter: aConverter 
			andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing 
			andDefaultName: unit defaultName 
			andCategory: unit category
			).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:11:07' prior: 50358870!
    - aMeasure

	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .

	(self canAdd: aMeasure) ifFalse: [ ^ MeasureOperation with: self andOther: aMeasure ] .
	^ self class 
		withAmount: (self convertToDefaultUnit amount) - (aMeasure convertToDefaultUnit amount) 
		andUnit: (
			unit class withName: unit defaultName 
			andAConverter: aConverter 
			andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing 
			andDefaultName: unit defaultName 
			andCategory: unit category
			).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:11:15' prior: 50356148!
      convertToDefaultUnit

	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .

	^ self class new 
		initializeWithAmount: (unit applyConversionMethodTo: amount) 
		andUnit: (
			MeasureUnit 
				withName: unit defaultName 
				andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] 
				andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] 
				andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing
				andDefaultName: unit defaultName 
				andCategory: unit category
			)! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:11:27' prior: 50359065!
            convertToDefaultUnit

	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .

	^ self class new 
		initializeWithAmount: (unit applyConversionMethodTo: amount) 
		andUnit: (
			MeasureUnit 
				withName: unit defaultName 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing
				andDefaultName: unit defaultName 
				andCategory: unit category
			)! !

!classDefinition: #MeasureTest category: #'Distance-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit pesosUnit secondUnit tenMetersPerSecond tenSquareMeters tenSquareMetersPerSecond aConverter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:11:49' prior: 50358743!
   setUp

	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1] andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:12:11' prior: 50359127!
                       setUp

	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andConversionMethod: [:pesosAmountInThisUnit | pesosAmountInThisUnit * 1] andInverseConversionMethod: [:pesosAmountInDefaultUnit | pesosAmountInDefaultUnit / 1] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:12:22' prior: 50359191!
          setUp

	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !

!classDefinition: #MeasureTest category: #'Distance-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit pesosUnit secondUnit tenMetersPerSecond tenSquareMeters tenSquareMetersPerSecond aConverter aDefaultConverter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:12:44' prior: 50359250!
                    setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !

!classDefinition: #MeasureTest category: #'Distance-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit pesosUnit secondUnit tenMetersPerSecond tenSquareMeters tenSquareMetersPerSecond aConverter aDefaultConverter aSecondConverter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:13:11' prior: 50359321!
                            setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:13:28' prior: 50359393!
 setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 60]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 60] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60] andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:13:49' prior: 50359455!
                               setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 60]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 60] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andAConverter: aSecondConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:14:30' prior: 50355875!
                celsius
	| aCelsiusConverter |
	aCelsiusConverter := MeasureUnitConverter withConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit + 273.15]  andInverseConversionMethod: [:temperatureAmountInDefaultUnit | temperatureAmountInDefaultUnit - 273.15]  .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'celsius' 
				andConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit + 273.15] 
				andInverseConversionMethod: [:temperatureAmountInDefaultUnit | temperatureAmountInDefaultUnit - 273.15] 
				andAmountValueThatRepresentsNothing: -273.15
				andDefaultName: 'kelvin' 
				andCategory: 'temperature'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:14:47' prior: 50359577!
                      celsius
	| aCelsiusConverter |
	aCelsiusConverter := MeasureUnitConverter withConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit + 273.15]  andInverseConversionMethod: [:temperatureAmountInDefaultUnit | temperatureAmountInDefaultUnit - 273.15]  .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'celsius' 
				andAConverter: aCelsiusConverter 
				andAmountValueThatRepresentsNothing: -273.15
				andDefaultName: 'kelvin' 
				andCategory: 'temperature'
				)! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:15:03' prior: 50359518!
       setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60]  andInverseConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 60] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andAConverter: aSecondConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:15:47' prior: 50359041!
    - aMeasure

	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	(self canAdd: aMeasure) ifFalse: [ ^ MeasureOperation with: self andOther: aMeasure ] .
	^ self class 
		withAmount: (self convertToDefaultUnit amount) - (aMeasure convertToDefaultUnit amount) 
		andUnit: (
			unit class withName: unit defaultName 
			andAConverter: aConverter 
			andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing 
			andDefaultName: unit defaultName 
			andCategory: unit category
			).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:16:05' prior: 50359621!
                setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 60] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andAConverter: aSecondConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute' andCategory: 'time'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:16:29' prior: 50359091!
                              convertToDefaultUnit

	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ self class new 
		initializeWithAmount: (unit applyConversionMethodTo: amount) 
		andUnit: (
			MeasureUnit 
				withName: unit defaultName 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing
				andDefaultName: unit defaultName 
				andCategory: unit category
			)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:16:54' prior: 50355891!
      centimeters
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit / 100]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit * 100] .
	
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'centimeter' 
				andConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 100] 
				andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 100] 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				andCategory: 'distance'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:17:04' prior: 50359781!
                centimeters
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit / 100]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit * 100] .
	
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'centimeter' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				andCategory: 'distance'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:17:24' prior: 50355907!
            dolars
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'dolar' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'dolar' 
				andCategory: 'dolar'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:18:00' prior: 50355922!
                              fahrenheit
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:temperatureAmountInThisUnit | (temperatureAmountInThisUnit + 459.67) * (5/9)] andInverseConversionMethod: [:temperatureAmountInDefaultUnit | (temperatureAmountInDefaultUnit * (9/5)) - 459.67] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'fahrenheit' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: -459.67
				andDefaultName: 'kelvin' 
				andCategory: 'temperature'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:18:36' prior: 50355939!
                               grams
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'gram' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'gram' 
				andCategory: 'weight'
				).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:18:56' prior: 50355953!
                               kelvin
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'kelvin' 
				andAConverter: aConverter
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'kelvin' 
				andCategory: 'temperature'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:19:13' prior: 50355969!
                       kilograms
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1000]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1000] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'kilogram' 
				andConversionMethod: [:weightAmountInThisUnit | weightAmountInThisUnit * 1000] 
				andInverseConversionMethod: [:weightAmountInDefaultUnit | weightAmountInDefaultUnit / 1000] 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'gram' 
				andCategory: 'weight'
				).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:19:26' prior: 50359891!
                           kilograms
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1000]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1000] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'kilogram' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'gram' 
				andCategory: 'weight'
				).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:19:54' prior: 50355984!
                 kilometers
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1000]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1000] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'kilometer' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				andCategory: 'distance'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:20:13' prior: 50356000!
             meters
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'meter' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				andCategory: 'distance'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:20:40' prior: 50356015!
                           millimeters
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit / 1000]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit * 1000] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'millimeter' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				andCategory: 'distance'
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:20:56' prior: 50356031!
           pesos
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .
	
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'peso' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'peso' 
				andCategory: 'peso')! !

!classDefinition: #MeasureUnit category: #'Distance-Solution'!
MeasureUnitBehavior subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName category amountThatRepresentsNothing conversionMethod inverseConversionMethod converter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:21:43'!
                    withName: aName andAConverter: aConverter andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName andCategory: aCategory
	name := aName.
	converter := aConverter .
	amountThatRepresentsNothing := anAmount.
	defaultName := aDefaultName.
	category  := aCategory.! !

MeasureUnitBehavior subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName category amountThatRepresentsNothing converter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #MeasureUnit category: #'Distance-Solution'!
MeasureUnitBehavior subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName category amountThatRepresentsNothing converter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

"E" MeasureTest debug: #test01MeterIsEqualToHimself!
!MeasureUnitConverter class methodsFor: 'initialization' stamp: 'GDS 6/7/2017 20:22:19'!
               withConversionMethod: aBlockClosure andInverseConversionMethod: aBlockClosure2 
	self shouldBeImplemented! !
!MeasureUnitConverter class methodsFor: 'initialization' stamp: 'GDS 6/7/2017 20:23:07' prior: 50360036!
          withConversionMethod: aConversionMethod andInverseConversionMethod: anInverseConversionMethod
	^ self new initializeWithConversionMethod: aConversionMethod andInverseConversionMethod: anInverseConversionMethod ! !
!MeasureUnitConverter methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:23:33'!
                  initializeWithConversionMethod: aBlockClosure andInverseConversionMethod: aBlockClosure2 
	self shouldBeImplemented! !

!classDefinition: #MeasureUnitConverter category: #'Distance-Solution'!
Object subclass: #MeasureUnitConverter
	instanceVariableNames: 'conversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #MeasureUnitConverter category: #'Distance-Solution'!
Object subclass: #MeasureUnitConverter
	instanceVariableNames: 'conversionMethod inverseConversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!MeasureUnitConverter methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:24:04' prior: 50360053!
                       initializeWithConversionMethod: aConversionMethod andInverseConversionMethod: anInverseConversionMethod 
	conversionMethod := aConversionMethod .
	inverseConversionMethod := anInverseConversionMethod ! !
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:24:49' prior: 50356510!
                     applyConversionMethodTo: aNumber

	^ converter applyConversionMethodTo: aNumber! !
!MeasureUnitConverter methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:24:57'!
                     applyConversionMethodTo: aSmallInteger 
	self shouldBeImplemented! !
!MeasureUnitConverter methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:25:18' prior: 50360092!
                   applyConversionMethodTo: aNumber
	^ conversionMethod value: aNumber ! !

----SNAPSHOT----#(7 June 2017 8:25:41.965969 pm) Cuis5.0-3081-spur-64.image priorSource: 870000!
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:26:06' prior: 50356515!
                       applyInverseConversionMethodTo: aNumber 
	
	^ converter applyInverseConversionMethodTo: aNumber! !
!MeasureUnitConverter methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:26:11'!
     applyInverseConversionMethodTo: aSmallInteger 
	self shouldBeImplemented! !
!MeasureUnitConverter methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:26:28' prior: 50360113!
            applyInverseConversionMethodTo: aNumber
	^ inverseConversionMethod value: aNumber ! !

----SNAPSHOT----#(7 June 2017 8:26:36.75965 pm) Cuis5.0-3081-spur-64.image priorSource: 910471!

MeasureUnit removeSelector: #withName:andAConverter:andAmountValueThatRepresentsNothing:andDefaultName:andCategory:!
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:27:36'!
    withName: aName andAConverter: aConverter andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName andCategory: aCategory
	name := aName.
	converter := aConverter.
	amountThatRepresentsNothing := anAmount.
	defaultName := aDefaultName.
	category  := aCategory.! !

MeasureUnit removeSelector: #withName:andConversionMethod:andInverseConversionMethod:andAmountValueThatRepresentsNothing:andDefaultName:andCategory:!

MeasureUnit removeSelector: #conversionMethod!
!MeasureUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:33:01'!
                withName: aName andAConverter: aConverter andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName
	name := aName.
	converter := aConverter.
	amountThatRepresentsNothing := anAmount.
	defaultName := aDefaultName.! !
!MeasureUnit class methodsFor: 'instance creation' stamp: 'GDS 6/7/2017 20:33:13'!
   withName: aName andAConverter: aConverter andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName
	^ self new withName: aName andAConverter: aConverter andAmountValueThatRepresentsNothing: anAmount andDefaultName: aDefaultName! !

MeasureUnit class removeSelector: #withName:andAConverter:andAmountValueThatRepresentsNothing:andDefaultName:andCategory:!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:33:25' prior: 50359017!
                + aMeasure
	
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	
	(self canAdd: aMeasure) ifFalse: [ ^ MeasureOperation with: self andOther: aMeasure ] .
	^ self class 
		withAmount: (self convertToDefaultUnit amount) + (aMeasure convertToDefaultUnit amount) 
		andUnit: (
			unit class withName: unit defaultName 
			andAConverter: aConverter 
			andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing 
			andDefaultName: unit defaultName 
			).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:33:29' prior: 50359679!
  - aMeasure

	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	(self canAdd: aMeasure) ifFalse: [ ^ MeasureOperation with: self andOther: aMeasure ] .
	^ self class 
		withAmount: (self convertToDefaultUnit amount) - (aMeasure convertToDefaultUnit amount) 
		andUnit: (
			unit class withName: unit defaultName 
			andAConverter: aConverter 
			andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing 
			andDefaultName: unit defaultName 
			).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:33:33' prior: 50359761!
    convertToDefaultUnit

	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ self class new 
		initializeWithAmount: (unit applyConversionMethodTo: amount) 
		andUnit: (
			MeasureUnit 
				withName: unit defaultName 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing
				andDefaultName: unit defaultName 
			)! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:33:41' prior: 50359702!
             setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 60] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' andCategory: 'peso'.
	secondUnit := MeasureUnit withName: 'second' andAConverter: aSecondConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:33:45' prior: 50360238!
                            setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 60] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter' andCategory: 'distance'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' .
	secondUnit := MeasureUnit withName: 'second' andAConverter: aSecondConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/7/2017 20:33:48' prior: 50360296!
               setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 60] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' .
	secondUnit := MeasureUnit withName: 'second' andAConverter: aSecondConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'minute'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:33:53' prior: 50359602!
                               celsius
	| aCelsiusConverter |
	aCelsiusConverter := MeasureUnitConverter withConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit + 273.15]  andInverseConversionMethod: [:temperatureAmountInDefaultUnit | temperatureAmountInDefaultUnit - 273.15]  .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'celsius' 
				andAConverter: aCelsiusConverter 
				andAmountValueThatRepresentsNothing: -273.15
				andDefaultName: 'kelvin' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:33:57' prior: 50359803!
                              centimeters
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit / 100]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit * 100] .
	
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'centimeter' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:34:02' prior: 50359820!
        dolars
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'dolar' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'dolar' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:34:07' prior: 50359837!
                       fahrenheit
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:temperatureAmountInThisUnit | (temperatureAmountInThisUnit + 459.67) * (5/9)] andInverseConversionMethod: [:temperatureAmountInDefaultUnit | (temperatureAmountInDefaultUnit * (9/5)) - 459.67] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'fahrenheit' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: -459.67
				andDefaultName: 'kelvin' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:34:13' prior: 50359857!
                              grams
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'gram' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'gram' 
				).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:34:18' prior: 50359874!
                         kelvin
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'kelvin' 
				andAConverter: aConverter
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'kelvin' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:34:22' prior: 50359913!
                      kilograms
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1000]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1000] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'kilogram' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'gram' 
				).! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:34:25' prior: 50359930!
           kilometers
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1000]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1000] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'kilometer' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:34:29' prior: 50359947!
         meters
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'meter' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:34:34' prior: 50359964!
                       millimeters
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit / 1000]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit * 1000] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'millimeter' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'meter' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/7/2017 20:34:40' prior: 50359981!
       pesos
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .
	
	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'peso' 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'peso' 
		)! !

"F" MeasureTest debug: #test27TheSumOfTwoMeasuresWithDifferentTypeIsNotEqualsToASumOfMeasuresWithSameType!

"F" MeasureTest debug: #test29CannotConvertAMeasureToAUnitThatHasDifferentType!

"F" MeasureTest debug: #test30TheDifferenceOfTwoMeasuresWithDifferentTypeIsNotEqualsToASumOfMeasuresWithSameType!
!MeasureUnit methodsFor: 'testing' stamp: 'GDS 6/7/2017 20:36:09' prior: 50357901!
                 hasSameCategoryAs: aMeasureUnit
	(aMeasureUnit isKindOf: self class) ifTrue: [^ defaultName = aMeasureUnit defaultName].
	^ true! !

MeasureUnitBehavior subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName amountThatRepresentsNothing converter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #MeasureUnit category: #'Distance-Solution'!
MeasureUnitBehavior subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName amountThatRepresentsNothing converter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

MeasureUnit removeSelector: #category!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:37:04' prior: 50356127!
    canAdd: aMeasure 
	^ unit defaultName = aMeasure unit defaultName! !
!MeasureUnit methodsFor: 'comparing' stamp: 'GDS 6/7/2017 20:37:31' prior: 50356498!
      = aWeightUnit 

	^ (aWeightUnit isKindOf: self class) and: [name = aWeightUnit name and: [ defaultName = aWeightUnit defaultName ]].! !

MeasureUnit removeSelector: #withName:andAConverter:andAmountValueThatRepresentsNothing:andDefaultName:andCategory:!
!MeasureUnit methodsFor: 'testing' stamp: 'GDS 6/7/2017 20:37:59'!
                               hasSameDefaultNameAs: aMeasureUnit
	(aMeasureUnit isKindOf: self class) ifTrue: [^ defaultName = aMeasureUnit defaultName].
	^ true! !

MeasureUnit removeSelector: #hasSameCategoryAs:!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:38:12' prior: 50357059!
            = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [(unit hasSameDefaultNameAs: aMeasure unit ) and: [amount = (aMeasure convertTo: unit) amount]]
	].! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:38:22' prior: 50357084!
                      canConvert: aMeasureUnit 
	^ unit hasSameDefaultNameAs: aMeasureUnit! !

"E" MeasureTest debug: #test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual!
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:39:48'!
                   hasSameDefaultNameAs: aCompoundUnit 
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:39:57' prior: 50360667!
                              hasSameDefaultNameAs: aCompoundUnit 
	^ ''! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:40:21' prior: 50360673!
                  hasSameDefaultNameAs: aCompoundUnit 
	^ true! !

----SNAPSHOT----#(7 June 2017 8:40:31.786898 pm) Cuis5.0-3081-spur-64.image priorSource: 911157!

----SNAPSHOT----#(7 June 2017 8:41:04.824634 pm) Cuis5.0-3081-spur-64.image priorSource: 929007!

CompoundUnit removeSelector: #applyConversionMethodTo:!

CompoundUnit removeSelector: #applyInverseConversionMethodTo:!

CompoundUnit removeSelector: #category!

CompoundUnit removeSelector: #hasSameCategoryAs:!
!MeasureUnitBehavior methodsFor: 'nil' stamp: 'GDS 6/7/2017 20:43:27'!
                * aMeasureUnit 
	^ self subclassResponsibility .! !
!MeasureUnitBehavior methodsFor: 'nil' stamp: 'GDS 6/7/2017 20:46:12'!
     / aMeasureUnit 
	^ self class withUnit: self and: aMeasureUnit andOperation: #/. ! !
!MeasureUnitBehavior methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:46:23' prior: 50360699!
    / aMeasureUnit 
	^ self subclassResponsibility ! !
!MeasureUnitBehavior methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:46:41'!
                      adaptToNumber: aSmallInteger andSend: aSymbol 
	^ self subclassResponsibility ! !

CompoundUnit removeSelector: #defaultName!

CompoundUnit removeSelector: #hasSameDefaultNameAs:!

"E" MeasureTest debug: #test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual!
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:51:22'!
       hasSameDefaultNameAs: aCompoundUnit 
	self shouldBeImplemented! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/7/2017 20:53:07'!
                           test36
	
	self assert: 10 * (meterUnit/secondUnit) = tenMetersPerSecond.
! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/7/2017 20:53:18'!
                test37
		
	self assert: 10 * meterUnit * meterUnit = tenSquareMeters.

! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/7/2017 20:53:22'!
                  test38
		
	self assert: 10 * meterUnit * meterUnit = tenSquareMeters.

! !
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/7/2017 20:53:24' prior: 50360736!
  test38
		
	self assert: 10 * (meterUnit * meterUnit) = tenSquareMeters.

! !

"E" MeasureTest debug: #test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual!
!MeasureTest methodsFor: 'Testing' stamp: 'GDS 6/7/2017 20:54:04' prior: 50357745!
           test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual
	
	self assert: 10 * meterUnit/secondUnit = tenMetersPerSecond.! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:54:33' prior: 50360721!
  hasSameDefaultNameAs: aCompoundUnit 
	^ true! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:56:40' prior: 50360649!
                     = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [(aMeasure unit isKindOf: unit class) and:[(unit hasSameDefaultNameAs: aMeasure unit ) and: [amount = (aMeasure convertTo: unit) amount]]]
	].! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 20:59:06' prior: 50360761!
           = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [(unit hasSameDefaultNameAs: aMeasure unit ) and: [amount = (aMeasure convertTo: unit) amount]]].! !

!classDefinition: #NullUnit category: #'Distance-Solution'!
MeasureUnitBehavior subclass: #NullUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:03:11' prior: 50360772!
          = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [(unit / aMeasure unit) isKindOf: NullUnit  and: [amount = (aMeasure convertTo: unit) amount]]].! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:04:00' prior: 50360788!
                         = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [(unit / (aMeasure unit) isKindOf: NullUnit)  and: [amount = (aMeasure convertTo: unit) amount]]].! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:04:51' prior: 50360798!
                       = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [self / aMeasure = 1]]! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:04:52' prior: 50360808!
   = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [self / aMeasure = 1]].! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:06:25' prior: 50358508!
  / aDividend 
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	^ self class withAmount: amount / aDividend amount andUnit: (CompoundUnit withUnit: unit and: aDividend andOperation: #/).! !
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:08:06' prior: 50358465!
        withUnit: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation

	^ self new initializeWith: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation ! !
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:08:06' prior: 50360833!
                 withUnit: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation
	^ self new initializeWith: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation ! !
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:08:07' prior: 50360842!
                  withUnit: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation

	^ self new initializeWith: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation ! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:08:43' prior: 50360822!
                            / aDividend 
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	^ self class withAmount: amount / aDividend amount andUnit: (MeasureUnitBehavior withUnit: unit and: aDividend andOperation: #/).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:08:56' prior: 50360860!
            / aDividend 
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	^ self class withAmount: amount / aDividend amount andUnit: (MeasureUnitBehavior withUnit: unit andUnit: aDividend andOperation: #/).! !
!MeasureUnitBehavior class methodsFor: 'no messages' stamp: 'GDS 6/7/2017 21:09:43'!
              withUnit: aMeasureUnit andUnit: anotherMeasureUnit andOperation: anOperation! !
!MeasureUnitBehavior class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:09:44' prior: 50360882!
   withUnit: aMeasureUnit andUnit: anotherMeasureUnit andOperation: anOperation
! !
!MeasureUnitBehavior class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:09:45' prior: 50360888!
  withUnit: aMeasureUnit andUnit: anotherMeasureUnit andOperation: anOperation

	! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:12:46' prior: 50360871!
                  / aDividend 
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	^ self class withAmount: amount convertToDefaultUnit / aDividend amount andUnit: (MeasureUnitBehavior withUnit: unit andUnit: aDividend andOperation: #/).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:14:48' prior: 50360900!
                   / aDividend 
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	^ self class withAmount: self convertToDefaultUnit amount / aDividend convertToDefaultUnit amount andUnit: (MeasureUnitBehavior withUnit: unit andUnit: aDividend andOperation: #/).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:15:20' prior: 50360912!
                         / aDividend 
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	^ self class withAmount: self convertToDefaultUnit amount / (aDividend convertToDefaultUnit amount) andUnit: (MeasureUnitBehavior withUnit: unit andUnit: aDividend andOperation: #/).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:18:42' prior: 50360925!
                       / aDividend 
	| aDividendInDefaultUnit selfInDefaultUnit |
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	
	selfInDefaultUnit := self convertToDefaultUnit .
	aDividendInDefaultUnit := aDividend convertToDefaultUnit .
	^ self class withAmount: selfInDefaultUnit amount / aDividendInDefaultUnit amountandUnit: (MeasureUnitBehavior withUnit: unit andUnit: aDividend andOperation: #/).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:18:53' prior: 50360938!
            / aDividend 
	| aDividendInDefaultUnit selfInDefaultUnit |
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	
	selfInDefaultUnit := self convertToDefaultUnit .
	aDividendInDefaultUnit := aDividend convertToDefaultUnit .
	^ self class withAmount: selfInDefaultUnit amount / aDividendInDefaultUnit amount andUnit: (MeasureUnitBehavior withUnit: unit andUnit: aDividend andOperation: #/).! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:20:17' prior: 50360955!
           / aDividend 
	| aDividendInDefaultUnit selfInDefaultUnit |
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	
	selfInDefaultUnit := self convertToDefaultUnit .
	aDividendInDefaultUnit := aDividend convertToDefaultUnit .
	^ self class withAmount: selfInDefaultUnit amount / aDividendInDefaultUnit amount andUnit: unit / aDividend unit.! !
!MeasureUnit methodsFor: 'math operations' stamp: 'GDS 6/7/2017 21:21:51' prior: 50358813!
                              / aMeasureUnit 
	(self hasSameDefaultNameAs: aMeasureUnit) ifTrue: [^ NullUnit].
	^ CompoundUnit withUnit: self and: aMeasureUnit andOperation: #/.! !
!MeasureUnit methodsFor: 'math operations' stamp: 'GDS 6/7/2017 21:21:54' prior: 50360988!
              / aMeasureUnit 
	(self hasSameDefaultNameAs: aMeasureUnit) ifTrue: [^ NullUnit new].
	^ CompoundUnit withUnit: self and: aMeasureUnit andOperation: #/.! !
!MeasureUnit methodsFor: 'math operations' stamp: 'GDS 6/7/2017 21:21:57' prior: 50360996!
          / aMeasureUnit 
	(self hasSameDefaultNameAs: aMeasureUnit) ifTrue: [^ NullUnit new].
	^ CompoundUnit withUnit: self and: aMeasureUnit andOperation: #/.! !

"F" MeasureTest debug: #test02DifferentTwoMetersObjectAreEqual!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:23:43' prior: 50360815!
         = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [self / aMeasure = Measure withAmount: 1 andUnit: NullUnit]].! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:23:46' prior: 50361014!
                            = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [self / aMeasure = Measure withAmount: 1 andUnit: NullUnit new]].! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:24:04' prior: 50361023!
                        = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [self / aMeasure = (Measure withAmount: 1 andUnit: NullUnit new)]].! !

"E" MeasureTest debug: #test01MeterIsEqualToHimself!
!NullUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:24:45'!
               amountThatRepresentsNothing
	self shouldBeImplemented! !
!NullUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:24:50' prior: 50361042!
           amountThatRepresentsNothing
	^ 0! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:26:18' prior: 50361032!
 = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [self / aMeasure = (Measure withAmount: 1 andUnit: NullUnit new)]].! !
!NullUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:26:42'!
     applyConversionMethodTo: aSmallInteger 
	self shouldBeImplemented! !
!NullUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:26:48' prior: 50361059!
                               applyConversionMethodTo: aSmallInteger 
	^ self! !
!NullUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:27:08'!
 defaultName
	self shouldBeImplemented! !
!NullUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:27:18' prior: 50361069!
                           defaultName
	^ ''! !
!NullUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:27:38'!
                               / aNullUnit 
	self shouldBeImplemented! !
!NullUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:28:00' prior: 50361078!
                          / aNullUnit 
	^ self! !

----SNAPSHOT----#(7 June 2017 9:28:11.89283 pm) Cuis5.0-3081-spur-64.image priorSource: 929105!

----SNAPSHOT----#(7 June 2017 9:28:19.552143 pm) Cuis5.0-3081-spur-64.image priorSource: 941943!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:31:45' prior: 50361051!
          = aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [(self / aMeasure) amount = 1 and: [(self / aMeasure) unit = NullUnit new]]].! !

----SNAPSHOT----#(7 June 2017 9:32:03.084641 pm) Cuis5.0-3081-spur-64.image priorSource: 942040!

"F" MeasureTest debug: #test01MeterIsEqualToHimself!

(self / aMeasure) amount!

(self / aMeasure) unit!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:32:46' prior: 50361093!
= aMeasure
	
	^ (aMeasure isKindOf: self class) and: [
		(self isNothing and: [aMeasure isNothing]) or: [(self / aMeasure) amount = 1 and: [(self / aMeasure) unit isKindOf: NullUnit]]].! !

----SNAPSHOT----#(7 June 2017 9:33:10.786518 pm) Cuis5.0-3081-spur-64.image priorSource: 942424!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:39:50' prior: 50360972!
      / aDividend 
	| aDividendInDefaultUnit selfInDefaultUnit |
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	(aDividend isKindOf: MeasureUnit) ifTrue: [
		 ^ self class withAmount: amount andUnit: aDividend ].
	
	selfInDefaultUnit := self convertToDefaultUnit .
	aDividendInDefaultUnit := aDividend convertToDefaultUnit .
	^ self class withAmount: selfInDefaultUnit amount / aDividendInDefaultUnit amount andUnit: unit / aDividend unit.! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:41:36' prior: 50361120!
                        / aDividend 
	| aDividendInDefaultUnit selfInDefaultUnit |
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	(aDividend isKindOf: MeasureUnit) ifTrue: [
		 ^ self class withAmount: amount andUnit: (CompoundUnit withUnit: self andUnit: aDividend andOperation: #/)].
	
	selfInDefaultUnit := self convertToDefaultUnit .
	aDividendInDefaultUnit := aDividend convertToDefaultUnit .
	^ self class withAmount: selfInDefaultUnit amount / aDividendInDefaultUnit amount andUnit: unit / aDividend unit.! !

----SNAPSHOT----#(7 June 2017 9:41:41.175048 pm) Cuis5.0-3081-spur-64.image priorSource: 942908!
!CompoundUnit class methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 21:56:38'!
    amountThatRepresentsNothing
	self shouldBeImplemented! !

"E" MeasureTest debug: #test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual!

CompoundUnit class removeSelector: #amountThatRepresentsNothing!

"E" MeasureTest debug: #test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 22:14:41' prior: 50361139!
/ aDividend 
	| aDividendInDefaultUnit selfInDefaultUnit |
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	(aDividend isKindOf: MeasureUnit) ifTrue: [
		 ^ self class withAmount: amount andUnit: (CompoundUnit withUnit: self and: aDividend andOperation: #/)].
	
	selfInDefaultUnit := self convertToDefaultUnit .
	aDividendInDefaultUnit := aDividend convertToDefaultUnit .
	^ self class withAmount: selfInDefaultUnit amount / aDividendInDefaultUnit amount andUnit: unit / aDividend unit.! !
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 22:17:23' prior: 50361174!
     / aDividend 
	| aDividendInDefaultUnit selfInDefaultUnit |
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	(aDividend isKindOf: MeasureUnit) ifTrue: [
		 ^ self class withAmount: amount andUnit: (CompoundUnit withUnit: self and: aDividend andOperation: #/)].
	
	selfInDefaultUnit := self convertToDefaultUnit .
	aDividendInDefaultUnit := aDividend convertToDefaultUnit .
	^ self class withAmount: selfInDefaultUnit amount / aDividendInDefaultUnit amount andUnit: unit / aDividend unit.! !

MeasureUnitBehavior class removeSelector: #withUnit:andUnit:andOperation:!

"E" MeasureTest debug: #test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual!
!Measure methodsFor: 'as yet unclassified' stamp: 'GDS 6/7/2017 22:19:32' prior: 50361194!
    / aDividend 
	| aDividendInDefaultUnit selfInDefaultUnit |
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	(aDividend isKindOf: MeasureUnit) ifTrue: [
		 ^ self class withAmount: amount andUnit: (CompoundUnit withUnit: unit and: aDividend andOperation: #/)].
	
	selfInDefaultUnit := self convertToDefaultUnit .
	aDividendInDefaultUnit := aDividend convertToDefaultUnit .
	^ self class withAmount: selfInDefaultUnit amount / aDividendInDefaultUnit amount andUnit: unit / aDividend unit.! !

"E" MeasureTest debug: #test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual!

----SNAPSHOT----#(7 June 2017 10:29:35.389069 pm) Cuis5.0-3081-spur-64.image priorSource: 944259!

----QUIT----#(7 June 2017 10:30:14.855798 pm) Cuis5.0-3081-spur-64.image priorSource: 946900!

----STARTUP----#(8 June 2017 4:00:26.741222 pm) as /home/sherman1000/Desktop/Facu/POO/Cuis-Smalltalk-Dev/Cuis5.0-3081-spur-64.image!

!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:17:58'!
                 centimeter
	^ -1 meters! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:19:30' prior: 50361252!
    centimeter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 100]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 100] .
	^ MeasureUnit withName: 'meter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !

MeasureFactory removeSelector: #minusOneMeter!

MeasureFactory removeSelector: #oneCentimeter!

MeasureFactory removeSelector: #oneHundredCentimeters!

MeasureFactory removeSelector: #oneMeter!

MeasureFactory removeSelector: #twoHundredCentimeters!

MeasureFactory removeSelector: #twoMeters!

MeasureFactory removeSelector: #zeroMeters!
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:20:13'!
         decimeter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 100]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 100] .
	^ MeasureUnit withName: 'meter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:20:25' prior: 50361281!
              decimeter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 100]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 100] .
	^ MeasureUnit withName: 'decimeter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:20:32' prior: 50361256!
          centimeter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 100]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 100] .
	^ MeasureUnit withName: 'centimeter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:20:50' prior: 50361296!
        decimeter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 10]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 10] .
	^ MeasureUnit withName: 'decimeter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:21:12' prior: 50361326!
            decimeter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 10]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 10] .
	^ MeasureUnit withName: 'decimeter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:21:30'!
                            decameter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 10]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 10] .
	^ MeasureUnit withName: 'decimeter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:21:33' prior: 50361356!
            decameter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 10]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 10] .
	^ MeasureUnit withName: 'decameter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:21:40' prior: 50361371!
            decameter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 10]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 10] .
	^ MeasureUnit withName: 'decameter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:22:38'!
                            hectometer
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 10]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 10] .
	^ MeasureUnit withName: 'decameter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:22:44' prior: 50361401!
           hectometer
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 10]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 10] .
	^ MeasureUnit withName: 'hectometer' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:22:57' prior: 50361416!
          hectometer
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 100]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 10] .
	^ MeasureUnit withName: 'hectometer' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:23:01' prior: 50361431!
         hectometer
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 100]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 10] .
	^ MeasureUnit withName: 'hectometer' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:23:06' prior: 50361446!
         hectometer
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 100]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 100] .
	^ MeasureUnit withName: 'hectometer' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:23:23'!
                        kilometer
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1000]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 100] .
	^ MeasureUnit withName: 'hectometer' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:23:27' prior: 50361476!
        kilometer
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1000]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1000] .
	^ MeasureUnit withName: 'hectometer' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:23:33' prior: 50361491!
       kilometer
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1000]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1000] .
	^ MeasureUnit withName: 'kilometer' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:23:41'!
                        meter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1000]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1000] .
	^ MeasureUnit withName: 'kilometer' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:23:49' prior: 50361521!
            meter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	^ MeasureUnit withName: 'kilometer' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:23:53' prior: 50361536!
                  meter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	^ MeasureUnit withName: 'meter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:24:00'!
      millimeter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	^ MeasureUnit withName: 'meter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:24:23' prior: 50361565!
                 millimeter
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit / 1000]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit * 1000] .
	^ MeasureUnit withName: 'meter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:25:05'!
                           minusOneMeter

	^ -1 meters! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:25:21'!
                oneCentimeter

	^ 1 centimeters! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:25:38'!
            oneHundredCentimeters

	^ 100 centimeters! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:25:49'!
  oneMeter

	^ 1 meters! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:26:02'!
                      twoHundredCentimeters

	^ 200 centimeters! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:26:13'!
  twoMeters

	^ 2 meters! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:26:21'!
                     zeroMeters

	^ 0 meters! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:26:34'!
                    celsius
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 10]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 10] .
	^ MeasureUnit withName: 'decimeter' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:26:43' prior: 50361623!
              celsius
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 10]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 10] .
	^ MeasureUnit withName: 'celsius' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'temperature'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:27:33' prior: 50361638!
          celsius
	| aCelsiusConverter |
	aCelsiusConverter := MeasureUnitConverter withConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit + 273.15]  andInverseConversionMethod: [:temperatureAmountInDefaultUnit | temperatureAmountInDefaultUnit - 273.15]  .

	^ MeasureUnit  withName: 'celsius' andAConverter: aCelsiusConverter andAmountValueThatRepresentsNothing: -273.15andDefaultName: 'kelvin'! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:27:52'!
             fahrenheit
	| aCelsiusConverter |
	aCelsiusConverter := MeasureUnitConverter withConversionMethod: [:temperatureAmountIntThisUnit | temperatureAmountIntThisUnit + 273.15]  andInverseConversionMethod: [:temperatureAmountInDefaultUnit | temperatureAmountInDefaultUnit - 273.15]  .

	^ MeasureUnit  withName: 'celsius' andAConverter: aCelsiusConverter andAmountValueThatRepresentsNothing: -273.15andDefaultName: 'kelvin'! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:28:22' prior: 50361669!
                          fahrenheit
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:temperatureAmountInThisUnit | (temperatureAmountInThisUnit + 459.67) * (5/9)] andInverseConversionMethod: [:temperatureAmountInDefaultUnit | (temperatureAmountInDefaultUnit * (9/5)) - 459.67] .

	^ MeasureUnit withName: 'fahrenheit' andAConverter: aConverter andAmountValueThatRepresentsNothing: -459.67 andDefaultName: 'kelvin' ! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:28:32'!
            kelvin
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:temperatureAmountInThisUnit | (temperatureAmountInThisUnit + 459.67) * (5/9)] andInverseConversionMethod: [:temperatureAmountInDefaultUnit | (temperatureAmountInDefaultUnit * (9/5)) - 459.67] .

	^ MeasureUnit withName: 'fahrenheit' andAConverter: aConverter andAmountValueThatRepresentsNothing: -459.67 andDefaultName: 'kelvin' ! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:29:00' prior: 50361702!
kelvin
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ MeasureUnit withName: 'kelvin' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'kelvin' ! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:29:21'!
   oneCelsius

	^ 1 celsius! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:29:44'!
                   thirtyTwoFahrenheits

	^ 32 fahrenheit! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:30:02'!
     twoCelisus

	^ 2 celsius! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:30:08'!
                   zeroCelisus

	^ 0 celsius! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:30:18'!
                  zeroKelvin 

	^ 0 kelvin! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:31:14'!
                   day
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 10]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 10] .
	^ MeasureUnit withName: 'day' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hours'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:33:14' prior: 50361751!
                        day
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 24]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 24] .
	^ MeasureUnit withName: 'day' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hours'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:33:24' prior: 50361766!
        day
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 24]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit / 24] .
	^ MeasureUnit withName: 'day' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hours'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:33:45'!
                        hour
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 1]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit / 1] .
	^ MeasureUnit withName: 'day' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hours'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:33:57'!
                         minute
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 1]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit / 1] .
	^ MeasureUnit withName: 'day' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hours'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:34:08' prior: 50361808!
       minute
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 60] .
	^ MeasureUnit withName: 'day' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hours'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:34:14' prior: 50361822!
     minute
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 60] .
	^ MeasureUnit withName: 'minute' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hours'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:34:25' prior: 50361794!
  hour
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 1]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit / 1] .
	^ MeasureUnit withName: 'hour' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hours'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:34:29' prior: 50361850!
        hour
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 1]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit / 1] .
	^ MeasureUnit withName: 'hour' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hour'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:34:33' prior: 50361780!
         day
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 24]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit / 24] .
	^ MeasureUnit withName: 'day' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hour'.! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:34:47' prior: 50361836!
         minute
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 60] .
	^ MeasureUnit withName: 'minute' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hour'.! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/8/2017 16:36:21' prior: 16879900!
           days
	|aConverter| 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'day' 
				andAConverter: aConverter
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'hour' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/8/2017 16:36:38' prior: 50361906!
                             days
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 24]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit / 24] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'day' 
				andAConverter: aConverter
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'hour' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/8/2017 16:36:55' prior: 16879932!
          minutes
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 24]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit / 24] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'minute' 
				andAConverter: aConverter
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'hour' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/8/2017 16:37:12' prior: 50361938!
    minutes
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 60] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'minute' 
				andAConverter: aConverter
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'hour' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/8/2017 16:37:21' prior: 16879946!
    seconds
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 60] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'minute' 
				andAConverter: aConverter
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'hour' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/8/2017 16:37:24' prior: 50361970!
    seconds
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 60]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 60] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'second' 
				andAConverter: aConverter
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'hour' 
				)! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:38:26'!
            second
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 3600]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 3600] .
	^ MeasureUnit withName: 'second' andAConverter: aConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hour'.! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/8/2017 16:38:35' prior: 50361986!
       seconds
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 3600]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 3600] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'second' 
				andAConverter: aConverter
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'hour' 
				)! !
!Number methodsFor: '*Distance-Solution' stamp: 'GDS 6/8/2017 16:39:43' prior: 16879920!
hours
	| aConverter |
	aConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit * 1]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit / 1] .

	^ Measure 
		withAmount: self 
		andUnit: (
			MeasureUnit 
				withName: 'hour' 
				andAConverter: aConverter
				andAmountValueThatRepresentsNothing: 0
				andDefaultName: 'hour' 
				)! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:40:09'!
                  oneDay

	^ 1 days! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:40:21'!
                          oneHour

	^ 1 hours! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:40:28'!
                        oneSecond

	^ 1 seconds! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:40:45'!
                    sixtyMinutes

	^ 60 minutes! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:40:59'!
                sixtyOneSeconds

	^ 61 seconds! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:41:05'!
             sixtySeconds

	^ 61 seconds! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:41:07' prior: 50362068!
sixtySeconds

	^ 60 seconds! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:41:19'!
                twentyFourHours

	^ 24 hours! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:41:27'!
               twoSeconds

	^ 2 seconds! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:41:32'!
                   zeroSeconds

	^ 0 seconds! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:43:12'!
                  eightCubicmeters

	^ 8 meters * (self meter) * (self meter)! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:43:19'!
                eightCubicMeters

	^ 8 meters * (self meter) * (self meter)! !

MeasureFactory removeSelector: #eightCubicmeters!
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:43:37'!
                             fourSquaredMeters

	^ 4 meters * (self meter)! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:43:59'!
                              oneHundredTwentyOneMetersPerSecond

	^ 121 meters / (self second)! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:44:14'!
          oneMeterPerSecond

	^ 1 meters / (self second)! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:44:30'!
                             oneSquaredMeter

	^ 1 meters * (self meter)! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:44:43'!
oneSquaredSecond

	^ 1 seconds * (self second)! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:45:05'!
                             twoMetersBySecond

	^ 2 meters / (self second)! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:45:31'!
                             twoMetersPerSquaredSecond

	^ 2 meters / (self second * (self second))! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:45:48'!
     twoMetersTimesSecond

	^ 2 meters * (self second)! !
!MeasureFactory methodsFor: 'instances-creation' stamp: 'GDS 6/8/2017 16:47:45'!
                          finalSpeedStartingAt: vi accelerating: a during: t

	^ vi + a * t! !

----SNAPSHOT----#(8 June 2017 4:48:07.24993 pm) Cuis5.0-3081-spur-64.image priorSource: 946999!

----SNAPSHOT----#(8 June 2017 4:49:33.377047 pm) Cuis5.0-3081-spur-64.image priorSource: 975780!

MeasureUnitBehavior subclass: #CompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit operation'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #CompoundUnit category: #'Measure-Solution'!
MeasureUnitBehavior subclass: #CompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit operation'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

MeasureUnitBehavior subclass: #NullUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #NullUnit category: #'Measure-Solution'!
MeasureUnitBehavior subclass: #NullUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

Object subclass: #MeasureOperation
	instanceVariableNames: 'firstMeasure secondMeasure'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #MeasureOperation category: #'Measure-Solution'!
Object subclass: #MeasureOperation
	instanceVariableNames: 'firstMeasure secondMeasure'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

Object subclass: #MeasureFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #MeasureFactory category: #'Measure-Solution'!
Object subclass: #MeasureFactory
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

Object subclass: #MeasureUnitConverter
	instanceVariableNames: 'conversionMethod inverseConversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #MeasureUnitConverter category: #'Measure-Solution'!
Object subclass: #MeasureUnitConverter
	instanceVariableNames: 'conversionMethod inverseConversionMethod'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit pesosUnit secondUnit tenMetersPerSecond tenSquareMeters tenSquareMetersPerSecond aConverter aDefaultConverter aSecondConverter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #MeasureTest category: #'Measure-Solution'!
TestCase subclass: #MeasureTest
	instanceVariableNames: 'aMeter twoMeters hundredCentimeters twoHundredCentimeters thousandMillimeters halfAMeter tenKilometers zeroKilograms aKilogram twoKilograms hundredGrams oneThousandOneHundredGrams tenPesos meterUnit pesosUnit secondUnit tenMetersPerSecond tenSquareMeters tenSquareMetersPerSecond aConverter aDefaultConverter aSecondConverter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

!classDefinition: #Measure category: #'Distance-Solution'!
Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Distance-Solution'!

Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #Measure category: #'Measure-Solution'!
Magnitude subclass: #Measure
	instanceVariableNames: 'amount unit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

MeasureUnitBehavior subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName amountThatRepresentsNothing converter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #MeasureUnit category: #'Measure-Solution'!
MeasureUnitBehavior subclass: #MeasureUnit
	instanceVariableNames: 'name defaultName amountThatRepresentsNothing converter'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

Object subclass: #MeasureUnitBehavior
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #MeasureUnitBehavior category: #'Measure-Solution'!
Object subclass: #MeasureUnitBehavior
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

"E" MeasureTest debug: #test35DifferentWaysToCreateMeasureWithCompoundUnitAreEqual!

----SNAPSHOT----#(8 June 2017 4:54:14.048737 pm) Cuis5.0-3081-spur-64.image priorSource: 975877!
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/8/2017 16:54:22'!
                       applyConversionMethodTo: aSmallInteger 
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/8/2017 17:07:31' prior: 50362296!
                           applyConversionMethodTo: anAmount 
	| unitAsMeasure secondUnitAsMeasure |

	unitAsMeasure := Measure withAmount: 1 andUnit: measureUnit.
	secondUnitAsMeasure := Measure withAmount: 1 andUnit: secondMeasureUnit.
	^ anAmount * (unitAsMeasure convertToDefaultUnit amount) * (secondUnitAsMeasure convertToDefaultUnit amount)! !

----SNAPSHOT----#(8 June 2017 5:10:20.941428 pm) Cuis5.0-3081-spur-64.image priorSource: 980534!

self name!
!CompoundUnit methodsFor: 'accessing' stamp: 'GDS 6/8/2017 17:18:52'!
        operation
	^ operation! !
!Measure methodsFor: 'converting' stamp: 'GDS 6/8/2017 17:19:00' prior: 50360219!
                    convertToDefaultUnit

	|aConverter unitAsMeasure secondUnitAsMeasure | 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	(unit isKindOf: CompoundUnit) ifTrue: [ | newUnit |
		unitAsMeasure := Measure withAmount: 1 andUnit: unit measureUnit.
		secondUnitAsMeasure := Measure withAmount: 1 andUnit: unit secondMeasureUnit.
		newUnit := CompoundUnit withUnit: unitAsMeasure convertToDefaultUnit unit and: secondUnitAsMeasure convertToDefaultUnit unit andOperation: unit operation.
		].

	^ self class new 
		initializeWithAmount: (unit applyConversionMethodTo: amount) 
		andUnit: (
			MeasureUnit 
				withName: unit defaultName 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing
				andDefaultName: unit defaultName 
			)! !
!Measure methodsFor: 'converting' stamp: 'GDS 6/8/2017 17:20:51' prior: 50362322!
                             convertToDefaultUnit

	|aConverter unitAsMeasure secondUnitAsMeasure newUnit | 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	(unit isKindOf: CompoundUnit) ifTrue: [
		unitAsMeasure := Measure withAmount: 1 andUnit: unit measureUnit.
		secondUnitAsMeasure := Measure withAmount: 1 andUnit: unit secondMeasureUnit.
		newUnit := CompoundUnit withUnit: unitAsMeasure convertToDefaultUnit unit and: secondUnitAsMeasure convertToDefaultUnit unit andOperation: unit operation.
	] ifFalse: [
		newUnit := 
			MeasureUnit 
				withName: unit defaultName 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing
				andDefaultName: unit defaultName 
	].

	^ self class new 
		initializeWithAmount: (unit applyConversionMethodTo: amount) 
		andUnit: newUnit! !

self / aMeasure!

unit name!

unit measureUnit!

10 * meterUnit/secondUnit!
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/8/2017 17:24:20' prior: 50360353!
                         setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 3600]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 3600] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' .
	secondUnit := MeasureUnit withName: 'second' andAConverter: aSecondConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hour'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !

selfInDefaultUnit amount / aDividendInDefaultUnit amount!

CompoundUnit subclass: #DivisionCompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit operation'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

CompoundUnit subclass: #DivisionCompoundUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #DivisionCompoundUnit category: #'Measure-Solution'!
CompoundUnit subclass: #DivisionCompoundUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

CompoundUnit subclass: #MultiplicationCompoundUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #MultiplicationCompoundUnit category: #'Measure-Solution'!
CompoundUnit subclass: #MultiplicationCompoundUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

MeasureUnitBehavior subclass: #CompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #CompoundUnit category: #'Measure-Solution'!
MeasureUnitBehavior subclass: #CompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

CompoundUnit class removeSelector: #withUnit:and:andOperation:!
!Measure methodsFor: 'math operations' stamp: 'GDS 6/8/2017 17:40:02' prior: 50358487!
           * aMultiplier 
	(aMultiplier isKindOf: Number) ifTrue: [
		^ self class withAmount: amount * aMultiplier andUnit: unit].
	^ self class withAmount: amount andUnit: (MultiplicationCompoundUnit withUnit: unit and: aMultiplier andOperation: #*).! !
!Measure methodsFor: 'math operations' stamp: 'GDS 6/8/2017 17:40:21' prior: 50361219!
                    / aDividend 
	| aDividendInDefaultUnit selfInDefaultUnit |
	(aDividend isKindOf: Number) ifTrue: [
		^ self class withAmount: amount / aDividend andUnit: unit].
	(aDividend isKindOf: MeasureUnit) ifTrue: [
		 ^ self class withAmount: amount andUnit: (DivisionCompoundUnit withUnit: unit and: aDividend)].
	
	selfInDefaultUnit := self convertToDefaultUnit .
	aDividendInDefaultUnit := aDividend convertToDefaultUnit .
	^ self class withAmount: selfInDefaultUnit amount / aDividendInDefaultUnit amount andUnit: unit / aDividend unit.! !
!Measure methodsFor: 'math operations' stamp: 'GDS 6/8/2017 17:40:31' prior: 50362492!
                  * aMultiplier 
	(aMultiplier isKindOf: Number) ifTrue: [
		^ self class withAmount: amount * aMultiplier andUnit: unit].
	^ self class withAmount: amount andUnit: (MultiplicationCompoundUnit withUnit: unit and: aMultiplier).! !
!Measure methodsFor: 'converting' stamp: 'GDS 6/8/2017 17:41:22' prior: 50362354!
          convertToDefaultUnit

	|aConverter unitAsMeasure secondUnitAsMeasure newUnit | 
	aConverter := MeasureUnitConverter withConversionMethod: [:amountInThisUnit | amountInThisUnit * 1]  andInverseConversionMethod: [:amountInDefaultUnit | amountInDefaultUnit / 1] .

	(unit isKindOf: CompoundUnit) ifTrue: [
		unitAsMeasure := Measure withAmount: 1 andUnit: unit measureUnit.
		secondUnitAsMeasure := Measure withAmount: 1 andUnit: unit secondMeasureUnit.
		newUnit := unit class withUnit: unitAsMeasure convertToDefaultUnit unit and: secondUnitAsMeasure convertToDefaultUnit unit.
	] ifFalse: [
		newUnit := 
			MeasureUnit 
				withName: unit defaultName 
				andAConverter: aConverter 
				andAmountValueThatRepresentsNothing: unit amountThatRepresentsNothing
				andDefaultName: unit defaultName 
	].

	^ self class new 
		initializeWithAmount: (unit applyConversionMethodTo: amount) 
		andUnit: newUnit! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/8/2017 17:41:37' prior: 50362389!
     setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 3600]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 3600] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' .
	secondUnit := MeasureUnit withName: 'second' andAConverter: aSecondConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hour'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: meterUnit and: secondUnit andOperation: #/).
	tenSquareMeters := Measure withAmount: 10 andUnit: (MultiplicationCompoundUnit withUnit: meterUnit and: meterUnit).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/8/2017 17:41:45' prior: 50362564!
        setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 3600]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 3600] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' .
	secondUnit := MeasureUnit withName: 'second' andAConverter: aSecondConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hour'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (DivisionCompoundUnit withUnit: meterUnit and: secondUnit).
	tenSquareMeters := Measure withAmount: 10 andUnit: (MultiplicationCompoundUnit withUnit: meterUnit and: meterUnit).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (CompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit andOperation: #/).! !
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/8/2017 17:41:53' prior: 50362620!
                 setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 3600]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 3600] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' .
	secondUnit := MeasureUnit withName: 'second' andAConverter: aSecondConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hour'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (DivisionCompoundUnit withUnit: meterUnit and: secondUnit).
	tenSquareMeters := Measure withAmount: 10 andUnit: (MultiplicationCompoundUnit withUnit: meterUnit and: meterUnit).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (CompoundUnit withUnit: (DivisionCompoundUnit withUnit: meterUnit and: meterUnit andOperation: #*) and: secondUnit).! !
!MeasureUnit methodsFor: 'math operations' stamp: 'GDS 6/8/2017 17:42:06' prior: 50358801!
                * aMeasureUnit 
	^ MultiplicationCompoundUnit withUnit: self and: aMeasureUnit.! !
!MeasureUnit methodsFor: 'math operations' stamp: 'GDS 6/8/2017 17:42:17' prior: 50361004!
                  / aMeasureUnit 
	(self hasSameDefaultNameAs: aMeasureUnit) ifTrue: [^ NullUnit new].
	^ DivisionCompoundUnit withUnit: self and: aMeasureUnit.! !

"E" MeasureTest debug: #test01MeterIsEqualToHimself!
!DivisionCompoundUnit class methodsFor: 'initialization' stamp: 'GDS 6/8/2017 17:42:45'!
                               withUnit: aMeasureUnit and: aMeasureUnit2 
	self shouldBeImplemented! !
!CompoundUnit methodsFor: 'initialization' stamp: 'GDS 6/8/2017 17:43:13' prior: 50358827!
                             initializeWith: aMeasureUnit and: anotherMeasureUnit andOperation: anOperation
	measureUnit := aMeasureUnit.
	secondMeasureUnit := anotherMeasureUnit.! !
!CompoundUnit class methodsFor: 'instance creation' stamp: 'GDS 6/8/2017 17:44:35'!
                  withUnit: aMeasureUnit and: anotherMeasureUnit
	^ self new initializeWith: aMeasureUnit and: anotherMeasureUnit ! !
!CompoundUnit methodsFor: 'initialization' stamp: 'GDS 6/8/2017 17:44:43'!
 initializeWith: aMeasureUnit and: anotherMeasureUnit
	measureUnit := aMeasureUnit.
	secondMeasureUnit := anotherMeasureUnit.! !

CompoundUnit removeSelector: #initializeWith:and:andOperation:!

"E" MeasureTest debug: #test01MeterIsEqualToHimself!

DivisionCompoundUnit class removeSelector: #withUnit:and:!

"E" MeasureTest debug: #test02DifferentTwoMetersObjectAreEqual!
!MeasureTest methodsFor: 'setup' stamp: 'GDS 6/8/2017 17:45:29' prior: 50362676!
                           setUp

	aDefaultConverter := MeasureUnitConverter withConversionMethod: [:distanceAmountInThisUnit | distanceAmountInThisUnit * 1]  andInverseConversionMethod: [:distanceAmountInDefaultUnit | distanceAmountInDefaultUnit / 1] .
	aSecondConverter := MeasureUnitConverter withConversionMethod: [:timeAmountInThisUnit | timeAmountInThisUnit / 3600]  andInverseConversionMethod: [:timeAmountInDefaultUnit | timeAmountInDefaultUnit * 3600] .
	aMeter := 1 meters.
	halfAMeter := (1/2) meters.
	twoMeters := 2 meters.
	hundredCentimeters := 100 centimeters.
	twoHundredCentimeters := 200 centimeters.
	thousandMillimeters := 1000 millimeters.
	tenKilometers := 10 kilometers.
	zeroKilograms := 0 kilograms.
	aKilogram := 1 kilograms.
	twoKilograms := 2 kilograms.
	hundredGrams := 100 grams.
	oneThousandOneHundredGrams := 1100 grams.
	tenPesos := 10 pesos.
	meterUnit := MeasureUnit withName: 'meter' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'meter'.
	pesosUnit := MeasureUnit withName: 'peso' andAConverter: aDefaultConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'peso' .
	secondUnit := MeasureUnit withName: 'second' andAConverter: aSecondConverter andAmountValueThatRepresentsNothing: 0 andDefaultName: 'hour'.
	tenMetersPerSecond := Measure withAmount: 10 andUnit: (DivisionCompoundUnit withUnit: meterUnit and: secondUnit).
	tenSquareMeters := Measure withAmount: 10 andUnit: (MultiplicationCompoundUnit withUnit: meterUnit and: meterUnit).
	tenSquareMetersPerSecond := Measure withAmount: 10 andUnit: (MultiplicationCompoundUnit withUnit: (DivisionCompoundUnit withUnit: meterUnit and: meterUnit) and: secondUnit).! !
!CompoundUnit methodsFor: 'math operations' stamp: 'GDS 6/8/2017 17:46:41' prior: 50358475!
                  * aMeasureUnit 
	^ self subclassResponsibility .! !
!CompoundUnit methodsFor: 'math operations' stamp: 'GDS 6/8/2017 17:46:51' prior: 50358481!
                / aMeasureUnit 
	^ self subclassResponsibility . ! !
!DivisionCompoundUnit methodsFor: 'nil' stamp: 'GDS 6/8/2017 17:47:49'!
   / aMeasureUnit

! !

MeasureUnitBehavior subclass: #CompoundUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #CompoundUnit category: #'Measure-Solution'!
MeasureUnitBehavior subclass: #CompoundUnit
	instanceVariableNames: ''
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

CompoundUnit subclass: #DivisionCompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #DivisionCompoundUnit category: #'Measure-Solution'!
CompoundUnit subclass: #DivisionCompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

CompoundUnit subclass: #MultiplicationCompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!

!classDefinition: #MultiplicationCompoundUnit category: #'Measure-Solution'!
CompoundUnit subclass: #MultiplicationCompoundUnit
	instanceVariableNames: 'measureUnit secondMeasureUnit'
	classVariableNames: ''
	poolDictionaries: ''
	category: 'Measure-Solution'!
!DivisionCompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/8/2017 17:53:59' prior: 50362848!
               / aMeasureUnit

	((aMeasureUnit isKindOf: CompoundUnit) and:[ measureUnit hasSameDefaultNameAs: ''] ) ifTrue: 
	(secondMeasureUnit hasSameDefaultNameAs: aMeasureUnit) ifTrue: [^ measureUnit].

	
	! !
!DivisionCompoundUnit methodsFor: 'as yet unclassified' stamp: 'GDS 6/8/2017 17:54:32' prior: 50362891!
                / aMeasureUnit

	(secondMeasureUnit hasSameDefaultNameAs: aMeasureUnit) ifTrue: [^ measureUnit].

	
	! !

----SNAPSHOT----#(8 June 2017 5:55:18.632806 pm) Cuis5.0-3081-spur-64.image priorSource: 981251!

----SNAPSHOT----#(8 June 2017 5:55:43.561218 pm) Cuis5.0-3081-spur-64.image priorSource: 1000200!